/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={239:(t,e,i)=>{t=i.nmd(t),function(){var t=function(){return this}();t||"undefined"==typeof window||(t=window);var e=function(t,i,n){"string"==typeof t?(2==arguments.length&&(n=i),e.modules[t]||(e.payloads[t]=n,e.modules[t]=null)):e.original?e.original.apply(this,arguments):(console.error("dropping module because define wasn't a string."),console.trace())};e.modules={},e.payloads={};var i,n,s=function(t,e,i){if("string"==typeof e){var n=a(t,e);if(null!=n)return i&&i(),n}else if("[object Array]"===Object.prototype.toString.call(e)){for(var s=[],r=0,l=e.length;r<l;++r){var h=a(t,e[r]);if(null==h&&o.original)return;s.push(h)}return i&&i.apply(null,s)||!0}},o=function(t,e){var i=s("",t,e);return null==i&&o.original?o.original.apply(this,arguments):i},r=function(t,e){if(-1!==e.indexOf("!")){var i=e.split("!");return r(t,i[0])+"!"+r(t,i[1])}if("."==e.charAt(0))for(e=t.split("/").slice(0,-1).join("/")+"/"+e;-1!==e.indexOf(".")&&n!=e;){var n=e;e=e.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return e},a=function(t,i){i=r(t,i);var n=e.modules[i];if(!n){if("function"==typeof(n=e.payloads[i])){var o={},a={id:i,uri:"",exports:o,packaged:!0};o=n((function(t,e){return s(i,t,e)}),o,a)||a.exports,e.modules[i]=o,delete e.payloads[i]}n=e.modules[i]=o||n}return n};n=t,(i="ace")&&(t[i]||(t[i]={}),n=t[i]),n.define&&n.define.packaged||(e.original=n.define,n.define=e,n.define.packaged=!0),n.require&&n.require.packaged||(o.original=n.require,n.require=o,n.require.packaged=!0)}(),ace.define("ace/lib/es6-shim",["require","exports","module"],(function(t,e,i){function n(t,e,i){Object.defineProperty(t,e,{value:i,enumerable:!1,writable:!0,configurable:!0})}String.prototype.startsWith||n(String.prototype,"startsWith",(function(t,e){return e=e||0,this.lastIndexOf(t,e)===e})),String.prototype.endsWith||n(String.prototype,"endsWith",(function(t,e){var i=this;(void 0===e||e>i.length)&&(e=i.length),e-=t.length;var n=i.indexOf(t,e);return-1!==n&&n===e})),String.prototype.repeat||n(String.prototype,"repeat",(function(t){for(var e="",i=this;t>0;)1&t&&(e+=i),(t>>=1)&&(i+=i);return e})),String.prototype.includes||n(String.prototype,"includes",(function(t,e){return-1!=this.indexOf(t,e)})),Object.assign||(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];null!=n&&Object.keys(n).forEach((function(t){e[t]=n[t]}))}return e}),Object.values||(Object.values=function(t){return Object.keys(t).map((function(e){return t[e]}))}),Array.prototype.find||n(Array.prototype,"find",(function(t){for(var e=this.length,i=arguments[1],n=0;n<e;n++){var s=this[n];if(t.call(i,s,n,this))return s}})),Array.prototype.findIndex||n(Array.prototype,"findIndex",(function(t){for(var e=this.length,i=arguments[1],n=0;n<e;n++){var s=this[n];if(t.call(i,s,n,this))return n}})),Array.prototype.includes||n(Array.prototype,"includes",(function(t,e){return-1!=this.indexOf(t,e)})),Array.prototype.fill||n(Array.prototype,"fill",(function(t){for(var e=this,i=e.length>>>0,n=arguments[1]>>0,s=n<0?Math.max(i+n,0):Math.min(n,i),o=arguments[2],r=void 0===o?i:o>>0,a=r<0?Math.max(i+r,0):Math.min(r,i);s<a;)e[s]=t,s++;return e})),Array.of||n(Array,"of",(function(){return Array.prototype.slice.call(arguments)}))})),ace.define("ace/lib/fixoldbrowsers",["require","exports","module","ace/lib/es6-shim"],(function(t,e,i){"use strict";t("./es6-shim")})),ace.define("ace/lib/deep_copy",["require","exports","module"],(function(t,e,i){e.deepCopy=function t(e){if("object"!=typeof e||!e)return e;var i;if(Array.isArray(e)){i=[];for(var n=0;n<e.length;n++)i[n]=t(e[n]);return i}if("[object Object]"!==Object.prototype.toString.call(e))return e;for(var n in i={},e)i[n]=t(e[n]);return i}})),ace.define("ace/lib/lang",["require","exports","module","ace/lib/deep_copy"],(function(t,e,i){"use strict";e.last=function(t){return t[t.length-1]},e.stringReverse=function(t){return t.split("").reverse().join("")},e.stringRepeat=function(t,e){for(var i="";e>0;)1&e&&(i+=t),(e>>=1)&&(t+=t);return i};var n=/^\s\s*/,s=/\s\s*$/;e.stringTrimLeft=function(t){return t.replace(n,"")},e.stringTrimRight=function(t){return t.replace(s,"")},e.copyObject=function(t){var e={};for(var i in t)e[i]=t[i];return e},e.copyArray=function(t){for(var e=[],i=0,n=t.length;i<n;i++)t[i]&&"object"==typeof t[i]?e[i]=this.copyObject(t[i]):e[i]=t[i];return e},e.deepCopy=t("./deep_copy").deepCopy,e.arrayToMap=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=1;return e},e.createMap=function(t){var e=Object.create(null);for(var i in t)e[i]=t[i];return e},e.arrayRemove=function(t,e){for(var i=0;i<=t.length;i++)e===t[i]&&t.splice(i,1)},e.escapeRegExp=function(t){return t.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},e.escapeHTML=function(t){return(""+t).replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},e.getMatchOffsets=function(t,e){var i=[];return t.replace(e,(function(t){i.push({offset:arguments[arguments.length-2],length:t.length})})),i},e.deferredCall=function(t){var e=null,i=function(){e=null,t()},n=function(t){return n.cancel(),e=setTimeout(i,t||0),n};return n.schedule=n,n.call=function(){return this.cancel(),t(),n},n.cancel=function(){return clearTimeout(e),e=null,n},n.isPending=function(){return e},n},e.delayedCall=function(t,e){var i=null,n=function(){i=null,t()},s=function(t){null==i&&(i=setTimeout(n,t||e))};return s.delay=function(t){i&&clearTimeout(i),i=setTimeout(n,t||e)},s.schedule=s,s.call=function(){this.cancel(),t()},s.cancel=function(){i&&clearTimeout(i),i=null},s.isPending=function(){return i},s},e.supportsLookbehind=function(){try{new RegExp("(?<=.)")}catch(t){return!1}return!0},e.skipEmptyMatch=function(t,e,i){return i&&t.codePointAt(e)>65535?2:1}})),ace.define("ace/lib/useragent",["require","exports","module"],(function(t,e,i){"use strict";e.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},e.getOS=function(){return e.isMac?e.OS.MAC:e.isLinux?e.OS.LINUX:e.OS.WINDOWS};var n="object"==typeof navigator?navigator:{},s=(/mac|win|linux/i.exec(n.platform)||["other"])[0].toLowerCase(),o=n.userAgent||"",r=n.appName||"";e.isWin="win"==s,e.isMac="mac"==s,e.isLinux="linux"==s,e.isIE="Microsoft Internet Explorer"==r||r.indexOf("MSAppHost")>=0?parseFloat((o.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((o.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),e.isOldIE=e.isIE&&e.isIE<9,e.isGecko=e.isMozilla=o.match(/ Gecko\/\d+/),e.isOpera="object"==typeof opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),e.isWebKit=parseFloat(o.split("WebKit/")[1])||void 0,e.isChrome=parseFloat(o.split(" Chrome/")[1])||void 0,e.isSafari=parseFloat(o.split(" Safari/")[1])&&!e.isChrome||void 0,e.isEdge=parseFloat(o.split(" Edge/")[1])||void 0,e.isAIR=o.indexOf("AdobeAIR")>=0,e.isAndroid=o.indexOf("Android")>=0,e.isChromeOS=o.indexOf(" CrOS ")>=0,e.isIOS=/iPad|iPhone|iPod/.test(o)&&!window.MSStream,e.isIOS&&(e.isMac=!0),e.isMobile=e.isIOS||e.isAndroid})),ace.define("ace/lib/dom",["require","exports","module","ace/lib/useragent"],(function(t,e,i){"use strict";var n,s=t("./useragent");e.buildDom=function t(e,i,n){if("string"==typeof e&&e){var s=document.createTextNode(e);return i&&i.appendChild(s),s}if(!Array.isArray(e))return e&&e.appendChild&&i&&i.appendChild(e),e;if("string"!=typeof e[0]||!e[0]){for(var o=[],r=0;r<e.length;r++){var a=t(e[r],i,n);a&&o.push(a)}return o}var l=document.createElement(e[0]),h=e[1],c=1;for(h&&"object"==typeof h&&!Array.isArray(h)&&(c=2),r=c;r<e.length;r++)t(e[r],l,n);return 2==c&&Object.keys(h).forEach((function(t){var e=h[t];"class"===t?l.className=Array.isArray(e)?e.join(" "):e:"function"==typeof e||"value"==t||"$"==t[0]?l[t]=e:"ref"===t?n&&(n[e]=l):"style"===t?"string"==typeof e&&(l.style.cssText=e):null!=e&&l.setAttribute(t,e)})),i&&i.appendChild(l),l},e.getDocumentHead=function(t){return t||(t=document),t.head||t.getElementsByTagName("head")[0]||t.documentElement},e.createElement=function(t,e){return document.createElementNS?document.createElementNS(e||"http://www.w3.org/1999/xhtml",t):document.createElement(t)},e.removeChildren=function(t){t.innerHTML=""},e.createTextNode=function(t,e){return(e?e.ownerDocument:document).createTextNode(t)},e.createFragment=function(t){return(t?t.ownerDocument:document).createDocumentFragment()},e.hasCssClass=function(t,e){return-1!==(t.className+"").split(/\s+/g).indexOf(e)},e.addCssClass=function(t,i){e.hasCssClass(t,i)||(t.className+=" "+i)},e.removeCssClass=function(t,e){for(var i=t.className.split(/\s+/g);;){var n=i.indexOf(e);if(-1==n)break;i.splice(n,1)}t.className=i.join(" ")},e.toggleCssClass=function(t,e){for(var i=t.className.split(/\s+/g),n=!0;;){var s=i.indexOf(e);if(-1==s)break;n=!1,i.splice(s,1)}return n&&i.push(e),t.className=i.join(" "),n},e.setCssClass=function(t,i,n){n?e.addCssClass(t,i):e.removeCssClass(t,i)},e.hasCssString=function(t,e){var i,n=0;if(i=(e=e||document).querySelectorAll("style"))for(;n<i.length;)if(i[n++].id===t)return!0},e.removeElementById=function(t,e){(e=e||document).getElementById(t)&&e.getElementById(t).remove()};var o=[];function r(){var t=o;o=null,t&&t.forEach((function(t){a(t[0],t[1])}))}function a(t,i,s){if("undefined"!=typeof document){if(o)if(s)r();else if(!1===s)return o.push([t,i]);if(!n){var a=s;s&&s.getRootNode&&(a=s.getRootNode())&&a!=s||(a=document);var l=a.ownerDocument||a;if(i&&e.hasCssString(i,a))return null;i&&(t+="\n/*# sourceURL=ace/css/"+i+" */");var h=e.createElement("style");h.appendChild(l.createTextNode(t)),i&&(h.id=i),a==l&&(a=e.getDocumentHead(l)),a.insertBefore(h,a.firstChild)}}}if(e.useStrictCSP=function(t){n=t,0==t?r():o||(o=[])},e.importCssString=a,e.importCssStylsheet=function(t,i){e.buildDom(["link",{rel:"stylesheet",href:t}],e.getDocumentHead(i))},e.scrollbarWidth=function(t){var i=e.createElement("ace_inner");i.style.width="100%",i.style.minWidth="0px",i.style.height="200px",i.style.display="block";var n=e.createElement("ace_outer"),s=n.style;s.position="absolute",s.left="-10000px",s.overflow="hidden",s.width="200px",s.minWidth="0px",s.height="150px",s.display="block",n.appendChild(i);var o=t&&t.documentElement||document&&document.documentElement;if(!o)return 0;o.appendChild(n);var r=i.offsetWidth;s.overflow="scroll";var a=i.offsetWidth;return r===a&&(a=n.clientWidth),o.removeChild(n),r-a},e.computedStyle=function(t,e){return window.getComputedStyle(t,"")||{}},e.setStyle=function(t,e,i){t[e]!==i&&(t[e]=i)},e.HAS_CSS_ANIMATION=!1,e.HAS_CSS_TRANSFORMS=!1,e.HI_DPI=!s.isWin||"undefined"!=typeof window&&window.devicePixelRatio>=1.5,s.isChromeOS&&(e.HI_DPI=!1),"undefined"!=typeof document){var l=document.createElement("div");e.HI_DPI&&void 0!==l.style.transform&&(e.HAS_CSS_TRANSFORMS=!0),s.isEdge||void 0===l.style.animationName||(e.HAS_CSS_ANIMATION=!0),l=null}e.HAS_CSS_TRANSFORMS?e.translate=function(t,e,i){t.style.transform="translate("+Math.round(e)+"px, "+Math.round(i)+"px)"}:e.translate=function(t,e,i){t.style.top=Math.round(i)+"px",t.style.left=Math.round(e)+"px"}})),ace.define("ace/lib/net",["require","exports","module","ace/lib/dom"],(function(t,e,i){"use strict";var n=t("./dom");e.get=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.onreadystatechange=function(){4===i.readyState&&e(i.responseText)},i.send(null)},e.loadScript=function(t,e){var i=n.getDocumentHead(),s=document.createElement("script");s.src=t,i.appendChild(s),s.onload=s.onreadystatechange=function(t,i){!i&&s.readyState&&"loaded"!=s.readyState&&"complete"!=s.readyState||(s=s.onload=s.onreadystatechange=null,i||e())}},e.qualifyURL=function(t){var e=document.createElement("a");return e.href=t,e.href}})),ace.define("ace/lib/oop",["require","exports","module"],(function(t,e,i){"use strict";e.inherits=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},e.mixin=function(t,e){for(var i in e)t[i]=e[i];return t},e.implement=function(t,i){e.mixin(t,i)}})),ace.define("ace/lib/event_emitter",["require","exports","module"],(function(t,e,i){"use strict";var n={},s=function(){this.propagationStopped=!0},o=function(){this.defaultPrevented=!0};n._emit=n._dispatchEvent=function(t,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var i=this._eventRegistry[t]||[],n=this._defaultHandlers[t];if(i.length||n){"object"==typeof e&&e||(e={}),e.type||(e.type=t),e.stopPropagation||(e.stopPropagation=s),e.preventDefault||(e.preventDefault=o),i=i.slice();for(var r=0;r<i.length&&(i[r](e,this),!e.propagationStopped);r++);return n&&!e.defaultPrevented?n(e,this):void 0}},n._signal=function(t,e){var i=(this._eventRegistry||{})[t];if(i){i=i.slice();for(var n=0;n<i.length;n++)i[n](e,this)}},n.once=function(t,e){var i=this;if(this.on(t,(function n(){i.off(t,n),e.apply(null,arguments)})),!e)return new Promise((function(t){e=t}))},n.setDefaultHandler=function(t,e){var i=this._defaultHandlers;if(i||(i=this._defaultHandlers={_disabled_:{}}),i[t]){var n=i[t],s=i._disabled_[t];s||(i._disabled_[t]=s=[]),s.push(n);var o=s.indexOf(e);-1!=o&&s.splice(o,1)}i[t]=e},n.removeDefaultHandler=function(t,e){var i=this._defaultHandlers;if(i){var n=i._disabled_[t];if(i[t]==e)n&&this.setDefaultHandler(t,n.pop());else if(n){var s=n.indexOf(e);-1!=s&&n.splice(s,1)}}},n.on=n.addEventListener=function(t,e,i){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[t];return n||(n=this._eventRegistry[t]=[]),-1==n.indexOf(e)&&n[i?"unshift":"push"](e),e},n.off=n.removeListener=n.removeEventListener=function(t,e){this._eventRegistry=this._eventRegistry||{};var i=this._eventRegistry[t];if(i){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}},n.removeAllListeners=function(t){t||(this._eventRegistry=this._defaultHandlers=void 0),this._eventRegistry&&(this._eventRegistry[t]=void 0),this._defaultHandlers&&(this._defaultHandlers[t]=void 0)},e.EventEmitter=n})),ace.define("ace/lib/report_error",["require","exports","module"],(function(t,e,i){e.reportError=function(t,e){var i=new Error(t);i.data=e,"object"==typeof console&&console.error&&console.error(i),setTimeout((function(){throw i}))}})),ace.define("ace/lib/default_english_messages",["require","exports","module"],(function(t,e,i){e.defaultEnglishMessages={"autocomplete.popup.aria-roledescription":"Autocomplete suggestions","autocomplete.popup.aria-label":"Autocomplete suggestions","autocomplete.popup.item.aria-roledescription":"item","autocomplete.loading":"Loading...","editor.scroller.aria-roledescription":"editor","editor.scroller.aria-label":"Editor content, press Enter to start editing, press Escape to exit","editor.gutter.aria-roledescription":"editor","editor.gutter.aria-label":"Editor gutter, press Enter to interact with controls using arrow keys, press Escape to exit","error-marker.good-state":"Looks good!","prompt.recently-used":"Recently used","prompt.other-commands":"Other commands","prompt.no-matching-commands":"No matching commands","search-box.find.placeholder":"Search for","search-box.find-all.text":"All","search-box.replace.placeholder":"Replace with","search-box.replace-next.text":"Replace","search-box.replace-all.text":"All","search-box.toggle-replace.title":"Toggle Replace mode","search-box.toggle-regexp.title":"RegExp Search","search-box.toggle-case.title":"CaseSensitive Search","search-box.toggle-whole-word.title":"Whole Word Search","search-box.toggle-in-selection.title":"Search In Selection","search-box.search-counter":"$0 of $1","text-input.aria-roledescription":"editor","text-input.aria-label":"Cursor at row $0","gutter.code-folding.range.aria-label":"Toggle code folding, rows $0 through $1","gutter.code-folding.closed.aria-label":"Toggle code folding, rows $0 through $1","gutter.code-folding.open.aria-label":"Toggle code folding, row $0","gutter.code-folding.closed.title":"Unfold code","gutter.code-folding.open.title":"Fold code","gutter.annotation.aria-label.error":"Error, read annotations row $0","gutter.annotation.aria-label.warning":"Warning, read annotations row $0","gutter.annotation.aria-label.info":"Info, read annotations row $0","inline-fold.closed.title":"Unfold code","gutter-tooltip.aria-label.error.singular":"error","gutter-tooltip.aria-label.error.plural":"errors","gutter-tooltip.aria-label.warning.singular":"warning","gutter-tooltip.aria-label.warning.plural":"warnings","gutter-tooltip.aria-label.info.singular":"information message","gutter-tooltip.aria-label.info.plural":"information messages","gutter.annotation.aria-label.security":"Security finding, read annotations row $0","gutter.annotation.aria-label.hint":"Suggestion, read annotations row $0","gutter-tooltip.aria-label.security.singular":"security finding","gutter-tooltip.aria-label.security.plural":"security findings","gutter-tooltip.aria-label.hint.singular":"suggestion","gutter-tooltip.aria-label.hint.plural":"suggestions"}})),ace.define("ace/lib/app_config",["require","exports","module","ace/lib/oop","ace/lib/event_emitter","ace/lib/report_error","ace/lib/default_english_messages"],(function(t,e,i){var n,s,o=t("./oop"),r=t("./event_emitter").EventEmitter,a=t("./report_error").reportError,l=t("./default_english_messages").defaultEnglishMessages,h={setOptions:function(t){Object.keys(t).forEach((function(e){this.setOption(e,t[e])}),this)},getOptions:function(t){var e={};if(t)Array.isArray(t)||(e=t,t=Object.keys(e));else{var i=this.$options;t=Object.keys(i).filter((function(t){return!i[t].hidden}))}return t.forEach((function(t){e[t]=this.getOption(t)}),this),e},setOption:function(t,e){if(this["$"+t]!==e){var i=this.$options[t];if(!i)return c('misspelled option "'+t+'"');if(i.forwardTo)return this[i.forwardTo]&&this[i.forwardTo].setOption(t,e);i.handlesSet||(this["$"+t]=e),i&&i.set&&i.set.call(this,e)}},getOption:function(t){var e=this.$options[t];return e?e.forwardTo?this[e.forwardTo]&&this[e.forwardTo].getOption(t):e&&e.get?e.get.call(this):this["$"+t]:c('misspelled option "'+t+'"')}};function c(t){"undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments)}var d=function(){function t(){this.$defaultOptions={},n=l,s="dollarSigns"}return t.prototype.defineOptions=function(t,e,i){return t.$options||(this.$defaultOptions[e]=t.$options={}),Object.keys(i).forEach((function(e){var n=i[e];"string"==typeof n&&(n={forwardTo:n}),n.name||(n.name=e),t.$options[n.name]=n,"initialValue"in n&&(t["$"+n.name]=n.initialValue)})),o.implement(t,h),this},t.prototype.resetOptions=function(t){Object.keys(t.$options).forEach((function(e){var i=t.$options[e];"value"in i&&t.setOption(e,i.value)}))},t.prototype.setDefaultValue=function(t,e,i){if(!t){for(t in this.$defaultOptions)if(this.$defaultOptions[t][e])break;if(!this.$defaultOptions[t][e])return!1}var n=this.$defaultOptions[t]||(this.$defaultOptions[t]={});n[e]&&(n.forwardTo?this.setDefaultValue(n.forwardTo,e,i):n[e].value=i)},t.prototype.setDefaultValues=function(t,e){Object.keys(e).forEach((function(i){this.setDefaultValue(t,i,e[i])}),this)},t.prototype.setMessages=function(t,e){n=t,e&&e.placeholders&&(s=e.placeholders)},t.prototype.nls=function(t,e,i){n[t]||(c("No message found for the key '"+t+"' in the provided messages, trying to find a translation for the default string '"+e+"'."),n[e]||c("No message found for the default string '"+e+"' in the provided messages. Falling back to the default English message."));var o=n[t]||n[e]||e;return i&&("dollarSigns"===s&&(o=o.replace(/\$(\$|[\d]+)/g,(function(t,e){return"$"==e?"$":i[e]}))),"curlyBrackets"===s&&(o=o.replace(/\{([^\}]+)\}/g,(function(t,e){return i[e]})))),o},t}();d.prototype.warn=c,d.prototype.reportError=a,o.implement(d.prototype,r),e.AppConfig=d})),ace.define("ace/theme/textmate-css",["require","exports","module"],(function(t,e,i){i.exports='.ace-tm .ace_gutter {\n  background: #f0f0f0;\n  color: #333;\n}\n\n.ace-tm .ace_print-margin {\n  width: 1px;\n  background: #e8e8e8;\n}\n\n.ace-tm .ace_fold {\n    background-color: #6B72E6;\n}\n\n.ace-tm {\n  background-color: #FFFFFF;\n  color: black;\n}\n\n.ace-tm .ace_cursor {\n  color: black;\n}\n        \n.ace-tm .ace_invisible {\n  color: rgb(191, 191, 191);\n}\n\n.ace-tm .ace_storage,\n.ace-tm .ace_keyword {\n  color: blue;\n}\n\n.ace-tm .ace_constant {\n  color: rgb(197, 6, 11);\n}\n\n.ace-tm .ace_constant.ace_buildin {\n  color: rgb(88, 72, 246);\n}\n\n.ace-tm .ace_constant.ace_language {\n  color: rgb(88, 92, 246);\n}\n\n.ace-tm .ace_constant.ace_library {\n  color: rgb(6, 150, 14);\n}\n\n.ace-tm .ace_invalid {\n  background-color: rgba(255, 0, 0, 0.1);\n  color: red;\n}\n\n.ace-tm .ace_support.ace_function {\n  color: rgb(60, 76, 114);\n}\n\n.ace-tm .ace_support.ace_constant {\n  color: rgb(6, 150, 14);\n}\n\n.ace-tm .ace_support.ace_type,\n.ace-tm .ace_support.ace_class {\n  color: rgb(109, 121, 222);\n}\n\n.ace-tm .ace_keyword.ace_operator {\n  color: rgb(104, 118, 135);\n}\n\n.ace-tm .ace_string {\n  color: rgb(3, 106, 7);\n}\n\n.ace-tm .ace_comment {\n  color: rgb(76, 136, 107);\n}\n\n.ace-tm .ace_comment.ace_doc {\n  color: rgb(0, 102, 255);\n}\n\n.ace-tm .ace_comment.ace_doc.ace_tag {\n  color: rgb(128, 159, 191);\n}\n\n.ace-tm .ace_constant.ace_numeric {\n  color: rgb(0, 0, 205);\n}\n\n.ace-tm .ace_variable {\n  color: rgb(49, 132, 149);\n}\n\n.ace-tm .ace_xml-pe {\n  color: rgb(104, 104, 91);\n}\n\n.ace-tm .ace_entity.ace_name.ace_function {\n  color: #0000A2;\n}\n\n\n.ace-tm .ace_heading {\n  color: rgb(12, 7, 255);\n}\n\n.ace-tm .ace_list {\n  color:rgb(185, 6, 144);\n}\n\n.ace-tm .ace_meta.ace_tag {\n  color:rgb(0, 22, 142);\n}\n\n.ace-tm .ace_string.ace_regex {\n  color: rgb(255, 0, 0)\n}\n\n.ace-tm .ace_marker-layer .ace_selection {\n  background: rgb(181, 213, 255);\n}\n.ace-tm.ace_multiselect .ace_selection.ace_start {\n  box-shadow: 0 0 3px 0px white;\n}\n.ace-tm .ace_marker-layer .ace_step {\n  background: rgb(252, 255, 0);\n}\n\n.ace-tm .ace_marker-layer .ace_stack {\n  background: rgb(164, 229, 101);\n}\n\n.ace-tm .ace_marker-layer .ace_bracket {\n  margin: -1px 0 0 -1px;\n  border: 1px solid rgb(192, 192, 192);\n}\n\n.ace-tm .ace_marker-layer .ace_active-line {\n  background: rgba(0, 0, 0, 0.07);\n}\n\n.ace-tm .ace_gutter-active-line {\n    background-color : #dcdcdc;\n}\n\n.ace-tm .ace_marker-layer .ace_selected-word {\n  background: rgb(250, 250, 255);\n  border: 1px solid rgb(200, 200, 250);\n}\n\n.ace-tm .ace_indent-guide {\n  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;\n}\n\n.ace-tm .ace_indent-guide-active {\n  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAZSURBVHjaYvj///9/hivKyv8BAAAA//8DACLqBhbvk+/eAAAAAElFTkSuQmCC") right repeat-y;\n}\n'})),ace.define("ace/theme/textmate",["require","exports","module","ace/theme/textmate-css","ace/lib/dom"],(function(t,e,i){"use strict";e.isDark=!1,e.cssClass="ace-tm",e.cssText=t("./textmate-css"),e.$id="ace/theme/textmate",t("../lib/dom").importCssString(e.cssText,e.cssClass,!1)})),ace.define("ace/config",["require","exports","module","ace/lib/lang","ace/lib/net","ace/lib/dom","ace/lib/app_config","ace/theme/textmate"],(function(t,e,i){var n=t("./lib/lang"),s=t("./lib/net"),o=t("./lib/dom"),r=t("./lib/app_config").AppConfig;i.exports=e=new r;var a,l={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{},loadWorkerFromBlob:!0,sharedPopups:!1,useStrictCSP:null};e.get=function(t){if(!l.hasOwnProperty(t))throw new Error("Unknown config key: "+t);return l[t]},e.set=function(t,e){if(l.hasOwnProperty(t))l[t]=e;else if(0==this.setDefaultValue("",t,e))throw new Error("Unknown config key: "+t);"useStrictCSP"==t&&o.useStrictCSP(e)},e.all=function(){return n.copyObject(l)},e.$modes={},e.moduleUrl=function(t,e){if(l.$moduleUrls[t])return l.$moduleUrls[t];var i=t.split("/"),n="snippets"==(e=e||i[i.length-2]||"")?"/":"-",s=i[i.length-1];if("worker"==e&&"-"==n){var o=new RegExp("^"+e+"[\\-_]|[\\-_]"+e+"$","g");s=s.replace(o,"")}(!s||s==e)&&i.length>1&&(s=i[i.length-2]);var r=l[e+"Path"];return null==r?r=l.basePath:"/"==n&&(e=n=""),r&&"/"!=r.slice(-1)&&(r+="/"),r+e+n+s+this.get("suffix")},e.setModuleUrl=function(t,e){return l.$moduleUrls[t]=e},e.setLoader=function(t){a=t},e.dynamicModules=Object.create(null),e.$loading={},e.$loaded={},e.loadModule=function(i,n){var o;if(Array.isArray(i))var r=i[0],l=i[1];else"string"==typeof i&&(l=i);var c=function(i){if(i&&!e.$loading[l])return n&&n(i);if(e.$loading[l]||(e.$loading[l]=[]),e.$loading[l].push(n),!(e.$loading[l].length>1)){var o=function(){!function(e,i){"ace/theme/textmate"===e||"./theme/textmate"===e?i(0,t("./theme/textmate")):a?a(e,i):console.error("loader is not configured")}(l,(function(t,i){i&&(e.$loaded[l]=i),e._emit("load.module",{name:l,module:i});var n=e.$loading[l];e.$loading[l]=null,n.forEach((function(t){t&&t(i)}))}))};if(!e.get("packaged"))return o();s.loadScript(e.moduleUrl(l,r),o),h()}};if(e.dynamicModules[l])e.dynamicModules[l]().then((function(t){t.default?c(t.default):c(t)}));else{try{o=this.$require(l)}catch(t){}c(o||e.$loaded[l])}},e.$require=function(t){if("function"==typeof i.require)return i.require(t)},e.setModuleLoader=function(t,i){e.dynamicModules[t]=i};var h=function(){l.basePath||l.workerPath||l.modePath||l.themePath||Object.keys(l.$moduleUrls).length||(console.error("Unable to infer path to ace from script src,","use ace.config.set('basePath', 'path') to enable dynamic loading of modes and themes","or with webpack use ace/webpack-resolver"),h=function(){})};e.version="1.36.2"})),ace.define("ace/loader_build",["require","exports","module","ace/lib/fixoldbrowsers","ace/config"],(function(t,e,n){"use strict";t("./lib/fixoldbrowsers");var s=t("./config");s.setLoader((function(e,i){t([e],(function(t){i(null,t)}))}));var o=function(){return this||"undefined"!=typeof window&&window}();function r(e){if(o&&o.document){s.set("packaged",e||t.packaged||n.packaged||o.define&&i.amdD.packaged);var r={},a="",l=document.currentScript||document._currentScript,h=l&&l.ownerDocument||document;l&&l.src&&(a=l.src.split(/[?#]/)[0].split("/").slice(0,-1).join("/")||"");for(var c,d=h.getElementsByTagName("script"),u=0;u<d.length;u++){var p=d[u],g=p.src||p.getAttribute("src");if(g){for(var f=p.attributes,m=0,v=f.length;m<v;m++){var _=f[m];0===_.name.indexOf("data-ace-")&&(r[(c=_.name.replace(/^data-ace-/,""),c.replace(/-(.)/g,(function(t,e){return e.toUpperCase()})))]=_.value)}var y=g.match(/^(.*)\/ace([\-.]\w+)?\.js(\?|$)/);y&&(a=y[1])}}for(var w in a&&(r.base=r.base||a,r.packaged=!0),r.basePath=r.base,r.workerPath=r.workerPath||r.base,r.modePath=r.modePath||r.base,r.themePath=r.themePath||r.base,delete r.base,r)void 0!==r[w]&&s.set(w,r[w])}}n.exports=function(e){s.init=r,s.$require=t,e.require=t,e.define=i.amdD},r(!0)})),ace.define("ace/range",["require","exports","module"],(function(t,e,i){"use strict";var n=function(){function t(t,e,i,n){this.start={row:t,column:e},this.end={row:i,column:n}}return t.prototype.isEqual=function(t){return this.start.row===t.start.row&&this.end.row===t.end.row&&this.start.column===t.start.column&&this.end.column===t.end.column},t.prototype.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},t.prototype.contains=function(t,e){return 0==this.compare(t,e)},t.prototype.compareRange=function(t){var e,i=t.end,n=t.start;return 1==(e=this.compare(i.row,i.column))?1==(e=this.compare(n.row,n.column))?2:0==e?1:0:-1==e?-2:-1==(e=this.compare(n.row,n.column))?-1:1==e?42:0},t.prototype.comparePoint=function(t){return this.compare(t.row,t.column)},t.prototype.containsRange=function(t){return 0==this.comparePoint(t.start)&&0==this.comparePoint(t.end)},t.prototype.intersects=function(t){var e=this.compareRange(t);return-1==e||0==e||1==e},t.prototype.isEnd=function(t,e){return this.end.row==t&&this.end.column==e},t.prototype.isStart=function(t,e){return this.start.row==t&&this.start.column==e},t.prototype.setStart=function(t,e){"object"==typeof t?(this.start.column=t.column,this.start.row=t.row):(this.start.row=t,this.start.column=e)},t.prototype.setEnd=function(t,e){"object"==typeof t?(this.end.column=t.column,this.end.row=t.row):(this.end.row=t,this.end.column=e)},t.prototype.inside=function(t,e){return 0==this.compare(t,e)&&!this.isEnd(t,e)&&!this.isStart(t,e)},t.prototype.insideStart=function(t,e){return 0==this.compare(t,e)&&!this.isEnd(t,e)},t.prototype.insideEnd=function(t,e){return 0==this.compare(t,e)&&!this.isStart(t,e)},t.prototype.compare=function(t,e){return this.isMultiLine()||t!==this.start.row?t<this.start.row?-1:t>this.end.row?1:this.start.row===t?e>=this.start.column?0:-1:this.end.row===t?e<=this.end.column?0:1:0:e<this.start.column?-1:e>this.end.column?1:0},t.prototype.compareStart=function(t,e){return this.start.row==t&&this.start.column==e?-1:this.compare(t,e)},t.prototype.compareEnd=function(t,e){return this.end.row==t&&this.end.column==e?1:this.compare(t,e)},t.prototype.compareInside=function(t,e){return this.end.row==t&&this.end.column==e?1:this.start.row==t&&this.start.column==e?-1:this.compare(t,e)},t.prototype.clipRows=function(e,i){if(this.end.row>i)var n={row:i+1,column:0};else this.end.row<e&&(n={row:e,column:0});if(this.start.row>i)var s={row:i+1,column:0};else this.start.row<e&&(s={row:e,column:0});return t.fromPoints(s||this.start,n||this.end)},t.prototype.extend=function(e,i){var n=this.compare(e,i);if(0==n)return this;if(-1==n)var s={row:e,column:i};else var o={row:e,column:i};return t.fromPoints(s||this.start,o||this.end)},t.prototype.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},t.prototype.isMultiLine=function(){return this.start.row!==this.end.row},t.prototype.clone=function(){return t.fromPoints(this.start,this.end)},t.prototype.collapseRows=function(){return 0==this.end.column?new t(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new t(this.start.row,0,this.end.row,0)},t.prototype.toScreenRange=function(e){var i=e.documentToScreenPosition(this.start),n=e.documentToScreenPosition(this.end);return new t(i.row,i.column,n.row,n.column)},t.prototype.moveBy=function(t,e){this.start.row+=t,this.start.column+=e,this.end.row+=t,this.end.column+=e},t}();n.fromPoints=function(t,e){return new n(t.row,t.column,e.row,e.column)},n.comparePoints=function(t,e){return t.row-e.row||t.column-e.column},e.Range=n})),ace.define("ace/lib/keys",["require","exports","module","ace/lib/oop"],(function(t,e,i){"use strict";for(var n=t("./oop"),s={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta",91:"MetaLeft",92:"MetaRight",93:"ContextMenu"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8,control:1},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete","-13":"NumpadEnter",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",59:";",61:"=",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*"}},o={Command:224,Backspace:8,Tab:9,Return:13,Enter:13,Pause:19,Escape:27,PageUp:33,PageDown:34,End:35,Home:36,Insert:45,Delete:46,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Backquote:192,Minus:189,Equal:187,BracketLeft:219,Backslash:220,BracketRight:221,Semicolon:186,Quote:222,Comma:188,Period:190,Slash:191,Space:32,NumpadAdd:107,NumpadDecimal:110,NumpadSubtract:109,NumpadDivide:111,NumpadMultiply:106},r=0;r<10;r++)o["Digit"+r]=48+r,o["Numpad"+r]=96+r,s.PRINTABLE_KEYS[48+r]=""+r,s.FUNCTION_KEYS[96+r]="Numpad"+r;for(r=65;r<91;r++){var a=String.fromCharCode(r+32);o["Key"+a.toUpperCase()]=r,s.PRINTABLE_KEYS[r]=a}for(r=1;r<13;r++)o["F"+r]=111+r,s.FUNCTION_KEYS[111+r]="F"+r;var l={Shift:16,Control:17,Alt:18,Meta:224};for(var h in l)o[h]=o[h+"Left"]=o[h+"Right"]=l[h];for(var c in e.$codeToKeyCode=o,s.PRINTABLE_KEYS[173]="-",s.FUNCTION_KEYS){var d=s.FUNCTION_KEYS[c].toLowerCase();s[d]=parseInt(c,10)}for(var c in s.PRINTABLE_KEYS)d=s.PRINTABLE_KEYS[c].toLowerCase(),s[d]=parseInt(c,10);n.mixin(s,s.MODIFIER_KEYS),n.mixin(s,s.PRINTABLE_KEYS),n.mixin(s,s.FUNCTION_KEYS),s.enter=s.return,s.escape=s.esc,s.del=s.delete,function(){for(var t=["cmd","ctrl","alt","shift"],e=Math.pow(2,t.length);e--;)s.KEY_MODS[e]=t.filter((function(t){return e&s.KEY_MODS[t]})).join("-")+"-"}(),s.KEY_MODS[0]="",s.KEY_MODS[-1]="input-",n.mixin(e,s),e.default=e,e.keyCodeToString=function(t){var e=s[t];return"string"!=typeof e&&(e=String.fromCharCode(t)),e.toLowerCase()}})),ace.define("ace/lib/event",["require","exports","module","ace/lib/keys","ace/lib/useragent"],(function(t,e,i){"use strict";var n,s=t("./keys"),o=t("./useragent"),r=null,a=0;function l(){return null==n&&function(){n=!1;try{document.createComment("").addEventListener("test",(function(){}),{get passive(){return n={passive:!1},!0}})}catch(t){}}(),n}function h(t,e,i){this.elem=t,this.type=e,this.callback=i}h.prototype.destroy=function(){d(this.elem,this.type,this.callback),this.elem=this.type=this.callback=void 0};var c=e.addListener=function(t,e,i,n){t.addEventListener(e,i,l()),n&&n.$toDestroy.push(new h(t,e,i))},d=e.removeListener=function(t,e,i){t.removeEventListener(e,i,l())};function u(t){return 0|(t.ctrlKey?1:0)|(t.altKey?2:0)|(t.shiftKey?4:0)|(t.metaKey?8:0)}function p(){r=Object.create(null)}if(e.stopEvent=function(t){return e.stopPropagation(t),e.preventDefault(t),!1},e.stopPropagation=function(t){t.stopPropagation&&t.stopPropagation()},e.preventDefault=function(t){t.preventDefault&&t.preventDefault()},e.getButton=function(t){return"dblclick"==t.type?0:"contextmenu"==t.type||o.isMac&&t.ctrlKey&&!t.altKey&&!t.shiftKey?2:t.button},e.capture=function(t,e,i){var n=t&&t.ownerDocument||document;function s(t){e&&e(t),i&&i(t),d(n,"mousemove",e),d(n,"mouseup",s),d(n,"dragstart",s)}return c(n,"mousemove",e),c(n,"mouseup",s),c(n,"dragstart",s),s},e.addMouseWheelListener=function(t,e,i){c(t,"wheel",(function(t){var i=t.deltaX||0,n=t.deltaY||0;switch(t.deltaMode){case t.DOM_DELTA_PIXEL:t.wheelX=.15*i,t.wheelY=.15*n;break;case t.DOM_DELTA_LINE:t.wheelX=15*i,t.wheelY=15*n;break;case t.DOM_DELTA_PAGE:t.wheelX=150*i,t.wheelY=150*n}e(t)}),i)},e.addMultiMouseDownListener=function(t,i,n,s,r){var a,l,h,d=0,u={2:"dblclick",3:"tripleclick",4:"quadclick"};function p(t){if(0!==e.getButton(t)?d=0:t.detail>1?++d>4&&(d=1):d=1,o.isIE){var r=Math.abs(t.clientX-a)>5||Math.abs(t.clientY-l)>5;h&&!r||(d=1),h&&clearTimeout(h),h=setTimeout((function(){h=null}),i[d-1]||600),1==d&&(a=t.clientX,l=t.clientY)}if(t._clicks=d,n[s]("mousedown",t),d>4)d=0;else if(d>1)return n[s](u[d],t)}Array.isArray(t)||(t=[t]),t.forEach((function(t){c(t,"mousedown",p,r)}))},e.getModifierString=function(t){return s.KEY_MODS[u(t)]},e.addCommandKeyListener=function(t,i,n){var l=null;c(t,"keydown",(function(t){r[t.keyCode]=(r[t.keyCode]||0)+1;var e=function(t,e,i){var n=u(e);if(!i&&e.code&&(i=s.$codeToKeyCode[e.code]||i),!o.isMac&&r){if(e.getModifierState&&(e.getModifierState("OS")||e.getModifierState("Win"))&&(n|=8),r.altGr){if(3==(3&n))return;r.altGr=0}if(18===i||17===i){var l=e.location;17===i&&1===l?1==r[i]&&(a=e.timeStamp):18===i&&3===n&&2===l&&e.timeStamp-a<50&&(r.altGr=!0)}}if(i in s.MODIFIER_KEYS&&(i=-1),n||13!==i||3!==e.location||(t(e,n,-i),!e.defaultPrevented)){if(o.isChromeOS&&8&n){if(t(e,n,i),e.defaultPrevented)return;n&=-9}return!!(n||i in s.FUNCTION_KEYS||i in s.PRINTABLE_KEYS)&&t(e,n,i)}}(i,t,t.keyCode);return l=t.defaultPrevented,e}),n),c(t,"keypress",(function(t){l&&(t.ctrlKey||t.altKey||t.shiftKey||t.metaKey)&&(e.stopEvent(t),l=null)}),n),c(t,"keyup",(function(t){r[t.keyCode]=null}),n),r||(p(),c(window,"focus",p))},"object"==typeof window&&window.postMessage&&!o.isOldIE){var g=1;e.nextTick=function(t,i){i=i||window;var n="zero-timeout-message-"+g++,s=function(o){o.data==n&&(e.stopPropagation(o),d(i,"message",s),t())};c(i,"message",s),i.postMessage(n,"*")}}e.$idleBlocked=!1,e.onIdle=function(t,i){return setTimeout((function i(){e.$idleBlocked?setTimeout(i,100):t()}),i)},e.$idleBlockId=null,e.blockIdle=function(t){e.$idleBlockId&&clearTimeout(e.$idleBlockId),e.$idleBlocked=!0,e.$idleBlockId=setTimeout((function(){e.$idleBlocked=!1}),t||100)},e.nextFrame="object"==typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),e.nextFrame?e.nextFrame=e.nextFrame.bind(window):e.nextFrame=function(t){setTimeout(t,17)}})),ace.define("ace/clipboard",["require","exports","module"],(function(t,e,i){"use strict";var n;i.exports={lineMode:!1,pasteCancelled:function(){return!!(n&&n>Date.now()-50)||(n=!1)},cancel:function(){n=Date.now()}}})),ace.define("ace/keyboard/textinput",["require","exports","module","ace/lib/event","ace/config","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/clipboard","ace/lib/keys"],(function(t,e,i){"use strict";var n,s=t("../lib/event"),o=t("../config").nls,r=t("../lib/useragent"),a=t("../lib/dom"),l=t("../lib/lang"),h=t("../clipboard"),c=r.isChrome<18,d=r.isIE,u=r.isChrome>63,p=400,g=t("../lib/keys"),f=g.KEY_MODS,m=r.isIOS,v=m?/\s/:/\n/,_=r.isMobile;n=function(t,e){var i=a.createElement("textarea");i.className="ace_text-input",i.setAttribute("wrap","off"),i.setAttribute("autocorrect","off"),i.setAttribute("autocapitalize","off"),i.setAttribute("spellcheck","false"),i.style.opacity="0",t.insertBefore(i,t.firstChild);var n=!1,y=!1,w=!1,x=!1,b="";_||(i.style.fontSize="1px");var C=!1,A=!1,S="",E=0,T=0,k=0,M=Number.MAX_SAFE_INTEGER,$=Number.MIN_SAFE_INTEGER,L=0;try{var R=document.activeElement===i}catch(t){}this.setNumberOfExtraLines=function(t){M=Number.MAX_SAFE_INTEGER,$=Number.MIN_SAFE_INTEGER,L=t<0?0:t},this.setAriaOptions=function(t){if(t.activeDescendant?(i.setAttribute("aria-haspopup","true"),i.setAttribute("aria-autocomplete",t.inline?"both":"list"),i.setAttribute("aria-activedescendant",t.activeDescendant)):(i.setAttribute("aria-haspopup","false"),i.setAttribute("aria-autocomplete","both"),i.removeAttribute("aria-activedescendant")),t.role&&i.setAttribute("role",t.role),t.setLabel){i.setAttribute("aria-roledescription",o("text-input.aria-roledescription","editor"));var n="";if(e.$textInputAriaLabel&&(n+="".concat(e.$textInputAriaLabel,", ")),e.session){var s=e.session.selection.cursor.row;n+=o("text-input.aria-label","Cursor at row $0",[s+1])}i.setAttribute("aria-label",n)}},this.setAriaOptions({role:"textbox"}),s.addListener(i,"blur",(function(t){A||(e.onBlur(t),R=!1)}),e),s.addListener(i,"focus",(function(t){if(!A){if(R=!0,r.isEdge)try{if(!document.hasFocus())return}catch(t){}e.onFocus(t),r.isEdge?setTimeout(D):D()}}),e),this.$focusScroll=!1,this.focus=function(){if(this.setAriaOptions({setLabel:e.renderer.enableKeyboardAccessibility}),b||u||"browser"==this.$focusScroll)return i.focus({preventScroll:!0});var t=i.style.top;i.style.position="fixed",i.style.top="0px";try{var n=0!=i.getBoundingClientRect().top}catch(t){return}var s=[];if(n)for(var o=i.parentElement;o&&1==o.nodeType;)s.push(o),o.setAttribute("ace_nocontext","true"),o=!o.parentElement&&o.getRootNode?o.getRootNode().host:o.parentElement;i.focus({preventScroll:!0}),n&&s.forEach((function(t){t.removeAttribute("ace_nocontext")})),setTimeout((function(){i.style.position="","0px"==i.style.top&&(i.style.top=t)}),0)},this.blur=function(){i.blur()},this.isFocused=function(){return R},e.on("beforeEndOperation",(function(){var t=e.curOp,n=t&&t.command&&t.command.name;if("insertstring"!=n){var s=n&&(t.docChanged||t.selectionChanged);w&&s&&(S=i.value="",V()),D()}}));var I=function(t,i){for(var n=i,s=1;s<=t-M&&s<2*L+1;s++)n+=e.session.getLine(t-s).length+1;return n},D=m?function(t){if(R&&(!n||t)&&!x){t||(t="");var s="\n ab"+t+"cde fg\n";s!=i.value&&(i.value=S=s);var o=4+(t.length||(e.selection.isEmpty()?0:1));4==E&&T==o||i.setSelectionRange(4,o),E=4,T=o}}:function(){if(!w&&!x&&(R||B)){w=!0;var t=0,n=0,s="";if(e.session){var o=e.selection,r=o.getRange(),a=o.cursor.row;a===$+1?$=(M=$+1)+2*L:a===M-1?M=($=M-1)-2*L:(a<M-1||a>$+1)&&(M=a>L?a-L:0,$=a>L?a+L:2*L);for(var l=[],h=M;h<=$;h++)l.push(e.session.getLine(h));if(s=l.join("\n"),t=I(r.start.row,r.start.column),n=I(r.end.row,r.end.column),r.start.row<M){var c=e.session.getLine(M-1);t=r.start.row<M-1?0:t,n+=c.length+1,s=c+"\n"+s}else if(r.end.row>$){var d=e.session.getLine($+1);n=r.end.row>$+1?d.length:r.end.column,n+=s.length+1,s=s+"\n"+d}else _&&a>0&&(s="\n"+s,n+=1,t+=1);s.length>p&&(t<p&&n<p?s=s.slice(0,p):(s="\n",t==n?t=n=0:(t=0,n=1)));var u=s+"\n\n";u!=S&&(i.value=S=u,E=T=u.length)}if(B&&(E=i.selectionStart,T=i.selectionEnd),T!=n||E!=t||i.selectionEnd!=T)try{i.setSelectionRange(t,n),E=t,T=n}catch(t){}w=!1}};this.resetSelection=D,R&&e.onFocus();var P=null;this.setInputHandler=function(t){P=t},this.getInputHandler=function(){return P};var B=!1,F=function(t,n){if(B&&(B=!1),y)return D(),t&&e.onPaste(t),y=!1,"";for(var s=i.selectionStart,o=i.selectionEnd,a=E,l=S.length-T,h=t,c=t.length-s,d=t.length-o,u=0;a>0&&S[u]==t[u];)u++,a--;for(h=h.slice(u),u=1;l>0&&S.length-u>E-1&&S[S.length-u]==t[t.length-u];)u++,l--;c-=u-1,d-=u-1;var p=h.length-u+1;if(p<0&&(a=-p,p=0),h=h.slice(0,p),!(n||h||c||a||l||d))return"";x=!0;var g=!1;return r.isAndroid&&". "==h&&(h="  ",g=!0),h&&!a&&!l&&!c&&!d||C?e.onTextInput(h):e.onTextInput(h,{extendLeft:a,extendRight:l,restoreStart:c,restoreEnd:d}),x=!1,S=t,E=s,T=o,k=d,g?"\n":h},O=function(t){if(w)return j();if(t&&t.inputType){if("historyUndo"==t.inputType)return e.execCommand("undo");if("historyRedo"==t.inputType)return e.execCommand("redo")}var n=i.value,s=F(n,!0);(n.length>500||v.test(s)||_&&E<1&&E==T)&&D()},N=function(t,e,i){var n=t.clipboardData||window.clipboardData;if(n&&!c){var s=d||i?"Text":"text/plain";try{return e?!1!==n.setData(s,e):n.getData(s)}catch(t){if(!i)return N(t,e,!0)}}},z=function(t,o){var r=e.getCopyText();if(!r)return s.preventDefault(t);N(t,r)?(m&&(D(r),n=r,setTimeout((function(){n=!1}),10)),o?e.onCut():e.onCopy(),s.preventDefault(t)):(n=!0,i.value=r,i.select(),setTimeout((function(){n=!1,D(),o?e.onCut():e.onCopy()})))},W=function(t){z(t,!0)},H=function(t){z(t,!1)},U=function(t){var n=N(t);h.pasteCancelled()||("string"==typeof n?(n&&e.onPaste(n,t),r.isIE&&setTimeout(D),s.preventDefault(t)):(i.value="",y=!0))};s.addCommandKeyListener(i,(function(t,i,n){if(!w)return e.onCommandKey(t,i,n)}),e),s.addListener(i,"select",(function(t){w||(n?n=!1:function(t){return 0===t.selectionStart&&t.selectionEnd>=S.length&&t.value===S&&S&&t.selectionEnd!==T}(i)?(e.selectAll(),D()):_&&i.selectionStart!=E&&D())}),e),s.addListener(i,"input",O,e),s.addListener(i,"cut",W,e),s.addListener(i,"copy",H,e),s.addListener(i,"paste",U,e),"oncut"in i&&"oncopy"in i&&"onpaste"in i||s.addListener(t,"keydown",(function(t){if((!r.isMac||t.metaKey)&&t.ctrlKey)switch(t.keyCode){case 67:H(t);break;case 86:U(t);break;case 88:W(t)}}),e);var j=function(){if(w&&e.onCompositionUpdate&&!e.$readOnly){if(C)return G();if(w.useTextareaForIME)e.onCompositionUpdate(i.value);else{var t=i.value;F(t),w.markerRange&&(w.context&&(w.markerRange.start.column=w.selectionStart=w.context.compositionStartOffset),w.markerRange.end.column=w.markerRange.start.column+T-w.selectionStart+k)}}},V=function(t){e.onCompositionEnd&&!e.$readOnly&&(w=!1,e.onCompositionEnd(),e.off("mousedown",G),t&&O())};function G(){A=!0,i.blur(),i.focus(),A=!1}var K,Y=l.delayedCall(j,50).schedule.bind(null,null);function q(){clearTimeout(K),K=setTimeout((function(){b&&(i.style.cssText=b,b=""),e.renderer.$isMousePressed=!1,e.renderer.$keepTextAreaAtCursor&&e.renderer.$moveTextAreaToCursor()}),0)}s.addListener(i,"compositionstart",(function(t){if(!w&&e.onCompositionStart&&!e.$readOnly&&(w={},!C)){t.data&&(w.useTextareaForIME=!1),setTimeout(j,0),e._signal("compositionStart"),e.on("mousedown",G);var n=e.getSelectionRange();n.end.row=n.start.row,n.end.column=n.start.column,w.markerRange=n,w.selectionStart=E,e.onCompositionStart(w),w.useTextareaForIME?(S=i.value="",E=0,T=0):(i.msGetInputContext&&(w.context=i.msGetInputContext()),i.getInputContext&&(w.context=i.getInputContext()))}}),e),s.addListener(i,"compositionupdate",j,e),s.addListener(i,"keyup",(function(t){27==t.keyCode&&i.value.length<i.selectionStart&&(w||(S=i.value),E=T=-1,D()),Y()}),e),s.addListener(i,"keydown",Y,e),s.addListener(i,"compositionend",V,e),this.getElement=function(){return i},this.setCommandMode=function(t){C=t,i.readOnly=!1},this.setReadOnly=function(t){C||(i.readOnly=t)},this.setCopyWithEmptySelection=function(t){},this.onContextMenu=function(t){B=!0,D(),e._emit("nativecontextmenu",{target:e,domEvent:t}),this.moveToMouse(t,!0)},this.moveToMouse=function(t,n){b||(b=i.style.cssText),i.style.cssText=(n?"z-index:100000;":"")+(r.isIE?"opacity:0.1;":"")+"text-indent: -"+(E+T)*e.renderer.characterWidth*.5+"px;";var o=e.container.getBoundingClientRect(),l=a.computedStyle(e.container),h=o.top+(parseInt(l.borderTopWidth)||0),c=o.left+(parseInt(o.borderLeftWidth)||0),d=o.bottom-h-i.clientHeight-2,u=function(t){a.translate(i,t.clientX-c-2,Math.min(t.clientY-h-2,d))};u(t),"mousedown"==t.type&&(e.renderer.$isMousePressed=!0,clearTimeout(K),r.isWin&&s.capture(e.container,u,q))},this.onContextMenuClose=q;var X=function(t){e.textInput.onContextMenu(t),q()};s.addListener(i,"mouseup",X,e),s.addListener(i,"mousedown",(function(t){t.preventDefault(),q()}),e),s.addListener(e.renderer.scroller,"contextmenu",X,e),s.addListener(i,"contextmenu",X,e),m&&function(t,e,i){var s=null,o=!1;i.addEventListener("keydown",(function(t){s&&clearTimeout(s),o=!0}),!0),i.addEventListener("keyup",(function(t){s=setTimeout((function(){o=!1}),100)}),!0);var r=function(t){if(document.activeElement===i&&!(o||w||e.$mouseHandler.isMousePressed||n)){var s=i.selectionStart,r=i.selectionEnd,a=null,l=0;if(0==s?a=g.up:1==s?a=g.home:r>T&&"\n"==S[r]?a=g.end:s<E&&" "==S[s-1]?(a=g.left,l=f.option):s<E||s==E&&T!=E&&s==r?a=g.left:r>T&&S.slice(0,r).split("\n").length>2?a=g.down:r>T&&" "==S[r-1]?(a=g.right,l=f.option):(r>T||r==T&&T!=E&&s==r)&&(a=g.right),s!==r&&(l|=f.shift),a){if(!e.onCommandKey({},l,a)&&e.commands){a=g.keyCodeToString(a);var h=e.commands.findKeyCommand(l,a);h&&e.execCommand(h)}E=s,T=r,D("")}}};document.addEventListener("selectionchange",r),e.on("destroy",(function(){document.removeEventListener("selectionchange",r)}))}(0,e,i),this.destroy=function(){i.parentElement&&i.parentElement.removeChild(i)}},e.TextInput=n,e.$setUserAgentForTests=function(t,e){_=t,m=e}})),ace.define("ace/mouse/default_handlers",["require","exports","module","ace/lib/useragent"],(function(t,e,i){"use strict";var n=t("../lib/useragent"),s=function(){function t(t){t.$clickSelection=null;var e=t.editor;e.setDefaultHandler("mousedown",this.onMouseDown.bind(t)),e.setDefaultHandler("dblclick",this.onDoubleClick.bind(t)),e.setDefaultHandler("tripleclick",this.onTripleClick.bind(t)),e.setDefaultHandler("quadclick",this.onQuadClick.bind(t)),e.setDefaultHandler("mousewheel",this.onMouseWheel.bind(t)),["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach((function(e){t[e]=this[e]}),this),t.selectByLines=this.extendSelectionBy.bind(t,"getLineRange"),t.selectByWords=this.extendSelectionBy.bind(t,"getWordRange")}return t.prototype.onMouseDown=function(t){var e=t.inSelection(),i=t.getDocumentPosition();this.mousedownEvent=t;var s=this.editor,o=t.getButton();return 0!==o?((s.getSelectionRange().isEmpty()||1==o)&&s.selection.moveToPosition(i),void(2==o&&(s.textInput.onContextMenu(t.domEvent),n.isMozilla||t.preventDefault()))):(this.mousedownEvent.time=Date.now(),!e||s.isFocused()||(s.focus(),!this.$focusTimeout||this.$clickSelection||s.inMultiSelectMode)?(this.captureMouse(t),this.startSelect(i,t.domEvent._clicks>1),t.preventDefault()):(this.setState("focusWait"),void this.captureMouse(t)))},t.prototype.startSelect=function(t,e){t=t||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var i=this.editor;this.mousedownEvent&&(this.mousedownEvent.getShiftKey()?i.selection.selectToPosition(t):e||i.selection.moveToPosition(t),e||this.select(),i.setStyle("ace_selecting"),this.setState("select"))},t.prototype.select=function(){var t,e=this.editor,i=e.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var n=this.$clickSelection.comparePoint(i);if(-1==n)t=this.$clickSelection.end;else if(1==n)t=this.$clickSelection.start;else{var s=o(this.$clickSelection,i);i=s.cursor,t=s.anchor}e.selection.setSelectionAnchor(t.row,t.column)}e.selection.selectToPosition(i),e.renderer.scrollCursorIntoView()},t.prototype.extendSelectionBy=function(t){var e,i=this.editor,n=i.renderer.screenToTextCoordinates(this.x,this.y),s=i.selection[t](n.row,n.column);if(this.$clickSelection){var r=this.$clickSelection.comparePoint(s.start),a=this.$clickSelection.comparePoint(s.end);if(-1==r&&a<=0)e=this.$clickSelection.end,s.end.row==n.row&&s.end.column==n.column||(n=s.start);else if(1==a&&r>=0)e=this.$clickSelection.start,s.start.row==n.row&&s.start.column==n.column||(n=s.end);else if(-1==r&&1==a)n=s.end,e=s.start;else{var l=o(this.$clickSelection,n);n=l.cursor,e=l.anchor}i.selection.setSelectionAnchor(e.row,e.column)}i.selection.selectToPosition(n),i.renderer.scrollCursorIntoView()},t.prototype.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting")},t.prototype.focusWait=function(){var t,e,i,n,s=(t=this.mousedownEvent.x,e=this.mousedownEvent.y,i=this.x,n=this.y,Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2))),o=Date.now();(s>0||o-this.mousedownEvent.time>this.$focusTimeout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},t.prototype.onDoubleClick=function(t){var e=t.getDocumentPosition(),i=this.editor,n=i.session.getBracketRange(e);n?(n.isEmpty()&&(n.start.column--,n.end.column++),this.setState("select")):(n=i.selection.getWordRange(e.row,e.column),this.setState("selectByWords")),this.$clickSelection=n,this.select()},t.prototype.onTripleClick=function(t){var e=t.getDocumentPosition(),i=this.editor;this.setState("selectByLines");var n=i.getSelectionRange();n.isMultiLine()&&n.contains(e.row,e.column)?(this.$clickSelection=i.selection.getLineRange(n.start.row),this.$clickSelection.end=i.selection.getLineRange(n.end.row).end):this.$clickSelection=i.selection.getLineRange(e.row),this.select()},t.prototype.onQuadClick=function(t){var e=this.editor;e.selectAll(),this.$clickSelection=e.getSelectionRange(),this.setState("selectAll")},t.prototype.onMouseWheel=function(t){if(!t.getAccelKey()){t.getShiftKey()&&t.wheelY&&!t.wheelX&&(t.wheelX=t.wheelY,t.wheelY=0);var e=this.editor;this.$lastScroll||(this.$lastScroll={t:0,vx:0,vy:0,allowed:0});var i=this.$lastScroll,n=t.domEvent.timeStamp,s=n-i.t,o=s?t.wheelX/s:i.vx,r=s?t.wheelY/s:i.vy;s<550&&(o=(o+i.vx)/2,r=(r+i.vy)/2);var a=Math.abs(o/r),l=!1;return a>=1&&e.renderer.isScrollableBy(t.wheelX*t.speed,0)&&(l=!0),a<=1&&e.renderer.isScrollableBy(0,t.wheelY*t.speed)&&(l=!0),l?i.allowed=n:n-i.allowed<550&&(Math.abs(o)<=1.5*Math.abs(i.vx)&&Math.abs(r)<=1.5*Math.abs(i.vy)?(l=!0,i.allowed=n):i.allowed=0),i.t=n,i.vx=o,i.vy=r,l?(e.renderer.scrollBy(t.wheelX*t.speed,t.wheelY*t.speed),t.stop()):void 0}},t}();function o(t,e){if(t.start.row==t.end.row)var i=2*e.column-t.start.column-t.end.column;else if(t.start.row!=t.end.row-1||t.start.column||t.end.column)i=2*e.row-t.start.row-t.end.row;else i=e.column-4;return i<0?{cursor:t.start,anchor:t.end}:{cursor:t.end,anchor:t.start}}s.prototype.selectEnd=s.prototype.selectByLinesEnd,s.prototype.selectAllEnd=s.prototype.selectByLinesEnd,s.prototype.selectByWordsEnd=s.prototype.selectByLinesEnd,e.DefaultHandlers=s})),ace.define("ace/lib/scroll",["require","exports","module"],(function(t,e,i){e.preventParentScroll=function(t){t.stopPropagation();var e=t.currentTarget;e.scrollHeight>e.clientHeight||t.preventDefault()}})),ace.define("ace/tooltip",["require","exports","module","ace/lib/dom","ace/lib/event","ace/range","ace/lib/scroll"],(function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=t("./lib/dom"),a=(t("./lib/event"),t("./range").Range),l=t("./lib/scroll").preventParentScroll,h="ace_tooltip",c=function(){function t(t){this.isOpen=!1,this.$element=null,this.$parentNode=t}return t.prototype.$init=function(){return this.$element=r.createElement("div"),this.$element.className=h,this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},t.prototype.getElement=function(){return this.$element||this.$init()},t.prototype.setText=function(t){this.getElement().textContent=t},t.prototype.setHtml=function(t){this.getElement().innerHTML=t},t.prototype.setPosition=function(t,e){this.getElement().style.left=t+"px",this.getElement().style.top=e+"px"},t.prototype.setClassName=function(t){r.addCssClass(this.getElement(),t)},t.prototype.setTheme=function(t){this.$element.className=h+" "+(t.isDark?"ace_dark ":"")+(t.cssClass||"")},t.prototype.show=function(t,e,i){null!=t&&this.setText(t),null!=e&&null!=i&&this.setPosition(e,i),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},t.prototype.hide=function(t){this.isOpen&&(this.getElement().style.display="none",this.getElement().className=h,this.isOpen=!1)},t.prototype.getHeight=function(){return this.getElement().offsetHeight},t.prototype.getWidth=function(){return this.getElement().offsetWidth},t.prototype.destroy=function(){this.isOpen=!1,this.$element&&this.$element.parentNode&&this.$element.parentNode.removeChild(this.$element)},t}(),d=new(function(){function t(){this.popups=[]}return t.prototype.addPopup=function(t){this.popups.push(t),this.updatePopups()},t.prototype.removePopup=function(t){var e=this.popups.indexOf(t);-1!==e&&(this.popups.splice(e,1),this.updatePopups())},t.prototype.updatePopups=function(){var t,e,i,n;this.popups.sort((function(t,e){return e.priority-t.priority}));var s=[];try{for(var r=o(this.popups),a=r.next();!a.done;a=r.next()){var l=a.value,h=!0;try{for(var c=(i=void 0,o(s)),d=c.next();!d.done;d=c.next()){var u=d.value;if(this.doPopupsOverlap(u,l)){h=!1;break}}}catch(t){i={error:t}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(i)throw i.error}}h?s.push(l):l.hide()}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.doPopupsOverlap=function(t,e){var i=t.getElement().getBoundingClientRect(),n=e.getElement().getBoundingClientRect();return i.left<n.right&&i.right>n.left&&i.top<n.bottom&&i.bottom>n.top},t}());e.popupManager=d,e.Tooltip=c;var u=function(t){function e(e){void 0===e&&(e=document.body);var i=t.call(this,e)||this;i.timeout=void 0,i.lastT=0,i.idleTime=350,i.lastEvent=void 0,i.onMouseOut=i.onMouseOut.bind(i),i.onMouseMove=i.onMouseMove.bind(i),i.waitForHover=i.waitForHover.bind(i),i.hide=i.hide.bind(i);var n=i.getElement();return n.style.whiteSpace="pre-wrap",n.style.pointerEvents="auto",n.addEventListener("mouseout",i.onMouseOut),n.tabIndex=-1,n.addEventListener("blur",function(){n.contains(document.activeElement)||this.hide()}.bind(i)),n.addEventListener("wheel",l),i}return s(e,t),e.prototype.addToEditor=function(t){t.on("mousemove",this.onMouseMove),t.on("mousedown",this.hide),t.renderer.getMouseEventTarget().addEventListener("mouseout",this.onMouseOut,!0)},e.prototype.removeFromEditor=function(t){t.off("mousemove",this.onMouseMove),t.off("mousedown",this.hide),t.renderer.getMouseEventTarget().removeEventListener("mouseout",this.onMouseOut,!0),this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},e.prototype.onMouseMove=function(t,e){this.lastEvent=t,this.lastT=Date.now();var i=e.$mouseHandler.isMousePressed;if(this.isOpen){var n=this.lastEvent&&this.lastEvent.getDocumentPosition();this.range&&this.range.contains(n.row,n.column)&&!i&&!this.isOutsideOfText(this.lastEvent)||this.hide()}this.timeout||i||(this.lastEvent=t,this.timeout=setTimeout(this.waitForHover,this.idleTime))},e.prototype.waitForHover=function(){this.timeout&&clearTimeout(this.timeout);var t=Date.now()-this.lastT;this.idleTime-t>10?this.timeout=setTimeout(this.waitForHover,this.idleTime-t):(this.timeout=null,this.lastEvent&&!this.isOutsideOfText(this.lastEvent)&&this.$gatherData(this.lastEvent,this.lastEvent.editor))},e.prototype.isOutsideOfText=function(t){var e=t.editor,i=t.getDocumentPosition(),n=e.session.getLine(i.row);if(i.column==n.length){var s=e.renderer.pixelToScreenCoordinates(t.clientX,t.clientY),o=e.session.documentToScreenPosition(i.row,i.column);if(o.column!=s.column||o.row!=s.row)return!0}return!1},e.prototype.setDataProvider=function(t){this.$gatherData=t},e.prototype.showForRange=function(t,e,i,n){if(!(n&&n!=this.lastEvent||this.isOpen&&document.activeElement==this.getElement())){var s=t.renderer;this.isOpen||(d.addPopup(this),this.$registerCloseEvents(),this.setTheme(s.theme)),this.isOpen=!0,this.addMarker(e,t.session),this.range=a.fromPoints(e.start,e.end);var o=s.textToScreenCoordinates(e.start.row,e.start.column),r=s.scroller.getBoundingClientRect();o.pageX<r.left&&(o.pageX=r.left);var l=this.getElement();l.innerHTML="",l.appendChild(i),l.style.maxHeight="",l.style.display="block";var h=l.clientHeight,c=l.clientWidth,u=window.innerHeight-o.pageY-s.lineHeight,p=!0;o.pageY-h<0&&o.pageY<u&&(p=!1),l.style.maxHeight=(p?o.pageY:u)-10+"px",l.style.top=p?"":o.pageY+s.lineHeight+"px",l.style.bottom=p?window.innerHeight-o.pageY+"px":"",l.style.left=Math.min(o.pageX,window.innerWidth-c-10)+"px"}},e.prototype.addMarker=function(t,e){this.marker&&this.$markerSession.removeMarker(this.marker),this.$markerSession=e,this.marker=e&&e.addMarker(t,"ace_highlight-marker","text")},e.prototype.hide=function(t){(t||document.activeElement!=this.getElement())&&(t&&t.target&&("keydown"!=t.type||t.ctrlKey||t.metaKey)&&this.$element.contains(t.target)||(this.lastEvent=null,this.timeout&&clearTimeout(this.timeout),this.timeout=null,this.addMarker(null),this.isOpen&&(this.$removeCloseEvents(),this.getElement().style.display="none",this.isOpen=!1,d.removePopup(this))))},e.prototype.$registerCloseEvents=function(){window.addEventListener("keydown",this.hide,!0),window.addEventListener("wheel",this.hide,!0),window.addEventListener("mousedown",this.hide,!0)},e.prototype.$removeCloseEvents=function(){window.removeEventListener("keydown",this.hide,!0),window.removeEventListener("wheel",this.hide,!0),window.removeEventListener("mousedown",this.hide,!0)},e.prototype.onMouseOut=function(t){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.lastEvent=null,this.isOpen&&t.relatedTarget&&!this.getElement().contains(t.relatedTarget)&&(t&&t.currentTarget.contains(t.relatedTarget)||t.relatedTarget.classList.contains("ace_content")||this.hide())},e}(c);e.HoverTooltip=u})),ace.define("ace/mouse/default_gutter_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/tooltip","ace/config","ace/lib/lang"],(function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=t("../lib/dom"),a=t("../lib/event"),l=t("../tooltip").Tooltip,h=t("../config").nls;t("../lib/lang"),e.GutterHandler=function(t){var e,i,n=t.editor,s=n.renderer.$gutterLayer,o=new c(n);function l(){e&&(e=clearTimeout(e)),o.isOpen&&(o.hideTooltip(),n.off("mousewheel",l))}function h(t){o.setPosition(t.x,t.y)}t.editor.setDefaultHandler("guttermousedown",(function(e){if(n.isFocused()&&0==e.getButton()&&"foldWidgets"!=s.getRegion(e)){var i=e.getDocumentPosition().row,o=n.session.selection;if(e.getShiftKey())o.selectTo(i,0);else{if(2==e.domEvent.detail)return n.selectAll(),e.preventDefault();t.$clickSelection=n.selection.getLineRange(i)}return t.setState("selectByLines"),t.captureMouse(e),e.preventDefault()}})),t.editor.setDefaultHandler("guttermousemove",(function(a){var c=a.domEvent.target||a.domEvent.srcElement;if(r.hasCssClass(c,"ace_fold-widget"))return l();o.isOpen&&t.$tooltipFollowsMouse&&h(a),i=a,e||(e=setTimeout((function(){e=null,i&&!t.isMousePressed?function(){var e=i.getDocumentPosition().row;if(e==n.session.getLength()){var r=n.renderer.pixelToScreenCoordinates(0,i.y).row,a=i.$pos;if(r>n.session.documentToScreenRow(a.row,a.column))return l()}if(o.showTooltip(e),o.isOpen)if(n.on("mousewheel",l),t.$tooltipFollowsMouse)h(i);else{var c=i.getGutterRow(),d=s.$lines.get(c);if(d){var u=d.element.querySelector(".ace_gutter_annotation").getBoundingClientRect(),p=o.getElement().style;p.left=u.right+"px",p.top=u.bottom+"px"}else h(i)}}():l()}),50))})),a.addListener(n.renderer.$gutter,"mouseout",(function(t){i=null,o.isOpen&&!e&&(e=setTimeout((function(){e=null,l()}),50))}),n),n.on("changeSession",l),n.on("input",l)};var c=function(t){function e(e){var i=t.call(this,e.container)||this;return i.editor=e,i}return s(e,t),e.prototype.setPosition=function(t,e){var i=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight,s=this.getWidth(),o=this.getHeight();(t+=15)+s>i&&(t-=t+s-i),(e+=15)+o>n&&(e-=20+o),l.prototype.setPosition.call(this,t,e)},Object.defineProperty(e,"annotationLabels",{get:function(){return{error:{singular:h("gutter-tooltip.aria-label.error.singular","error"),plural:h("gutter-tooltip.aria-label.error.plural","errors")},security:{singular:h("gutter-tooltip.aria-label.security.singular","security finding"),plural:h("gutter-tooltip.aria-label.security.plural","security findings")},warning:{singular:h("gutter-tooltip.aria-label.warning.singular","warning"),plural:h("gutter-tooltip.aria-label.warning.plural","warnings")},info:{singular:h("gutter-tooltip.aria-label.info.singular","information message"),plural:h("gutter-tooltip.aria-label.info.plural","information messages")},hint:{singular:h("gutter-tooltip.aria-label.hint.singular","suggestion"),plural:h("gutter-tooltip.aria-label.hint.plural","suggestions")}}},enumerable:!1,configurable:!0}),e.prototype.showTooltip=function(t){var i,n,s=this.editor.renderer.$gutterLayer,o=s.$annotations[t];n=o?{displayText:Array.from(o.displayText),type:Array.from(o.type)}:{displayText:[],type:[]};var a=s.session.getFoldLine(t);if(a&&s.$showFoldedAnnotations){for(var l,h={error:[],security:[],warning:[],info:[],hint:[]},c={error:1,security:2,warning:3,info:4,hint:5},d=t+1;d<=a.end.row;d++)if(s.$annotations[d])for(var u=0;u<s.$annotations[d].text.length;u++){var p=s.$annotations[d].type[u];h[p].push(s.$annotations[d].text[u]),(!l||c[p]<c[l])&&(l=p)}if(["error","security","warning"].includes(l)){var g="".concat(e.annotationsToSummaryString(h)," in folded code.");n.displayText.push(g),n.type.push(l+"_fold")}}if(0===n.displayText.length)return this.hide();var f={error:[],security:[],warning:[],info:[],hint:[]},m=s.$useSvgGutterIcons?"ace_icon_svg":"ace_icon";for(d=0;d<n.displayText.length;d++){var v=r.createElement("span"),_=r.createElement("span");(i=_.classList).add.apply(i,["ace_".concat(n.type[d]),m]),_.setAttribute("aria-label","".concat(e.annotationLabels[n.type[d].replace("_fold","")].singular)),_.setAttribute("role","img"),_.appendChild(r.createTextNode(" ")),v.appendChild(_),v.appendChild(r.createTextNode(n.displayText[d])),v.appendChild(r.createElement("br")),f[n.type[d].replace("_fold","")].push(v)}var y=this.getElement();r.removeChildren(y),f.error.forEach((function(t){return y.appendChild(t)})),f.security.forEach((function(t){return y.appendChild(t)})),f.warning.forEach((function(t){return y.appendChild(t)})),f.info.forEach((function(t){return y.appendChild(t)})),f.hint.forEach((function(t){return y.appendChild(t)})),y.setAttribute("aria-live","polite"),this.isOpen||(this.setTheme(this.editor.renderer.theme),this.setClassName("ace_gutter-tooltip")),this.show(),this.editor._signal("showGutterTooltip",this)},e.prototype.hideTooltip=function(){this.$element.removeAttribute("aria-live"),this.hide(),this.editor._signal("hideGutterTooltip",this)},e.annotationsToSummaryString=function(t){var i,n,s=[];try{for(var r=o(["error","security","warning","info","hint"]),a=r.next();!a.done;a=r.next()){var l=a.value;if(t[l].length){var h=1===t[l].length?e.annotationLabels[l].singular:e.annotationLabels[l].plural;s.push("".concat(t[l].length," ").concat(h))}}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return s.join(", ")},e}(l);e.GutterTooltip=c})),ace.define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],(function(t,e,i){"use strict";var n=t("../lib/event"),s=t("../lib/useragent"),o=function(){function t(t,e){this.speed,this.wheelX,this.wheelY,this.domEvent=t,this.editor=e,this.x=this.clientX=t.clientX,this.y=this.clientY=t.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1}return t.prototype.stopPropagation=function(){n.stopPropagation(this.domEvent),this.propagationStopped=!0},t.prototype.preventDefault=function(){n.preventDefault(this.domEvent),this.defaultPrevented=!0},t.prototype.stop=function(){this.stopPropagation(),this.preventDefault()},t.prototype.getDocumentPosition=function(){return this.$pos||(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY)),this.$pos},t.prototype.getGutterRow=function(){var t=this.getDocumentPosition().row;return this.editor.session.documentToScreenRow(t,0)-this.editor.session.documentToScreenRow(this.editor.renderer.$gutterLayer.$lines.get(0).row,0)},t.prototype.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var t=this.editor.getSelectionRange();if(t.isEmpty())this.$inSelection=!1;else{var e=this.getDocumentPosition();this.$inSelection=t.contains(e.row,e.column)}return this.$inSelection},t.prototype.getButton=function(){return n.getButton(this.domEvent)},t.prototype.getShiftKey=function(){return this.domEvent.shiftKey},t.prototype.getAccelKey=function(){return s.isMac?this.domEvent.metaKey:this.domEvent.ctrlKey},t}();e.MouseEvent=o})),ace.define("ace/mouse/dragdrop_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],(function(t,e,i){"use strict";var n=t("../lib/dom"),s=t("../lib/event"),o=t("../lib/useragent");function r(t){var e=t.editor,i=n.createElement("div");i.style.cssText="top:-100px;position:absolute;z-index:2147483647;opacity:0.5",i.textContent=" ",["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach((function(e){t[e]=this[e]}),this),e.on("mousedown",this.onMouseDown.bind(t));var r,l,h,c,d,u,p,g,f,m,v,_=e.container,y=0;function w(){var t=u;(function(t,i){var n=Date.now(),s=!i||t.row!=i.row,o=!i||t.column!=i.column;!m||s||o?(e.moveCursorToPosition(t),m=n,v={x:l,y:h}):a(v.x,v.y,l,h)>5?m=null:n-m>=200&&(e.renderer.scrollCursorIntoView(),m=null)})(u=e.renderer.screenToTextCoordinates(l,h),t),function(t,i){var n=Date.now(),s=e.renderer.layerConfig.lineHeight,o=e.renderer.layerConfig.characterWidth,r=e.renderer.scroller.getBoundingClientRect(),a={x:{left:l-r.left,right:r.right-l},y:{top:h-r.top,bottom:r.bottom-h}},c=Math.min(a.x.left,a.x.right),d=Math.min(a.y.top,a.y.bottom),u={row:t.row,column:t.column};c/o<=2&&(u.column+=a.x.left<a.x.right?-3:2),d/s<=1&&(u.row+=a.y.top<a.y.bottom?-1:1);var p=t.row!=u.row,g=t.column!=u.column,m=!i||t.row!=i.row;p||g&&!m?f?n-f>=200&&e.renderer.scrollCursorIntoView(u):f=n:f=null}(u,t)}function x(){d=e.selection.toOrientedRange(),r=e.session.addMarker(d,"ace_selection",e.getSelectionStyle()),e.clearSelection(),e.isFocused()&&e.renderer.$cursorLayer.setBlinking(!1),clearInterval(c),w(),c=setInterval(w,20),y=0,s.addListener(document,"mousemove",A)}function b(){clearInterval(c),e.session.removeMarker(r),r=null,e.selection.fromOrientedRange(d),e.isFocused()&&!g&&e.$resetCursorStyle(),d=null,u=null,y=0,f=null,m=null,s.removeListener(document,"mousemove",A)}this.onDragStart=function(t){if(this.cancelDrag||!_.draggable){var n=this;return setTimeout((function(){n.startSelect(),n.captureMouse(t)}),0),t.preventDefault()}d=e.getSelectionRange();var s=t.dataTransfer;s.effectAllowed=e.getReadOnly()?"copy":"copyMove",e.container.appendChild(i),s.setDragImage&&s.setDragImage(i,0,0),setTimeout((function(){e.container.removeChild(i)})),s.clearData(),s.setData("Text",e.session.getTextRange()),g=!0,this.setState("drag")},this.onDragEnd=function(t){if(_.draggable=!1,g=!1,this.setState(null),!e.getReadOnly()){var i=t.dataTransfer.dropEffect;p||"move"!=i||e.session.remove(e.getSelectionRange()),e.$resetCursorStyle()}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(t){if(!e.getReadOnly()&&S(t.dataTransfer))return l=t.clientX,h=t.clientY,r||x(),y++,t.dataTransfer.dropEffect=p=E(t),s.preventDefault(t)},this.onDragOver=function(t){if(!e.getReadOnly()&&S(t.dataTransfer))return l=t.clientX,h=t.clientY,r||(x(),y++),null!==C&&(C=null),t.dataTransfer.dropEffect=p=E(t),s.preventDefault(t)},this.onDragLeave=function(t){if(--y<=0&&r)return b(),p=null,s.preventDefault(t)},this.onDrop=function(t){if(u){var i=t.dataTransfer;if(g)switch(p){case"move":d=d.contains(u.row,u.column)?{start:u,end:u}:e.moveText(d,u);break;case"copy":d=e.moveText(d,u,!0)}else{var n=i.getData("Text");d={start:u,end:e.session.insert(u,n)},e.focus(),p=null}return b(),s.preventDefault(t)}},s.addListener(_,"dragstart",this.onDragStart.bind(t),e),s.addListener(_,"dragend",this.onDragEnd.bind(t),e),s.addListener(_,"dragenter",this.onDragEnter.bind(t),e),s.addListener(_,"dragover",this.onDragOver.bind(t),e),s.addListener(_,"dragleave",this.onDragLeave.bind(t),e),s.addListener(_,"drop",this.onDrop.bind(t),e);var C=null;function A(){null==C&&(C=setTimeout((function(){null!=C&&r&&b()}),20))}function S(t){var e=t.types;return!e||Array.prototype.some.call(e,(function(t){return"text/plain"==t||"Text"==t}))}function E(t){var e=["copy","copymove","all","uninitialized"],i=o.isMac?t.altKey:t.ctrlKey,n="uninitialized";try{n=t.dataTransfer.effectAllowed.toLowerCase()}catch(t){}var s="none";return i&&e.indexOf(n)>=0?s="copy":["move","copymove","linkmove","all","uninitialized"].indexOf(n)>=0?s="move":e.indexOf(n)>=0&&(s="copy"),s}}function a(t,e,i,n){return Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2))}(function(){this.dragWait=function(){Date.now()-this.mousedownEvent.time>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){this.editor.container.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(t){this.editor.$resetCursorStyle(),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var t=this.editor;t.container.draggable=!0,t.renderer.$cursorLayer.setBlinking(!1),t.setStyle("ace_dragging");var e=o.isWin?"default":"move";t.renderer.setCursorStyle(e),this.setState("dragReady")},this.onMouseDrag=function(t){var e=this.editor.container;o.isIE&&"dragReady"==this.state&&a(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>3&&e.dragDrop(),"dragWait"===this.state&&a(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>0&&(e.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()))},this.onMouseDown=function(t){if(this.$dragEnabled){this.mousedownEvent=t;var e=this.editor,i=t.inSelection(),n=t.getButton();if(1===(t.domEvent.detail||1)&&0===n&&i){if(t.editor.inMultiSelectMode&&(t.getAccelKey()||t.getShiftKey()))return;this.mousedownEvent.time=Date.now();var s=t.domEvent.target||t.domEvent.srcElement;"unselectable"in s&&(s.unselectable="on"),e.getDragDelay()?(o.isWebKit&&(this.cancelDrag=!0,e.container.draggable=!0),this.setState("dragWait")):this.startDrag(),this.captureMouse(t,this.onMouseDrag.bind(this)),t.defaultPrevented=!0}}}}).call(r.prototype),e.DragdropHandler=r})),ace.define("ace/mouse/touch_handler",["require","exports","module","ace/mouse/mouse_event","ace/lib/event","ace/lib/dom"],(function(t,e,i){"use strict";var n=t("./mouse_event").MouseEvent,s=t("../lib/event"),o=t("../lib/dom");e.addTouchListeners=function(t,e){var i,r,a,l,h,c,d,u,p,g="scroll",f=0,m=0,v=0,_=0;function y(){if(e.getOption("enableMobileMenu")){p||(a=window.navigator&&window.navigator.clipboard,l=!1,h=function(t){return e.commands.canExecute(t,e)},c=function(t){var i,n,s=t.target.getAttribute("action");if("more"==s||!l)return l=!l,i=e.getCopyText(),n=e.session.getUndoManager().hasUndo(),void p.replaceChild(o.buildDom(l?["span",!i&&h("selectall")&&["span",{class:"ace_mobile-button",action:"selectall"},"Select All"],i&&h("copy")&&["span",{class:"ace_mobile-button",action:"copy"},"Copy"],i&&h("cut")&&["span",{class:"ace_mobile-button",action:"cut"},"Cut"],a&&h("paste")&&["span",{class:"ace_mobile-button",action:"paste"},"Paste"],n&&h("undo")&&["span",{class:"ace_mobile-button",action:"undo"},"Undo"],h("find")&&["span",{class:"ace_mobile-button",action:"find"},"Find"],h("openCommandPalette")&&["span",{class:"ace_mobile-button",action:"openCommandPalette"},"Palette"]]:["span"]),p.firstChild);"paste"==s?a.readText().then((function(t){e.execCommand(s,t)})):s&&("cut"!=s&&"copy"!=s||(a?a.writeText(e.getCopyText()):document.execCommand("copy")),e.execCommand(s)),p.firstChild.style.display="none",l=!1,"openCommandPalette"!=s&&e.focus()},p=o.buildDom(["div",{class:"ace_mobile-menu",ontouchstart:function(t){g="menu",t.stopPropagation(),t.preventDefault(),e.textInput.focus()},ontouchend:function(t){t.stopPropagation(),t.preventDefault(),c(t)},onclick:c},["span"],["span",{class:"ace_mobile-button",action:"more"},"..."]],e.container));var t=e.selection.cursor,i=e.renderer.textToScreenCoordinates(t.row,t.column),n=e.renderer.textToScreenCoordinates(0,0).pageX,s=e.renderer.scrollLeft,r=e.container.getBoundingClientRect();p.style.top=i.pageY-r.top-3+"px",i.pageX-r.left<r.width-70?(p.style.left="",p.style.right="10px"):(p.style.right="",p.style.left=n+s-r.left+"px"),p.style.display="",p.firstChild.style.display="none",e.on("input",w)}else p&&w();var a,l,h,c}function w(t){p&&(p.style.display="none"),e.off("input",w)}function x(){h=null,clearTimeout(h);var t=e.selection.getRange(),i=t.contains(d.row,d.column);!t.isEmpty()&&i||(e.selection.moveToPosition(d),e.selection.selectWord()),g="wait",y()}s.addListener(t,"contextmenu",(function(t){u&&e.textInput.getElement().focus()}),e),s.addListener(t,"touchstart",(function(t){var s=t.touches;if(h||s.length>1)return clearTimeout(h),h=null,a=-1,void(g="zoom");u=e.$mouseHandler.isMousePressed=!0;var o=e.renderer.layerConfig.lineHeight,c=e.renderer.layerConfig.lineHeight,p=t.timeStamp;l=p;var y=s[0],w=y.clientX,b=y.clientY;Math.abs(i-w)+Math.abs(r-b)>o&&(a=-1),i=t.clientX=w,r=t.clientY=b,v=_=0;var C=new n(t,e);if(d=C.getDocumentPosition(),p-a<500&&1==s.length&&!f)m++,t.preventDefault(),t.button=0,function(){h=null,clearTimeout(h),e.selection.moveToPosition(d);var t=m>=2?e.selection.getLineRange(d.row):e.session.getBracketRange(d);t&&!t.isEmpty()?e.selection.setRange(t):e.selection.selectWord(),g="wait"}();else{m=0;var A=e.selection.cursor,S=e.selection.isEmpty()?A:e.selection.anchor,E=e.renderer.$cursorLayer.getPixelPosition(A,!0),T=e.renderer.$cursorLayer.getPixelPosition(S,!0),k=e.renderer.scroller.getBoundingClientRect(),M=e.renderer.layerConfig.offset,$=e.renderer.scrollLeft,L=function(t,e){return(t/=c)*t+(e=e/o-.75)*e};if(t.clientX<k.left)return void(g="zoom");var R=L(t.clientX-k.left-E.left+$,t.clientY-k.top-E.top+M),I=L(t.clientX-k.left-T.left+$,t.clientY-k.top-T.top+M);R<3.5&&I<3.5&&(g=R>I?"cursor":"anchor"),g=I<3.5?"anchor":R<3.5?"cursor":"scroll",h=setTimeout(x,450)}a=p}),e),s.addListener(t,"touchend",(function(t){u=e.$mouseHandler.isMousePressed=!1,c&&clearInterval(c),"zoom"==g?(g="",f=0):h?(e.selection.moveToPosition(d),f=0,y()):"scroll"==g?(f+=60,c=setInterval((function(){f--<=0&&(clearInterval(c),c=null),Math.abs(v)<.01&&(v=0),Math.abs(_)<.01&&(_=0),f<20&&(v*=.9),f<20&&(_*=.9);var t=e.session.getScrollTop();e.renderer.scrollBy(10*v,10*_),t==e.session.getScrollTop()&&(f=0)}),10),w()):y(),clearTimeout(h),h=null}),e),s.addListener(t,"touchmove",(function(t){h&&(clearTimeout(h),h=null);var s=t.touches;if(!(s.length>1||"zoom"==g)){var o=s[0],a=i-o.clientX,c=r-o.clientY;if("wait"==g){if(!(a*a+c*c>4))return t.preventDefault();g="cursor"}i=o.clientX,r=o.clientY,t.clientX=o.clientX,t.clientY=o.clientY;var d=t.timeStamp,u=d-l;if(l=d,"scroll"==g){var p=new n(t,e);p.speed=1,p.wheelX=a,p.wheelY=c,10*Math.abs(a)<Math.abs(c)&&(a=0),10*Math.abs(c)<Math.abs(a)&&(c=0),0!=u&&(v=a/u,_=c/u),e._emit("mousewheel",p),p.propagationStopped||(v=_=0)}else{var f=new n(t,e).getDocumentPosition();"cursor"==g?e.selection.moveCursorToPosition(f):"anchor"==g&&e.selection.setSelectionAnchor(f.row,f.column),e.renderer.scrollCursorIntoView(f),t.preventDefault()}}}),e)}})),ace.define("ace/mouse/mouse_handler",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/mouse/default_handlers","ace/mouse/default_gutter_handler","ace/mouse/mouse_event","ace/mouse/dragdrop_handler","ace/mouse/touch_handler","ace/config"],(function(t,e,i){"use strict";var n=t("../lib/event"),s=t("../lib/useragent"),o=t("./default_handlers").DefaultHandlers,r=t("./default_gutter_handler").GutterHandler,a=t("./mouse_event").MouseEvent,l=t("./dragdrop_handler").DragdropHandler,h=t("./touch_handler").addTouchListeners,c=t("../config"),d=function(){function t(t){this.$dragDelay,this.$dragEnabled,this.$mouseMoved,this.mouseEvent,this.$focusTimeout;var e=this;this.editor=t,new o(this),new r(this),new l(this);var i=function(e){(!document.hasFocus||!document.hasFocus()||!t.isFocused()&&document.activeElement==(t.textInput&&t.textInput.getElement()))&&window.focus(),t.focus(),setTimeout((function(){t.isFocused()||t.focus()}))},a=t.renderer.getMouseEventTarget();n.addListener(a,"click",this.onMouseEvent.bind(this,"click"),t),n.addListener(a,"mousemove",this.onMouseMove.bind(this,"mousemove"),t),n.addMultiMouseDownListener([a,t.renderer.scrollBarV&&t.renderer.scrollBarV.inner,t.renderer.scrollBarH&&t.renderer.scrollBarH.inner,t.textInput&&t.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent",t),n.addMouseWheelListener(t.container,this.onMouseWheel.bind(this,"mousewheel"),t),h(t.container,t);var c=t.renderer.$gutter;n.addListener(c,"mousedown",this.onMouseEvent.bind(this,"guttermousedown"),t),n.addListener(c,"click",this.onMouseEvent.bind(this,"gutterclick"),t),n.addListener(c,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick"),t),n.addListener(c,"mousemove",this.onMouseEvent.bind(this,"guttermousemove"),t),n.addListener(a,"mousedown",i,t),n.addListener(c,"mousedown",i,t),s.isIE&&t.renderer.scrollBarV&&(n.addListener(t.renderer.scrollBarV.element,"mousedown",i,t),n.addListener(t.renderer.scrollBarH.element,"mousedown",i,t)),t.on("mousemove",(function(i){if(!e.state&&!e.$dragDelay&&e.$dragEnabled){var n=t.renderer.screenToTextCoordinates(i.x,i.y),s=t.session.selection.getRange(),o=t.renderer;!s.isEmpty()&&s.insideStart(n.row,n.column)?o.setCursorStyle("default"):o.setCursorStyle("")}}),t)}return t.prototype.onMouseEvent=function(t,e){this.editor.session&&this.editor._emit(t,new a(e,this.editor))},t.prototype.onMouseMove=function(t,e){var i=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;i&&i.length&&this.editor._emit(t,new a(e,this.editor))},t.prototype.onMouseWheel=function(t,e){var i=new a(e,this.editor);i.speed=2*this.$scrollSpeed,i.wheelX=e.wheelX,i.wheelY=e.wheelY,this.editor._emit(t,i)},t.prototype.setState=function(t){this.state=t},t.prototype.captureMouse=function(t,e){this.x=t.x,this.y=t.y,this.isMousePressed=!0;var i=this.editor,o=this.editor.renderer;o.$isMousePressed=!0;var r=this,l=function(t){if(t){if(s.isWebKit&&!t.which&&r.releaseMouse)return r.releaseMouse();r.x=t.clientX,r.y=t.clientY,e&&e(t),r.mouseEvent=new a(t,r.editor),r.$mouseMoved=!0}},h=function(t){i.off("beforeEndOperation",d),clearInterval(u),i.session&&c(),r[r.state+"End"]&&r[r.state+"End"](t),r.state="",r.isMousePressed=o.$isMousePressed=!1,o.$keepTextAreaAtCursor&&o.$moveTextAreaToCursor(),r.$onCaptureMouseMove=r.releaseMouse=null,t&&r.onMouseEvent("mouseup",t),i.endOperation()},c=function(){r[r.state]&&r[r.state](),r.$mouseMoved=!1};if(s.isOldIE&&"dblclick"==t.domEvent.type)return setTimeout((function(){h(t)}));var d=function(t){r.releaseMouse&&i.curOp.command.name&&i.curOp.selectionChanged&&(r[r.state+"End"]&&r[r.state+"End"](),r.state="",r.releaseMouse())};i.on("beforeEndOperation",d),i.startOperation({command:{name:"mouse"}}),r.$onCaptureMouseMove=l,r.releaseMouse=n.capture(this.editor.container,l,h);var u=setInterval(c,20)},t.prototype.cancelContextMenu=function(){var t=function(e){e&&e.domEvent&&"contextmenu"!=e.domEvent.type||(this.editor.off("nativecontextmenu",t),e&&e.domEvent&&n.stopEvent(e.domEvent))}.bind(this);setTimeout(t,10),this.editor.on("nativecontextmenu",t)},t.prototype.destroy=function(){this.releaseMouse&&this.releaseMouse()},t}();d.prototype.releaseMouse=null,c.defineOptions(d.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:s.isMac?150:0},dragEnabled:{initialValue:!0},focusTimeout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),e.MouseHandler=d})),ace.define("ace/mouse/fold_handler",["require","exports","module","ace/lib/dom"],(function(t,e,i){"use strict";var n=t("../lib/dom");e.FoldHandler=function(t){t.on("click",(function(e){var i=e.getDocumentPosition(),s=t.session,o=s.getFoldAt(i.row,i.column,1);o&&(e.getAccelKey()?s.removeFold(o):s.expandFold(o),e.stop());var r=e.domEvent&&e.domEvent.target;r&&n.hasCssClass(r,"ace_inline_button")&&n.hasCssClass(r,"ace_toggle_wrap")&&(s.setOption("wrap",!s.getUseWrapMode()),t.renderer.scrollCursorIntoView())})),t.on("gutterclick",(function(e){if("foldWidgets"==t.renderer.$gutterLayer.getRegion(e)){var i=e.getDocumentPosition().row,n=t.session;n.foldWidgets&&n.foldWidgets[i]&&t.session.onFoldWidgetClick(i,e),t.isFocused()||t.focus(),e.stop()}})),t.on("gutterdblclick",(function(e){if("foldWidgets"==t.renderer.$gutterLayer.getRegion(e)){var i=e.getDocumentPosition().row,n=t.session,s=n.getParentFoldRangeData(i,!0),o=s.range||s.firstRange;if(o){i=o.start.row;var r=n.getFoldAt(i,n.getLine(i).length,1);r?n.removeFold(r):(n.addFold("...",o),t.renderer.scrollCursorIntoView({row:o.start.row,column:0}))}e.stop()}}))}})),ace.define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],(function(t,e,i){"use strict";var n=t("../lib/keys"),s=t("../lib/event"),o=function(){function t(t){this.$editor=t,this.$data={editor:t},this.$handlers=[],this.setDefaultHandler(t.commands)}return t.prototype.setDefaultHandler=function(t){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=t,this.addKeyboardHandler(t,0)},t.prototype.setKeyboardHandler=function(t){var e=this.$handlers;if(e[e.length-1]!=t){for(;e[e.length-1]&&e[e.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(e[e.length-1]);this.addKeyboardHandler(t,1)}},t.prototype.addKeyboardHandler=function(t,e){if(t){"function"!=typeof t||t.handleKeyboard||(t.handleKeyboard=t);var i=this.$handlers.indexOf(t);-1!=i&&this.$handlers.splice(i,1),null==e?this.$handlers.push(t):this.$handlers.splice(e,0,t),-1==i&&t.attach&&t.attach(this.$editor)}},t.prototype.removeKeyboardHandler=function(t){var e=this.$handlers.indexOf(t);return-1!=e&&(this.$handlers.splice(e,1),t.detach&&t.detach(this.$editor),!0)},t.prototype.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},t.prototype.getStatusText=function(){var t=this.$data,e=t.editor;return this.$handlers.map((function(i){return i.getStatusText&&i.getStatusText(e,t)||""})).filter(Boolean).join(" ")},t.prototype.$callKeyboardHandlers=function(t,e,i,n){for(var o,r=!1,a=this.$editor.commands,l=this.$handlers.length;l--&&!((o=this.$handlers[l].handleKeyboard(this.$data,t,e,i,n))&&o.command&&((r="null"==o.command||a.exec(o.command,this.$editor,o.args,n))&&n&&-1!=t&&1!=o.passEvent&&1!=o.command.passEvent&&s.stopEvent(n),r)););return r||-1!=t||(o={command:"insertstring"},r=a.exec("insertstring",this.$editor,e)),r&&this.$editor._signal&&this.$editor._signal("keyboardActivity",o),r},t.prototype.onCommandKey=function(t,e,i){var s=n.keyCodeToString(i);return this.$callKeyboardHandlers(e,s,i,t)},t.prototype.onTextInput=function(t){return this.$callKeyboardHandlers(-1,t)},t}();e.KeyBinding=o})),ace.define("ace/lib/bidiutil",["require","exports","module"],(function(t,e,i){"use strict";var n=0,s=0,o=!1,r=!1,a=!1,l=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],c=11,d=18,u=[d,d,d,d,d,d,d,d,d,6,5,6,8,5,d,d,d,d,d,d,d,d,d,d,d,d,d,d,5,5,5,6,8,4,4,c,c,c,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,d,d,d,d,d,d,5,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,9,4,c,c,c,c,4,4,4,4,0,4,4,d,4,4,c,c,2,2,4,0,4,4,4,2,0,4,4,4,4,4],p=[8,8,8,8,8,8,8,8,8,8,8,d,d,d,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,c,c,c,c,c,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8];function g(t,e,i){if(!(s<t))if(1!=t||1!=n||r)for(var o,a,l,h,c=i.length,d=0;d<c;){if(e[d]>=t){for(o=d+1;o<c&&e[o]>=t;)o++;for(a=d,l=o-1;a<l;a++,l--)h=i[a],i[a]=i[l],i[l]=h;d=o}d++}else i.reverse()}function f(t,e,i,s){var l,h,u,p,g=e[s];switch(g){case 0:case 1:o=!1;case 4:case 3:return g;case 2:return o?3:2;case 7:return o=!0,1;case 8:return 4;case 9:return s<1||s+1>=e.length||2!=(l=i[s-1])&&3!=l||2!=(h=e[s+1])&&3!=h?4:(o&&(h=3),h==l?h:4);case 10:return 2==(l=s>0?i[s-1]:5)&&s+1<e.length&&2==e[s+1]?2:4;case c:if(s>0&&2==i[s-1])return 2;if(o)return 4;for(p=s+1,u=e.length;p<u&&e[p]==c;)p++;return p<u&&2==e[p]?2:4;case 12:for(u=e.length,p=s+1;p<u&&12==e[p];)p++;if(p<u){var f=t[s],m=f>=1425&&f<=2303||64286==f;if(l=e[p],m&&(1==l||7==l))return 1}return s<1||5==(l=e[s-1])?4:i[s-1];case 5:return o=!1,r=!0,n;case 6:return a=!0,4;case 13:case 14:case 16:case 17:case 15:o=!1;case d:return 4}}function m(t){var e=t.charCodeAt(0),i=e>>8;return 0==i?e>191?0:u[e]:5==i?/[\u0591-\u05f4]/.test(t)?1:0:6==i?/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(t)?12:/[\u0660-\u0669\u066b-\u066c]/.test(t)?3:1642==e?c:/[\u06f0-\u06f9]/.test(t)?2:7:32==i&&e<=8287?p[255&e]:254==i&&e>=65136?7:4}e.L=0,e.R=1,e.EN=2,e.ON_R=3,e.AN=4,e.R_H=5,e.B=6,e.RLE=7,e.DOT="·",e.doBidiReorder=function(t,i,c){if(t.length<2)return{};var u=t.split(""),p=new Array(u.length),v=new Array(u.length),_=[];n=c?1:0,function(t,e,i,c){var d=n?h:l,u=null,p=null,g=null,v=0,_=null,y=-1,w=null,x=null,b=[];if(!c)for(w=0,c=[];w<i;w++)c[w]=m(t[w]);for(s=n,o=!1,r=!1,a=!1,x=0;x<i;x++){if(u=v,b[x]=p=f(t,c,b,x),_=240&(v=d[u][p]),v&=15,e[x]=g=d[v][5],_>0)if(16==_){for(w=y;w<x;w++)e[w]=1;y=-1}else y=-1;if(d[v][6])-1==y&&(y=x);else if(y>-1){for(w=y;w<x;w++)e[w]=g;y=-1}5==c[x]&&(e[x]=0),s|=g}if(a)for(w=0;w<i;w++)if(6==c[w]){e[w]=n;for(var C=w-1;C>=0&&8==c[C];C--)e[C]=n}}(u,_,u.length,i);for(var y=0;y<p.length;p[y]=y,y++);for(g(2,_,p),g(1,_,p),y=0;y<p.length-1;y++)3===i[y]?_[y]=e.AN:1===_[y]&&(i[y]>7&&i[y]<13||4===i[y]||i[y]===d)?_[y]=e.ON_R:y>0&&"ل"===u[y-1]&&/\u0622|\u0623|\u0625|\u0627/.test(u[y])&&(_[y-1]=_[y]=e.R_H,y++);for(u[u.length-1]===e.DOT&&(_[u.length-1]=e.B),"‫"===u[0]&&(_[0]=e.RLE),y=0;y<p.length;y++)v[y]=_[p[y]];return{logicalFromVisual:p,bidiLevels:v}},e.hasBidiCharacters=function(t,e){for(var i=!1,n=0;n<t.length;n++)e[n]=m(t.charAt(n)),i||1!=e[n]&&7!=e[n]&&3!=e[n]||(i=!0);return i},e.getVisualFromLogicalIdx=function(t,e){for(var i=0;i<e.logicalFromVisual.length;i++)if(e.logicalFromVisual[i]==t)return i;return 0}})),ace.define("ace/bidihandler",["require","exports","module","ace/lib/bidiutil","ace/lib/lang"],(function(t,e,i){"use strict";var n=t("./lib/bidiutil"),s=t("./lib/lang"),o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\u202B]/,r=function(){function t(t){this.session=t,this.bidiMap={},this.currentRow=null,this.bidiUtil=n,this.charWidths=[],this.EOL="¬",this.showInvisibles=!0,this.isRtlDir=!1,this.$isRtl=!1,this.line="",this.wrapIndent=0,this.EOF="¶",this.RLE="‫",this.contentWidth=0,this.fontMetrics=null,this.rtlLineOffset=0,this.wrapOffset=0,this.isMoveLeftOperation=!1,this.seenBidi=o.test(t.getValue())}return t.prototype.isBidiRow=function(t,e,i){return!!this.seenBidi&&(t!==this.currentRow&&(this.currentRow=t,this.updateRowLine(e,i),this.updateBidiMap()),this.bidiMap.bidiLevels)},t.prototype.onChange=function(t){this.seenBidi?this.currentRow=null:"insert"==t.action&&o.test(t.lines.join("\n"))&&(this.seenBidi=!0,this.currentRow=null)},t.prototype.getDocumentRow=function(){var t=0,e=this.session.$screenRowCache;if(e.length){var i=this.session.$getRowCacheIndex(e,this.currentRow);i>=0&&(t=this.session.$docRowCache[i])}return t},t.prototype.getSplitIndex=function(){var t=0,e=this.session.$screenRowCache;if(e.length)for(var i,n=this.session.$getRowCacheIndex(e,this.currentRow);this.currentRow-t>0&&(i=this.session.$getRowCacheIndex(e,this.currentRow-t-1))===n;)n=i,t++;else t=this.currentRow;return t},t.prototype.updateRowLine=function(t,e){void 0===t&&(t=this.getDocumentRow());var i=t===this.session.getLength()-1?this.EOF:this.EOL;if(this.wrapIndent=0,this.line=this.session.getLine(t),this.isRtlDir=this.$isRtl||this.line.charAt(0)===this.RLE,this.session.$useWrapMode){var o=this.session.$wrapData[t];o&&(void 0===e&&(e=this.getSplitIndex()),e>0&&o.length?(this.wrapIndent=o.indent,this.wrapOffset=this.wrapIndent*this.charWidths[n.L],this.line=e<o.length?this.line.substring(o[e-1],o[e]):this.line.substring(o[o.length-1])):this.line=this.line.substring(0,o[e]),e==o.length&&(this.line+=this.showInvisibles?i:n.DOT))}else this.line+=this.showInvisibles?i:n.DOT;var r,a=this.session,l=0;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,(function(t,e){return"\t"===t||a.isFullWidth(t.charCodeAt(0))?(r="\t"===t?a.getScreenTabSize(e+l):2,l+=r-1,s.stringRepeat(n.DOT,r)):t})),this.isRtlDir&&(this.fontMetrics.$main.textContent=this.line.charAt(this.line.length-1)==n.DOT?this.line.substr(0,this.line.length-1):this.line,this.rtlLineOffset=this.contentWidth-this.fontMetrics.$main.getBoundingClientRect().width)},t.prototype.updateBidiMap=function(){var t=[];n.hasBidiCharacters(this.line,t)||this.isRtlDir?this.bidiMap=n.doBidiReorder(this.line,t,this.isRtlDir):this.bidiMap={}},t.prototype.markAsDirty=function(){this.currentRow=null},t.prototype.updateCharacterWidths=function(t){if(this.characterWidth!==t.$characterSize.width){this.fontMetrics=t;var e=this.characterWidth=t.$characterSize.width,i=t.$measureCharWidth("ה");this.charWidths[n.L]=this.charWidths[n.EN]=this.charWidths[n.ON_R]=e,this.charWidths[n.R]=this.charWidths[n.AN]=i,this.charWidths[n.R_H]=.45*i,this.charWidths[n.B]=this.charWidths[n.RLE]=0,this.currentRow=null}},t.prototype.setShowInvisibles=function(t){this.showInvisibles=t,this.currentRow=null},t.prototype.setEolChar=function(t){this.EOL=t},t.prototype.setContentWidth=function(t){this.contentWidth=t},t.prototype.isRtlLine=function(t){return!!this.$isRtl||(null!=t?this.session.getLine(t).charAt(0)==this.RLE:this.isRtlDir)},t.prototype.setRtlDirection=function(t,e){for(var i=t.getCursorPosition(),n=t.selection.getSelectionAnchor().row;n<=i.row;n++)e||t.session.getLine(n).charAt(0)!==t.session.$bidiHandler.RLE?e&&t.session.getLine(n).charAt(0)!==t.session.$bidiHandler.RLE&&t.session.doc.insert({column:0,row:n},t.session.$bidiHandler.RLE):t.session.doc.removeInLine(n,0,1)},t.prototype.getPosLeft=function(t){t-=this.wrapIndent;var e=this.line.charAt(0)===this.RLE?1:0,i=t>e?this.session.getOverwrite()?t:t-1:e,s=n.getVisualFromLogicalIdx(i,this.bidiMap),o=this.bidiMap.bidiLevels,r=0;!this.session.getOverwrite()&&t<=e&&o[s]%2!=0&&s++;for(var a=0;a<s;a++)r+=this.charWidths[o[a]];return!this.session.getOverwrite()&&t>e&&o[s]%2==0&&(r+=this.charWidths[o[s]]),this.wrapIndent&&(r+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset),this.isRtlDir&&(r+=this.rtlLineOffset),r},t.prototype.getSelections=function(t,e){var i,n=this.bidiMap,s=n.bidiLevels,o=[],r=0,a=Math.min(t,e)-this.wrapIndent,l=Math.max(t,e)-this.wrapIndent,h=!1,c=!1,d=0;this.wrapIndent&&(r+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);for(var u,p=0;p<s.length;p++)u=n.logicalFromVisual[p],i=s[p],(h=u>=a&&u<l)&&!c?d=r:!h&&c&&o.push({left:d,width:r-d}),r+=this.charWidths[i],c=h;if(h&&p===s.length&&o.push({left:d,width:r-d}),this.isRtlDir)for(var g=0;g<o.length;g++)o[g].left+=this.rtlLineOffset;return o},t.prototype.offsetToCol=function(t){this.isRtlDir&&(t-=this.rtlLineOffset);var e=0,i=(t=Math.max(t,0),0),n=0,s=this.bidiMap.bidiLevels,o=this.charWidths[s[n]];for(this.wrapIndent&&(t-=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);t>i+o/2;){if(i+=o,n===s.length-1){o=0;break}o=this.charWidths[s[++n]]}return n>0&&s[n-1]%2!=0&&s[n]%2==0?(t<i&&n--,e=this.bidiMap.logicalFromVisual[n]):n>0&&s[n-1]%2==0&&s[n]%2!=0?e=1+(t>i?this.bidiMap.logicalFromVisual[n]:this.bidiMap.logicalFromVisual[n-1]):this.isRtlDir&&n===s.length-1&&0===o&&s[n-1]%2==0||!this.isRtlDir&&0===n&&s[n]%2!=0?e=1+this.bidiMap.logicalFromVisual[n]:(n>0&&s[n-1]%2!=0&&0!==o&&n--,e=this.bidiMap.logicalFromVisual[n]),0===e&&this.isRtlDir&&e++,e+this.wrapIndent},t}();e.BidiHandler=r})),ace.define("ace/selection",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/range"],(function(t,e,i){"use strict";var n=t("./lib/oop"),s=t("./lib/lang"),o=t("./lib/event_emitter").EventEmitter,r=t("./range").Range,a=function(){function t(t){this.session=t,this.doc=t.getDocument(),this.clearSelection(),this.cursor=this.lead=this.doc.createAnchor(0,0),this.anchor=this.doc.createAnchor(0,0),this.$silent=!1;var e=this;this.cursor.on("change",(function(t){e.$cursorChanged=!0,e.$silent||e._emit("changeCursor"),e.$isEmpty||e.$silent||e._emit("changeSelection"),e.$keepDesiredColumnOnChange||t.old.column==t.value.column||(e.$desiredColumn=null)})),this.anchor.on("change",(function(){e.$anchorChanged=!0,e.$isEmpty||e.$silent||e._emit("changeSelection")}))}return t.prototype.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},t.prototype.isMultiLine=function(){return!this.$isEmpty&&this.anchor.row!=this.cursor.row},t.prototype.getCursor=function(){return this.lead.getPosition()},t.prototype.setAnchor=function(t,e){this.$isEmpty=!1,this.anchor.setPosition(t,e)},t.prototype.getAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},t.prototype.getSelectionLead=function(){return this.lead.getPosition()},t.prototype.isBackwards=function(){var t=this.anchor,e=this.lead;return t.row>e.row||t.row==e.row&&t.column>e.column},t.prototype.getRange=function(){var t=this.anchor,e=this.lead;return this.$isEmpty?r.fromPoints(e,e):this.isBackwards()?r.fromPoints(e,t):r.fromPoints(t,e)},t.prototype.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},t.prototype.selectAll=function(){this.$setSelection(0,0,Number.MAX_VALUE,Number.MAX_VALUE)},t.prototype.setRange=function(t,e){var i=e?t.end:t.start,n=e?t.start:t.end;this.$setSelection(i.row,i.column,n.row,n.column)},t.prototype.$setSelection=function(t,e,i,n){if(!this.$silent){var s=this.$isEmpty,o=this.inMultiSelectMode;this.$silent=!0,this.$cursorChanged=this.$anchorChanged=!1,this.anchor.setPosition(t,e),this.cursor.setPosition(i,n),this.$isEmpty=!r.comparePoints(this.anchor,this.cursor),this.$silent=!1,this.$cursorChanged&&this._emit("changeCursor"),(this.$cursorChanged||this.$anchorChanged||s!=this.$isEmpty||o)&&this._emit("changeSelection")}},t.prototype.$moveSelection=function(t){var e=this.lead;this.$isEmpty&&this.setSelectionAnchor(e.row,e.column),t.call(this)},t.prototype.selectTo=function(t,e){this.$moveSelection((function(){this.moveCursorTo(t,e)}))},t.prototype.selectToPosition=function(t){this.$moveSelection((function(){this.moveCursorToPosition(t)}))},t.prototype.moveTo=function(t,e){this.clearSelection(),this.moveCursorTo(t,e)},t.prototype.moveToPosition=function(t){this.clearSelection(),this.moveCursorToPosition(t)},t.prototype.selectUp=function(){this.$moveSelection(this.moveCursorUp)},t.prototype.selectDown=function(){this.$moveSelection(this.moveCursorDown)},t.prototype.selectRight=function(){this.$moveSelection(this.moveCursorRight)},t.prototype.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},t.prototype.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},t.prototype.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},t.prototype.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},t.prototype.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},t.prototype.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},t.prototype.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},t.prototype.getWordRange=function(t,e){if(void 0===e){var i=t||this.lead;t=i.row,e=i.column}return this.session.getWordRange(t,e)},t.prototype.selectWord=function(){this.setSelectionRange(this.getWordRange())},t.prototype.selectAWord=function(){var t=this.getCursor(),e=this.session.getAWordRange(t.row,t.column);this.setSelectionRange(e)},t.prototype.getLineRange=function(t,e){var i,n="number"==typeof t?t:this.lead.row,s=this.session.getFoldLine(n);return s?(n=s.start.row,i=s.end.row):i=n,!0===e?new r(n,0,i,this.session.getLine(i).length):new r(n,0,i+1,0)},t.prototype.selectLine=function(){this.setSelectionRange(this.getLineRange())},t.prototype.moveCursorUp=function(){this.moveCursorBy(-1,0)},t.prototype.moveCursorDown=function(){this.moveCursorBy(1,0)},t.prototype.wouldMoveIntoSoftTab=function(t,e,i){var n=t.column,s=t.column+e;return i<0&&(n=t.column-e,s=t.column),this.session.isTabStop(t)&&this.doc.getLine(t.row).slice(n,s).split(" ").length-1==e},t.prototype.moveCursorLeft=function(){var t,e=this.lead.getPosition();if(t=this.session.getFoldAt(e.row,e.column,-1))this.moveCursorTo(t.start.row,t.start.column);else if(0===e.column)e.row>0&&this.moveCursorTo(e.row-1,this.doc.getLine(e.row-1).length);else{var i=this.session.getTabSize();this.wouldMoveIntoSoftTab(e,i,-1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,-i):this.moveCursorBy(0,-1)}},t.prototype.moveCursorRight=function(){var t,e=this.lead.getPosition();if(t=this.session.getFoldAt(e.row,e.column,1))this.moveCursorTo(t.end.row,t.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var i=this.session.getTabSize();e=this.lead,this.wouldMoveIntoSoftTab(e,i,1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,i):this.moveCursorBy(0,1)}},t.prototype.moveCursorLineStart=function(){var t=this.lead.row,e=this.lead.column,i=this.session.documentToScreenRow(t,e),n=this.session.screenToDocumentPosition(i,0),s=this.session.getDisplayLine(t,null,n.row,n.column).match(/^\s*/);s[0].length==e||this.session.$useEmacsStyleLineStart||(n.column+=s[0].length),this.moveCursorToPosition(n)},t.prototype.moveCursorLineEnd=function(){var t=this.lead,e=this.session.getDocumentLastRowColumnPosition(t.row,t.column);if(this.lead.column==e.column){var i=this.session.getLine(e.row);if(e.column==i.length){var n=i.search(/\s+$/);n>0&&(e.column=n)}}this.moveCursorTo(e.row,e.column)},t.prototype.moveCursorFileEnd=function(){var t=this.doc.getLength()-1,e=this.doc.getLine(t).length;this.moveCursorTo(t,e)},t.prototype.moveCursorFileStart=function(){this.moveCursorTo(0,0)},t.prototype.moveCursorLongWordRight=function(){var t=this.lead.row,e=this.lead.column,i=this.doc.getLine(t),n=i.substring(e);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var s=this.session.getFoldAt(t,e,1);if(s)this.moveCursorTo(s.end.row,s.end.column);else{if(this.session.nonTokenRe.exec(n)&&(e+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,n=i.substring(e)),e>=i.length)return this.moveCursorTo(t,i.length),this.moveCursorRight(),void(t<this.doc.getLength()-1&&this.moveCursorWordRight());this.session.tokenRe.exec(n)&&(e+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(t,e)}},t.prototype.moveCursorLongWordLeft=function(){var t,e=this.lead.row,i=this.lead.column;if(t=this.session.getFoldAt(e,i,-1))this.moveCursorTo(t.start.row,t.start.column);else{var n=this.session.getFoldStringAt(e,i,-1);null==n&&(n=this.doc.getLine(e).substring(0,i));var o=s.stringReverse(n);if(this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(o)&&(i-=this.session.nonTokenRe.lastIndex,o=o.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),i<=0)return this.moveCursorTo(e,0),this.moveCursorLeft(),void(e>0&&this.moveCursorWordLeft());this.session.tokenRe.exec(o)&&(i-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(e,i)}},t.prototype.$shortWordEndIndex=function(t){var e,i=0,n=/\s/,s=this.session.tokenRe;if(s.lastIndex=0,this.session.tokenRe.exec(t))i=this.session.tokenRe.lastIndex;else{for(;(e=t[i])&&n.test(e);)i++;if(i<1)for(s.lastIndex=0;(e=t[i])&&!s.test(e);)if(s.lastIndex=0,i++,n.test(e)){if(i>2){i--;break}for(;(e=t[i])&&n.test(e);)i++;if(i>2)break}}return s.lastIndex=0,i},t.prototype.moveCursorShortWordRight=function(){var t=this.lead.row,e=this.lead.column,i=this.doc.getLine(t),n=i.substring(e),s=this.session.getFoldAt(t,e,1);if(s)return this.moveCursorTo(s.end.row,s.end.column);if(e==i.length){var o=this.doc.getLength();do{t++,n=this.doc.getLine(t)}while(t<o&&/^\s*$/.test(n));/^\s+/.test(n)||(n=""),e=0}var r=this.$shortWordEndIndex(n);this.moveCursorTo(t,e+r)},t.prototype.moveCursorShortWordLeft=function(){var t,e=this.lead.row,i=this.lead.column;if(t=this.session.getFoldAt(e,i,-1))return this.moveCursorTo(t.start.row,t.start.column);var n=this.session.getLine(e).substring(0,i);if(0===i){do{e--,n=this.doc.getLine(e)}while(e>0&&/^\s*$/.test(n));i=n.length,/\s+$/.test(n)||(n="")}var o=s.stringReverse(n),r=this.$shortWordEndIndex(o);return this.moveCursorTo(e,i-r)},t.prototype.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},t.prototype.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},t.prototype.moveCursorBy=function(t,e){var i,n=this.session.documentToScreenPosition(this.lead.row,this.lead.column);if(0===e&&(0!==t&&(this.session.$bidiHandler.isBidiRow(n.row,this.lead.row)?(i=this.session.$bidiHandler.getPosLeft(n.column),n.column=Math.round(i/this.session.$bidiHandler.charWidths[0])):i=n.column*this.session.$bidiHandler.charWidths[0]),this.$desiredColumn?n.column=this.$desiredColumn:this.$desiredColumn=n.column),0!=t&&this.session.lineWidgets&&this.session.lineWidgets[this.lead.row]){var s=this.session.lineWidgets[this.lead.row];t<0?t-=s.rowsAbove||0:t>0&&(t+=s.rowCount-(s.rowsAbove||0))}var o=this.session.screenToDocumentPosition(n.row+t,n.column,i);0!==t&&0===e&&o.row===this.lead.row&&(o.column,this.lead.column),this.moveCursorTo(o.row,o.column+e,0===e)},t.prototype.moveCursorToPosition=function(t){this.moveCursorTo(t.row,t.column)},t.prototype.moveCursorTo=function(t,e,i){var n=this.session.getFoldAt(t,e,1);n&&(t=n.start.row,e=n.start.column),this.$keepDesiredColumnOnChange=!0;var s=this.session.getLine(t);/[\uDC00-\uDFFF]/.test(s.charAt(e))&&s.charAt(e-1)&&(this.lead.row==t&&this.lead.column==e+1?e-=1:e+=1),this.lead.setPosition(t,e),this.$keepDesiredColumnOnChange=!1,i||(this.$desiredColumn=null)},t.prototype.moveCursorToScreen=function(t,e,i){var n=this.session.screenToDocumentPosition(t,e);this.moveCursorTo(n.row,n.column,i)},t.prototype.detach=function(){this.lead.detach(),this.anchor.detach()},t.prototype.fromOrientedRange=function(t){this.setSelectionRange(t,t.cursor==t.start),this.$desiredColumn=t.desiredColumn||this.$desiredColumn},t.prototype.toOrientedRange=function(t){var e=this.getRange();return t?(t.start.column=e.start.column,t.start.row=e.start.row,t.end.column=e.end.column,t.end.row=e.end.row):t=e,t.cursor=this.isBackwards()?t.start:t.end,t.desiredColumn=this.$desiredColumn,t},t.prototype.getRangeOfMovements=function(t){var e=this.getCursor();try{t(this);var i=this.getCursor();return r.fromPoints(e,i)}catch(t){return r.fromPoints(e,e)}finally{this.moveCursorToPosition(e)}},t.prototype.toJSON=function(){if(this.rangeCount)var t=this.ranges.map((function(t){var e=t.clone();return e.isBackwards=t.cursor==t.start,e}));else(t=this.getRange()).isBackwards=this.isBackwards();return t},t.prototype.fromJSON=function(t){if(null==t.start){if(this.rangeList&&t.length>1){this.toSingleRange(t[0]);for(var e=t.length;e--;){var i=r.fromPoints(t[e].start,t[e].end);t[e].isBackwards&&(i.cursor=i.start),this.addRange(i,!0)}return}t=t[0]}this.rangeList&&this.toSingleRange(t),this.setSelectionRange(t,t.isBackwards)},t.prototype.isEqual=function(t){if((t.length||this.rangeCount)&&t.length!=this.rangeCount)return!1;if(!t.length||!this.ranges)return this.getRange().isEqual(t);for(var e=this.ranges.length;e--;)if(!this.ranges[e].isEqual(t[e]))return!1;return!0},t}();a.prototype.setSelectionAnchor=a.prototype.setAnchor,a.prototype.getSelectionAnchor=a.prototype.getAnchor,a.prototype.setSelectionRange=a.prototype.setRange,n.implement(a.prototype,o),e.Selection=a})),ace.define("ace/tokenizer",["require","exports","module","ace/lib/report_error"],(function(t,e,i){"use strict";var n=t("./lib/report_error").reportError,s=2e3,o=function(){function t(t){for(var e in this.splitRegex,this.states=t,this.regExps={},this.matchMappings={},this.states){for(var i=this.states[e],n=[],s=0,o=this.matchMappings[e]={defaultToken:"text"},r="g",a=[],l=0;l<i.length;l++){var h=i[l];if(h.defaultToken&&(o.defaultToken=h.defaultToken),h.caseInsensitive&&-1===r.indexOf("i")&&(r+="i"),h.unicode&&-1===r.indexOf("u")&&(r+="u"),null!=h.regex){h.regex instanceof RegExp&&(h.regex=h.regex.toString().slice(1,-1));var c=h.regex,d=new RegExp("(?:("+c+")|(.))").exec("a").length-2;Array.isArray(h.token)?1==h.token.length||1==d?h.token=h.token[0]:d-1!=h.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:h,groupCount:d-1}),h.token=h.token[0]):(h.tokenArray=h.token,h.token=null,h.onMatch=this.$arrayTokens):"function"!=typeof h.token||h.onMatch||(h.onMatch=d>1?this.$applyToken:h.token),d>1&&(/\\\d/.test(h.regex)?c=h.regex.replace(/\\([0-9]+)/g,(function(t,e){return"\\"+(parseInt(e,10)+s+1)})):(d=1,c=this.removeCapturingGroups(h.regex)),h.splitRegex||"string"==typeof h.token||a.push(h)),o[s]=l,s+=d,n.push(c),h.onMatch||(h.onMatch=null)}}n.length||(o[0]=0,n.push("$")),a.forEach((function(t){t.splitRegex=this.createSplitterRegexp(t.regex,r)}),this),this.regExps[e]=new RegExp("("+n.join(")|(")+")|($)",r)}}return t.prototype.$setMaxTokenCount=function(t){s=0|t},t.prototype.$applyToken=function(t){var e=this.splitRegex.exec(t).slice(1),i=this.token.apply(this,e);if("string"==typeof i)return[{type:i,value:t}];for(var n=[],s=0,o=i.length;s<o;s++)e[s]&&(n[n.length]={type:i[s],value:e[s]});return n},t.prototype.$arrayTokens=function(t){if(!t)return[];var e=this.splitRegex.exec(t);if(!e)return"text";for(var i=[],n=this.tokenArray,s=0,o=n.length;s<o;s++)e[s+1]&&(i[i.length]={type:n[s],value:e[s+1]});return i},t.prototype.removeCapturingGroups=function(t){return t.replace(/\\.|\[(?:\\.|[^\\\]])*|\(\?[:=!<]|(\()/g,(function(t,e){return e?"(?:":t}))},t.prototype.createSplitterRegexp=function(t,e){if(-1!=t.indexOf("(?=")){var i=0,n=!1,s={};t.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,(function(t,e,o,r,a,l){return n?n="]"!=a:a?n=!0:r?(i==s.stack&&(s.end=l+1,s.stack=-1),i--):o&&(i++,1!=o.length&&(s.stack=i,s.start=l)),t})),null!=s.end&&/^\)*$/.test(t.substr(s.end))&&(t=t.substring(0,s.start)+t.substr(s.end))}return"^"!=t.charAt(0)&&(t="^"+t),"$"!=t.charAt(t.length-1)&&(t+="$"),new RegExp(t,(e||"").replace("g",""))},t.prototype.getLineTokens=function(t,e){if(e&&"string"!=typeof e){var i=e.slice(0);"#tmp"===(e=i[0])&&(i.shift(),e=i.shift())}else i=[];var n=e||"start",o=this.states[n];o||(n="start",o=this.states[n]);var r=this.matchMappings[n],a=this.regExps[n];a.lastIndex=0;for(var l,h=[],c=0,d=0,u={type:null,value:""};l=a.exec(t);){var p=r.defaultToken,g=null,f=l[0],m=a.lastIndex;if(m-f.length>c){var v=t.substring(c,m-f.length);u.type==p?u.value+=v:(u.type&&h.push(u),u={type:p,value:v})}for(var _=0;_<l.length-2;_++)if(void 0!==l[_+1]){p=(g=o[r[_]]).onMatch?g.onMatch(f,n,i,t):g.token,g.next&&(n="string"==typeof g.next?g.next:g.next(n,i),(o=this.states[n])||(this.reportError("state doesn't exist",n),n="start",o=this.states[n]),r=this.matchMappings[n],c=m,(a=this.regExps[n]).lastIndex=m),g.consumeLineEnd&&(c=m);break}if(f)if("string"==typeof p)g&&!1===g.merge||u.type!==p?(u.type&&h.push(u),u={type:p,value:f}):u.value+=f;else if(p)for(u.type&&h.push(u),u={type:null,value:""},_=0;_<p.length;_++)h.push(p[_]);if(c==t.length)break;if(c=m,d++>s){for(d>2*t.length&&this.reportError("infinite loop with in ace tokenizer",{startState:e,line:t});c<t.length;)u.type&&h.push(u),u={value:t.substring(c,c+=500),type:"overflow"};n="start",i=[];break}}return u.type&&h.push(u),i.length>1&&i[0]!==n&&i.unshift("#tmp",n),{tokens:h,state:i.length?i:n}},t}();o.prototype.reportError=n,e.Tokenizer=o})),ace.define("ace/mode/text_highlight_rules",["require","exports","module","ace/lib/deep_copy"],(function(t,e,i){"use strict";var n,s=t("../lib/deep_copy").deepCopy;(function(){this.addRules=function(t,e){if(e)for(var i in t){for(var n=t[i],s=0;s<n.length;s++){var o=n[s];(o.next||o.onMatch)&&("string"==typeof o.next&&0!==o.next.indexOf(e)&&(o.next=e+o.next),o.nextState&&0!==o.nextState.indexOf(e)&&(o.nextState=e+o.nextState))}this.$rules[e+i]=n}else for(var i in t)this.$rules[i]=t[i]},this.getRules=function(){return this.$rules},this.embedRules=function(t,e,i,n,o){var r="function"==typeof t?(new t).getRules():t;if(n)for(var a=0;a<n.length;a++)n[a]=e+n[a];else for(var l in n=[],r)n.push(e+l);if(this.addRules(r,e),i){var h=Array.prototype[o?"push":"unshift"];for(a=0;a<n.length;a++)h.apply(this.$rules[n[a]],s(i))}this.$embeds||(this.$embeds=[]),this.$embeds.push(e)},this.getEmbeds=function(){return this.$embeds};var t=function(t,e){return("start"!=t||e.length)&&e.unshift(this.nextState,t),this.nextState},e=function(t,e){return e.shift(),e.shift()||"start"};this.normalizeRules=function(){var i=0,n=this.$rules;Object.keys(n).forEach((function s(o){var r=n[o];r.processed=!0;for(var a=0;a<r.length;a++){var l=r[a],h=null;Array.isArray(l)&&(h=l,l={}),!l.regex&&l.start&&(l.regex=l.start,l.next||(l.next=[]),l.next.push({defaultToken:l.token},{token:l.token+".end",regex:l.end||l.start,next:"pop"}),l.token=l.token+".start",l.push=!0);var c=l.next||l.push;if(c&&Array.isArray(c)){var d=l.stateName;d||("string"!=typeof(d=l.token)&&(d=d[0]||""),n[d]&&(d+=i++)),n[d]=c,l.next=d,s(d)}else"pop"==c&&(l.next=e);if(l.push&&(l.nextState=l.next||l.push,l.next=t,delete l.push),l.rules)for(var u in l.rules)n[u]?n[u].push&&n[u].push.apply(n[u],l.rules[u]):n[u]=l.rules[u];var p="string"==typeof l?l:l.include;if(p&&("$self"===p&&(p="start"),h=Array.isArray(p)?p.map((function(t){return n[t]})):n[p]),h){var g=[a,1].concat(h);l.noEscape&&(g=g.filter((function(t){return!t.next}))),r.splice.apply(r,g),a--}l.keywordMap&&(l.token=this.createKeywordMapper(l.keywordMap,l.defaultToken||"text",l.caseInsensitive),delete l.defaultToken)}}),this)},this.createKeywordMapper=function(t,e,i,n){var s=Object.create(null);return this.$keywordList=[],Object.keys(t).forEach((function(e){for(var o=t[e].split(n||"|"),r=o.length;r--;){var a=o[r];this.$keywordList.push(a),i&&(a=a.toLowerCase()),s[a]=e}}),this),t=null,i?function(t){return s[t.toLowerCase()]||e}:function(t){return s[t]||e}},this.getKeywords=function(){return this.$keywords}}).call((n=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}}).prototype),e.TextHighlightRules=n})),ace.define("ace/mode/behaviour",["require","exports","module"],(function(t,e,i){"use strict";var n;(function(){this.add=function(t,e,i){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[t]:this.$behaviours[t]={}}this.$behaviours[t][e]=i},this.addBehaviours=function(t){for(var e in t)for(var i in t[e])this.add(e,i,t[e][i])},this.remove=function(t){this.$behaviours&&this.$behaviours[t]&&delete this.$behaviours[t]},this.inherit=function(t,e){if("function"==typeof t)var i=(new t).getBehaviours(e);else i=t.getBehaviours(e);this.addBehaviours(i)},this.getBehaviours=function(t){if(t){for(var e={},i=0;i<t.length;i++)this.$behaviours[t[i]]&&(e[t[i]]=this.$behaviours[t[i]]);return e}return this.$behaviours}}).call((n=function(){this.$behaviours={}}).prototype),e.Behaviour=n})),ace.define("ace/token_iterator",["require","exports","module","ace/range"],(function(t,e,i){"use strict";var n=t("./range").Range,s=function(){function t(t,e,i){this.$session=t,this.$row=e,this.$rowTokens=t.getTokens(e);var n=t.getTokenAt(e,i);this.$tokenIndex=n?n.index:-1}return t.prototype.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},t.prototype.stepForward=function(){var t;for(this.$tokenIndex+=1;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,t||(t=this.$session.getLength()),this.$row>=t)return this.$row=t-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},t.prototype.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},t.prototype.getCurrentTokenRow=function(){return this.$row},t.prototype.getCurrentTokenColumn=function(){var t=this.$rowTokens,e=this.$tokenIndex,i=t[e].start;if(void 0!==i)return i;for(i=0;e>0;)i+=t[e-=1].value.length;return i},t.prototype.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()}},t.prototype.getCurrentTokenRange=function(){var t=this.$rowTokens[this.$tokenIndex],e=this.getCurrentTokenColumn();return new n(this.$row,e,this.$row,e+t.value.length)},t}();e.TokenIterator=s})),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],(function(t,e,i){"use strict";var n,s,o=t("../../lib/oop"),r=t("../behaviour").Behaviour,a=t("../../token_iterator").TokenIterator,l=t("../../lib/lang"),h=["text","paren.rparen","rparen","paren","punctuation.operator"],c=["text","paren.rparen","rparen","paren","punctuation.operator","comment"],d={},u={'"':'"',"'":"'"},p=function(t){var e=-1;if(t.multiSelect&&(e=t.selection.index,d.rangeCount!=t.multiSelect.rangeCount&&(d={rangeCount:t.multiSelect.rangeCount})),d[e])return n=d[e];n=d[e]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""}},g=function(t,e,i,n){var s=t.end.row-t.start.row;return{text:i+e+n,selection:[0,t.start.column+1,s,t.end.column+(s?0:1)]}};(s=function(t){t=t||{},this.add("braces","insertion",(function(e,i,o,r,a){var h=o.getCursorPosition(),c=r.doc.getLine(h.row);if("{"==a){p(o);var d=o.getSelectionRange(),u=r.doc.getTextRange(d),f=r.getTokenAt(h.row,h.column);if(""!==u&&"{"!==u&&o.getWrapBehavioursEnabled())return g(d,u,"{","}");if(f&&/(?:string)\.quasi|\.xml/.test(f.type)){if([/tag\-(?:open|name)/,/attribute\-name/].some((function(t){return t.test(f.type)}))||/(string)\.quasi/.test(f.type)&&"$"!==f.value[h.column-f.start-1])return;return s.recordAutoInsert(o,r,"}"),{text:"{}",selection:[1,1]}}if(s.isSaneInsertion(o,r))return/[\]\}\)]/.test(c[h.column])||o.inMultiSelectMode||t.braces?(s.recordAutoInsert(o,r,"}"),{text:"{}",selection:[1,1]}):(s.recordMaybeInsert(o,r,"{"),{text:"{",selection:[1,1]})}else if("}"==a){if(p(o),"}"==c.substring(h.column,h.column+1)&&null!==r.$findOpeningBracket("}",{column:h.column+1,row:h.row})&&s.isAutoInsertedClosing(h,c,a))return s.popAutoInsertedClosing(),{text:"",selection:[1,1]}}else{if("\n"==a||"\r\n"==a){p(o);var m="";if(s.isMaybeInsertedClosing(h,c)&&(m=l.stringRepeat("}",n.maybeInsertedBrackets),s.clearMaybeInsertedClosing()),"}"===c.substring(h.column,h.column+1)){var v=r.findMatchingBracket({row:h.row,column:h.column+1},"}");if(!v)return null;var _=this.$getIndent(r.getLine(v.row))}else{if(!m)return void s.clearMaybeInsertedClosing();_=this.$getIndent(c)}var y=_+r.getTabString();return{text:"\n"+y+"\n"+_+m,selection:[1,y.length,1,y.length]}}s.clearMaybeInsertedClosing()}})),this.add("braces","deletion",(function(t,e,i,s,o){var r=s.doc.getTextRange(o);if(!o.isMultiLine()&&"{"==r){if(p(i),"}"==s.doc.getLine(o.start.row).substring(o.end.column,o.end.column+1))return o.end.column++,o;n.maybeInsertedBrackets--}})),this.add("parens","insertion",(function(t,e,i,n,o){if("("==o){p(i);var r=i.getSelectionRange(),a=n.doc.getTextRange(r);if(""!==a&&i.getWrapBehavioursEnabled())return g(r,a,"(",")");if(s.isSaneInsertion(i,n))return s.recordAutoInsert(i,n,")"),{text:"()",selection:[1,1]}}else if(")"==o){p(i);var l=i.getCursorPosition(),h=n.doc.getLine(l.row);if(")"==h.substring(l.column,l.column+1)&&null!==n.$findOpeningBracket(")",{column:l.column+1,row:l.row})&&s.isAutoInsertedClosing(l,h,o))return s.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("parens","deletion",(function(t,e,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"("==o&&(p(i),")"==n.doc.getLine(s.start.row).substring(s.start.column+1,s.start.column+2)))return s.end.column++,s})),this.add("brackets","insertion",(function(t,e,i,n,o){if("["==o){p(i);var r=i.getSelectionRange(),a=n.doc.getTextRange(r);if(""!==a&&i.getWrapBehavioursEnabled())return g(r,a,"[","]");if(s.isSaneInsertion(i,n))return s.recordAutoInsert(i,n,"]"),{text:"[]",selection:[1,1]}}else if("]"==o){p(i);var l=i.getCursorPosition(),h=n.doc.getLine(l.row);if("]"==h.substring(l.column,l.column+1)&&null!==n.$findOpeningBracket("]",{column:l.column+1,row:l.row})&&s.isAutoInsertedClosing(l,h,o))return s.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("brackets","deletion",(function(t,e,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"["==o&&(p(i),"]"==n.doc.getLine(s.start.row).substring(s.start.column+1,s.start.column+2)))return s.end.column++,s})),this.add("string_dquotes","insertion",(function(t,e,i,n,s){var o=n.$mode.$quotes||u;if(1==s.length&&o[s]){if(this.lineCommentStart&&-1!=this.lineCommentStart.indexOf(s))return;p(i);var r=s,a=i.getSelectionRange(),l=n.doc.getTextRange(a);if(!(""===l||1==l.length&&o[l])&&i.getWrapBehavioursEnabled())return g(a,l,r,r);if(!l){var h=i.getCursorPosition(),c=n.doc.getLine(h.row),d=c.substring(h.column-1,h.column),f=c.substring(h.column,h.column+1),m=n.getTokenAt(h.row,h.column),v=n.getTokenAt(h.row,h.column+1);if("\\"==d&&m&&/escape/.test(m.type))return null;var _,y=m&&/string|escape/.test(m.type),w=!v||/string|escape/.test(v.type);if(f==r)(_=y!==w)&&/string\.end/.test(v.type)&&(_=!1);else{if(y&&!w)return null;if(y&&w)return null;var x=n.$mode.tokenRe;x.lastIndex=0;var b=x.test(d);x.lastIndex=0;var C=x.test(f),A=n.$mode.$pairQuotesAfter;if(!(A&&A[r]&&A[r].test(d))&&b||C)return null;if(f&&!/[\s;,.})\]\\]/.test(f))return null;var S=c[h.column-2];if(d==r&&(S==r||x.test(S)))return null;_=!0}return{text:_?r+r:"",selection:[1,1]}}}})),this.add("string_dquotes","deletion",(function(t,e,i,n,s){var o=n.$mode.$quotes||u,r=n.doc.getTextRange(s);if(!s.isMultiLine()&&o.hasOwnProperty(r)&&(p(i),n.doc.getLine(s.start.row).substring(s.start.column+1,s.start.column+2)==r))return s.end.column++,s})),!1!==t.closeDocComment&&this.add("doc comment end","insertion",(function(t,e,i,n,s){if("doc-start"===t&&("\n"===s||"\r\n"===s)&&i.selection.isEmpty()){var o=i.getCursorPosition();if(0===o.column)return;for(var r=n.doc.getLine(o.row),a=n.doc.getLine(o.row+1),l=n.getTokens(o.row),h=0,c=0;c<l.length;c++){h+=l[c].value.length;var d=l[c];if(h>=o.column){if(h===o.column){if(!/\.doc/.test(d.type))return;if(/\*\//.test(d.value)){var u=l[c+1];if(!u||!/\.doc/.test(u.type))return}}var p=o.column-(h-d.value.length),g=d.value.indexOf("*/"),f=d.value.indexOf("/**",g>-1?g+2:0);if(-1!==f&&p>f&&p<f+3)return;if(-1!==g&&-1!==f&&p>=g&&p<=f||!/\.doc/.test(d.type))return;break}}var m=this.$getIndent(r);if(/\s*\*/.test(a))return/^\s*\*/.test(r)?{text:s+m+"* ",selection:[1,2+m.length,1,2+m.length]}:{text:s+m+" * ",selection:[1,3+m.length,1,3+m.length]};if(/\/\*\*/.test(r.substring(0,o.column)))return{text:s+m+" * "+s+" "+m+"*/",selection:[1,4+m.length,1,4+m.length]}}}))}).isSaneInsertion=function(t,e){var i=t.getCursorPosition(),n=new a(e,i.row,i.column);if(!this.$matchTokenType(n.getCurrentToken()||"text",h)){if(/[)}\]]/.test(t.session.getLine(i.row)[i.column]))return!0;var s=new a(e,i.row,i.column+1);if(!this.$matchTokenType(s.getCurrentToken()||"text",h))return!1}return n.stepForward(),n.getCurrentTokenRow()!==i.row||this.$matchTokenType(n.getCurrentToken()||"text",c)},s.$matchTokenType=function(t,e){return e.indexOf(t.type||t)>-1},s.recordAutoInsert=function(t,e,i){var s=t.getCursorPosition(),o=e.doc.getLine(s.row);this.isAutoInsertedClosing(s,o,n.autoInsertedLineEnd[0])||(n.autoInsertedBrackets=0),n.autoInsertedRow=s.row,n.autoInsertedLineEnd=i+o.substr(s.column),n.autoInsertedBrackets++},s.recordMaybeInsert=function(t,e,i){var s=t.getCursorPosition(),o=e.doc.getLine(s.row);this.isMaybeInsertedClosing(s,o)||(n.maybeInsertedBrackets=0),n.maybeInsertedRow=s.row,n.maybeInsertedLineStart=o.substr(0,s.column)+i,n.maybeInsertedLineEnd=o.substr(s.column),n.maybeInsertedBrackets++},s.isAutoInsertedClosing=function(t,e,i){return n.autoInsertedBrackets>0&&t.row===n.autoInsertedRow&&i===n.autoInsertedLineEnd[0]&&e.substr(t.column)===n.autoInsertedLineEnd},s.isMaybeInsertedClosing=function(t,e){return n.maybeInsertedBrackets>0&&t.row===n.maybeInsertedRow&&e.substr(t.column)===n.maybeInsertedLineEnd&&e.substr(0,t.column)==n.maybeInsertedLineStart},s.popAutoInsertedClosing=function(){n.autoInsertedLineEnd=n.autoInsertedLineEnd.substr(1),n.autoInsertedBrackets--},s.clearMaybeInsertedClosing=function(){n&&(n.maybeInsertedBrackets=0,n.maybeInsertedRow=-1)},o.inherits(s,r),e.CstyleBehaviour=s})),ace.define("ace/unicode",["require","exports","module"],(function(t,e,i){"use strict";for(var n=[48,9,8,25,5,0,2,25,48,0,11,0,5,0,6,22,2,30,2,457,5,11,15,4,8,0,2,0,18,116,2,1,3,3,9,0,2,2,2,0,2,19,2,82,2,138,2,4,3,155,12,37,3,0,8,38,10,44,2,0,2,1,2,1,2,0,9,26,6,2,30,10,7,61,2,9,5,101,2,7,3,9,2,18,3,0,17,58,3,100,15,53,5,0,6,45,211,57,3,18,2,5,3,11,3,9,2,1,7,6,2,2,2,7,3,1,3,21,2,6,2,0,4,3,3,8,3,1,3,3,9,0,5,1,2,4,3,11,16,2,2,5,5,1,3,21,2,6,2,1,2,1,2,1,3,0,2,4,5,1,3,2,4,0,8,3,2,0,8,15,12,2,2,8,2,2,2,21,2,6,2,1,2,4,3,9,2,2,2,2,3,0,16,3,3,9,18,2,2,7,3,1,3,21,2,6,2,1,2,4,3,8,3,1,3,2,9,1,5,1,2,4,3,9,2,0,17,1,2,5,4,2,2,3,4,1,2,0,2,1,4,1,4,2,4,11,5,4,4,2,2,3,3,0,7,0,15,9,18,2,2,7,2,2,2,22,2,9,2,4,4,7,2,2,2,3,8,1,2,1,7,3,3,9,19,1,2,7,2,2,2,22,2,9,2,4,3,8,2,2,2,3,8,1,8,0,2,3,3,9,19,1,2,7,2,2,2,22,2,15,4,7,2,2,2,3,10,0,9,3,3,9,11,5,3,1,2,17,4,23,2,8,2,0,3,6,4,0,5,5,2,0,2,7,19,1,14,57,6,14,2,9,40,1,2,0,3,1,2,0,3,0,7,3,2,6,2,2,2,0,2,0,3,1,2,12,2,2,3,4,2,0,2,5,3,9,3,1,35,0,24,1,7,9,12,0,2,0,2,0,5,9,2,35,5,19,2,5,5,7,2,35,10,0,58,73,7,77,3,37,11,42,2,0,4,328,2,3,3,6,2,0,2,3,3,40,2,3,3,32,2,3,3,6,2,0,2,3,3,14,2,56,2,3,3,66,5,0,33,15,17,84,13,619,3,16,2,25,6,74,22,12,2,6,12,20,12,19,13,12,2,2,2,1,13,51,3,29,4,0,5,1,3,9,34,2,3,9,7,87,9,42,6,69,11,28,4,11,5,11,11,39,3,4,12,43,5,25,7,10,38,27,5,62,2,28,3,10,7,9,14,0,89,75,5,9,18,8,13,42,4,11,71,55,9,9,4,48,83,2,2,30,14,230,23,280,3,5,3,37,3,5,3,7,2,0,2,0,2,0,2,30,3,52,2,6,2,0,4,2,2,6,4,3,3,5,5,12,6,2,2,6,67,1,20,0,29,0,14,0,17,4,60,12,5,0,4,11,18,0,5,0,3,9,2,0,4,4,7,0,2,0,2,0,2,3,2,10,3,3,6,4,5,0,53,1,2684,46,2,46,2,132,7,6,15,37,11,53,10,0,17,22,10,6,2,6,2,6,2,6,2,6,2,6,2,6,2,6,2,31,48,0,470,1,36,5,2,4,6,1,5,85,3,1,3,2,2,89,2,3,6,40,4,93,18,23,57,15,513,6581,75,20939,53,1164,68,45,3,268,4,27,21,31,3,13,13,1,2,24,9,69,11,1,38,8,3,102,3,1,111,44,25,51,13,68,12,9,7,23,4,0,5,45,3,35,13,28,4,64,15,10,39,54,10,13,3,9,7,22,4,1,5,66,25,2,227,42,2,1,3,9,7,11171,13,22,5,48,8453,301,3,61,3,105,39,6,13,4,6,11,2,12,2,4,2,0,2,1,2,1,2,107,34,362,19,63,3,53,41,11,5,15,17,6,13,1,25,2,33,4,2,134,20,9,8,25,5,0,2,25,12,88,4,5,3,5,3,5,3,2],s=0,o=[],r=0;r<n.length;r+=2)o.push(s+=n[r]),n[r+1]&&o.push(45,s+=n[r+1]);e.wordChars=String.fromCharCode.apply(null,o)})),ace.define("ace/mode/text",["require","exports","module","ace/config","ace/tokenizer","ace/mode/text_highlight_rules","ace/mode/behaviour/cstyle","ace/unicode","ace/lib/lang","ace/token_iterator","ace/range"],(function(t,e,i){"use strict";var n,s=t("../config"),o=t("../tokenizer").Tokenizer,r=t("./text_highlight_rules").TextHighlightRules,a=t("./behaviour/cstyle").CstyleBehaviour,l=t("../unicode"),h=t("../lib/lang"),c=t("../token_iterator").TokenIterator,d=t("../range").Range;(function(){this.$defaultBehaviour=new a,this.tokenRe=new RegExp("^["+l.wordChars+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+l.wordChars+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new o(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(t,e,i,n){var s=e.doc,o=!0,r=!0,a=1/0,l=e.getTabSize(),c=!1;if(this.lineCommentStart){Array.isArray(this.lineCommentStart)?(f=this.lineCommentStart.map(h.escapeRegExp).join("|"),p=this.lineCommentStart[0]):(f=h.escapeRegExp(this.lineCommentStart),p=this.lineCommentStart),f=new RegExp("^(\\s*)(?:"+f+") ?"),c=e.getUseSoftTabs(),_=function(t,e){var i=t.match(f);if(i){var n=i[1].length,o=i[0].length;u(t,n,o)||" "!=i[0][o-1]||o--,s.removeInLine(e,n,o)}};var d=p+" ",u=(v=function(t,e){o&&!/\S/.test(t)||(u(t,a,a)?s.insertInLine({row:e,column:a},d):s.insertInLine({row:e,column:a},p))},y=function(t,e){return f.test(t)},function(t,e,i){for(var n=0;e--&&" "==t.charAt(e);)n++;if(n%l!=0)return!1;for(n=0;" "==t.charAt(i++);)n++;return l>2?n%l!=l-1:n%l==0})}else{if(!this.blockComment)return!1;var p=this.blockComment.start,g=this.blockComment.end,f=new RegExp("^(\\s*)(?:"+h.escapeRegExp(p)+")"),m=new RegExp("(?:"+h.escapeRegExp(g)+")\\s*$"),v=function(t,e){y(t,e)||o&&!/\S/.test(t)||(s.insertInLine({row:e,column:t.length},g),s.insertInLine({row:e,column:a},p))},_=function(t,e){var i;(i=t.match(m))&&s.removeInLine(e,t.length-i[0].length,t.length),(i=t.match(f))&&s.removeInLine(e,i[1].length,i[0].length)},y=function(t,i){if(f.test(t))return!0;for(var n=e.getTokens(i),s=0;s<n.length;s++)if("comment"===n[s].type)return!0}}function w(t){for(var e=i;e<=n;e++)t(s.getLine(e),e)}var x=1/0;w((function(t,e){var i=t.search(/\S/);-1!==i?(i<a&&(a=i),r&&!y(t,e)&&(r=!1)):x>t.length&&(x=t.length)})),a==1/0&&(a=x,o=!1,r=!1),c&&a%l!=0&&(a=Math.floor(a/l)*l),w(r?_:v)},this.toggleBlockComment=function(t,e,i,n){var s=this.blockComment;if(s){!s.start&&s[0]&&(s=s[0]);var o,r,a=(f=new c(e,n.row,n.column)).getCurrentToken(),l=(e.selection,e.selection.toOrientedRange());if(a&&/comment/.test(a.type)){for(var h,u;a&&/comment/.test(a.type);){if(-1!=(m=a.value.indexOf(s.start))){var p=f.getCurrentTokenRow(),g=f.getCurrentTokenColumn()+m;h=new d(p,g,p,g+s.start.length);break}a=f.stepBackward()}var f;for(a=(f=new c(e,n.row,n.column)).getCurrentToken();a&&/comment/.test(a.type);){var m;if(-1!=(m=a.value.indexOf(s.end))){p=f.getCurrentTokenRow(),g=f.getCurrentTokenColumn()+m,u=new d(p,g,p,g+s.end.length);break}a=f.stepForward()}u&&e.remove(u),h&&(e.remove(h),o=h.start.row,r=-s.start.length)}else r=s.start.length,o=i.start.row,e.insert(i.end,s.end),e.insert(i.start,s.start);l.start.row==o&&(l.start.column+=r),l.end.row==o&&(l.end.column+=r),e.selection.fromOrientedRange(l)}},this.getNextLineIndent=function(t,e,i){return this.$getIndent(e)},this.checkOutdent=function(t,e,i){return!1},this.autoOutdent=function(t,e,i){},this.$getIndent=function(t){return t.match(/^\s*/)[0]},this.createWorker=function(t){return null},this.createModeDelegates=function(t){for(var e in this.$embeds=[],this.$modes={},t)if(t[e]){var i=t[e],n=i.prototype.$id,o=s.$modes[n];o||(s.$modes[n]=o=new i),s.$modes[e]||(s.$modes[e]=o),this.$embeds.push(e),this.$modes[e]=o}var r=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"],a=function(t){var e,i,n;n=(e=l)[i=r[t]],e[r[t]]=function(){return this.$delegator(i,arguments,n)}},l=this;for(e=0;e<r.length;e++)a(e)},this.$delegator=function(t,e,i){var n=e[0]||"start";if("string"!=typeof n){if(Array.isArray(n[2])){var s=n[2][n[2].length-1];if(r=this.$modes[s])return r[t].apply(r,[n[1]].concat([].slice.call(e,1)))}n=n[0]||"start"}for(var o=0;o<this.$embeds.length;o++)if(this.$modes[this.$embeds[o]]){var r,a=n.split(this.$embeds[o]);if(!a[0]&&a[1])return e[0]=a[1],(r=this.$modes[this.$embeds[o]])[t].apply(r,e)}var l=i.apply(this,e);return i?l:void 0},this.transformAction=function(t,e,i,n,s){if(this.$behaviour){var o=this.$behaviour.getBehaviours();for(var r in o)if(o[r][e]){var a=o[r][e].apply(this,arguments);if(a)return a}}},this.getKeywords=function(t){if(!this.completionKeywords){var e=this.$tokenizer.rules,i=[];for(var n in e)for(var s=e[n],o=0,r=s.length;o<r;o++)if("string"==typeof s[o].token)/keyword|support|storage/.test(s[o].token)&&i.push(s[o].regex);else if("object"==typeof s[o].token)for(var a=0,l=s[o].token.length;a<l;a++)/keyword|support|storage/.test(s[o].token[a])&&(n=s[o].regex.match(/\(.+?\)/g)[a],i.push(n.substr(1,n.length-2)));this.completionKeywords=i}return t?i.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(t,e,i,n){return(this.$keywordList||this.$createKeywordList()).map((function(t){return{name:t,value:t,score:0,meta:"keyword"}}))},this.$id="ace/mode/text"}).call((n=function(){this.HighlightRules=r}).prototype),e.Mode=n})),ace.define("ace/apply_delta",["require","exports","module"],(function(t,e,i){"use strict";e.applyDelta=function(t,e,i){var n=e.start.row,s=e.start.column,o=t[n]||"";switch(e.action){case"insert":if(1===e.lines.length)t[n]=o.substring(0,s)+e.lines[0]+o.substring(s);else{var r=[n,1].concat(e.lines);t.splice.apply(t,r),t[n]=o.substring(0,s)+t[n],t[n+e.lines.length-1]+=o.substring(s)}break;case"remove":var a=e.end.column,l=e.end.row;n===l?t[n]=o.substring(0,s)+o.substring(a):t.splice(n,l-n+1,o.substring(0,s)+t[l].substring(a))}}})),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(t,e,i){"use strict";var n=t("./lib/oop"),s=t("./lib/event_emitter").EventEmitter,o=function(){function t(t,e,i){this.$onChange=this.onChange.bind(this),this.attach(t),"number"!=typeof e?this.setPosition(e.row,e.column):this.setPosition(e,i)}return t.prototype.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},t.prototype.getDocument=function(){return this.document},t.prototype.onChange=function(t){if(!(t.start.row==t.end.row&&t.start.row!=this.row||t.start.row>this.row)){var e=function(t,e,i){var n="insert"==t.action,s=(n?1:-1)*(t.end.row-t.start.row),o=(n?1:-1)*(t.end.column-t.start.column),a=t.start,l=n?a:t.end;return r(e,a,i)?{row:e.row,column:e.column}:r(l,e,!i)?{row:e.row+s,column:e.column+(e.row==l.row?o:0)}:{row:a.row,column:a.column}}(t,{row:this.row,column:this.column},this.$insertRight);this.setPosition(e.row,e.column,!0)}},t.prototype.setPosition=function(t,e,i){var n;if(n=i?{row:t,column:e}:this.$clipPositionToDocument(t,e),this.row!=n.row||this.column!=n.column){var s={row:this.row,column:this.column};this.row=n.row,this.column=n.column,this._signal("change",{old:s,value:n})}},t.prototype.detach=function(){this.document.off("change",this.$onChange)},t.prototype.attach=function(t){this.document=t||this.document,this.document.on("change",this.$onChange)},t.prototype.$clipPositionToDocument=function(t,e){var i={};return t>=this.document.getLength()?(i.row=Math.max(0,this.document.getLength()-1),i.column=this.document.getLine(i.row).length):t<0?(i.row=0,i.column=0):(i.row=t,i.column=Math.min(this.document.getLine(i.row).length,Math.max(0,e))),e<0&&(i.column=0),i},t}();function r(t,e,i){var n=i?t.column<=e.column:t.column<e.column;return t.row<e.row||t.row==e.row&&n}o.prototype.$insertRight=!1,n.implement(o.prototype,s),e.Anchor=o})),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],(function(t,e,i){"use strict";var n=t("./lib/oop"),s=t("./apply_delta").applyDelta,o=t("./lib/event_emitter").EventEmitter,r=t("./range").Range,a=t("./anchor").Anchor,l=function(){function t(t){this.$lines=[""],0===t.length?this.$lines=[""]:Array.isArray(t)?this.insertMergedLines({row:0,column:0},t):this.insert({row:0,column:0},t)}return t.prototype.setValue=function(t){var e=this.getLength()-1;this.remove(new r(0,0,e,this.getLine(e).length)),this.insert({row:0,column:0},t||"")},t.prototype.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},t.prototype.createAnchor=function(t,e){return new a(this,t,e)},t.prototype.$detectNewLine=function(t){var e=t.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=e?e[1]:"\n",this._signal("changeNewLineMode")},t.prototype.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},t.prototype.setNewLineMode=function(t){this.$newLineMode!==t&&(this.$newLineMode=t,this._signal("changeNewLineMode"))},t.prototype.getNewLineMode=function(){return this.$newLineMode},t.prototype.isNewLine=function(t){return"\r\n"==t||"\r"==t||"\n"==t},t.prototype.getLine=function(t){return this.$lines[t]||""},t.prototype.getLines=function(t,e){return this.$lines.slice(t,e+1)},t.prototype.getAllLines=function(){return this.getLines(0,this.getLength())},t.prototype.getLength=function(){return this.$lines.length},t.prototype.getTextRange=function(t){return this.getLinesForRange(t).join(this.getNewLineCharacter())},t.prototype.getLinesForRange=function(t){var e;if(t.start.row===t.end.row)e=[this.getLine(t.start.row).substring(t.start.column,t.end.column)];else{(e=this.getLines(t.start.row,t.end.row))[0]=(e[0]||"").substring(t.start.column);var i=e.length-1;t.end.row-t.start.row==i&&(e[i]=e[i].substring(0,t.end.column))}return e},t.prototype.insertLines=function(t,e){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(t,e)},t.prototype.removeLines=function(t,e){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(t,e)},t.prototype.insertNewLine=function(t){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(t,["",""])},t.prototype.insert=function(t,e){return this.getLength()<=1&&this.$detectNewLine(e),this.insertMergedLines(t,this.$split(e))},t.prototype.insertInLine=function(t,e){var i=this.clippedPos(t.row,t.column),n=this.pos(t.row,t.column+e.length);return this.applyDelta({start:i,end:n,action:"insert",lines:[e]},!0),this.clonePos(n)},t.prototype.clippedPos=function(t,e){var i=this.getLength();void 0===t?t=i:t<0?t=0:t>=i&&(t=i-1,e=void 0);var n=this.getLine(t);return null==e&&(e=n.length),{row:t,column:e=Math.min(Math.max(e,0),n.length)}},t.prototype.clonePos=function(t){return{row:t.row,column:t.column}},t.prototype.pos=function(t,e){return{row:t,column:e}},t.prototype.$clipPosition=function(t){var e=this.getLength();return t.row>=e?(t.row=Math.max(0,e-1),t.column=this.getLine(e-1).length):(t.row=Math.max(0,t.row),t.column=Math.min(Math.max(t.column,0),this.getLine(t.row).length)),t},t.prototype.insertFullLines=function(t,e){var i=0;(t=Math.min(Math.max(t,0),this.getLength()))<this.getLength()?(e=e.concat([""]),i=0):(e=[""].concat(e),t--,i=this.$lines[t].length),this.insertMergedLines({row:t,column:i},e)},t.prototype.insertMergedLines=function(t,e){var i=this.clippedPos(t.row,t.column),n={row:i.row+e.length-1,column:(1==e.length?i.column:0)+e[e.length-1].length};return this.applyDelta({start:i,end:n,action:"insert",lines:e}),this.clonePos(n)},t.prototype.remove=function(t){var e=this.clippedPos(t.start.row,t.start.column),i=this.clippedPos(t.end.row,t.end.column);return this.applyDelta({start:e,end:i,action:"remove",lines:this.getLinesForRange({start:e,end:i})}),this.clonePos(e)},t.prototype.removeInLine=function(t,e,i){var n=this.clippedPos(t,e),s=this.clippedPos(t,i);return this.applyDelta({start:n,end:s,action:"remove",lines:this.getLinesForRange({start:n,end:s})},!0),this.clonePos(n)},t.prototype.removeFullLines=function(t,e){t=Math.min(Math.max(0,t),this.getLength()-1);var i=(e=Math.min(Math.max(0,e),this.getLength()-1))==this.getLength()-1&&t>0,n=e<this.getLength()-1,s=i?t-1:t,o=i?this.getLine(s).length:0,a=n?e+1:e,l=n?0:this.getLine(a).length,h=new r(s,o,a,l),c=this.$lines.slice(t,e+1);return this.applyDelta({start:h.start,end:h.end,action:"remove",lines:this.getLinesForRange(h)}),c},t.prototype.removeNewLine=function(t){t<this.getLength()-1&&t>=0&&this.applyDelta({start:this.pos(t,this.getLine(t).length),end:this.pos(t+1,0),action:"remove",lines:["",""]})},t.prototype.replace=function(t,e){return t instanceof r||(t=r.fromPoints(t.start,t.end)),0===e.length&&t.isEmpty()?t.start:e==this.getTextRange(t)?t.end:(this.remove(t),e?this.insert(t.start,e):t.start)},t.prototype.applyDeltas=function(t){for(var e=0;e<t.length;e++)this.applyDelta(t[e])},t.prototype.revertDeltas=function(t){for(var e=t.length-1;e>=0;e--)this.revertDelta(t[e])},t.prototype.applyDelta=function(t,e){var i="insert"==t.action;(i?t.lines.length<=1&&!t.lines[0]:!r.comparePoints(t.start,t.end))||(i&&t.lines.length>2e4?this.$splitAndapplyLargeDelta(t,2e4):(s(this.$lines,t,e),this._signal("change",t)))},t.prototype.$safeApplyDelta=function(t){var e=this.$lines.length;("remove"==t.action&&t.start.row<e&&t.end.row<e||"insert"==t.action&&t.start.row<=e)&&this.applyDelta(t)},t.prototype.$splitAndapplyLargeDelta=function(t,e){for(var i=t.lines,n=i.length-e+1,s=t.start.row,o=t.start.column,r=0,a=0;r<n;r=a){a+=e-1;var l=i.slice(r,a);l.push(""),this.applyDelta({start:this.pos(s+r,o),end:this.pos(s+a,o=0),action:t.action,lines:l},!0)}t.lines=i.slice(r),t.start.row=s+r,t.start.column=o,this.applyDelta(t,!0)},t.prototype.revertDelta=function(t){this.$safeApplyDelta({start:this.clonePos(t.start),end:this.clonePos(t.end),action:"insert"==t.action?"remove":"insert",lines:t.lines.slice()})},t.prototype.indexToPosition=function(t,e){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,s=e||0,o=i.length;s<o;s++)if((t-=i[s].length+n)<0)return{row:s,column:t+i[s].length+n};return{row:o-1,column:t+i[o-1].length+n}},t.prototype.positionToIndex=function(t,e){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,s=0,o=Math.min(t.row,i.length),r=e||0;r<o;++r)s+=i[r].length+n;return s+t.column},t.prototype.$split=function(t){return t.split(/\r\n|\r|\n/)},t}();l.prototype.$autoNewLine="",l.prototype.$newLineMode="auto",n.implement(l.prototype,o),e.Document=l})),ace.define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(t,e,i){"use strict";var n=t("./lib/oop"),s=t("./lib/event_emitter").EventEmitter,o=function(){function t(t,e){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=t;var i=this;this.$worker=function(){if(i.running){for(var t=new Date,e=i.currentLine,n=-1,s=i.doc,o=e;i.lines[e];)e++;var r=s.getLength(),a=0;for(i.running=!1;e<r;){i.$tokenizeRow(e),n=e;do{e++}while(i.lines[e]);if(++a%5==0&&new Date-t>20){i.running=setTimeout(i.$worker,20);break}}i.currentLine=e,-1==n&&(n=e),o<=n&&i.fireUpdateEvent(o,n)}}}return t.prototype.setTokenizer=function(t){this.tokenizer=t,this.lines=[],this.states=[],this.start(0)},t.prototype.setDocument=function(t){this.doc=t,this.lines=[],this.states=[],this.stop()},t.prototype.fireUpdateEvent=function(t,e){var i={first:t,last:e};this._signal("update",{data:i})},t.prototype.start=function(t){this.currentLine=Math.min(t||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},t.prototype.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},t.prototype.$updateOnChange=function(t){var e=t.start.row,i=t.end.row-e;if(0===i)this.lines[e]=null;else if("remove"==t.action)this.lines.splice(e,i+1,null),this.states.splice(e,i+1,null);else{var n=Array(i+1);n.unshift(e,1),this.lines.splice.apply(this.lines,n),this.states.splice.apply(this.states,n)}this.currentLine=Math.min(e,this.currentLine,this.doc.getLength()),this.stop()},t.prototype.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},t.prototype.getTokens=function(t){return this.lines[t]||this.$tokenizeRow(t)},t.prototype.getState=function(t){return this.currentLine==t&&this.$tokenizeRow(t),this.states[t]||"start"},t.prototype.$tokenizeRow=function(t){var e=this.doc.getLine(t),i=this.states[t-1],n=this.tokenizer.getLineTokens(e,i,t);return this.states[t]+""!=n.state+""?(this.states[t]=n.state,this.lines[t+1]=null,this.currentLine>t+1&&(this.currentLine=t+1)):this.currentLine==t&&(this.currentLine=t+1),this.lines[t]=n.tokens},t.prototype.cleanup=function(){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.removeAllListeners()},t}();n.implement(o.prototype,s),e.BackgroundTokenizer=o})),ace.define("ace/search_highlight",["require","exports","module","ace/lib/lang","ace/range"],(function(t,e,i){"use strict";var n=t("./lib/lang"),s=t("./range").Range,o=function(){function t(t,e,i){void 0===i&&(i="text"),this.setRegexp(t),this.clazz=e,this.type=i}return t.prototype.setRegexp=function(t){this.regExp+""!=t+""&&(this.regExp=t,this.cache=[])},t.prototype.update=function(t,e,i,o){if(this.regExp)for(var r=o.firstRow,a=o.lastRow,l={},h=r;h<=a;h++){var c=this.cache[h];null==c&&((c=n.getMatchOffsets(i.getLine(h),this.regExp)).length>this.MAX_RANGES&&(c=c.slice(0,this.MAX_RANGES)),c=c.map((function(t){return new s(h,t.offset,h,t.offset+t.length)})),this.cache[h]=c.length?c:"");for(var d=c.length;d--;){var u=c[d].toScreenRange(i),p=u.toString();l[p]||(l[p]=!0,e.drawSingleLineMarker(t,u,this.clazz,o))}}},t}();o.prototype.MAX_RANGES=500,e.SearchHighlight=o})),ace.define("ace/undomanager",["require","exports","module","ace/range"],(function(t,e,i){"use strict";var n=function(){function t(){this.$keepRedoStack,this.$maxRev=0,this.$fromUndo=!1,this.$undoDepth=1/0,this.reset()}return t.prototype.addSession=function(t){this.$session=t},t.prototype.add=function(t,e,i){if(!this.$fromUndo&&t!=this.$lastDelta){if(this.$keepRedoStack||(this.$redoStack.length=0),!1===e||!this.lastDeltas){this.lastDeltas=[];var n=this.$undoStack.length;n>this.$undoDepth-1&&this.$undoStack.splice(0,n-this.$undoDepth+1),this.$undoStack.push(this.lastDeltas),t.id=this.$rev=++this.$maxRev}"remove"!=t.action&&"insert"!=t.action||(this.$lastDelta=t),this.lastDeltas.push(t)}},t.prototype.addSelection=function(t,e){this.selections.push({value:t,rev:e||this.$rev})},t.prototype.startNewGroup=function(){return this.lastDeltas=null,this.$rev},t.prototype.markIgnored=function(t,e){null==e&&(e=this.$rev+1);for(var i=this.$undoStack,n=i.length;n--;){var s=i[n][0];if(s.id<=t)break;s.id<e&&(s.ignore=!0)}this.lastDeltas=null},t.prototype.getSelection=function(t,e){for(var i=this.selections,n=i.length;n--;){var s=i[n];if(s.rev<t)return e&&(s=i[n+1]),s}},t.prototype.getRevision=function(){return this.$rev},t.prototype.getDeltas=function(t,e){null==e&&(e=this.$rev+1);for(var i=this.$undoStack,n=null,s=0,o=i.length;o--;){var r=i[o][0];if(r.id<e&&!n&&(n=o+1),r.id<=t){s=o+1;break}}return i.slice(s,n)},t.prototype.getChangedRanges=function(t,e){null==e&&(e=this.$rev+1)},t.prototype.getChangedLines=function(t,e){null==e&&(e=this.$rev+1)},t.prototype.undo=function(t,e){this.lastDeltas=null;var i=this.$undoStack;if(function(t,e){for(var i=e;i--;){var n=t[i];if(n&&!n[0].ignore){for(;i<e-1;){var s=c(t[i],t[i+1]);t[i]=s[0],t[i+1]=s[1],i++}return!0}}}(i,i.length)){t||(t=this.$session),this.$redoStackBaseRev!==this.$rev&&this.$redoStack.length&&(this.$redoStack=[]),this.$fromUndo=!0;var n=i.pop(),s=null;return n&&(s=t.undoChanges(n,e),this.$redoStack.push(n),this.$syncRev()),this.$fromUndo=!1,s}},t.prototype.redo=function(t,e){if(this.lastDeltas=null,t||(t=this.$session),this.$fromUndo=!0,this.$redoStackBaseRev!=this.$rev){var i=this.getDeltas(this.$redoStackBaseRev,this.$rev+1);!function(t,e){for(var i=0;i<e.length;i++)for(var n=e[i],s=0;s<n.length;s++)f(t,n[s])}(this.$redoStack,i),this.$redoStackBaseRev=this.$rev,this.$redoStack.forEach((function(t){t[0].id=++this.$maxRev}),this)}var n=this.$redoStack.pop(),s=null;return n&&(s=t.redoChanges(n,e),this.$undoStack.push(n),this.$syncRev()),this.$fromUndo=!1,s},t.prototype.$syncRev=function(){var t=this.$undoStack,e=t[t.length-1],i=e&&e[0].id||0;this.$redoStackBaseRev=i,this.$rev=i},t.prototype.reset=function(){this.lastDeltas=null,this.$lastDelta=null,this.$undoStack=[],this.$redoStack=[],this.$rev=0,this.mark=0,this.$redoStackBaseRev=this.$rev,this.selections=[]},t.prototype.canUndo=function(){return this.$undoStack.length>0},t.prototype.canRedo=function(){return this.$redoStack.length>0},t.prototype.bookmark=function(t){null==t&&(t=this.$rev),this.mark=t},t.prototype.isAtBookmark=function(){return this.$rev===this.mark},t.prototype.toJSON=function(){return{$redoStack:this.$redoStack,$undoStack:this.$undoStack}},t.prototype.fromJSON=function(t){this.reset(),this.$undoStack=t.$undoStack,this.$redoStack=t.$redoStack},t.prototype.$prettyPrint=function(t){return t?a(t):a(this.$undoStack)+"\n---\n"+a(this.$redoStack)},t}();n.prototype.hasUndo=n.prototype.canUndo,n.prototype.hasRedo=n.prototype.canRedo,n.prototype.isClean=n.prototype.isAtBookmark,n.prototype.markClean=n.prototype.bookmark;var s=t("./range").Range,o=s.comparePoints;function r(t){return{row:t.row,column:t.column}}function a(t){if(t=t||this,Array.isArray(t))return t.map(a).join("\n");var e="";return t.action?(e="insert"==t.action?"+":"-",e+="["+t.lines+"]"):t.value&&(e=Array.isArray(t.value)?t.value.map(l).join("\n"):l(t.value)),t.start&&(e+=l(t)),(t.id||t.rev)&&(e+="\t("+(t.id||t.rev)+")"),e}function l(t){return t.start.row+":"+t.start.column+"=>"+t.end.row+":"+t.end.column}function h(t,e){var i="insert"==t.action,n="insert"==e.action;if(i&&n)if(o(e.start,t.end)>=0)u(e,t,-1);else{if(!(o(e.start,t.start)<=0))return null;u(t,e,1)}else if(i&&!n)if(o(e.start,t.end)>=0)u(e,t,-1);else{if(!(o(e.end,t.start)<=0))return null;u(t,e,-1)}else if(!i&&n)if(o(e.start,t.start)>=0)u(e,t,1);else{if(!(o(e.start,t.start)<=0))return null;u(t,e,1)}else if(!i&&!n)if(o(e.start,t.start)>=0)u(e,t,1);else{if(!(o(e.end,t.start)<=0))return null;u(t,e,-1)}return[e,t]}function c(t,e){for(var i=t.length;i--;)for(var n=0;n<e.length;n++)if(!h(t[i],e[n])){for(;i<t.length;){for(;n--;)h(e[n],t[i]);n=e.length,i++}return[t,e]}return t.selectionBefore=e.selectionBefore=t.selectionAfter=e.selectionAfter=null,[e,t]}function d(t,e){var i="insert"==t.action,n="insert"==e.action;if(i&&n)o(t.start,e.start)<0?u(e,t,1):u(t,e,1);else if(i&&!n)o(t.start,e.end)>=0?u(t,e,-1):(o(t.start,e.start)<=0||u(t,s.fromPoints(e.start,t.start),-1),u(e,t,1));else if(!i&&n)o(e.start,t.end)>=0?u(e,t,-1):(o(e.start,t.start)<=0||u(e,s.fromPoints(t.start,e.start),-1),u(t,e,1));else if(!i&&!n)if(o(e.start,t.end)>=0)u(e,t,-1);else{var r,a;if(!(o(e.end,t.start)<=0))return o(t.start,e.start)<0&&(r=t,t=g(t,e.start)),o(t.end,e.end)>0&&(a=g(t,e.end)),p(e.end,t.start,t.end,-1),a&&!r&&(t.lines=a.lines,t.start=a.start,t.end=a.end,a=t),[e,r,a].filter(Boolean);u(t,e,-1)}return[e,t]}function u(t,e,i){p(t.start,e.start,e.end,i),p(t.end,e.start,e.end,i)}function p(t,e,i,n){t.row==(1==n?e:i).row&&(t.column+=n*(i.column-e.column)),t.row+=n*(i.row-e.row)}function g(t,e){var i=t.lines,n=t.end;t.end=r(e);var s=t.end.row-t.start.row,o=i.splice(s,i.length),a=s?e.column:e.column-t.start.column;return i.push(o[0].substring(0,a)),o[0]=o[0].substr(a),{start:r(e),end:n,lines:o,action:t.action}}function f(t,e){e=function(t){return{start:r(t.start),end:r(t.end),action:t.action,lines:t.lines.slice()}}(e);for(var i=t.length;i--;){for(var n=t[i],s=0;s<n.length;s++){var o=d(n[s],e);e=o[0],2!=o.length&&(o[2]?(n.splice(s+1,1,o[1],o[2]),s++):o[1]||(n.splice(s,1),s--))}n.length||t.splice(i,1)}return t}s.comparePoints,e.UndoManager=n})),ace.define("ace/edit_session/fold_line",["require","exports","module","ace/range"],(function(t,e,i){"use strict";var n=t("../range").Range,s=function(){function t(t,e){this.foldData=t,Array.isArray(e)?this.folds=e:e=this.folds=[e];var i=e[e.length-1];this.range=new n(e[0].start.row,e[0].start.column,i.end.row,i.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach((function(t){t.setFoldLine(this)}),this)}return t.prototype.shiftRow=function(t){this.start.row+=t,this.end.row+=t,this.folds.forEach((function(e){e.start.row+=t,e.end.row+=t}))},t.prototype.addFold=function(t){if(t.sameRow){if(t.start.row<this.startRow||t.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(t),this.folds.sort((function(t,e){return-t.range.compareEnd(e.start.row,e.start.column)})),this.range.compareEnd(t.start.row,t.start.column)>0?(this.end.row=t.end.row,this.end.column=t.end.column):this.range.compareStart(t.end.row,t.end.column)<0&&(this.start.row=t.start.row,this.start.column=t.start.column)}else if(t.start.row==this.end.row)this.folds.push(t),this.end.row=t.end.row,this.end.column=t.end.column;else{if(t.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(t),this.start.row=t.start.row,this.start.column=t.start.column}t.foldLine=this},t.prototype.containsRow=function(t){return t>=this.start.row&&t<=this.end.row},t.prototype.walk=function(t,e,i){var n,s,o=0,r=this.folds,a=!0;null==e&&(e=this.end.row,i=this.end.column);for(var l=0;l<r.length;l++){if(-1==(s=(n=r[l]).range.compareStart(e,i)))return void t(null,e,i,o,a);if(!t(null,n.start.row,n.start.column,o,a)&&t(n.placeholder,n.start.row,n.start.column,o)||0===s)return;a=!n.sameRow,o=n.end.column}t(null,e,i,o,a)},t.prototype.getNextFoldTo=function(t,e){for(var i,n,s=0;s<this.folds.length;s++){if(-1==(n=(i=this.folds[s]).range.compareEnd(t,e)))return{fold:i,kind:"after"};if(0===n)return{fold:i,kind:"inside"}}return null},t.prototype.addRemoveChars=function(t,e,i){var n,s,o=this.getNextFoldTo(t,e);if(o)if(n=o.fold,"inside"==o.kind&&n.start.column!=e&&n.start.row!=t)window.console&&window.console.log(t,e,n);else if(n.start.row==t){var r=(s=this.folds).indexOf(n);for(0===r&&(this.start.column+=i);r<s.length;r++){if((n=s[r]).start.column+=i,!n.sameRow)return;n.end.column+=i}this.end.column+=i}},t.prototype.split=function(e,i){var n=this.getNextFoldTo(e,i);if(!n||"inside"==n.kind)return null;var s=n.fold,o=this.folds,r=this.foldData,a=o.indexOf(s),l=o[a-1];this.end.row=l.end.row,this.end.column=l.end.column;var h=new t(r,o=o.splice(a,o.length-a));return r.splice(r.indexOf(this)+1,0,h),h},t.prototype.merge=function(t){for(var e=t.folds,i=0;i<e.length;i++)this.addFold(e[i]);var n=this.foldData;n.splice(n.indexOf(t),1)},t.prototype.toString=function(){var t=[this.range.toString()+": ["];return this.folds.forEach((function(e){t.push("  "+e.toString())})),t.push("]"),t.join("\n")},t.prototype.idxToPosition=function(t){for(var e=0,i=0;i<this.folds.length;i++){var n=this.folds[i];if((t-=n.start.column-e)<0)return{row:n.start.row,column:n.start.column+t};if((t-=n.placeholder.length)<0)return n.start;e=n.end.column}return{row:this.end.row,column:this.end.column+t}},t}();e.FoldLine=s})),ace.define("ace/range_list",["require","exports","module","ace/range"],(function(t,e,i){"use strict";var n=t("./range").Range.comparePoints,s=function(){function t(){this.ranges=[],this.$bias=1}return t.prototype.pointIndex=function(t,e,i){for(var s=this.ranges,o=i||0;o<s.length;o++){var r=s[o],a=n(t,r.end);if(!(a>0)){var l=n(t,r.start);return 0===a?e&&0!==l?-o-2:o:l>0||0===l&&!e?o:-o-1}}return-o-1},t.prototype.add=function(t){var e=!t.isEmpty(),i=this.pointIndex(t.start,e);i<0&&(i=-i-1);var n=this.pointIndex(t.end,e,i);return n<0?n=-n-1:n++,this.ranges.splice(i,n-i,t)},t.prototype.addList=function(t){for(var e=[],i=t.length;i--;)e.push.apply(e,this.add(t[i]));return e},t.prototype.substractPoint=function(t){var e=this.pointIndex(t);if(e>=0)return this.ranges.splice(e,1)},t.prototype.merge=function(){for(var t,e=[],i=this.ranges,s=(i=i.sort((function(t,e){return n(t.start,e.start)})))[0],o=1;o<i.length;o++){t=s,s=i[o];var r=n(t.end,s.start);r<0||(0!=r||t.isEmpty()||s.isEmpty())&&(n(t.end,s.end)<0&&(t.end.row=s.end.row,t.end.column=s.end.column),i.splice(o,1),e.push(s),s=t,o--)}return this.ranges=i,e},t.prototype.contains=function(t,e){return this.pointIndex({row:t,column:e})>=0},t.prototype.containsPoint=function(t){return this.pointIndex(t)>=0},t.prototype.rangeAtPoint=function(t){var e=this.pointIndex(t);if(e>=0)return this.ranges[e]},t.prototype.clipRows=function(t,e){var i=this.ranges;if(i[0].start.row>e||i[i.length-1].start.row<t)return[];var n=this.pointIndex({row:t,column:0});n<0&&(n=-n-1);var s=this.pointIndex({row:e,column:0},n);s<0&&(s=-s-1);for(var o=[],r=n;r<s;r++)o.push(i[r]);return o},t.prototype.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},t.prototype.attach=function(t){this.session&&this.detach(),this.session=t,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},t.prototype.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},t.prototype.$onChange=function(t){for(var e=t.start,i=t.end,n=e.row,s=i.row,o=this.ranges,r=0,a=o.length;r<a&&!((c=o[r]).end.row>=n);r++);if("insert"==t.action){for(var l=s-n,h=-e.column+i.column;r<a&&!((c=o[r]).start.row>n);r++)if(c.start.row==n&&c.start.column>=e.column&&(c.start.column==e.column&&this.$bias<=0||(c.start.column+=h,c.start.row+=l)),c.end.row==n&&c.end.column>=e.column){if(c.end.column==e.column&&this.$bias<0)continue;c.end.column==e.column&&h>0&&r<a-1&&c.end.column>c.start.column&&c.end.column==o[r+1].start.column&&(c.end.column-=h),c.end.column+=h,c.end.row+=l}}else for(l=n-s,h=e.column-i.column;r<a&&!((c=o[r]).start.row>s);r++)c.end.row<s&&(n<c.end.row||n==c.end.row&&e.column<c.end.column)?(c.end.row=n,c.end.column=e.column):c.end.row==s?c.end.column<=i.column?(l||c.end.column>e.column)&&(c.end.column=e.column,c.end.row=e.row):(c.end.column+=h,c.end.row+=l):c.end.row>s&&(c.end.row+=l),c.start.row<s&&(n<c.start.row||n==c.start.row&&e.column<c.start.column)?(c.start.row=n,c.start.column=e.column):c.start.row==s?c.start.column<=i.column?(l||c.start.column>e.column)&&(c.start.column=e.column,c.start.row=e.row):(c.start.column+=h,c.start.row+=l):c.start.row>s&&(c.start.row+=l);if(0!=l&&r<a)for(;r<a;r++){var c;(c=o[r]).start.row+=l,c.end.row+=l}},t}();s.prototype.comparePoints=n,e.RangeList=s})),ace.define("ace/edit_session/fold",["require","exports","module","ace/range_list"],(function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=function(t){function e(e,i){var n=t.call(this)||this;return n.foldLine=null,n.placeholder=i,n.range=e,n.start=e.start,n.end=e.end,n.sameRow=e.start.row==e.end.row,n.subFolds=n.ranges=[],n}return s(e,t),e.prototype.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},e.prototype.setFoldLine=function(t){this.foldLine=t,this.subFolds.forEach((function(e){e.setFoldLine(t)}))},e.prototype.clone=function(){var t=new e(this.range.clone(),this.placeholder);return this.subFolds.forEach((function(e){t.subFolds.push(e.clone())})),t.collapseChildren=this.collapseChildren,t},e.prototype.addSubFold=function(t){if(!this.range.isEqual(t)){var e,i;e=t,i=this.start,r(e.start,i),r(e.end,i);for(var n=t.start.row,s=t.start.column,o=0,a=-1;o<this.subFolds.length&&1==(a=this.subFolds[o].range.compare(n,s));o++);var l=this.subFolds[o],h=0;if(0==a){if(l.range.containsRange(t))return l.addSubFold(t);h=1}n=t.range.end.row,s=t.range.end.column;var c=o;for(a=-1;c<this.subFolds.length&&1==(a=this.subFolds[c].range.compare(n,s));c++);0==a&&c++;for(var d=this.subFolds.splice(o,c-o,t),u=0==a?d.length-1:d.length,p=h;p<u;p++)t.addSubFold(d[p]);return t.setFoldLine(this.foldLine),t}},e.prototype.restoreRange=function(t){return function(t,e){a(t.start,e),a(t.end,e)}(t,this.start)},e}(t("../range_list").RangeList);function r(t,e){t.row-=e.row,0==t.row&&(t.column-=e.column)}function a(t,e){0==t.row&&(t.column+=e.column),t.row+=e.row}e.Fold=o})),ace.define("ace/edit_session/folding",["require","exports","module","ace/range","ace/edit_session/fold_line","ace/edit_session/fold","ace/token_iterator","ace/mouse/mouse_event"],(function(t,e,i){"use strict";var n=t("../range").Range,s=t("./fold_line").FoldLine,o=t("./fold").Fold,r=t("../token_iterator").TokenIterator,a=t("../mouse/mouse_event").MouseEvent;e.Folding=function(){this.getFoldAt=function(t,e,i){var n=this.getFoldLine(t);if(!n)return null;for(var s=n.folds,o=0;o<s.length;o++){var r=s[o].range;if(r.contains(t,e)){if(1==i&&r.isEnd(t,e)&&!r.isEmpty())continue;if(-1==i&&r.isStart(t,e)&&!r.isEmpty())continue;return s[o]}}},this.getFoldsInRange=function(t){var e=t.start,i=t.end,n=this.$foldData,s=[];e.column+=1,i.column-=1;for(var o=0;o<n.length;o++){var r=n[o].range.compareRange(t);if(2!=r){if(-2==r)break;for(var a=n[o].folds,l=0;l<a.length;l++){var h=a[l];if(-2==(r=h.range.compareRange(t)))break;if(2!=r){if(42==r)break;s.push(h)}}}}return e.column-=1,i.column+=1,s},this.getFoldsInRangeList=function(t){if(Array.isArray(t)){var e=[];t.forEach((function(t){e=e.concat(this.getFoldsInRange(t))}),this)}else e=this.getFoldsInRange(t);return e},this.getAllFolds=function(){for(var t=[],e=this.$foldData,i=0;i<e.length;i++)for(var n=0;n<e[i].folds.length;n++)t.push(e[i].folds[n]);return t},this.getFoldStringAt=function(t,e,i,n){if(!(n=n||this.getFoldLine(t)))return null;for(var s,o,r={end:{column:0}},a=0;a<n.folds.length;a++){var l=(o=n.folds[a]).range.compareEnd(t,e);if(-1==l){s=this.getLine(o.start.row).substring(r.end.column,o.start.column);break}if(0===l)return null;r=o}return s||(s=this.getLine(o.start.row).substring(r.end.column)),-1==i?s.substring(0,e-r.end.column):1==i?s.substring(e-r.end.column):s},this.getFoldLine=function(t,e){var i=this.$foldData,n=0;for(e&&(n=i.indexOf(e)),-1==n&&(n=0);n<i.length;n++){var s=i[n];if(s.start.row<=t&&s.end.row>=t)return s;if(s.end.row>t)return null}return null},this.getNextFoldLine=function(t,e){var i=this.$foldData,n=0;for(e&&(n=i.indexOf(e)),-1==n&&(n=0);n<i.length;n++){var s=i[n];if(s.end.row>=t)return s}return null},this.getFoldedRowCount=function(t,e){for(var i=this.$foldData,n=e-t+1,s=0;s<i.length;s++){var o=i[s],r=o.end.row,a=o.start.row;if(r>=e){a<e&&(a>=t?n-=e-a:n=0);break}r>=t&&(n-=a>=t?r-a:r-t+1)}return n},this.$addFoldLine=function(t){return this.$foldData.push(t),this.$foldData.sort((function(t,e){return t.start.row-e.start.row})),t},this.addFold=function(t,e){var i,n=this.$foldData,r=!1;t instanceof o?i=t:(i=new o(e,t)).collapseChildren=e.collapseChildren,this.$clipRangeToDocument(i.range);var a=i.start.row,l=i.start.column,h=i.end.row,c=i.end.column,d=this.getFoldAt(a,l,1),u=this.getFoldAt(h,c,-1);if(d&&u==d)return d.addSubFold(i);d&&!d.range.isStart(a,l)&&this.removeFold(d),u&&!u.range.isEnd(h,c)&&this.removeFold(u);var p=this.getFoldsInRange(i.range);p.length>0&&(this.removeFolds(p),i.collapseChildren||p.forEach((function(t){i.addSubFold(t)})));for(var g=0;g<n.length;g++){var f=n[g];if(h==f.start.row){f.addFold(i),r=!0;break}if(a==f.end.row){if(f.addFold(i),r=!0,!i.sameRow){var m=n[g+1];if(m&&m.start.row==h){f.merge(m);break}}break}if(h<=f.start.row)break}return r||(f=this.$addFoldLine(new s(this.$foldData,i))),this.$useWrapMode?this.$updateWrapData(f.start.row,f.start.row):this.$updateRowLengthCache(f.start.row,f.start.row),this.$modified=!0,this._signal("changeFold",{data:i,action:"add"}),i},this.addFolds=function(t){t.forEach((function(t){this.addFold(t)}),this)},this.removeFold=function(t){var e=t.foldLine,i=e.start.row,n=e.end.row,s=this.$foldData,o=e.folds;if(1==o.length)s.splice(s.indexOf(e),1);else if(e.range.isEnd(t.end.row,t.end.column))o.pop(),e.end.row=o[o.length-1].end.row,e.end.column=o[o.length-1].end.column;else if(e.range.isStart(t.start.row,t.start.column))o.shift(),e.start.row=o[0].start.row,e.start.column=o[0].start.column;else if(t.sameRow)o.splice(o.indexOf(t),1);else{var r=e.split(t.start.row,t.start.column);(o=r.folds).shift(),r.start.row=o[0].start.row,r.start.column=o[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(i,n):this.$updateRowLengthCache(i,n)),this.$modified=!0,this._signal("changeFold",{data:t,action:"remove"})},this.removeFolds=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);e.forEach((function(t){this.removeFold(t)}),this),this.$modified=!0},this.expandFold=function(t){this.removeFold(t),t.subFolds.forEach((function(e){t.restoreRange(e),this.addFold(e)}),this),t.collapseChildren>0&&this.foldAll(t.start.row+1,t.end.row,t.collapseChildren-1),t.subFolds=[]},this.expandFolds=function(t){t.forEach((function(t){this.expandFold(t)}),this)},this.unfold=function(t,e){var i,s;if(null==t)i=new n(0,0,this.getLength(),0),null==e&&(e=!0);else if("number"==typeof t)i=new n(t,0,t,this.getLine(t).length);else if("row"in t)i=n.fromPoints(t,t);else{if(Array.isArray(t))return s=[],t.forEach((function(t){s=s.concat(this.unfold(t))}),this),s;i=t}for(var o=s=this.getFoldsInRangeList(i);1==s.length&&n.comparePoints(s[0].start,i.start)<0&&n.comparePoints(s[0].end,i.end)>0;)this.expandFolds(s),s=this.getFoldsInRangeList(i);if(0!=e?this.removeFolds(s):this.expandFolds(s),o.length)return o},this.isRowFolded=function(t,e){return!!this.getFoldLine(t,e)},this.getRowFoldEnd=function(t,e){var i=this.getFoldLine(t,e);return i?i.end.row:t},this.getRowFoldStart=function(t,e){var i=this.getFoldLine(t,e);return i?i.start.row:t},this.getFoldDisplayLine=function(t,e,i,n,s){null==n&&(n=t.start.row),null==s&&(s=0),null==e&&(e=t.end.row),null==i&&(i=this.getLine(e).length);var o=this.doc,r="";return t.walk((function(t,e,i,a){if(!(e<n)){if(e==n){if(i<s)return;a=Math.max(s,a)}r+=null!=t?t:o.getLine(e).substring(a,i)}}),e,i),r},this.getDisplayLine=function(t,e,i,n){var s,o=this.getFoldLine(t);return o?this.getFoldDisplayLine(o,t,e,i,n):(s=this.doc.getLine(t)).substring(n||0,e||s.length)},this.$cloneFoldData=function(){var t=[];return t=this.$foldData.map((function(e){var i=e.folds.map((function(t){return t.clone()}));return new s(t,i)}))},this.toggleFold=function(t){var e,i,n=this.selection.getRange();if(n.isEmpty()){var s=n.start;if(e=this.getFoldAt(s.row,s.column))return void this.expandFold(e);(i=this.findMatchingBracket(s))?1==n.comparePoint(i)?n.end=i:(n.start=i,n.start.column++,n.end.column--):(i=this.findMatchingBracket({row:s.row,column:s.column+1}))?(1==n.comparePoint(i)?n.end=i:n.start=i,n.start.column++):n=this.getCommentFoldRange(s.row,s.column)||n}else{var o=this.getFoldsInRange(n);if(t&&o.length)return void this.expandFolds(o);1==o.length&&(e=o[0])}if(e||(e=this.getFoldAt(n.start.row,n.start.column)),e&&e.range.toString()==n.toString())this.expandFold(e);else{var r="...";if(!n.isMultiLine()){if((r=this.getTextRange(n)).length<4)return;r=r.trim().substring(0,2)+".."}this.addFold(r,n)}},this.getCommentFoldRange=function(t,e,i){var s=new r(this,t,e),o=s.getCurrentToken(),a=o&&o.type;if(o&&/^comment|string/.test(a)){"comment"==(a=a.match(/comment|string/)[0])&&(a+="|doc-start|\\.doc");var l=new RegExp(a),h=new n;if(1!=i){do{o=s.stepBackward()}while(o&&l.test(o.type));o=s.stepForward()}h.start.row=s.getCurrentTokenRow(),h.start.column=s.getCurrentTokenColumn()+o.value.length,s=new r(this,t,e);var c=this.getState(s.$row);if(-1!=i){var d=-1;do{if(o=s.stepForward(),-1==d){var u=this.getState(s.$row);c.toString()!==u.toString()&&(d=s.$row)}else if(s.$row>d)break}while(o&&l.test(o.type));o=s.stepBackward()}else o=s.getCurrentToken();return h.end.row=s.getCurrentTokenRow(),h.end.column=s.getCurrentTokenColumn(),h}},this.foldAll=function(t,e,i,n){null==i&&(i=1e5);var s=this.foldWidgets;if(s){e=e||this.getLength();for(var o=t=t||0;o<e;o++)if(null==s[o]&&(s[o]=this.getFoldWidget(o)),"start"==s[o]&&(!n||n(o))){var r=this.getFoldWidgetRange(o);r&&r.isMultiLine()&&r.end.row<=e&&r.start.row>=t&&(o=r.end.row,r.collapseChildren=i,this.addFold("...",r))}}},this.foldToLevel=function(t){for(this.foldAll();t-- >0;)this.unfold(null,!1)},this.foldAllComments=function(){var t=this;this.foldAll(null,null,null,(function(e){for(var i=t.getTokens(e),n=0;n<i.length;n++){var s=i[n];if("text"!=s.type||!/^\s+$/.test(s.value))return!!/comment/.test(s.type)}}))},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(t){if(!this.$foldStyles[t])throw new Error("invalid fold style: "+t+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=t){this.$foldStyle=t,"manual"==t&&this.unfold();var e=this.$foldMode;this.$setFolding(null),this.$setFolding(e)}},this.$setFolding=function(t){this.$foldMode!=t&&(this.$foldMode=t,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._signal("changeAnnotation"),t&&"manual"!=this.$foldStyle?(this.foldWidgets=[],this.getFoldWidget=t.getFoldWidget.bind(t,this,this.$foldStyle),this.getFoldWidgetRange=t.getFoldWidgetRange.bind(t,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)):this.foldWidgets=null)},this.getParentFoldRangeData=function(t,e){var i=this.foldWidgets;if(!i||e&&i[t])return{};for(var n,s=t-1;s>=0;){var o=i[s];if(null==o&&(o=i[s]=this.getFoldWidget(s)),"start"==o){var r=this.getFoldWidgetRange(s);if(n||(n=r),r&&r.end.row>=t)break}s--}return{range:-1!==s&&r,firstRange:n}},this.onFoldWidgetClick=function(t,e){e instanceof a&&(e=e.domEvent);var i={children:e.shiftKey,all:e.ctrlKey||e.metaKey,siblings:e.altKey};if(!this.$toggleFoldWidget(t,i)){var n=e.target||e.srcElement;n&&/ace_fold-widget/.test(n.className)&&(n.className+=" ace_invalid")}},this.$toggleFoldWidget=function(t,e){if(this.getFoldWidget){var i=this.getFoldWidget(t),n=this.getLine(t),s="end"===i?-1:1,o=this.getFoldAt(t,-1===s?0:n.length,s);if(o)return e.children||e.all?this.removeFold(o):this.expandFold(o),o;var r=this.getFoldWidgetRange(t,!0);if(r&&!r.isMultiLine()&&(o=this.getFoldAt(r.start.row,r.start.column,1))&&r.isEqual(o.range))return this.removeFold(o),o;if(e.siblings){var a=this.getParentFoldRangeData(t);if(a.range)var l=a.range.start.row+1,h=a.range.end.row;this.foldAll(l,h,e.all?1e4:0)}else e.children?(h=r?r.end.row:this.getLength(),this.foldAll(t+1,h,e.all?1e4:0)):r&&(e.all&&(r.collapseChildren=1e4),this.addFold("...",r));return r}},this.toggleFoldWidget=function(t){var e=this.selection.getCursor().row;e=this.getRowFoldStart(e);var i=this.$toggleFoldWidget(e,{});if(!i){var n=this.getParentFoldRangeData(e,!0);if(i=n.range||n.firstRange){e=i.start.row;var s=this.getFoldAt(e,this.getLine(e).length,1);s?this.removeFold(s):this.addFold("...",i)}}},this.updateFoldWidgets=function(t){var e=t.start.row,i=t.end.row-e;if(0===i)this.foldWidgets[e]=null;else if("remove"==t.action)this.foldWidgets.splice(e,i+1,null);else{var n=Array(i+1);n.unshift(e,1),this.foldWidgets.splice.apply(this.foldWidgets,n)}},this.tokenizerUpdateFoldWidgets=function(t){var e=t.data;e.first!=e.last&&this.foldWidgets.length>e.first&&this.foldWidgets.splice(e.first,this.foldWidgets.length)}}})),ace.define("ace/edit_session/bracket_match",["require","exports","module","ace/token_iterator","ace/range"],(function(t,e,i){"use strict";var n=t("../token_iterator").TokenIterator,s=t("../range").Range;e.BracketMatch=function(){this.findMatchingBracket=function(t,e){if(0==t.column)return null;var i=e||this.getLine(t.row).charAt(t.column-1);if(""==i)return null;var n=i.match(/([\(\[\{])|([\)\]\}])/);return n?n[1]?this.$findClosingBracket(n[1],t):this.$findOpeningBracket(n[2],t):null},this.getBracketRange=function(t){var e,i=this.getLine(t.row),n=!0,o=i.charAt(t.column-1),r=o&&o.match(/([\(\[\{])|([\)\]\}])/);if(r||(o=i.charAt(t.column),t={row:t.row,column:t.column+1},r=o&&o.match(/([\(\[\{])|([\)\]\}])/),n=!1),!r)return null;if(r[1]){if(!(a=this.$findClosingBracket(r[1],t)))return null;e=s.fromPoints(t,a),n||(e.end.column++,e.start.column--),e.cursor=e.end}else{var a;if(!(a=this.$findOpeningBracket(r[2],t)))return null;e=s.fromPoints(a,t),n||(e.start.column++,e.end.column--),e.cursor=e.start}return e},this.getMatchingBracketRanges=function(t,e){var i=this.getLine(t.row),n=/([\(\[\{])|([\)\]\}])/,o=!e&&i.charAt(t.column-1),r=o&&o.match(n);if(r||(o=(void 0===e||e)&&i.charAt(t.column),t={row:t.row,column:t.column+1},r=o&&o.match(n)),!r)return null;var a=new s(t.row,t.column-1,t.row,t.column),l=r[1]?this.$findClosingBracket(r[1],t):this.$findOpeningBracket(r[2],t);return l?[a,new s(l.row,l.column,l.row,l.column+1)]:[a]},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{","<":">",">":"<"},this.$findOpeningBracket=function(t,e,i){var s=this.$brackets[t],o=1,r=new n(this,e.row,e.column),a=r.getCurrentToken();if(a||(a=r.stepForward()),a){i||(i=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)").replace(/-close\b/,"-(close|open)")+")+"));for(var l=e.column-r.getCurrentTokenColumn()-2,h=a.value;;){for(;l>=0;){var c=h.charAt(l);if(c==s){if(0==(o-=1))return{row:r.getCurrentTokenRow(),column:l+r.getCurrentTokenColumn()}}else c==t&&(o+=1);l-=1}do{a=r.stepBackward()}while(a&&!i.test(a.type));if(null==a)break;l=(h=a.value).length-1}return null}},this.$findClosingBracket=function(t,e,i){var s=this.$brackets[t],o=1,r=new n(this,e.row,e.column),a=r.getCurrentToken();if(a||(a=r.stepForward()),a){i||(i=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)").replace(/-open\b/,"-(close|open)")+")+"));for(var l=e.column-r.getCurrentTokenColumn();;){for(var h=a.value,c=h.length;l<c;){var d=h.charAt(l);if(d==s){if(0==(o-=1))return{row:r.getCurrentTokenRow(),column:l+r.getCurrentTokenColumn()}}else d==t&&(o+=1);l+=1}do{a=r.stepForward()}while(a&&!i.test(a.type));if(null==a)break;l=0}return null}},this.getMatchingTags=function(t){var e=new n(this,t.row,t.column),i=this.$findTagName(e);if(i)return"<"===e.stepBackward().value?this.$findClosingTag(e,i):this.$findOpeningTag(e,i)},this.$findTagName=function(t){var e=t.getCurrentToken(),i=!1,n=!1;if(e&&-1===e.type.indexOf("tag-name"))do{(e=n?t.stepBackward():t.stepForward())&&("/>"===e.value?n=!0:-1!==e.type.indexOf("tag-name")&&(i=!0))}while(e&&!i);return e},this.$findClosingTag=function(t,e){var i,n=e.value,o=e.value,r=0,a=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+1);e=t.stepForward();var l=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+e.value.length),h=!1;do{if(-1!==(i=e).type.indexOf("tag-close")&&!h){var c=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+1);h=!0}if(e=t.stepForward())if(">"!==e.value||h||(c=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+1),h=!0),-1!==e.type.indexOf("tag-name")){if(o===(n=e.value))if("<"===i.value)r++;else if("</"===i.value&&--r<0){t.stepBackward();var d=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+2);e=t.stepForward();var u=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+e.value.length);if(-1===e.type.indexOf("tag-close")&&(e=t.stepForward()),!e||">"!==e.value)return;var p=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+1)}}else o===n&&"/>"===e.value&&--r<0&&(p=u=d=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+2),c=new s(l.end.row,l.end.column,l.end.row,l.end.column+1))}while(e&&r>=0);if(a&&c&&d&&p&&l&&u)return{openTag:new s(a.start.row,a.start.column,c.end.row,c.end.column),closeTag:new s(d.start.row,d.start.column,p.end.row,p.end.column),openTagName:l,closeTagName:u}},this.$findOpeningTag=function(t,e){var i=t.getCurrentToken(),n=e.value,o=0,r=t.getCurrentTokenRow(),a=t.getCurrentTokenColumn(),l=a+2,h=new s(r,a,r,l);t.stepForward();var c=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+e.value.length);if(-1===e.type.indexOf("tag-close")&&(e=t.stepForward()),e&&">"===e.value){var d=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+1);t.stepBackward(),t.stepBackward();do{if(e=i,r=t.getCurrentTokenRow(),l=(a=t.getCurrentTokenColumn())+e.value.length,i=t.stepBackward(),e)if(-1!==e.type.indexOf("tag-name")){if(n===e.value)if("<"===i.value){if(++o>0){var u=new s(r,a,r,l),p=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+1);do{e=t.stepForward()}while(e&&">"!==e.value);var g=new s(t.getCurrentTokenRow(),t.getCurrentTokenColumn(),t.getCurrentTokenRow(),t.getCurrentTokenColumn()+1)}}else"</"===i.value&&o--}else if("/>"===e.value){for(var f=0,m=i;m;){if(-1!==m.type.indexOf("tag-name")&&m.value===n){o--;break}if("<"===m.value)break;m=t.stepBackward(),f++}for(var v=0;v<f;v++)t.stepForward()}}while(i&&o<=0);return p&&g&&h&&d&&u&&c?{openTag:new s(p.start.row,p.start.column,g.end.row,g.end.column),closeTag:new s(h.start.row,h.start.column,d.end.row,d.end.column),openTagName:u,closeTagName:c}:void 0}}}})),ace.define("ace/edit_session",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/bidihandler","ace/config","ace/lib/event_emitter","ace/selection","ace/mode/text","ace/range","ace/document","ace/background_tokenizer","ace/search_highlight","ace/undomanager","ace/edit_session/folding","ace/edit_session/bracket_match"],(function(t,e,i){"use strict";var n=t("./lib/oop"),s=t("./lib/lang"),o=t("./bidihandler").BidiHandler,r=t("./config"),a=t("./lib/event_emitter").EventEmitter,l=t("./selection").Selection,h=t("./mode/text").Mode,c=t("./range").Range,d=t("./document").Document,u=t("./background_tokenizer").BackgroundTokenizer,p=t("./search_highlight").SearchHighlight,g=t("./undomanager").UndoManager,f=function(){function t(e,i){this.doc,this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.id="session"+ ++t.$uid,this.$foldData.toString=function(){return this.join("\n")},this.bgTokenizer=new u((new h).getTokenizer(),this);var n=this;this.bgTokenizer.on("update",(function(t){n._signal("tokenizerUpdate",t)})),this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof e&&e.getLine||(e=new d(e)),this.setDocument(e),this.selection=new l(this),this.$bidiHandler=new o(this),r.resetOptions(this),this.setMode(i),r._signal("session",this),this.destroyed=!1}return t.prototype.setDocument=function(t){this.doc&&this.doc.off("change",this.$onChange),this.doc=t,t.on("change",this.$onChange,!0),this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},t.prototype.getDocument=function(){return this.doc},t.prototype.$resetRowCache=function(t){if(!t)return this.$docRowCache=[],void(this.$screenRowCache=[]);var e=this.$docRowCache.length,i=this.$getRowCacheIndex(this.$docRowCache,t)+1;e>i&&(this.$docRowCache.splice(i,e),this.$screenRowCache.splice(i,e))},t.prototype.$getRowCacheIndex=function(t,e){for(var i=0,n=t.length-1;i<=n;){var s=i+n>>1,o=t[s];if(e>o)i=s+1;else{if(!(e<o))return s;n=s-1}}return i-1},t.prototype.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.destroyed||this.bgTokenizer.start(0)},t.prototype.onChangeFold=function(t){var e=t.data;this.$resetRowCache(e.start.row)},t.prototype.onChange=function(t){this.$modified=!0,this.$bidiHandler.onChange(t),this.$resetRowCache(t.start.row);var e=this.$updateInternalDataOnChange(t);!this.$fromUndo&&this.$undoManager&&(e&&e.length&&(this.$undoManager.add({action:"removeFolds",folds:e},this.mergeUndoDeltas),this.mergeUndoDeltas=!0),this.$undoManager.add(t,this.mergeUndoDeltas),this.mergeUndoDeltas=!0,this.$informUndoManager.schedule()),this.bgTokenizer.$updateOnChange(t),this._signal("change",t)},t.prototype.setValue=function(t){this.doc.setValue(t),this.selection.moveTo(0,0),this.$resetRowCache(0),this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},t.fromJSON=function(e){"string"==typeof e&&(e=JSON.parse(e));var i=new g;i.$undoStack=e.history.undo,i.$redoStack=e.history.redo,i.mark=e.history.mark,i.$rev=e.history.rev;var n=new t(e.value);return e.folds.forEach((function(t){n.addFold("...",c.fromPoints(t.start,t.end))})),n.setAnnotations(e.annotations),n.setBreakpoints(e.breakpoints),n.setMode(e.mode),n.setScrollLeft(e.scrollLeft),n.setScrollTop(e.scrollTop),n.setUndoManager(i),n.selection.fromJSON(e.selection),n},t.prototype.toJSON=function(){return{annotations:this.$annotations,breakpoints:this.$breakpoints,folds:this.getAllFolds().map((function(t){return t.range})),history:this.getUndoManager(),mode:this.$mode.$id,scrollLeft:this.$scrollLeft,scrollTop:this.$scrollTop,selection:this.selection.toJSON(),value:this.doc.getValue()}},t.prototype.toString=function(){return this.doc.getValue()},t.prototype.getSelection=function(){return this.selection},t.prototype.getState=function(t){return this.bgTokenizer.getState(t)},t.prototype.getTokens=function(t){return this.bgTokenizer.getTokens(t)},t.prototype.getTokenAt=function(t,e){var i,n=this.bgTokenizer.getTokens(t),s=0;if(null==e){var o=n.length-1;s=this.getLine(t).length}else for(o=0;o<n.length&&!((s+=n[o].value.length)>=e);o++);return(i=n[o])?(i.index=o,i.start=s-i.value.length,i):null},t.prototype.setUndoManager=function(t){if(this.$undoManager=t,this.$informUndoManager&&this.$informUndoManager.cancel(),t){var e=this;t.addSession(this),this.$syncInformUndoManager=function(){e.$informUndoManager.cancel(),e.mergeUndoDeltas=!1},this.$informUndoManager=s.delayedCall(this.$syncInformUndoManager)}else this.$syncInformUndoManager=function(){}},t.prototype.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},t.prototype.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},t.prototype.getTabString=function(){return this.getUseSoftTabs()?s.stringRepeat(" ",this.getTabSize()):"\t"},t.prototype.setUseSoftTabs=function(t){this.setOption("useSoftTabs",t)},t.prototype.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},t.prototype.setTabSize=function(t){this.setOption("tabSize",t)},t.prototype.getTabSize=function(){return this.$tabSize},t.prototype.isTabStop=function(t){return this.$useSoftTabs&&t.column%this.$tabSize==0},t.prototype.setNavigateWithinSoftTabs=function(t){this.setOption("navigateWithinSoftTabs",t)},t.prototype.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs},t.prototype.setOverwrite=function(t){this.setOption("overwrite",t)},t.prototype.getOverwrite=function(){return this.$overwrite},t.prototype.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},t.prototype.addGutterDecoration=function(t,e){this.$decorations[t]||(this.$decorations[t]=""),this.$decorations[t]+=" "+e,this._signal("changeBreakpoint",{})},t.prototype.removeGutterDecoration=function(t,e){this.$decorations[t]=(this.$decorations[t]||"").replace(" "+e,""),this._signal("changeBreakpoint",{})},t.prototype.getBreakpoints=function(){return this.$breakpoints},t.prototype.setBreakpoints=function(t){this.$breakpoints=[];for(var e=0;e<t.length;e++)this.$breakpoints[t[e]]="ace_breakpoint";this._signal("changeBreakpoint",{})},t.prototype.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},t.prototype.setBreakpoint=function(t,e){void 0===e&&(e="ace_breakpoint"),e?this.$breakpoints[t]=e:delete this.$breakpoints[t],this._signal("changeBreakpoint",{})},t.prototype.clearBreakpoint=function(t){delete this.$breakpoints[t],this._signal("changeBreakpoint",{})},t.prototype.addMarker=function(t,e,i,n){var s=this.$markerId++,o={range:t,type:i||"line",renderer:"function"==typeof i?i:null,clazz:e,inFront:!!n,id:s};return n?(this.$frontMarkers[s]=o,this._signal("changeFrontMarker")):(this.$backMarkers[s]=o,this._signal("changeBackMarker")),s},t.prototype.addDynamicMarker=function(t,e){if(t.update){var i=this.$markerId++;return t.id=i,t.inFront=!!e,e?(this.$frontMarkers[i]=t,this._signal("changeFrontMarker")):(this.$backMarkers[i]=t,this._signal("changeBackMarker")),t}},t.prototype.removeMarker=function(t){var e=this.$frontMarkers[t]||this.$backMarkers[t];e&&(delete(e.inFront?this.$frontMarkers:this.$backMarkers)[t],this._signal(e.inFront?"changeFrontMarker":"changeBackMarker"))},t.prototype.getMarkers=function(t){return t?this.$frontMarkers:this.$backMarkers},t.prototype.highlight=function(t){if(!this.$searchHighlight){var e=new p(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(e)}this.$searchHighlight.setRegexp(t)},t.prototype.highlightLines=function(t,e,i,n){"number"!=typeof e&&(i=e,e=t),i||(i="ace_step");var s=new c(t,0,e,1/0);return s.id=this.addMarker(s,i,"fullLine",n),s},t.prototype.setAnnotations=function(t){this.$annotations=t,this._signal("changeAnnotation",{})},t.prototype.getAnnotations=function(){return this.$annotations||[]},t.prototype.clearAnnotations=function(){this.setAnnotations([])},t.prototype.$detectNewLine=function(t){var e=t.match(/^.*?(\r?\n)/m);this.$autoNewLine=e?e[1]:"\n"},t.prototype.getWordRange=function(t,e){var i=this.getLine(t),n=!1;if(e>0&&(n=!!i.charAt(e-1).match(this.tokenRe)),n||(n=!!i.charAt(e).match(this.tokenRe)),n)var s=this.tokenRe;else s=/^\s+$/.test(i.slice(e-1,e+1))?/\s/:this.nonTokenRe;var o=e;if(o>0){do{o--}while(o>=0&&i.charAt(o).match(s));o++}for(var r=e;r<i.length&&i.charAt(r).match(s);)r++;return new c(t,o,t,r)},t.prototype.getAWordRange=function(t,e){for(var i=this.getWordRange(t,e),n=this.getLine(i.end.row);n.charAt(i.end.column).match(/[ \t]/);)i.end.column+=1;return i},t.prototype.setNewLineMode=function(t){this.doc.setNewLineMode(t)},t.prototype.getNewLineMode=function(){return this.doc.getNewLineMode()},t.prototype.setUseWorker=function(t){this.setOption("useWorker",t)},t.prototype.getUseWorker=function(){return this.$useWorker},t.prototype.onReloadTokenizer=function(t){var e=t.data;this.bgTokenizer.start(e.first),this._signal("tokenizerUpdate",t)},t.prototype.setMode=function(t,e){if(t&&"object"==typeof t){if(t.getTokenizer)return this.$onChangeMode(t);var i=t,n=i.path}else n=t||"ace/mode/text";if(this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new h),this.$modes[n]&&!i)return this.$onChangeMode(this.$modes[n]),void(e&&e());this.$modeId=n,r.loadModule(["mode",n],function(t){if(this.$modeId!==n)return e&&e();this.$modes[n]&&!i?this.$onChangeMode(this.$modes[n]):t&&t.Mode&&(t=new t.Mode(i),i||(this.$modes[n]=t,t.$id=n),this.$onChangeMode(t)),e&&e()}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},t.prototype.$onChangeMode=function(t,e){if(e||(this.$modeId=t.$id),this.$mode!==t){var i=this.$mode;this.$mode=t,this.$stopWorker(),this.$useWorker&&this.$startWorker();var n=t.getTokenizer();if(void 0!==n.on){var s=this.onReloadTokenizer.bind(this);n.on("update",s)}this.bgTokenizer.setTokenizer(n),this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=t.tokenRe,this.nonTokenRe=t.nonTokenRe,e||(t.attachToSession&&t.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(t.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode",{oldMode:i,mode:t}))}},t.prototype.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},t.prototype.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(t){r.warn("Could not load worker",t),this.$worker=null}},t.prototype.getMode=function(){return this.$mode},t.prototype.setScrollTop=function(t){this.$scrollTop===t||isNaN(t)||(this.$scrollTop=t,this._signal("changeScrollTop",t))},t.prototype.getScrollTop=function(){return this.$scrollTop},t.prototype.setScrollLeft=function(t){this.$scrollLeft===t||isNaN(t)||(this.$scrollLeft=t,this._signal("changeScrollLeft",t))},t.prototype.getScrollLeft=function(){return this.$scrollLeft},t.prototype.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},t.prototype.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var t=0;return this.lineWidgets.forEach((function(e){e&&e.screenWidth>t&&(t=e.screenWidth)})),this.lineWidgetWidth=t},t.prototype.$computeWidth=function(t){if(this.$modified||t){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var e=this.doc.getAllLines(),i=this.$rowLengthCache,n=0,s=0,o=this.$foldData[s],r=o?o.start.row:1/0,a=e.length,l=0;l<a;l++){if(l>r){if((l=o.end.row+1)>=a)break;r=(o=this.$foldData[s++])?o.start.row:1/0}null==i[l]&&(i[l]=this.$getStringScreenWidth(e[l])[0]),i[l]>n&&(n=i[l])}this.screenWidth=n}},t.prototype.getLine=function(t){return this.doc.getLine(t)},t.prototype.getLines=function(t,e){return this.doc.getLines(t,e)},t.prototype.getLength=function(){return this.doc.getLength()},t.prototype.getTextRange=function(t){return this.doc.getTextRange(t||this.selection.getRange())},t.prototype.insert=function(t,e){return this.doc.insert(t,e)},t.prototype.remove=function(t){return this.doc.remove(t)},t.prototype.removeFullLines=function(t,e){return this.doc.removeFullLines(t,e)},t.prototype.undoChanges=function(t,e){if(t.length){this.$fromUndo=!0;for(var i=t.length-1;-1!=i;i--){var n=t[i];"insert"==n.action||"remove"==n.action?this.doc.revertDelta(n):n.folds&&this.addFolds(n.folds)}!e&&this.$undoSelect&&(t.selectionBefore?this.selection.fromJSON(t.selectionBefore):this.selection.setRange(this.$getUndoSelection(t,!0))),this.$fromUndo=!1}},t.prototype.redoChanges=function(t,e){if(t.length){this.$fromUndo=!0;for(var i=0;i<t.length;i++){var n=t[i];"insert"!=n.action&&"remove"!=n.action||this.doc.$safeApplyDelta(n)}!e&&this.$undoSelect&&(t.selectionAfter?this.selection.fromJSON(t.selectionAfter):this.selection.setRange(this.$getUndoSelection(t,!1))),this.$fromUndo=!1}},t.prototype.setUndoSelect=function(t){this.$undoSelect=t},t.prototype.$getUndoSelection=function(t,e){function i(t){return e?"insert"!==t.action:"insert"===t.action}for(var n,s,o=0;o<t.length;o++){var r=t[o];r.start&&(n?i(r)?(s=r.start,-1==n.compare(s.row,s.column)&&n.setStart(s),s=r.end,1==n.compare(s.row,s.column)&&n.setEnd(s)):(s=r.start,-1==n.compare(s.row,s.column)&&(n=c.fromPoints(r.start,r.start))):n=i(r)?c.fromPoints(r.start,r.end):c.fromPoints(r.start,r.start))}return n},t.prototype.replace=function(t,e){return this.doc.replace(t,e)},t.prototype.moveText=function(t,e,i){var n=this.getTextRange(t),s=this.getFoldsInRange(t),o=c.fromPoints(e,e);if(!i){this.remove(t);var r=t.start.row-t.end.row;(h=r?-t.end.column:t.start.column-t.end.column)&&(o.start.row==t.end.row&&o.start.column>t.end.column&&(o.start.column+=h),o.end.row==t.end.row&&o.end.column>t.end.column&&(o.end.column+=h)),r&&o.start.row>=t.end.row&&(o.start.row+=r,o.end.row+=r)}if(o.end=this.insert(o.start,n),s.length){var a=t.start,l=o.start,h=(r=l.row-a.row,l.column-a.column);this.addFolds(s.map((function(t){return(t=t.clone()).start.row==a.row&&(t.start.column+=h),t.end.row==a.row&&(t.end.column+=h),t.start.row+=r,t.end.row+=r,t})))}return o},t.prototype.indentRows=function(t,e,i){i=i.replace(/\t/g,this.getTabString());for(var n=t;n<=e;n++)this.doc.insertInLine({row:n,column:0},i)},t.prototype.outdentRows=function(t){for(var e=t.collapseRows(),i=new c(0,0,0,0),n=this.getTabSize(),s=e.start.row;s<=e.end.row;++s){var o=this.getLine(s);i.start.row=s,i.end.row=s;for(var r=0;r<n&&" "==o.charAt(r);++r);r<n&&"\t"==o.charAt(r)?(i.start.column=r,i.end.column=r+1):(i.start.column=0,i.end.column=r),this.remove(i)}},t.prototype.$moveLines=function(t,e,i){if(t=this.getRowFoldStart(t),e=this.getRowFoldEnd(e),i<0){if((s=this.getRowFoldStart(t+i))<0)return 0;var n=s-t}else if(i>0){var s;if((s=this.getRowFoldEnd(e+i))>this.doc.getLength()-1)return 0;n=s-e}else t=this.$clipRowToDocument(t),n=(e=this.$clipRowToDocument(e))-t+1;var o=new c(t,0,e,Number.MAX_VALUE),r=this.getFoldsInRange(o).map((function(t){return(t=t.clone()).start.row+=n,t.end.row+=n,t})),a=0==i?this.doc.getLines(t,e):this.doc.removeFullLines(t,e);return this.doc.insertFullLines(t+n,a),r.length&&this.addFolds(r),n},t.prototype.moveLinesUp=function(t,e){return this.$moveLines(t,e,-1)},t.prototype.moveLinesDown=function(t,e){return this.$moveLines(t,e,1)},t.prototype.duplicateLines=function(t,e){return this.$moveLines(t,e,0)},t.prototype.$clipRowToDocument=function(t){return Math.max(0,Math.min(t,this.doc.getLength()-1))},t.prototype.$clipColumnToRow=function(t,e){return e<0?0:Math.min(this.doc.getLine(t).length,e)},t.prototype.$clipPositionToDocument=function(t,e){if(e=Math.max(0,e),t<0)t=0,e=0;else{var i=this.doc.getLength();t>=i?(t=i-1,e=this.doc.getLine(i-1).length):e=Math.min(this.doc.getLine(t).length,e)}return{row:t,column:e}},t.prototype.$clipRangeToDocument=function(t){t.start.row<0?(t.start.row=0,t.start.column=0):t.start.column=this.$clipColumnToRow(t.start.row,t.start.column);var e=this.doc.getLength()-1;return t.end.row>e?(t.end.row=e,t.end.column=this.doc.getLine(e).length):t.end.column=this.$clipColumnToRow(t.end.row,t.end.column),t},t.prototype.setUseWrapMode=function(t){if(t!=this.$useWrapMode){if(this.$useWrapMode=t,this.$modified=!0,this.$resetRowCache(0),t){var e=this.getLength();this.$wrapData=Array(e),this.$updateWrapData(0,e-1)}this._signal("changeWrapMode")}},t.prototype.getUseWrapMode=function(){return this.$useWrapMode},t.prototype.setWrapLimitRange=function(t,e){this.$wrapLimitRange.min===t&&this.$wrapLimitRange.max===e||(this.$wrapLimitRange={min:t,max:e},this.$modified=!0,this.$bidiHandler.markAsDirty(),this.$useWrapMode&&this._signal("changeWrapMode"))},t.prototype.adjustWrapLimit=function(t,e){var i=this.$wrapLimitRange;i.max<0&&(i={min:e,max:e});var n=this.$constrainWrapLimit(t,i.min,i.max);return n!=this.$wrapLimit&&n>1&&(this.$wrapLimit=n,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0)},t.prototype.$constrainWrapLimit=function(t,e,i){return e&&(t=Math.max(e,t)),i&&(t=Math.min(i,t)),t},t.prototype.getWrapLimit=function(){return this.$wrapLimit},t.prototype.setWrapLimit=function(t){this.setWrapLimitRange(t,t)},t.prototype.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},t.prototype.$updateInternalDataOnChange=function(t){var e=this.$useWrapMode,i=t.action,n=t.start,s=t.end,o=n.row,r=s.row,a=r-o,l=null;if(this.$updating=!0,0!=a)if("remove"===i){this[e?"$wrapData":"$rowLengthCache"].splice(o,a);var h=this.$foldData;l=this.getFoldsInRange(t),this.removeFolds(l);var c=0;if(f=this.getFoldLine(s.row)){f.addRemoveChars(s.row,s.column,n.column-s.column),f.shiftRow(-a);var d=this.getFoldLine(o);d&&d!==f&&(d.merge(f),f=d),c=h.indexOf(f)+1}for(;c<h.length;c++)(f=h[c]).start.row>=s.row&&f.shiftRow(-a);r=o}else{var u=Array(a);u.unshift(o,0);var p=e?this.$wrapData:this.$rowLengthCache;if(p.splice.apply(p,u),h=this.$foldData,c=0,f=this.getFoldLine(o)){var g=f.range.compareInside(n.row,n.column);0==g?(f=f.split(n.row,n.column))&&(f.shiftRow(a),f.addRemoveChars(r,0,s.column-n.column)):-1==g&&(f.addRemoveChars(o,0,s.column-n.column),f.shiftRow(a)),c=h.indexOf(f)+1}for(;c<h.length;c++){var f;(f=h[c]).start.row>=o&&f.shiftRow(a)}}else a=Math.abs(t.start.column-t.end.column),"remove"===i&&(l=this.getFoldsInRange(t),this.removeFolds(l),a=-a),(f=this.getFoldLine(o))&&f.addRemoveChars(o,n.column,a);return e&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,e?this.$updateWrapData(o,r):this.$updateRowLengthCache(o,r),l},t.prototype.$updateRowLengthCache=function(t,e){this.$rowLengthCache[t]=null,this.$rowLengthCache[e]=null},t.prototype.$updateWrapData=function(t,e){var i,n,s=this.doc.getAllLines(),o=this.getTabSize(),r=this.$wrapData,a=this.$wrapLimit,l=t;for(e=Math.min(e,s.length-1);l<=e;)(n=this.getFoldLine(l,n))?(i=[],n.walk(function(t,e,n,o){var r;if(null!=t){(r=this.$getDisplayTokens(t,i.length))[0]=_;for(var a=1;a<r.length;a++)r[a]=y}else r=this.$getDisplayTokens(s[e].substring(o,n),i.length);i=i.concat(r)}.bind(this),n.end.row,s[n.end.row].length+1),r[n.start.row]=this.$computeWrapSplits(i,a,o),l=n.end.row+1):(i=this.$getDisplayTokens(s[l]),r[l]=this.$computeWrapSplits(i,a,o),l++)},t.prototype.$computeWrapSplits=function(t,e,i){if(0==t.length)return[];var n=[],s=t.length,o=0,r=0,a=this.$wrapAsCode,l=this.$indentedSoftWrap,h=e<=Math.max(2*i,8)||!1===l?0:Math.floor(e/2);function c(e){for(var s=e-o,c=o;c<e;c++){var u=t[c];12!==u&&2!==u||(s-=1)}n.length||(d=function(){var e=0;if(0===h)return e;if(l)for(var n=0;n<t.length;n++){var s=t[n];if(s==x)e+=1;else{if(s!=b){if(s==C)continue;break}e+=i}}return a&&!1!==l&&(e+=i),Math.min(e,h)}(),n.indent=d),r+=s,n.push(r),o=e}for(var d=0;s-o>e-d;){var u=o+e-d;if(t[u-1]>=x&&t[u]>=x)c(u);else if(t[u]!=_&&t[u]!=y){for(var p=Math.max(u-(e-(e>>2)),o-1);u>p&&t[u]<_;)u--;if(a){for(;u>p&&t[u]<_;)u--;for(;u>p&&t[u]==w;)u--}else for(;u>p&&t[u]<x;)u--;u>p?c(++u):(t[u=o+e]==v&&u--,c(u-d))}else{for(;u!=o-1&&t[u]!=_;u--);if(u>o){c(u);continue}for(u=o+e;u<t.length&&t[u]==y;u++);if(u==t.length)break;c(u)}}return n},t.prototype.$getDisplayTokens=function(t,e){var i,n=[];e=e||0;for(var s=0;s<t.length;s++){var o=t.charCodeAt(s);if(9==o){i=this.getScreenTabSize(n.length+e),n.push(b);for(var r=1;r<i;r++)n.push(C)}else 32==o?n.push(x):o>39&&o<48||o>57&&o<64?n.push(w):o>=4352&&A(o)?n.push(m,v):n.push(m)}return n},t.prototype.$getStringScreenWidth=function(t,e,i){if(0==e)return[0,0];var n,s;for(null==e&&(e=1/0),i=i||0,s=0;s<t.length&&(9==(n=t.charCodeAt(s))?i+=this.getScreenTabSize(i):n>=4352&&A(n)?i+=2:i+=1,!(i>e));s++);return[i,s]},t.prototype.getRowLength=function(t){var e=1;return this.lineWidgets&&(e+=this.lineWidgets[t]&&this.lineWidgets[t].rowCount||0),this.$useWrapMode&&this.$wrapData[t]?this.$wrapData[t].length+e:e},t.prototype.getRowLineCount=function(t){return this.$useWrapMode&&this.$wrapData[t]?this.$wrapData[t].length+1:1},t.prototype.getRowWrapIndent=function(t){if(this.$useWrapMode){var e=this.screenToDocumentPosition(t,Number.MAX_VALUE),i=this.$wrapData[e.row];return i.length&&i[0]<e.column?i.indent:0}return 0},t.prototype.getScreenLastRowColumn=function(t){var e=this.screenToDocumentPosition(t,Number.MAX_VALUE);return this.documentToScreenColumn(e.row,e.column)},t.prototype.getDocumentLastRowColumn=function(t,e){var i=this.documentToScreenRow(t,e);return this.getScreenLastRowColumn(i)},t.prototype.getDocumentLastRowColumnPosition=function(t,e){var i=this.documentToScreenRow(t,e);return this.screenToDocumentPosition(i,Number.MAX_VALUE/10)},t.prototype.getRowSplitData=function(t){return this.$useWrapMode?this.$wrapData[t]:void 0},t.prototype.getScreenTabSize=function(t){return this.$tabSize-(t%this.$tabSize|0)},t.prototype.screenToDocumentRow=function(t,e){return this.screenToDocumentPosition(t,e).row},t.prototype.screenToDocumentColumn=function(t,e){return this.screenToDocumentPosition(t,e).column},t.prototype.screenToDocumentPosition=function(t,e,i){if(t<0)return{row:0,column:0};var n,s,o=0,r=0,a=0,l=0,h=this.$screenRowCache,c=this.$getRowCacheIndex(h,t),d=h.length;if(d&&c>=0){a=h[c],o=this.$docRowCache[c];var u=t>h[d-1]}else u=!d;for(var p=this.getLength()-1,g=this.getNextFoldLine(o),f=g?g.start.row:1/0;a<=t&&!(a+(l=this.getRowLength(o))>t||o>=p);)a+=l,++o>f&&(o=g.end.row+1,f=(g=this.getNextFoldLine(o,g))?g.start.row:1/0),u&&(this.$docRowCache.push(o),this.$screenRowCache.push(a));if(g&&g.start.row<=o)n=this.getFoldDisplayLine(g),o=g.start.row;else{if(a+l<=t||o>p)return{row:p,column:this.getLine(p).length};n=this.getLine(o),g=null}var m=0,v=Math.floor(t-a);if(this.$useWrapMode){var _=this.$wrapData[o];_&&(s=_[v],v>0&&_.length&&(m=_.indent,r=_[v-1]||_[_.length-1],n=n.substring(r)))}return void 0!==i&&this.$bidiHandler.isBidiRow(a+v,o,v)&&(e=this.$bidiHandler.offsetToCol(i)),r+=this.$getStringScreenWidth(n,e-m)[1],this.$useWrapMode&&r>=s&&(r=s-1),g?g.idxToPosition(r):{row:o,column:r}},t.prototype.documentToScreenPosition=function(t,e){if(void 0===e)var i=this.$clipPositionToDocument(t.row,t.column);else i=this.$clipPositionToDocument(t,e);t=i.row,e=i.column;var n,s=0,o=null;(n=this.getFoldAt(t,e,1))&&(t=n.start.row,e=n.start.column);var r,a=0,l=this.$docRowCache,h=this.$getRowCacheIndex(l,t),c=l.length;if(c&&h>=0){a=l[h],s=this.$screenRowCache[h];var d=t>l[c-1]}else d=!c;for(var u=this.getNextFoldLine(a),p=u?u.start.row:1/0;a<t;){if(a>=p){if((r=u.end.row+1)>t)break;p=(u=this.getNextFoldLine(r,u))?u.start.row:1/0}else r=a+1;s+=this.getRowLength(a),a=r,d&&(this.$docRowCache.push(a),this.$screenRowCache.push(s))}var g="";u&&a>=p?(g=this.getFoldDisplayLine(u,t,e),o=u.start.row):(g=this.getLine(t).substring(0,e),o=t);var f=0;if(this.$useWrapMode){var m=this.$wrapData[o];if(m){for(var v=0;g.length>=m[v];)s++,v++;g=g.substring(m[v-1]||0,g.length),f=v>0?m.indent:0}}return this.lineWidgets&&this.lineWidgets[a]&&this.lineWidgets[a].rowsAbove&&(s+=this.lineWidgets[a].rowsAbove),{row:s,column:f+this.$getStringScreenWidth(g)[0]}},t.prototype.documentToScreenColumn=function(t,e){return this.documentToScreenPosition(t,e).column},t.prototype.documentToScreenRow=function(t,e){return this.documentToScreenPosition(t,e).row},t.prototype.getScreenLength=function(){var t=0,e=null;if(this.$useWrapMode)for(var i=this.$wrapData.length,n=0,s=(a=0,(e=this.$foldData[a++])?e.start.row:1/0);n<i;){var o=this.$wrapData[n];t+=o?o.length+1:1,++n>s&&(n=e.end.row+1,s=(e=this.$foldData[a++])?e.start.row:1/0)}else{t=this.getLength();for(var r=this.$foldData,a=0;a<r.length;a++)t-=(e=r[a]).end.row-e.start.row}return this.lineWidgets&&(t+=this.$getWidgetScreenLength()),t},t.prototype.$setFontMetrics=function(t){this.$enableVarChar&&(this.$getStringScreenWidth=function(e,i,n){if(0===i)return[0,0];var s,o;for(i||(i=1/0),n=n||0,o=0;o<e.length&&!((n+="\t"===(s=e.charAt(o))?this.getScreenTabSize(n):t.getCharacterWidth(s))>i);o++);return[n,o]})},t.prototype.getPrecedingCharacter=function(){var t=this.selection.getCursor();return 0===t.column?0===t.row?"":this.doc.getNewLineCharacter():this.getLine(t.row)[t.column-1]},t.prototype.destroy=function(){this.destroyed||(this.bgTokenizer.setDocument(null),this.bgTokenizer.cleanup(),this.destroyed=!0),this.$stopWorker(),this.removeAllListeners(),this.doc&&this.doc.off("change",this.$onChange),this.selection.detach()},t}();f.$uid=0,f.prototype.$modes=r.$modes,f.prototype.getValue=f.prototype.toString,f.prototype.$defaultUndoManager={undo:function(){},redo:function(){},hasUndo:function(){},hasRedo:function(){},reset:function(){},add:function(){},addSelection:function(){},startNewGroup:function(){},addSession:function(){}},f.prototype.$overwrite=!1,f.prototype.$mode=null,f.prototype.$modeId=null,f.prototype.$scrollTop=0,f.prototype.$scrollLeft=0,f.prototype.$wrapLimit=80,f.prototype.$useWrapMode=!1,f.prototype.$wrapLimitRange={min:null,max:null},f.prototype.lineWidgets=null,f.prototype.isFullWidth=A,n.implement(f.prototype,a);var m=1,v=2,_=3,y=4,w=9,x=10,b=11,C=12;function A(t){return!(t<4352)&&(t>=4352&&t<=4447||t>=4515&&t<=4519||t>=4602&&t<=4607||t>=9001&&t<=9002||t>=11904&&t<=11929||t>=11931&&t<=12019||t>=12032&&t<=12245||t>=12272&&t<=12283||t>=12288&&t<=12350||t>=12353&&t<=12438||t>=12441&&t<=12543||t>=12549&&t<=12589||t>=12593&&t<=12686||t>=12688&&t<=12730||t>=12736&&t<=12771||t>=12784&&t<=12830||t>=12832&&t<=12871||t>=12880&&t<=13054||t>=13056&&t<=19903||t>=19968&&t<=42124||t>=42128&&t<=42182||t>=43360&&t<=43388||t>=44032&&t<=55203||t>=55216&&t<=55238||t>=55243&&t<=55291||t>=63744&&t<=64255||t>=65040&&t<=65049||t>=65072&&t<=65106||t>=65108&&t<=65126||t>=65128&&t<=65131||t>=65281&&t<=65376||t>=65504&&t<=65510)}t("./edit_session/folding").Folding.call(f.prototype),t("./edit_session/bracket_match").BracketMatch.call(f.prototype),r.defineOptions(f.prototype,"session",{wrap:{set:function(t){if(t&&"off"!=t?"free"==t?t=!0:"printMargin"==t?t=-1:"string"==typeof t&&(t=parseInt(t,10)||!1):t=!1,this.$wrap!=t)if(this.$wrap=t,t){var e="number"==typeof t?t:null;this.setWrapLimitRange(e,e),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1)},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(t){(t="auto"==t?"text"!=this.$mode.type:"text"!=t)!=this.$wrapAsCode&&(this.$wrapAsCode=t,this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0)))},initialValue:"auto"},indentedSoftWrap:{set:function(){this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0))},initialValue:!0},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(t){this.$useWorker=t,this.$stopWorker(),t&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(t){(t=parseInt(t))>0&&this.$tabSize!==t&&(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=t,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},navigateWithinSoftTabs:{initialValue:!1},foldStyle:{set:function(t){this.setFoldStyle(t)},handlesSet:!0},overwrite:{set:function(t){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(t){this.doc.setNewLineMode(t)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(t){this.setMode(t)},get:function(){return this.$modeId},handlesSet:!0}}),e.EditSession=f})),ace.define("ace/search",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],(function(t,e,i){"use strict";var n=t("./lib/lang"),s=t("./lib/oop"),o=t("./range").Range,r=function(){function t(){this.$options={}}return t.prototype.set=function(t){return s.mixin(this.$options,t),this},t.prototype.getOptions=function(){return n.copyObject(this.$options)},t.prototype.setOptions=function(t){this.$options=t},t.prototype.find=function(t){var e=this.$options,i=this.$matchIterator(t,e);if(!i)return!1;var n=null;return i.forEach((function(t,i,s,r){return n=new o(t,i,s,r),!(i==r&&e.start&&e.start.start&&0!=e.skipCurrent&&n.isEqual(e.start)&&(n=null,1))})),n},t.prototype.findAll=function(t){var e=this.$options;if(!e.needle)return[];this.$assembleRegExp(e);var i=e.range,s=i?t.getLines(i.start.row,i.end.row):t.doc.getAllLines(),r=[],a=e.re;if(e.$isMultiLine){var l,h=a.length,c=s.length-h;t:for(var d=a.offset||0;d<=c;d++){for(var u=0;u<h;u++)if(-1==s[d+u].search(a[u]))continue t;var p=s[d],g=s[d+h-1],f=p.length-p.match(a[0])[0].length,m=g.match(a[h-1])[0].length;l&&l.end.row===d&&l.end.column>f||(r.push(l=new o(d,f,d+h-1,m)),h>2&&(d=d+h-2))}}else for(var v=0;v<s.length;v++){var _=n.getMatchOffsets(s[v],a);for(u=0;u<_.length;u++){var y=_[u];r.push(new o(v,y.offset,v,y.offset+y.length))}}if(i){var w=i.start.column,x=i.end.column;for(v=0,u=r.length-1;v<u&&r[v].start.column<w&&0==r[v].start.row;)v++;for(var b=i.end.row-i.start.row;v<u&&r[u].end.column>x&&r[u].end.row==b;)u--;for(r=r.slice(v,u+1),v=0,u=r.length;v<u;v++)r[v].start.row+=i.start.row,r[v].end.row+=i.start.row}return r},t.prototype.replace=function(t,e){var i=this.$options,n=this.$assembleRegExp(i);if(i.$isMultiLine)return e;if(n){var s=n.exec(t);if(!s||s[0].length!=t.length)return null;if(i.regExp||(e=e.replace(/\$/g,"$$$$")),e=t.replace(n,e),i.preserveCase){e=e.split("");for(var o=Math.min(t.length,t.length);o--;){var r=t[o];r&&r.toLowerCase()!=r?e[o]=e[o].toUpperCase():e[o]=e[o].toLowerCase()}e=e.join("")}return e}},t.prototype.$assembleRegExp=function(t,e){if(t.needle instanceof RegExp)return t.re=t.needle;var i=t.needle;if(!t.needle)return t.re=!1;t.regExp||(i=n.escapeRegExp(i));var s=t.caseSensitive?"gm":"gmi";try{new RegExp(i,"u"),t.$supportsUnicodeFlag=!0,s+="u"}catch(e){t.$supportsUnicodeFlag=!1}if(t.wholeWord&&(i=function(t,e){var i=n.supportsLookbehind();function s(t,n){return void 0===n&&(n=!0),(i&&e.$supportsUnicodeFlag?new RegExp("[\\p{L}\\p{N}_]","u"):new RegExp("\\w")).test(t)||e.regExp?i&&e.$supportsUnicodeFlag?n?"(?<=^|[^\\p{L}\\p{N}_])":"(?=[^\\p{L}\\p{N}_]|$)":"\\b":""}var o=Array.from(t),r=o[0],a=o[o.length-1];return s(r)+t+s(a,!1)}(i,t)),t.$isMultiLine=!e&&/[\n\r]/.test(i),t.$isMultiLine)return t.re=this.$assembleMultilineRegExp(i,s);try{var o=new RegExp(i,s)}catch(t){o=!1}return t.re=o},t.prototype.$assembleMultilineRegExp=function(t,e){for(var i=t.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),n=[],s=0;s<i.length;s++)try{n.push(new RegExp(i[s],e))}catch(t){return!1}return n},t.prototype.$matchIterator=function(t,e){var i=this.$assembleRegExp(e);if(!i)return!1;var s=1==e.backwards,o=0!=e.skipCurrent,r=i.unicode,a=e.range,l=e.start;l||(l=a?a[s?"end":"start"]:t.selection.getRange()),l.start&&(l=l[o!=s?"end":"start"]);var h=a?a.start.row:0,c=a?a.end.row:t.getLength()-1;if(s)var d=function(t){var i=l.row;if(!p(i,l.column,t)){for(i--;i>=h;i--)if(p(i,Number.MAX_VALUE,t))return;if(0!=e.wrap)for(i=c,h=l.row;i>=h;i--)if(p(i,Number.MAX_VALUE,t))return}};else d=function(t){var i=l.row;if(!p(i,l.column,t)){for(i+=1;i<=c;i++)if(p(i,0,t))return;if(0!=e.wrap)for(i=h,c=l.row;i<=c;i++)if(p(i,0,t))return}};if(e.$isMultiLine)var u=i.length,p=function(e,n,o){var r=s?e-u+1:e;if(!(r<0||r+u>t.getLength())){var a=t.getLine(r),l=a.search(i[0]);if(!(!s&&l<n||-1===l)){for(var h=1;h<u;h++)if(-1==(a=t.getLine(r+h)).search(i[h]))return;var c=a.match(i[u-1])[0].length;if(!(s&&c>n))return!!o(r,l,r+u-1,c)||void 0}}};else p=s?function(e,s,o){var a,l=t.getLine(e),h=[],c=0;for(i.lastIndex=0;a=i.exec(l);){var d=a[0].length;if(c=a.index,!d){if(c>=l.length)break;i.lastIndex=c+=n.skipEmptyMatch(l,c,r)}if(a.index+d>s)break;h.push(a.index,d)}for(var u=h.length-1;u>=0;u-=2){var p=h[u-1];if(o(e,p,e,p+(d=h[u])))return!0}}:function(e,s,o){var a,l,h=t.getLine(e);for(i.lastIndex=s;l=i.exec(h);){var c=l[0].length;if(o(e,a=l.index,e,a+c))return!0;if(!c&&(i.lastIndex=a+=n.skipEmptyMatch(h,a,r),a>=h.length))return!1}};return{forEach:d}},t}();e.Search=r})),ace.define("ace/keyboard/hash_handler",["require","exports","module","ace/lib/keys","ace/lib/useragent"],(function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=t("../lib/keys"),r=t("../lib/useragent"),a=o.KEY_MODS,l=function(){function t(t,e){this.$init(t,e,!1)}return t.prototype.$init=function(t,e,i){this.platform=e||(r.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(t),this.$singleCommand=i},t.prototype.addCommand=function(t){this.commands[t.name]&&this.removeCommand(t),this.commands[t.name]=t,t.bindKey&&this._buildKeyHash(t)},t.prototype.removeCommand=function(t,e){var i=t&&("string"==typeof t?t:t.name);t=this.commands[i],e||delete this.commands[i];var n=this.commandKeyBinding;for(var s in n){var o=n[s];if(o==t)delete n[s];else if(Array.isArray(o)){var r=o.indexOf(t);-1!=r&&(o.splice(r,1),1==o.length&&(n[s]=o[0]))}}},t.prototype.bindKey=function(t,e,i){if("object"==typeof t&&t&&(null==i&&(i=t.position),t=t[this.platform]),t)return"function"==typeof e?this.addCommand({exec:e,bindKey:t,name:e.name||t}):void t.split("|").forEach((function(t){var n="";if(-1!=t.indexOf(" ")){var s=t.split(/\s+/);t=s.pop(),s.forEach((function(t){var e=this.parseKeys(t),i=a[e.hashId]+e.key;n+=(n?" ":"")+i,this._addCommandToBinding(n,"chainKeys")}),this),n+=" "}var o=this.parseKeys(t),r=a[o.hashId]+o.key;this._addCommandToBinding(n+r,e,i)}),this)},t.prototype._addCommandToBinding=function(t,e,i){var n,s=this.commandKeyBinding;if(e)if(!s[t]||this.$singleCommand)s[t]=e;else{Array.isArray(s[t])?-1!=(n=s[t].indexOf(e))&&s[t].splice(n,1):s[t]=[s[t]],"number"!=typeof i&&(i=h(e));var o=s[t];for(n=0;n<o.length&&!(h(o[n])>i);n++);o.splice(n,0,e)}else delete s[t]},t.prototype.addCommands=function(t){t&&Object.keys(t).forEach((function(e){var i=t[e];if(i){if("string"==typeof i)return this.bindKey(i,e);"function"==typeof i&&(i={exec:i}),"object"==typeof i&&(i.name||(i.name=e),this.addCommand(i))}}),this)},t.prototype.removeCommands=function(t){Object.keys(t).forEach((function(e){this.removeCommand(t[e])}),this)},t.prototype.bindKeys=function(t){Object.keys(t).forEach((function(e){this.bindKey(e,t[e])}),this)},t.prototype._buildKeyHash=function(t){this.bindKey(t.bindKey,t)},t.prototype.parseKeys=function(t){var e=t.toLowerCase().split(/[\-\+]([\-\+])?/).filter((function(t){return t})),i=e.pop(),n=o[i];if(o.FUNCTION_KEYS[n])i=o.FUNCTION_KEYS[n].toLowerCase();else{if(!e.length)return{key:i,hashId:-1};if(1==e.length&&"shift"==e[0])return{key:i.toUpperCase(),hashId:-1}}for(var s=0,r=e.length;r--;){var a=o.KEY_MODS[e[r]];if(null==a)return"undefined"!=typeof console&&console.error("invalid modifier "+e[r]+" in "+t),!1;s|=a}return{key:i,hashId:s}},t.prototype.findKeyCommand=function(t,e){var i=a[t]+e;return this.commandKeyBinding[i]},t.prototype.handleKeyboard=function(t,e,i,n){if(!(n<0)){var s=a[e]+i,o=this.commandKeyBinding[s];return t.$keyChain&&(t.$keyChain+=" "+s,o=this.commandKeyBinding[t.$keyChain]||o),!o||"chainKeys"!=o&&"chainKeys"!=o[o.length-1]?(t.$keyChain&&(e&&4!=e||1!=i.length?(-1==e||n>0)&&(t.$keyChain=""):t.$keyChain=t.$keyChain.slice(0,-s.length-1)),{command:o}):(t.$keyChain=t.$keyChain||s,{command:"null"})}},t.prototype.getStatusText=function(t,e){return e.$keyChain||""},t}();function h(t){return"object"==typeof t&&t.bindKey&&t.bindKey.position||(t.isDefault?-100:0)}var c=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.$singleCommand=!0,n}return s(e,t),e}(l);c.call=function(t,e,i){l.prototype.$init.call(t,e,i,!0)},l.call=function(t,e,i){l.prototype.$init.call(t,e,i,!1)},e.HashHandler=c,e.MultiHashHandler=l})),ace.define("ace/commands/command_manager",["require","exports","module","ace/lib/oop","ace/keyboard/hash_handler","ace/lib/event_emitter"],(function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=t("../lib/oop"),r=t("../keyboard/hash_handler").MultiHashHandler,a=t("../lib/event_emitter").EventEmitter,l=function(t){function e(e,i){var n=t.call(this,i,e)||this;return n.byName=n.commands,n.setDefaultHandler("exec",(function(t){return t.args?t.command.exec(t.editor,t.args,t.event,!1):t.command.exec(t.editor,{},t.event,!0)})),n}return s(e,t),e.prototype.exec=function(t,e,i){if(Array.isArray(t)){for(var n=t.length;n--;)if(this.exec(t[n],e,i))return!0;return!1}if("string"==typeof t&&(t=this.commands[t]),!this.canExecute(t,e))return!1;var s={editor:e,command:t,args:i};return s.returnValue=this._emit("exec",s),this._signal("afterExec",s),!1!==s.returnValue},e.prototype.canExecute=function(t,e){return"string"==typeof t&&(t=this.commands[t]),!(!t||e&&e.$readOnly&&!t.readOnly||0!=this.$checkCommandState&&t.isAvailable&&!t.isAvailable(e))},e.prototype.toggleRecording=function(t){if(!this.$inReplay)return t&&t._emit("changeStatus"),this.recording?(this.macro.pop(),this.off("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(t){this.macro.push([t.command,t.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},e.prototype.replay=function(t){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(t);try{this.$inReplay=!0,this.macro.forEach((function(e){"string"==typeof e?this.exec(e,t):this.exec(e[0],t,e[1])}),this)}finally{this.$inReplay=!1}}},e.prototype.trimMacro=function(t){return t.map((function(t){return"string"!=typeof t[0]&&(t[0]=t[0].name),t[1]||(t=t[0]),t}))},e}(r);o.implement(l.prototype,a),e.CommandManager=l})),ace.define("ace/commands/default_commands",["require","exports","module","ace/lib/lang","ace/config","ace/range"],(function(t,e,i){"use strict";var n=t("../lib/lang"),s=t("../config"),o=t("../range").Range;function r(t,e){return{win:t,mac:e}}e.commands=[{name:"showSettingsMenu",description:"Show settings menu",bindKey:r("Ctrl-,","Command-,"),exec:function(t){s.loadModule("ace/ext/settings_menu",(function(e){e.init(t),t.showSettingsMenu()}))},readOnly:!0},{name:"goToNextError",description:"Go to next error",bindKey:r("Alt-E","F4"),exec:function(t){s.loadModule("ace/ext/error_marker",(function(e){e.showErrorMarker(t,1)}))},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",description:"Go to previous error",bindKey:r("Alt-Shift-E","Shift-F4"),exec:function(t){s.loadModule("ace/ext/error_marker",(function(e){e.showErrorMarker(t,-1)}))},scrollIntoView:"animate",readOnly:!0},{name:"selectall",description:"Select all",bindKey:r("Ctrl-A","Command-A"),exec:function(t){t.selectAll()},readOnly:!0},{name:"centerselection",description:"Center selection",bindKey:r(null,"Ctrl-L"),exec:function(t){t.centerSelection()},readOnly:!0},{name:"gotoline",description:"Go to line...",bindKey:r("Ctrl-L","Command-L"),exec:function(t,e){"number"!=typeof e||isNaN(e)||t.gotoLine(e),t.prompt({$type:"gotoLine"})},readOnly:!0},{name:"fold",bindKey:r("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(t){t.session.toggleFold(!1)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:r("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(t){t.session.toggleFold(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",description:"Toggle fold widget",bindKey:r("F2","F2"),exec:function(t){t.session.toggleFoldWidget()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",description:"Toggle parent fold widget",bindKey:r("Alt-F2","Alt-F2"),exec:function(t){t.session.toggleFoldWidget(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"foldall",description:"Fold all",bindKey:r(null,"Ctrl-Command-Option-0"),exec:function(t){t.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldAllComments",description:"Fold all comments",bindKey:r(null,"Ctrl-Command-Option-0"),exec:function(t){t.session.foldAllComments()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",description:"Fold other",bindKey:r("Alt-0","Command-Option-0"),exec:function(t){t.session.foldAll(),t.session.unfold(t.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",description:"Unfold all",bindKey:r("Alt-Shift-0","Command-Option-Shift-0"),exec:function(t){t.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",description:"Find next",bindKey:r("Ctrl-K","Command-G"),exec:function(t){t.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",description:"Find previous",bindKey:r("Ctrl-Shift-K","Command-Shift-G"),exec:function(t){t.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",description:"Select or find next",bindKey:r("Alt-K","Ctrl-G"),exec:function(t){t.selection.isEmpty()?t.selection.selectWord():t.findNext()},readOnly:!0},{name:"selectOrFindPrevious",description:"Select or find previous",bindKey:r("Alt-Shift-K","Ctrl-Shift-G"),exec:function(t){t.selection.isEmpty()?t.selection.selectWord():t.findPrevious()},readOnly:!0},{name:"find",description:"Find",bindKey:r("Ctrl-F","Command-F"),exec:function(t){s.loadModule("ace/ext/searchbox",(function(e){e.Search(t)}))},readOnly:!0},{name:"overwrite",description:"Overwrite",bindKey:"Insert",exec:function(t){t.toggleOverwrite()},readOnly:!0},{name:"selecttostart",description:"Select to start",bindKey:r("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(t){t.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",description:"Go to start",bindKey:r("Ctrl-Home","Command-Home|Command-Up"),exec:function(t){t.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",description:"Select up",bindKey:r("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(t){t.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",description:"Go line up",bindKey:r("Up","Up|Ctrl-P"),exec:function(t,e){t.navigateUp(e.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",description:"Select to end",bindKey:r("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(t){t.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",description:"Go to end",bindKey:r("Ctrl-End","Command-End|Command-Down"),exec:function(t){t.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",description:"Select down",bindKey:r("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(t){t.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",description:"Go line down",bindKey:r("Down","Down|Ctrl-N"),exec:function(t,e){t.navigateDown(e.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",description:"Select word left",bindKey:r("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(t){t.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",description:"Go to word left",bindKey:r("Ctrl-Left","Option-Left"),exec:function(t){t.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",description:"Select to line start",bindKey:r("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(t){t.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",description:"Go to line start",bindKey:r("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(t){t.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",description:"Select left",bindKey:r("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(t){t.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",description:"Go to left",bindKey:r("Left","Left|Ctrl-B"),exec:function(t,e){t.navigateLeft(e.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",description:"Select word right",bindKey:r("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(t){t.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",description:"Go to word right",bindKey:r("Ctrl-Right","Option-Right"),exec:function(t){t.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",description:"Select to line end",bindKey:r("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(t){t.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",description:"Go to line end",bindKey:r("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(t){t.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",description:"Select right",bindKey:r("Shift-Right","Shift-Right"),exec:function(t){t.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",description:"Go to right",bindKey:r("Right","Right|Ctrl-F"),exec:function(t,e){t.navigateRight(e.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",description:"Select page down",bindKey:"Shift-PageDown",exec:function(t){t.selectPageDown()},readOnly:!0},{name:"pagedown",description:"Page down",bindKey:r(null,"Option-PageDown"),exec:function(t){t.scrollPageDown()},readOnly:!0},{name:"gotopagedown",description:"Go to page down",bindKey:r("PageDown","PageDown|Ctrl-V"),exec:function(t){t.gotoPageDown()},readOnly:!0},{name:"selectpageup",description:"Select page up",bindKey:"Shift-PageUp",exec:function(t){t.selectPageUp()},readOnly:!0},{name:"pageup",description:"Page up",bindKey:r(null,"Option-PageUp"),exec:function(t){t.scrollPageUp()},readOnly:!0},{name:"gotopageup",description:"Go to page up",bindKey:"PageUp",exec:function(t){t.gotoPageUp()},readOnly:!0},{name:"scrollup",description:"Scroll up",bindKey:r("Ctrl-Up",null),exec:function(t){t.renderer.scrollBy(0,-2*t.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",description:"Scroll down",bindKey:r("Ctrl-Down",null),exec:function(t){t.renderer.scrollBy(0,2*t.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",description:"Select line start",bindKey:"Shift-Home",exec:function(t){t.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",description:"Select line end",bindKey:"Shift-End",exec:function(t){t.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",description:"Toggle recording",bindKey:r("Ctrl-Alt-E","Command-Option-E"),exec:function(t){t.commands.toggleRecording(t)},readOnly:!0},{name:"replaymacro",description:"Replay macro",bindKey:r("Ctrl-Shift-E","Command-Shift-E"),exec:function(t){t.commands.replay(t)},readOnly:!0},{name:"jumptomatching",description:"Jump to matching",bindKey:r("Ctrl-\\|Ctrl-P","Command-\\"),exec:function(t){t.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",description:"Select to matching",bindKey:r("Ctrl-Shift-\\|Ctrl-Shift-P","Command-Shift-\\"),exec:function(t){t.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",description:"Expand to matching",bindKey:r("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(t){t.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",description:"Pass keys to browser",bindKey:r(null,null),exec:function(){},passEvent:!0,readOnly:!0},{name:"copy",description:"Copy",exec:function(t){},readOnly:!0},{name:"cut",description:"Cut",exec:function(t){var e=t.$copyWithEmptySelection&&t.selection.isEmpty()?t.selection.getLineRange():t.selection.getRange();t._emit("cut",e),e.isEmpty()||t.session.remove(e),t.clearSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",description:"Paste",exec:function(t,e){t.$handlePaste(e)},scrollIntoView:"cursor"},{name:"removeline",description:"Remove line",bindKey:r("Ctrl-D","Command-D"),exec:function(t){t.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",description:"Duplicate selection",bindKey:r("Ctrl-Shift-D","Command-Shift-D"),exec:function(t){t.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",description:"Sort lines",bindKey:r("Ctrl-Alt-S","Command-Alt-S"),exec:function(t){t.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",description:"Toggle comment",bindKey:r("Ctrl-/","Command-/"),exec:function(t){t.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",description:"Toggle block comment",bindKey:r("Ctrl-Shift-/","Command-Shift-/"),exec:function(t){t.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",description:"Modify number up",bindKey:r("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(t){t.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",description:"Modify number down",bindKey:r("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(t){t.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",description:"Replace",bindKey:r("Ctrl-H","Command-Option-F"),exec:function(t){s.loadModule("ace/ext/searchbox",(function(e){e.Search(t,!0)}))}},{name:"undo",description:"Undo",bindKey:r("Ctrl-Z","Command-Z"),exec:function(t){t.undo()}},{name:"redo",description:"Redo",bindKey:r("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(t){t.redo()}},{name:"copylinesup",description:"Copy lines up",bindKey:r("Alt-Shift-Up","Command-Option-Up"),exec:function(t){t.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",description:"Move lines up",bindKey:r("Alt-Up","Option-Up"),exec:function(t){t.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",description:"Copy lines down",bindKey:r("Alt-Shift-Down","Command-Option-Down"),exec:function(t){t.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",description:"Move lines down",bindKey:r("Alt-Down","Option-Down"),exec:function(t){t.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",description:"Delete",bindKey:r("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(t){t.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",description:"Backspace",bindKey:r("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(t){t.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",description:"Cut or delete",bindKey:r("Shift-Delete",null),exec:function(t){if(!t.selection.isEmpty())return!1;t.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",description:"Remove to line start",bindKey:r("Alt-Backspace","Command-Backspace"),exec:function(t){t.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",description:"Remove to line end",bindKey:r("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(t){t.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",description:"Remove to line start hard",bindKey:r("Ctrl-Shift-Backspace",null),exec:function(t){var e=t.selection.getRange();e.start.column=0,t.session.remove(e)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",description:"Remove to line end hard",bindKey:r("Ctrl-Shift-Delete",null),exec:function(t){var e=t.selection.getRange();e.end.column=Number.MAX_VALUE,t.session.remove(e)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",description:"Remove word left",bindKey:r("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(t){t.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",description:"Remove word right",bindKey:r("Ctrl-Delete","Alt-Delete"),exec:function(t){t.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",description:"Outdent",bindKey:r("Shift-Tab","Shift-Tab"),exec:function(t){t.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",description:"Indent",bindKey:r("Tab","Tab"),exec:function(t){t.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",description:"Block outdent",bindKey:r("Ctrl-[","Ctrl-["),exec:function(t){t.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",description:"Block indent",bindKey:r("Ctrl-]","Ctrl-]"),exec:function(t){t.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",description:"Insert string",exec:function(t,e){t.insert(e)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",description:"Insert text",exec:function(t,e){t.insert(n.stringRepeat(e.text||"",e.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",description:"Split line",bindKey:r(null,"Ctrl-O"),exec:function(t){t.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",description:"Transpose letters",bindKey:r("Alt-Shift-X","Ctrl-T"),exec:function(t){t.transposeLetters()},multiSelectAction:function(t){t.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",description:"To uppercase",bindKey:r("Ctrl-U","Ctrl-U"),exec:function(t){t.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",description:"To lowercase",bindKey:r("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(t){t.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"autoindent",description:"Auto Indent",bindKey:r(null,null),exec:function(t){t.autoIndent()},scrollIntoView:"animate"},{name:"expandtoline",description:"Expand to line",bindKey:r("Ctrl-Shift-L","Command-Shift-L"),exec:function(t){var e=t.selection.getRange();e.start.column=e.end.column=0,e.end.row++,t.selection.setRange(e,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"openlink",bindKey:r("Ctrl+F3","F3"),exec:function(t){t.openLink()}},{name:"joinlines",description:"Join lines",bindKey:r(null,null),exec:function(t){for(var e=t.selection.isBackwards(),i=e?t.selection.getSelectionLead():t.selection.getSelectionAnchor(),s=e?t.selection.getSelectionAnchor():t.selection.getSelectionLead(),r=t.session.doc.getLine(i.row).length,a=t.session.doc.getTextRange(t.selection.getRange()).replace(/\n\s*/," ").length,l=t.session.doc.getLine(i.row),h=i.row+1;h<=s.row+1;h++){var c=n.stringTrimLeft(n.stringTrimRight(t.session.doc.getLine(h)));0!==c.length&&(c=" "+c),l+=c}s.row+1<t.session.doc.getLength()-1&&(l+=t.session.doc.getNewLineCharacter()),t.clearSelection(),t.session.doc.replace(new o(i.row,0,s.row+2,0),l),a>0?(t.selection.moveCursorTo(i.row,i.column),t.selection.selectTo(i.row,i.column+a)):(r=t.session.doc.getLine(i.row).length>r?r+1:r,t.selection.moveCursorTo(i.row,r))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",description:"Invert selection",bindKey:r(null,null),exec:function(t){var e=t.session.doc.getLength()-1,i=t.session.doc.getLine(e).length,n=t.selection.rangeList.ranges,s=[];n.length<1&&(n=[t.selection.getRange()]);for(var r=0;r<n.length;r++)r==n.length-1&&(n[r].end.row===e&&n[r].end.column===i||s.push(new o(n[r].end.row,n[r].end.column,e,i))),0===r?0===n[r].start.row&&0===n[r].start.column||s.push(new o(0,0,n[r].start.row,n[r].start.column)):s.push(new o(n[r-1].end.row,n[r-1].end.column,n[r].start.row,n[r].start.column));for(t.exitMultiSelectMode(),t.clearSelection(),r=0;r<s.length;r++)t.selection.addRange(s[r],!1)},readOnly:!0,scrollIntoView:"none"},{name:"addLineAfter",description:"Add new line after the current line",exec:function(t){t.selection.clearSelection(),t.navigateLineEnd(),t.insert("\n")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"addLineBefore",description:"Add new line before the current line",exec:function(t){t.selection.clearSelection();var e=t.getCursorPosition();t.selection.moveTo(e.row-1,Number.MAX_VALUE),t.insert("\n"),0===e.row&&t.navigateUp()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"openCommandPallete",exec:function(t){console.warn("This is an obsolete command. Please use `openCommandPalette` instead."),t.prompt({$type:"commands"})},readOnly:!0},{name:"openCommandPalette",description:"Open command palette",bindKey:r("F1","F1"),exec:function(t){t.prompt({$type:"commands"})},readOnly:!0},{name:"modeSelect",description:"Change language mode...",bindKey:r(null,null),exec:function(t){t.prompt({$type:"modes"})},readOnly:!0}];for(var a=1;a<9;a++)e.commands.push({name:"foldToLevel"+a,description:"Fold To Level "+a,level:a,exec:function(t){t.session.foldToLevel(this.level)},scrollIntoView:"center",readOnly:!0})})),ace.define("ace/line_widgets",["require","exports","module","ace/lib/dom"],(function(t,e,i){"use strict";var n=t("./lib/dom"),s=function(){function t(t){this.session=t,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeFold",this.updateOnFold),this.session.on("changeEditor",this.$onChangeEditor)}return t.prototype.getRowLength=function(t){var e;return e=this.lineWidgets&&this.lineWidgets[t]&&this.lineWidgets[t].rowCount||0,this.$useWrapMode&&this.$wrapData[t]?this.$wrapData[t].length+1+e:1+e},t.prototype.$getWidgetScreenLength=function(){var t=0;return this.lineWidgets.forEach((function(e){e&&e.rowCount&&!e.hidden&&(t+=e.rowCount)})),t},t.prototype.$onChangeEditor=function(t){this.attach(t.editor)},t.prototype.attach=function(t){t&&t.widgetManager&&t.widgetManager!=this&&t.widgetManager.detach(),this.editor!=t&&(this.detach(),this.editor=t,t&&(t.widgetManager=this,t.renderer.on("beforeRender",this.measureWidgets),t.renderer.on("afterRender",this.renderWidgets)))},t.prototype.detach=function(t){var e=this.editor;if(e){this.editor=null,e.widgetManager=null,e.renderer.off("beforeRender",this.measureWidgets),e.renderer.off("afterRender",this.renderWidgets);var i=this.session.lineWidgets;i&&i.forEach((function(t){t&&t.el&&t.el.parentNode&&(t._inDocument=!1,t.el.parentNode.removeChild(t.el))}))}},t.prototype.updateOnFold=function(t,e){var i=e.lineWidgets;if(i&&t.action){for(var n=t.data,s=n.start.row,o=n.end.row,r="add"==t.action,a=s+1;a<o;a++)i[a]&&(i[a].hidden=r);i[o]&&(r?i[s]?i[o].hidden=r:i[s]=i[o]:(i[s]==i[o]&&(i[s]=void 0),i[o].hidden=r))}},t.prototype.updateOnChange=function(t){var e=this.session.lineWidgets;if(e){var i=t.start.row,n=t.end.row-i;if(0===n);else if("remove"==t.action){var s=e.splice(i+1,n);!e[i]&&s[s.length-1]&&(e[i]=s.pop()),s.forEach((function(t){t&&this.removeLineWidget(t)}),this),this.$updateRows()}else{var o=new Array(n);e[i]&&null!=e[i].column&&t.start.column>e[i].column&&i++,o.unshift(i,0),e.splice.apply(e,o),this.$updateRows()}}},t.prototype.$updateRows=function(){var t=this.session.lineWidgets;if(t){var e=!0;t.forEach((function(t,i){if(t)for(e=!1,t.row=i;t.$oldWidget;)t.$oldWidget.row=i,t=t.$oldWidget})),e&&(this.session.lineWidgets=null)}},t.prototype.$registerLineWidget=function(t){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength()));var e=this.session.lineWidgets[t.row];return e&&(t.$oldWidget=e,e.el&&e.el.parentNode&&(e.el.parentNode.removeChild(e.el),e._inDocument=!1)),this.session.lineWidgets[t.row]=t,t},t.prototype.addLineWidget=function(t){if(this.$registerLineWidget(t),t.session=this.session,!this.editor)return t;var e=this.editor.renderer;t.html&&!t.el&&(t.el=n.createElement("div"),t.el.innerHTML=t.html),t.text&&!t.el&&(t.el=n.createElement("div"),t.el.textContent=t.text),t.el&&(n.addCssClass(t.el,"ace_lineWidgetContainer"),t.className&&n.addCssClass(t.el,t.className),t.el.style.position="absolute",t.el.style.zIndex="5",e.container.appendChild(t.el),t._inDocument=!0,t.coverGutter||(t.el.style.zIndex="3"),null==t.pixelHeight&&(t.pixelHeight=t.el.offsetHeight)),null==t.rowCount&&(t.rowCount=t.pixelHeight/e.layerConfig.lineHeight);var i=this.session.getFoldAt(t.row,0);if(t.$fold=i,i){var s=this.session.lineWidgets;t.row!=i.end.row||s[i.start.row]?t.hidden=!0:s[i.start.row]=t}return this.session._emit("changeFold",{data:{start:{row:t.row}}}),this.$updateRows(),this.renderWidgets(null,e),this.onWidgetChanged(t),t},t.prototype.removeLineWidget=function(t){if(t._inDocument=!1,t.session=null,t.el&&t.el.parentNode&&t.el.parentNode.removeChild(t.el),t.editor&&t.editor.destroy)try{t.editor.destroy()}catch(t){}if(this.session.lineWidgets){var e=this.session.lineWidgets[t.row];if(e==t)this.session.lineWidgets[t.row]=t.$oldWidget,t.$oldWidget&&this.onWidgetChanged(t.$oldWidget);else for(;e;){if(e.$oldWidget==t){e.$oldWidget=t.$oldWidget;break}e=e.$oldWidget}}this.session._emit("changeFold",{data:{start:{row:t.row}}}),this.$updateRows()},t.prototype.getWidgetsAtRow=function(t){for(var e=this.session.lineWidgets,i=e&&e[t],n=[];i;)n.push(i),i=i.$oldWidget;return n},t.prototype.onWidgetChanged=function(t){this.session._changedWidgets.push(t),this.editor&&this.editor.renderer.updateFull()},t.prototype.measureWidgets=function(t,e){var i=this.session._changedWidgets,n=e.layerConfig;if(i&&i.length){for(var s=1/0,o=0;o<i.length;o++){var r=i[o];if(r&&r.el&&r.session==this.session){if(!r._inDocument){if(this.session.lineWidgets[r.row]!=r)continue;r._inDocument=!0,e.container.appendChild(r.el)}r.h=r.el.offsetHeight,r.fixedWidth||(r.w=r.el.offsetWidth,r.screenWidth=Math.ceil(r.w/n.characterWidth));var a=r.h/n.lineHeight;r.coverLine&&(a-=this.session.getRowLineCount(r.row))<0&&(a=0),r.rowCount!=a&&(r.rowCount=a,r.row<s&&(s=r.row))}}s!=1/0&&(this.session._emit("changeFold",{data:{start:{row:s}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},t.prototype.renderWidgets=function(t,e){var i=e.layerConfig,n=this.session.lineWidgets;if(n){for(var s=Math.min(this.firstRow,i.firstRow),o=Math.max(this.lastRow,i.lastRow,n.length);s>0&&!n[s];)s--;this.firstRow=i.firstRow,this.lastRow=i.lastRow,e.$cursorLayer.config=i;for(var r=s;r<=o;r++){var a=n[r];if(a&&a.el)if(a.hidden)a.el.style.top=-100-(a.pixelHeight||0)+"px";else{a._inDocument||(a._inDocument=!0,e.container.appendChild(a.el));var l=e.$cursorLayer.getPixelPosition({row:r,column:0},!0).top;a.coverLine||(l+=i.lineHeight*this.session.getRowLineCount(a.row)),a.el.style.top=l-i.offset+"px";var h=a.coverGutter?0:e.gutterWidth;a.fixedWidth||(h-=e.scrollLeft),a.el.style.left=h+"px",a.fullWidth&&a.screenWidth&&(a.el.style.minWidth=i.width+2*i.padding+"px"),a.fixedWidth?a.el.style.right=e.scrollBar.getWidth()+"px":a.el.style.right=""}}}},t}();e.LineWidgets=s})),ace.define("ace/keyboard/gutter_handler",["require","exports","module","ace/lib/keys","ace/mouse/default_gutter_handler"],(function(t,e,i){"use strict";var n=t("../lib/keys"),s=t("../mouse/default_gutter_handler").GutterTooltip,o=function(){function t(t){this.editor=t,this.gutterLayer=t.renderer.$gutterLayer,this.element=t.renderer.$gutter,this.lines=t.renderer.$gutterLayer.$lines,this.activeRowIndex=null,this.activeLane=null,this.annotationTooltip=new s(this.editor)}return t.prototype.addListener=function(){this.element.addEventListener("keydown",this.$onGutterKeyDown.bind(this)),this.element.addEventListener("focusout",this.$blurGutter.bind(this)),this.editor.on("mousewheel",this.$blurGutter.bind(this))},t.prototype.removeListener=function(){this.element.removeEventListener("keydown",this.$onGutterKeyDown.bind(this)),this.element.removeEventListener("focusout",this.$blurGutter.bind(this)),this.editor.off("mousewheel",this.$blurGutter.bind(this))},t.prototype.$onGutterKeyDown=function(t){if(this.annotationTooltip.isOpen)return t.preventDefault(),void(t.keyCode===n.escape&&this.annotationTooltip.hideTooltip());if(t.target===this.element){if(t.keyCode!=n.enter)return;t.preventDefault();var e=this.editor.getCursorPosition().row;return this.editor.isRowVisible(e)||this.editor.scrollToLine(e,!0,!0),void setTimeout(function(){var t=this.$rowToRowIndex(this.gutterLayer.$cursorCell.row),e=this.$findNearestFoldWidget(t),i=this.$findNearestAnnotation(t);if(null!==e||null!==i)return null===e&&null!==i?(this.activeRowIndex=i,this.activeLane="annotation",void this.$focusAnnotation(this.activeRowIndex)):null!==e&&null===i?(this.activeRowIndex=e,this.activeLane="fold",void this.$focusFoldWidget(this.activeRowIndex)):Math.abs(i-t)<Math.abs(e-t)?(this.activeRowIndex=i,this.activeLane="annotation",void this.$focusAnnotation(this.activeRowIndex)):(this.activeRowIndex=e,this.activeLane="fold",void this.$focusFoldWidget(this.activeRowIndex))}.bind(this),10)}this.$handleGutterKeyboardInteraction(t),setTimeout(function(){this.editor._signal("gutterkeydown",new r(t,this))}.bind(this),10)},t.prototype.$handleGutterKeyboardInteraction=function(t){if(t.keyCode!==n.tab){if(t.keyCode===n.escape)return t.preventDefault(),this.$blurGutter(),this.element.focus(),void(this.lane=null);if(t.keyCode!==n.up)if(t.keyCode!==n.down){if(t.keyCode===n.left)return t.preventDefault(),void this.$switchLane("annotation");if(t.keyCode===n.right)return t.preventDefault(),void this.$switchLane("fold");if(t.keyCode!==n.enter&&t.keyCode!==n.space);else switch(t.preventDefault(),this.activeLane){case"fold":if("start"===this.gutterLayer.session.foldWidgets[this.$rowIndexToRow(this.activeRowIndex)]){var e=this.$rowIndexToRow(this.activeRowIndex);this.editor.session.onFoldWidgetClick(this.$rowIndexToRow(this.activeRowIndex),t),setTimeout(function(){this.$rowIndexToRow(this.activeRowIndex)!==e&&(this.$blurFoldWidget(this.activeRowIndex),this.activeRowIndex=this.$rowToRowIndex(e),this.$focusFoldWidget(this.activeRowIndex))}.bind(this),10);break}if("end"===this.gutterLayer.session.foldWidgets[this.$rowIndexToRow(this.activeRowIndex)])break;return;case"annotation":var i=this.lines.cells[this.activeRowIndex].element.childNodes[2].getBoundingClientRect(),s=this.annotationTooltip.getElement().style;s.left=i.right+"px",s.top=i.bottom+"px",this.annotationTooltip.showTooltip(this.$rowIndexToRow(this.activeRowIndex))}}else switch(t.preventDefault(),this.activeLane){case"fold":this.$moveFoldWidgetDown();break;case"annotation":this.$moveAnnotationDown()}else switch(t.preventDefault(),this.activeLane){case"fold":this.$moveFoldWidgetUp();break;case"annotation":this.$moveAnnotationUp()}}else t.preventDefault()},t.prototype.$blurGutter=function(){if(null!==this.activeRowIndex)switch(this.activeLane){case"fold":this.$blurFoldWidget(this.activeRowIndex);break;case"annotation":this.$blurAnnotation(this.activeRowIndex)}this.annotationTooltip.isOpen&&this.annotationTooltip.hideTooltip()},t.prototype.$isFoldWidgetVisible=function(t){var e=this.editor.isRowFullyVisible(this.$rowIndexToRow(t)),i="none"!==this.$getFoldWidget(t).style.display;return e&&i},t.prototype.$isAnnotationVisible=function(t){var e=this.editor.isRowFullyVisible(this.$rowIndexToRow(t)),i="none"!==this.$getAnnotation(t).style.display;return e&&i},t.prototype.$getFoldWidget=function(t){return this.lines.get(t).element.childNodes[1]},t.prototype.$getAnnotation=function(t){return this.lines.get(t).element.childNodes[2]},t.prototype.$findNearestFoldWidget=function(t){if(this.$isFoldWidgetVisible(t))return t;for(var e=0;t-e>0||t+e<this.lines.getLength()-1;){if(t-++e>=0&&this.$isFoldWidgetVisible(t-e))return t-e;if(t+e<=this.lines.getLength()-1&&this.$isFoldWidgetVisible(t+e))return t+e}return null},t.prototype.$findNearestAnnotation=function(t){if(this.$isAnnotationVisible(t))return t;for(var e=0;t-e>0||t+e<this.lines.getLength()-1;){if(t-++e>=0&&this.$isAnnotationVisible(t-e))return t-e;if(t+e<=this.lines.getLength()-1&&this.$isAnnotationVisible(t+e))return t+e}return null},t.prototype.$focusFoldWidget=function(t){if(null!=t){var e=this.$getFoldWidget(t);e.classList.add(this.editor.renderer.keyboardFocusClassName),e.focus()}},t.prototype.$focusAnnotation=function(t){if(null!=t){var e=this.$getAnnotation(t);e.classList.add(this.editor.renderer.keyboardFocusClassName),e.focus()}},t.prototype.$blurFoldWidget=function(t){var e=this.$getFoldWidget(t);e.classList.remove(this.editor.renderer.keyboardFocusClassName),e.blur()},t.prototype.$blurAnnotation=function(t){var e=this.$getAnnotation(t);e.classList.remove(this.editor.renderer.keyboardFocusClassName),e.blur()},t.prototype.$moveFoldWidgetUp=function(){for(var t=this.activeRowIndex;t>0;)if(t--,this.$isFoldWidgetVisible(t))return this.$blurFoldWidget(this.activeRowIndex),this.activeRowIndex=t,void this.$focusFoldWidget(this.activeRowIndex)},t.prototype.$moveFoldWidgetDown=function(){for(var t=this.activeRowIndex;t<this.lines.getLength()-1;)if(t++,this.$isFoldWidgetVisible(t))return this.$blurFoldWidget(this.activeRowIndex),this.activeRowIndex=t,void this.$focusFoldWidget(this.activeRowIndex)},t.prototype.$moveAnnotationUp=function(){for(var t=this.activeRowIndex;t>0;)if(t--,this.$isAnnotationVisible(t))return this.$blurAnnotation(this.activeRowIndex),this.activeRowIndex=t,void this.$focusAnnotation(this.activeRowIndex)},t.prototype.$moveAnnotationDown=function(){for(var t=this.activeRowIndex;t<this.lines.getLength()-1;)if(t++,this.$isAnnotationVisible(t))return this.$blurAnnotation(this.activeRowIndex),this.activeRowIndex=t,void this.$focusAnnotation(this.activeRowIndex)},t.prototype.$switchLane=function(t){switch(t){case"annotation":if("annotation"===this.activeLane)break;var e=this.$findNearestAnnotation(this.activeRowIndex);if(null==e)break;this.activeLane="annotation",this.$blurFoldWidget(this.activeRowIndex),this.activeRowIndex=e,this.$focusAnnotation(this.activeRowIndex);break;case"fold":if("fold"===this.activeLane)break;var i=this.$findNearestFoldWidget(this.activeRowIndex);if(null==i)break;this.activeLane="fold",this.$blurAnnotation(this.activeRowIndex),this.activeRowIndex=i,this.$focusFoldWidget(this.activeRowIndex)}},t.prototype.$rowIndexToRow=function(t){var e=this.lines.get(t);return e?e.row:null},t.prototype.$rowToRowIndex=function(t){for(var e=0;e<this.lines.getLength();e++)if(this.lines.get(e).row==t)return e;return null},t}();e.GutterKeyboardHandler=o;var r=function(){function t(t,e){this.gutterKeyboardHandler=e,this.domEvent=t}return t.prototype.getKey=function(){return n.keyCodeToString(this.domEvent.keyCode)},t.prototype.getRow=function(){return this.gutterKeyboardHandler.$rowIndexToRow(this.gutterKeyboardHandler.activeRowIndex)},t.prototype.isInAnnotationLane=function(){return"annotation"===this.gutterKeyboardHandler.activeLane},t.prototype.isInFoldLane=function(){return"fold"===this.gutterKeyboardHandler.activeLane},t}();e.GutterKeyboardEvent=r})),ace.define("ace/editor",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/keyboard/textinput","ace/mouse/mouse_handler","ace/mouse/fold_handler","ace/keyboard/keybinding","ace/edit_session","ace/search","ace/range","ace/lib/event_emitter","ace/commands/command_manager","ace/commands/default_commands","ace/config","ace/token_iterator","ace/line_widgets","ace/keyboard/gutter_handler","ace/config","ace/clipboard","ace/lib/keys"],(function(t,e,i){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=t("./lib/oop"),o=t("./lib/dom"),r=t("./lib/lang"),a=t("./lib/useragent"),l=t("./keyboard/textinput").TextInput,h=t("./mouse/mouse_handler").MouseHandler,c=t("./mouse/fold_handler").FoldHandler,d=t("./keyboard/keybinding").KeyBinding,u=t("./edit_session").EditSession,p=t("./search").Search,g=t("./range").Range,f=t("./lib/event_emitter").EventEmitter,m=t("./commands/command_manager").CommandManager,v=t("./commands/default_commands").commands,_=t("./config"),y=t("./token_iterator").TokenIterator,w=t("./line_widgets").LineWidgets,x=t("./keyboard/gutter_handler").GutterKeyboardHandler,b=t("./config").nls,C=t("./clipboard"),A=t("./lib/keys"),S=function(){function t(e,i,n){this.session,this.$toDestroy=[];var s=e.getContainerElement();this.container=s,this.renderer=e,this.id="editor"+ ++t.$uid,this.commands=new m(a.isMac?"mac":"win",v),"object"==typeof document&&(this.textInput=new l(e.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.$mouseHandler=new h(this),new c(this)),this.keyBinding=new d(this),this.$search=(new p).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=r.delayedCall(function(){this._signal("input",{}),this.session&&!this.session.destroyed&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",(function(t,e){e._$emitInputEvent.schedule(31)})),this.setSession(i||n&&n.session||new u("")),_.resetOptions(this),n&&this.setOptions(n),_._signal("editor",this)}return t.prototype.$initOperationListeners=function(){this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=r.delayedCall(this.endOperation.bind(this,!0)),this.on("change",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.selectionChanged=!0}.bind(this),!0)},t.prototype.startOperation=function(t){if(this.curOp){if(!t||this.curOp.command)return;this.prevOp=this.curOp}t||(this.previousCommand=null,t={}),this.$opResetTimer.schedule(),this.curOp=this.session.curOp={command:t.command||{},args:t.args,scrollTop:this.renderer.scrollTop},this.curOp.selectionBefore=this.selection.toJSON()},t.prototype.endOperation=function(t){if(this.curOp&&this.session){if(t&&!1===t.returnValue||!this.session)return this.curOp=null;if(1==t&&this.curOp.command&&"mouse"==this.curOp.command.name)return;if(this._signal("beforeEndOperation"),!this.curOp)return;var e=this.curOp.command,i=e&&e.scrollIntoView;if(i){switch(i){case"center-animate":i="animate";case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var n=this.selection.getRange(),s=this.renderer.layerConfig;(n.start.row>=s.lastRow||n.end.row<=s.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==i&&this.renderer.animateScrolling(this.curOp.scrollTop)}var o=this.selection.toJSON();this.curOp.selectionAfter=o,this.$lastSel=this.selection.toJSON(),this.session.getUndoManager().addSelection(o),this.prevOp=this.curOp,this.curOp=null}},t.prototype.$historyTracker=function(t){if(this.$mergeUndoDeltas){var e=this.prevOp,i=this.$mergeableCommands,n=e.command&&t.command.name==e.command.name;if("insertstring"==t.command.name){var s=t.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),n=n&&this.mergeNextCommand&&(!/\s/.test(s)||/\s/.test(e.args)),this.mergeNextCommand=!0}else n=n&&-1!==i.indexOf(t.command.name);"always"!=this.$mergeUndoDeltas&&Date.now()-this.sequenceStartTime>2e3&&(n=!1),n?this.session.mergeUndoDeltas=!0:-1!==i.indexOf(t.command.name)&&(this.sequenceStartTime=Date.now())}},t.prototype.setKeyboardHandler=function(t,e){if(t&&"string"==typeof t&&"ace"!=t){this.$keybindingId=t;var i=this;_.loadModule(["keybinding",t],(function(n){i.$keybindingId==t&&i.keyBinding.setKeyboardHandler(n&&n.handler),e&&e()}))}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(t),e&&e()},t.prototype.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},t.prototype.setSession=function(t){if(this.session!=t){this.curOp&&this.endOperation(),this.curOp={};var e=this.session;if(e){this.session.off("change",this.$onDocumentChange),this.session.off("changeMode",this.$onChangeMode),this.session.off("tokenizerUpdate",this.$onTokenizerUpdate),this.session.off("changeTabSize",this.$onChangeTabSize),this.session.off("changeWrapLimit",this.$onChangeWrapLimit),this.session.off("changeWrapMode",this.$onChangeWrapMode),this.session.off("changeFold",this.$onChangeFold),this.session.off("changeFrontMarker",this.$onChangeFrontMarker),this.session.off("changeBackMarker",this.$onChangeBackMarker),this.session.off("changeBreakpoint",this.$onChangeBreakpoint),this.session.off("changeAnnotation",this.$onChangeAnnotation),this.session.off("changeOverwrite",this.$onCursorChange),this.session.off("changeScrollTop",this.$onScrollTopChange),this.session.off("changeScrollLeft",this.$onScrollLeftChange);var i=this.session.getSelection();i.off("changeCursor",this.$onCursorChange),i.off("changeSelection",this.$onSelectionChange)}this.session=t,t?(this.$onDocumentChange=this.onDocumentChange.bind(this),t.on("change",this.$onDocumentChange),this.renderer.setSession(t),this.$onChangeMode=this.onChangeMode.bind(this),t.on("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),t.on("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),t.on("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),t.on("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),t.on("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),t.on("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.on("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.on("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.on("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.on("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.on("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.on("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.on("changeScrollLeft",this.$onScrollLeftChange),this.selection=t.getSelection(),this.selection.on("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.onCursorChange(),this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(t)),this._signal("changeSession",{session:t,oldSession:e}),this.curOp=null,e&&e._signal("changeEditor",{oldEditor:this}),t&&t._signal("changeEditor",{editor:this}),t&&!t.destroyed&&t.bgTokenizer.scheduleStart()}},t.prototype.getSession=function(){return this.session},t.prototype.setValue=function(t,e){return this.session.doc.setValue(t),e?1==e?this.navigateFileEnd():-1==e&&this.navigateFileStart():this.selectAll(),t},t.prototype.getValue=function(){return this.session.getValue()},t.prototype.getSelection=function(){return this.selection},t.prototype.resize=function(t){this.renderer.onResize(t)},t.prototype.setTheme=function(t,e){this.renderer.setTheme(t,e)},t.prototype.getTheme=function(){return this.renderer.getTheme()},t.prototype.setStyle=function(t){this.renderer.setStyle(t)},t.prototype.unsetStyle=function(t){this.renderer.unsetStyle(t)},t.prototype.getFontSize=function(){return this.getOption("fontSize")||o.computedStyle(this.container).fontSize},t.prototype.setFontSize=function(t){this.setOption("fontSize",t)},t.prototype.$highlightBrackets=function(){if(!this.$highlightPending){var t=this;this.$highlightPending=!0,setTimeout((function(){t.$highlightPending=!1;var e=t.session;if(e&&!e.destroyed){e.$bracketHighlight&&(e.$bracketHighlight.markerIds.forEach((function(t){e.removeMarker(t)})),e.$bracketHighlight=null);var i=t.getCursorPosition(),n=t.getKeyboardHandler(),s=n&&n.$getDirectionForHighlight&&n.$getDirectionForHighlight(t),o=e.getMatchingBracketRanges(i,s);if(!o){var r=new y(e,i.row,i.column).getCurrentToken();if(r&&/\b(?:tag-open|tag-name)/.test(r.type)){var a=e.getMatchingTags(i);a&&(o=[a.openTagName.isEmpty()?a.openTag:a.openTagName,a.closeTagName.isEmpty()?a.closeTag:a.closeTagName])}}if(!o&&e.$mode.getMatching&&(o=e.$mode.getMatching(t.session)),o){var l="ace_bracket";Array.isArray(o)?1==o.length&&(l="ace_error_bracket"):o=[o],2==o.length&&(0==g.comparePoints(o[0].end,o[1].start)?o=[g.fromPoints(o[0].start,o[1].end)]:0==g.comparePoints(o[0].start,o[1].end)&&(o=[g.fromPoints(o[1].start,o[0].end)])),e.$bracketHighlight={ranges:o,markerIds:o.map((function(t){return e.addMarker(t,l,"text")}))},t.getHighlightIndentGuides()&&t.renderer.$textLayer.$highlightIndentGuide()}else t.getHighlightIndentGuides()&&t.renderer.$textLayer.$highlightIndentGuide()}}),50)}},t.prototype.focus=function(){this.textInput.focus()},t.prototype.isFocused=function(){return this.textInput.isFocused()},t.prototype.blur=function(){this.textInput.blur()},t.prototype.onFocus=function(t){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",t))},t.prototype.onBlur=function(t){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",t))},t.prototype.$cursorChange=function(){this.renderer.updateCursor(),this.$highlightBrackets(),this.$updateHighlightActiveLine()},t.prototype.onDocumentChange=function(t){var e=this.session.$useWrapMode,i=t.start.row==t.end.row?t.end.row:1/0;this.renderer.updateLines(t.start.row,i,e),this._signal("change",t),this.$cursorChange()},t.prototype.onTokenizerUpdate=function(t){var e=t.data;this.renderer.updateLines(e.first,e.last)},t.prototype.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},t.prototype.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},t.prototype.onCursorChange=function(){this.$cursorChange(),this._signal("changeSelection")},t.prototype.$updateHighlightActiveLine=function(){var t,e=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(t=this.getCursorPosition()),this.renderer.theme&&this.renderer.theme.$selectionColorConflict&&!this.selection.isEmpty()&&(t=!1),!this.renderer.$maxLines||1!==this.session.getLength()||this.renderer.$minLines>1||(t=!1)),e.$highlightLineMarker&&!t)e.removeMarker(e.$highlightLineMarker.id),e.$highlightLineMarker=null;else if(!e.$highlightLineMarker&&t){var i=new g(t.row,t.column,t.row,1/0);i.id=e.addMarker(i,"ace_active-line","screenLine"),e.$highlightLineMarker=i}else t&&(e.$highlightLineMarker.start.row=t.row,e.$highlightLineMarker.end.row=t.row,e.$highlightLineMarker.start.column=t.column,e._signal("changeBackMarker"))},t.prototype.onSelectionChange=function(t){var e=this.session;if(e.$selectionMarker&&e.removeMarker(e.$selectionMarker),e.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var i=this.selection.getRange(),n=this.getSelectionStyle();e.$selectionMarker=e.addMarker(i,"ace_selection",n)}var s=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(s),this._signal("changeSelection")},t.prototype.$getSelectionHighLightRegexp=function(){var t=this.session,e=this.getSelectionRange();if(!e.isEmpty()&&!e.isMultiLine()){var i=e.start.column,n=e.end.column,s=t.getLine(e.start.row),o=s.substring(i,n);if(!(o.length>5e3)&&/[\w\d]/.test(o)){var r=this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:o}),a=s.substring(i-1,n+1);if(r.test(a))return r}}},t.prototype.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},t.prototype.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},t.prototype.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},t.prototype.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},t.prototype.onChangeMode=function(t){this.renderer.updateText(),this._emit("changeMode",t)},t.prototype.onChangeWrapLimit=function(){this.renderer.updateFull()},t.prototype.onChangeWrapMode=function(){this.renderer.onResize(!0)},t.prototype.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},t.prototype.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},t.prototype.getCopyText=function(){var t=this.getSelectedText(),e=this.session.doc.getNewLineCharacter(),i=!1;if(!t&&this.$copyWithEmptySelection){i=!0;for(var n=this.selection.getAllRanges(),s=0;s<n.length;s++){var o=n[s];s&&n[s-1].start.row==o.start.row||(t+=this.session.getLine(o.start.row)+e)}}var r={text:t};return this._signal("copy",r),C.lineMode=!!i&&r.text,r.text},t.prototype.onCopy=function(){this.commands.exec("copy",this)},t.prototype.onCut=function(){this.commands.exec("cut",this)},t.prototype.onPaste=function(t,e){var i={text:t,event:e};this.commands.exec("paste",this,i)},t.prototype.$handlePaste=function(t){"string"==typeof t&&(t={text:t}),this._signal("paste",t);var e=t.text,i=e===C.lineMode,n=this.session;if(!this.inMultiSelectMode||this.inVirtualSelectionMode)i?n.insert({row:this.selection.lead.row,column:0},e):this.insert(e);else if(i)this.selection.rangeList.ranges.forEach((function(t){n.insert({row:t.start.row,column:0},e)}));else{var s=e.split(/\r\n|\r|\n/),o=this.selection.rangeList.ranges,r=!(2!=s.length||s[0]&&s[1]);if(s.length!=o.length||r)return this.commands.exec("insertstring",this,e);for(var a=o.length;a--;){var l=o[a];l.isEmpty()||n.remove(l),n.insert(l.start,s[a])}}},t.prototype.execCommand=function(t,e){return this.commands.exec(t,this,e)},t.prototype.insert=function(t,e){var i=this.session,n=i.getMode(),s=this.getCursorPosition();if(this.getBehavioursEnabled()&&!e){var o=n.transformAction(i.getState(s.row),"insertion",this,i,t);o&&(t!==o.text&&(this.inVirtualSelectionMode||(this.session.mergeUndoDeltas=!1,this.mergeNextCommand=!1)),t=o.text)}if("\t"==t&&(t=this.session.getTabString()),this.selection.isEmpty())this.session.getOverwrite()&&-1==t.indexOf("\n")&&((r=g.fromPoints(s,s)).end.column+=t.length,this.session.remove(r));else{var r=this.getSelectionRange();s=this.session.remove(r),this.clearSelection()}if("\n"==t||"\r\n"==t){var a=i.getLine(s.row);if(s.column>a.search(/\S|$/)){var l=a.substr(s.column).search(/\S|$/);i.doc.removeInLine(s.row,s.column,s.column+l)}}this.clearSelection();var h=s.column,c=i.getState(s.row),d=(a=i.getLine(s.row),n.checkOutdent(c,a,t));if(i.insert(s,t),o&&o.selection&&(2==o.selection.length?this.selection.setSelectionRange(new g(s.row,h+o.selection[0],s.row,h+o.selection[1])):this.selection.setSelectionRange(new g(s.row+o.selection[0],o.selection[1],s.row+o.selection[2],o.selection[3]))),this.$enableAutoIndent){if(i.getDocument().isNewLine(t)){var u=n.getNextLineIndent(c,a.slice(0,s.column),i.getTabString());i.insert({row:s.row+1,column:0},u)}d&&n.autoOutdent(c,i,s.row)}},t.prototype.autoIndent=function(){for(var t=this.session,e=t.getMode(),i=this.selection.isEmpty()?[new g(0,0,t.doc.getLength()-1,0)]:this.selection.getAllRanges(),n="",s="",o="",r=t.getTabString(),a=0;a<i.length;a++)for(var l=i[a].start.row,h=i[a].end.row,c=l;c<=h;c++){c>0&&(n=t.getState(c-1),s=t.getLine(c-1),o=e.getNextLineIndent(n,s,r));var d=t.getLine(c),u=e.$getIndent(d);if(o!==u){if(u.length>0){var p=new g(c,0,c,u.length);t.remove(p)}o.length>0&&t.insert({row:c,column:0},o)}e.autoOutdent(n,t,c)}},t.prototype.onTextInput=function(t,e){if(!e)return this.keyBinding.onTextInput(t);this.startOperation({command:{name:"insertstring"}});var i=this.applyComposition.bind(this,t,e);this.selection.rangeCount?this.forEachSelection(i):i(),this.endOperation()},t.prototype.applyComposition=function(t,e){var i;(e.extendLeft||e.extendRight)&&((i=this.selection.getRange()).start.column-=e.extendLeft,i.end.column+=e.extendRight,i.start.column<0&&(i.start.row--,i.start.column+=this.session.getLine(i.start.row).length+1),this.selection.setRange(i),t||i.isEmpty()||this.remove()),!t&&this.selection.isEmpty()||this.insert(t,!0),(e.restoreStart||e.restoreEnd)&&((i=this.selection.getRange()).start.column-=e.restoreStart,i.end.column-=e.restoreEnd,this.selection.setRange(i))},t.prototype.onCommandKey=function(t,e,i){return this.keyBinding.onCommandKey(t,e,i)},t.prototype.setOverwrite=function(t){this.session.setOverwrite(t)},t.prototype.getOverwrite=function(){return this.session.getOverwrite()},t.prototype.toggleOverwrite=function(){this.session.toggleOverwrite()},t.prototype.setScrollSpeed=function(t){this.setOption("scrollSpeed",t)},t.prototype.getScrollSpeed=function(){return this.getOption("scrollSpeed")},t.prototype.setDragDelay=function(t){this.setOption("dragDelay",t)},t.prototype.getDragDelay=function(){return this.getOption("dragDelay")},t.prototype.setSelectionStyle=function(t){this.setOption("selectionStyle",t)},t.prototype.getSelectionStyle=function(){return this.getOption("selectionStyle")},t.prototype.setHighlightActiveLine=function(t){this.setOption("highlightActiveLine",t)},t.prototype.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},t.prototype.setHighlightGutterLine=function(t){this.setOption("highlightGutterLine",t)},t.prototype.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},t.prototype.setHighlightSelectedWord=function(t){this.setOption("highlightSelectedWord",t)},t.prototype.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},t.prototype.setAnimatedScroll=function(t){this.renderer.setAnimatedScroll(t)},t.prototype.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},t.prototype.setShowInvisibles=function(t){this.renderer.setShowInvisibles(t)},t.prototype.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},t.prototype.setDisplayIndentGuides=function(t){this.renderer.setDisplayIndentGuides(t)},t.prototype.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},t.prototype.setHighlightIndentGuides=function(t){this.renderer.setHighlightIndentGuides(t)},t.prototype.getHighlightIndentGuides=function(){return this.renderer.getHighlightIndentGuides()},t.prototype.setShowPrintMargin=function(t){this.renderer.setShowPrintMargin(t)},t.prototype.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},t.prototype.setPrintMarginColumn=function(t){this.renderer.setPrintMarginColumn(t)},t.prototype.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},t.prototype.setReadOnly=function(t){this.setOption("readOnly",t)},t.prototype.getReadOnly=function(){return this.getOption("readOnly")},t.prototype.setBehavioursEnabled=function(t){this.setOption("behavioursEnabled",t)},t.prototype.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},t.prototype.setWrapBehavioursEnabled=function(t){this.setOption("wrapBehavioursEnabled",t)},t.prototype.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},t.prototype.setShowFoldWidgets=function(t){this.setOption("showFoldWidgets",t)},t.prototype.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},t.prototype.setFadeFoldWidgets=function(t){this.setOption("fadeFoldWidgets",t)},t.prototype.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},t.prototype.remove=function(t){this.selection.isEmpty()&&("left"==t?this.selection.selectLeft():this.selection.selectRight());var e=this.getSelectionRange();if(this.getBehavioursEnabled()){var i=this.session,n=i.getState(e.start.row),s=i.getMode().transformAction(n,"deletion",this,i,e);if(0===e.end.column){var o=i.getTextRange(e);if("\n"==o[o.length-1]){var r=i.getLine(e.end.row);/^\s+$/.test(r)&&(e.end.column=r.length)}}s&&(e=s)}this.session.remove(e),this.clearSelection()},t.prototype.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},t.prototype.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},t.prototype.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.selection.isEmpty()&&this.selection.selectLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},t.prototype.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var t=this.getSelectionRange();t.start.column==t.end.column&&t.start.row==t.end.row&&(t.end.column=0,t.end.row++),this.session.remove(t),this.clearSelection()},t.prototype.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var t=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(t)},t.prototype.setGhostText=function(t,e){this.session.widgetManager||(this.session.widgetManager=new w(this.session),this.session.widgetManager.attach(this)),this.renderer.setGhostText(t,e)},t.prototype.removeGhostText=function(){this.session.widgetManager&&this.renderer.removeGhostText()},t.prototype.transposeLetters=function(){if(this.selection.isEmpty()){var t=this.getCursorPosition(),e=t.column;if(0!==e){var i,n,s=this.session.getLine(t.row);e<s.length?(i=s.charAt(e)+s.charAt(e-1),n=new g(t.row,e-1,t.row,e+1)):(i=s.charAt(e-1)+s.charAt(e-2),n=new g(t.row,e-2,t.row,e)),this.session.replace(n,i),this.session.selection.moveToPosition(n.end)}}},t.prototype.toLowerCase=function(){var t=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var e=this.getSelectionRange(),i=this.session.getTextRange(e);this.session.replace(e,i.toLowerCase()),this.selection.setSelectionRange(t)},t.prototype.toUpperCase=function(){var t=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var e=this.getSelectionRange(),i=this.session.getTextRange(e);this.session.replace(e,i.toUpperCase()),this.selection.setSelectionRange(t)},t.prototype.indent=function(){var t=this.session,e=this.getSelectionRange();if(!(e.start.row<e.end.row)){if(e.start.column<e.end.column){var i=t.getTextRange(e);if(!/^\s+$/.test(i))return c=this.$getSelectedRows(),void t.indentRows(c.first,c.last,"\t")}var n=t.getLine(e.start.row),s=e.start,o=t.getTabSize(),a=t.documentToScreenColumn(s.row,s.column);if(this.session.getUseSoftTabs())var l=o-a%o,h=r.stringRepeat(" ",l);else{for(l=a%o;" "==n[e.start.column-1]&&l;)e.start.column--,l--;this.selection.setSelectionRange(e),h="\t"}return this.insert(h)}var c=this.$getSelectedRows();t.indentRows(c.first,c.last,"\t")},t.prototype.blockIndent=function(){var t=this.$getSelectedRows();this.session.indentRows(t.first,t.last,"\t")},t.prototype.blockOutdent=function(){var t=this.session.getSelection();this.session.outdentRows(t.getRange())},t.prototype.sortLines=function(){for(var t=this.$getSelectedRows(),e=this.session,i=[],n=t.first;n<=t.last;n++)i.push(e.getLine(n));i.sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}));var s=new g(0,0,0,0);for(n=t.first;n<=t.last;n++){var o=e.getLine(n);s.start.row=n,s.end.row=n,s.end.column=o.length,e.replace(s,i[n-t.first])}},t.prototype.toggleCommentLines=function(){var t=this.session.getState(this.getCursorPosition().row),e=this.$getSelectedRows();this.session.getMode().toggleCommentLines(t,this.session,e.first,e.last)},t.prototype.toggleBlockComment=function(){var t=this.getCursorPosition(),e=this.session.getState(t.row),i=this.getSelectionRange();this.session.getMode().toggleBlockComment(e,this.session,i,t)},t.prototype.getNumberAt=function(t,e){var i=/[\-]?[0-9]+(?:\.[0-9]+)?/g;i.lastIndex=0;for(var n=this.session.getLine(t);i.lastIndex<e;){var s=i.exec(n);if(s.index<=e&&s.index+s[0].length>=e)return{value:s[0],start:s.index,end:s.index+s[0].length}}return null},t.prototype.modifyNumber=function(t){var e=this.selection.getCursor().row,i=this.selection.getCursor().column,n=new g(e,i-1,e,i),s=this.session.getTextRange(n);if(!isNaN(parseFloat(s))&&isFinite(s)){var o=this.getNumberAt(e,i);if(o){var r=o.value.indexOf(".")>=0?o.start+o.value.indexOf(".")+1:o.end,a=o.start+o.value.length-r,l=parseFloat(o.value);l*=Math.pow(10,a),r!==o.end&&i<r?t*=Math.pow(10,o.end-i-1):t*=Math.pow(10,o.end-i),l+=t;var h=(l/=Math.pow(10,a)).toFixed(a),c=new g(e,o.start,e,o.end);this.session.replace(c,h),this.moveCursorTo(e,Math.max(o.start+1,i+h.length-o.value.length))}}else this.toggleWord()},t.prototype.toggleWord=function(){var t=this.selection.getCursor().row,e=this.selection.getCursor().column;this.selection.selectWord();var i=this.getSelectedText(),n=this.selection.getWordRange().start.column,s=i.replace(/([a-z]+|[A-Z]+)(?=[A-Z_]|$)/g,"$1 ").split(/\s/),o=e-n-1;o<0&&(o=0);var a=0,l=0,h=this;i.match(/[A-Za-z0-9_]+/)&&s.forEach((function(e,s){l=a+e.length,o>=a&&o<=l&&(i=e,h.selection.clearSelection(),h.moveCursorTo(t,a+n),h.selection.selectTo(t,l+n)),a=l}));for(var c,d=this.$toggleWordPairs,u=0;u<d.length;u++)for(var p=d[u],g=0;g<=1;g++){var f=+!g,m=i.match(new RegExp("^\\s?_?("+r.escapeRegExp(p[g])+")\\s?$","i"));m&&i.match(new RegExp("([_]|^|\\s)("+r.escapeRegExp(m[1])+")($|\\s)","g"))&&(c=i.replace(new RegExp(r.escapeRegExp(p[g]),"i"),(function(t){var e=p[f];return t.toUpperCase()==t?e=e.toUpperCase():t.charAt(0).toUpperCase()==t.charAt(0)&&(e=e.substr(0,0)+p[f].charAt(0).toUpperCase()+e.substr(1)),e})),this.insert(c),c="")}},t.prototype.findLinkAt=function(t,e){var i,s,o=this.session.getLine(t).split(/((?:https?|ftp):\/\/[\S]+)/),r=e;r<0&&(r=0);var a,l=0,h=0;try{for(var c=n(o),d=c.next();!d.done;d=c.next()){var u=d.value;if(h=l+u.length,r>=l&&r<=h&&u.match(/((?:https?|ftp):\/\/[\S]+)/)){a=u.replace(/[\s:.,'";}\]]+$/,"");break}l=h}}catch(t){i={error:t}}finally{try{d&&!d.done&&(s=c.return)&&s.call(c)}finally{if(i)throw i.error}}return a},t.prototype.openLink=function(){var t=this.selection.getCursor(),e=this.findLinkAt(t.row,t.column);return e&&window.open(e,"_blank"),null!=e},t.prototype.removeLines=function(){var t=this.$getSelectedRows();this.session.removeFullLines(t.first,t.last),this.clearSelection()},t.prototype.duplicateSelection=function(){var t=this.selection,e=this.session,i=t.getRange(),n=t.isBackwards();if(i.isEmpty()){var s=i.start.row;e.duplicateLines(s,s)}else{var o=n?i.start:i.end,r=e.insert(o,e.getTextRange(i));i.start=o,i.end=r,t.setSelectionRange(i,n)}},t.prototype.moveLinesDown=function(){this.$moveLines(1,!1)},t.prototype.moveLinesUp=function(){this.$moveLines(-1,!1)},t.prototype.moveText=function(t,e,i){return this.session.moveText(t,e,i)},t.prototype.copyLinesUp=function(){this.$moveLines(-1,!0)},t.prototype.copyLinesDown=function(){this.$moveLines(1,!0)},t.prototype.$moveLines=function(t,e){var i,n,s=this.selection;if(!s.inMultiSelectMode||this.inVirtualSelectionMode){var o=s.toOrientedRange();i=this.$getSelectedRows(o),n=this.session.$moveLines(i.first,i.last,e?0:t),e&&-1==t&&(n=0),o.moveBy(n,0),s.fromOrientedRange(o)}else{var r=s.rangeList.ranges;s.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;for(var a=0,l=0,h=r.length,c=0;c<h;c++){var d=c;r[c].moveBy(a,0);for(var u=(i=this.$getSelectedRows(r[c])).first,p=i.last;++c<h;){l&&r[c].moveBy(l,0);var g=this.$getSelectedRows(r[c]);if(e&&g.first!=p)break;if(!e&&g.first>p+1)break;p=g.last}for(c--,a=this.session.$moveLines(u,p,e?0:t),e&&-1==t&&(d=c+1);d<=c;)r[d].moveBy(a,0),d++;e||(a=0),l+=a}s.fromOrientedRange(s.ranges[0]),s.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},t.prototype.$getSelectedRows=function(t){return t=(t||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(t.start.row),last:this.session.getRowFoldEnd(t.end.row)}},t.prototype.onCompositionStart=function(t){this.renderer.showComposition(t)},t.prototype.onCompositionUpdate=function(t){this.renderer.setCompositionText(t)},t.prototype.onCompositionEnd=function(){this.renderer.hideComposition()},t.prototype.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},t.prototype.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},t.prototype.isRowVisible=function(t){return t>=this.getFirstVisibleRow()&&t<=this.getLastVisibleRow()},t.prototype.isRowFullyVisible=function(t){return t>=this.renderer.getFirstFullyVisibleRow()&&t<=this.renderer.getLastFullyVisibleRow()},t.prototype.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},t.prototype.$moveByPage=function(t,e){var i=this.renderer,n=this.renderer.layerConfig,s=t*Math.floor(n.height/n.lineHeight);!0===e?this.selection.$moveSelection((function(){this.moveCursorBy(s,0)})):!1===e&&(this.selection.moveCursorBy(s,0),this.selection.clearSelection());var o=i.scrollTop;i.scrollBy(0,s*n.lineHeight),null!=e&&i.scrollCursorIntoView(null,.5),i.animateScrolling(o)},t.prototype.selectPageDown=function(){this.$moveByPage(1,!0)},t.prototype.selectPageUp=function(){this.$moveByPage(-1,!0)},t.prototype.gotoPageDown=function(){this.$moveByPage(1,!1)},t.prototype.gotoPageUp=function(){this.$moveByPage(-1,!1)},t.prototype.scrollPageDown=function(){this.$moveByPage(1)},t.prototype.scrollPageUp=function(){this.$moveByPage(-1)},t.prototype.scrollToRow=function(t){this.renderer.scrollToRow(t)},t.prototype.scrollToLine=function(t,e,i,n){this.renderer.scrollToLine(t,e,i,n)},t.prototype.centerSelection=function(){var t=this.getSelectionRange(),e={row:Math.floor(t.start.row+(t.end.row-t.start.row)/2),column:Math.floor(t.start.column+(t.end.column-t.start.column)/2)};this.renderer.alignCursor(e,.5)},t.prototype.getCursorPosition=function(){return this.selection.getCursor()},t.prototype.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},t.prototype.getSelectionRange=function(){return this.selection.getRange()},t.prototype.selectAll=function(){this.selection.selectAll()},t.prototype.clearSelection=function(){this.selection.clearSelection()},t.prototype.moveCursorTo=function(t,e){this.selection.moveCursorTo(t,e)},t.prototype.moveCursorToPosition=function(t){this.selection.moveCursorToPosition(t)},t.prototype.jumpToMatching=function(t,e){var i=this.getCursorPosition(),n=new y(this.session,i.row,i.column),s=n.getCurrentToken(),o=0;s&&-1!==s.type.indexOf("tag-name")&&(s=n.stepBackward());var r=s||n.stepForward();if(r){var a,l,h=!1,c={},d=i.column-r.start,u={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(r.value.match(/[{}()\[\]]/g)){for(;d<r.value.length&&!h;d++)if(u[r.value[d]])switch(l=u[r.value[d]]+"."+r.type.replace("rparen","lparen"),isNaN(c[l])&&(c[l]=0),r.value[d]){case"(":case"[":case"{":c[l]++;break;case")":case"]":case"}":c[l]--,-1===c[l]&&(a="bracket",h=!0)}}else-1!==r.type.indexOf("tag-name")&&(isNaN(c[r.value])&&(c[r.value]=0),"<"===s.value&&o>1?c[r.value]++:"</"===s.value&&c[r.value]--,-1===c[r.value]&&(a="tag",h=!0));h||(s=r,o++,r=n.stepForward(),d=0)}while(r&&!h);if(a){var p,f;if("bracket"===a)(p=this.session.getBracketRange(i))||(f=(p=new g(n.getCurrentTokenRow(),n.getCurrentTokenColumn()+d-1,n.getCurrentTokenRow(),n.getCurrentTokenColumn()+d-1)).start,(e||f.row===i.row&&Math.abs(f.column-i.column)<2)&&(p=this.session.getBracketRange(f)));else if("tag"===a){if(!r||-1===r.type.indexOf("tag-name"))return;if(0===(p=new g(n.getCurrentTokenRow(),n.getCurrentTokenColumn()-2,n.getCurrentTokenRow(),n.getCurrentTokenColumn()-2)).compare(i.row,i.column)){var m=this.session.getMatchingTags(i);m&&(m.openTag.contains(i.row,i.column)?f=(p=m.closeTag).start:(p=m.openTag,f=m.closeTag.start.row===i.row&&m.closeTag.start.column===i.column?p.end:p.start))}f=f||p.start}(f=p&&p.cursor||f)&&(t?p&&e?this.selection.setRange(p):p&&p.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(f.row,f.column):this.selection.moveTo(f.row,f.column))}}},t.prototype.gotoLine=function(t,e,i){this.selection.clearSelection(),this.session.unfold({row:t-1,column:e||0}),this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(t-1,e||0),this.isRowFullyVisible(t-1)||this.scrollToLine(t-1,!0,i)},t.prototype.navigateTo=function(t,e){this.selection.moveTo(t,e)},t.prototype.navigateUp=function(t){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var e=this.selection.anchor.getPosition();return this.moveCursorToPosition(e)}this.selection.clearSelection(),this.selection.moveCursorBy(-t||-1,0)},t.prototype.navigateDown=function(t){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var e=this.selection.anchor.getPosition();return this.moveCursorToPosition(e)}this.selection.clearSelection(),this.selection.moveCursorBy(t||1,0)},t.prototype.navigateLeft=function(t){if(this.selection.isEmpty())for(t=t||1;t--;)this.selection.moveCursorLeft();else{var e=this.getSelectionRange().start;this.moveCursorToPosition(e)}this.clearSelection()},t.prototype.navigateRight=function(t){if(this.selection.isEmpty())for(t=t||1;t--;)this.selection.moveCursorRight();else{var e=this.getSelectionRange().end;this.moveCursorToPosition(e)}this.clearSelection()},t.prototype.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},t.prototype.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},t.prototype.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},t.prototype.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},t.prototype.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},t.prototype.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},t.prototype.replace=function(t,e){e&&this.$search.set(e);var i=this.$search.find(this.session),n=0;return i?(this.$tryReplace(i,t)&&(n=1),this.selection.setSelectionRange(i),this.renderer.scrollSelectionIntoView(i.start,i.end),n):n},t.prototype.replaceAll=function(t,e){e&&this.$search.set(e);var i=this.$search.findAll(this.session),n=0;if(!i.length)return n;var s=this.getSelectionRange();this.selection.moveTo(0,0);for(var o=i.length-1;o>=0;--o)this.$tryReplace(i[o],t)&&n++;return this.selection.setSelectionRange(s),n},t.prototype.$tryReplace=function(t,e){var i=this.session.getTextRange(t);return null!==(e=this.$search.replace(i,e))?(t.end=this.session.replace(t,e),t):null},t.prototype.getLastSearchOptions=function(){return this.$search.getOptions()},t.prototype.find=function(t,e,i){e||(e={}),"string"==typeof t||t instanceof RegExp?e.needle=t:"object"==typeof t&&s.mixin(e,t);var n=this.selection.getRange();null==e.needle&&((t=this.session.getTextRange(n)||this.$search.$options.needle)||(n=this.session.getWordRange(n.start.row,n.start.column),t=this.session.getTextRange(n)),this.$search.set({needle:t})),this.$search.set(e),e.start||this.$search.set({start:n});var o=this.$search.find(this.session);return e.preventScroll?o:o?(this.revealRange(o,i),o):(e.backwards?n.start=n.end:n.end=n.start,void this.selection.setRange(n))},t.prototype.findNext=function(t,e){this.find({skipCurrent:!0,backwards:!1},t,e)},t.prototype.findPrevious=function(t,e){this.find(t,{skipCurrent:!0,backwards:!0},e)},t.prototype.revealRange=function(t,e){this.session.unfold(t),this.selection.setSelectionRange(t);var i=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(t.start,t.end,.5),!1!==e&&this.renderer.animateScrolling(i)},t.prototype.undo=function(){this.session.getUndoManager().undo(this.session),this.renderer.scrollCursorIntoView(null,.5)},t.prototype.redo=function(){this.session.getUndoManager().redo(this.session),this.renderer.scrollCursorIntoView(null,.5)},t.prototype.destroy=function(){this.$toDestroy&&(this.$toDestroy.forEach((function(t){t.destroy()})),this.$toDestroy=null),this.$mouseHandler&&this.$mouseHandler.destroy(),this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy(),this._$emitInputEvent&&this._$emitInputEvent.cancel(),this.removeAllListeners()},t.prototype.setAutoScrollEditorIntoView=function(t){if(t){var e,i=this,n=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var s=this.$scrollAnchor;s.style.cssText="position:absolute",this.container.insertBefore(s,this.container.firstChild);var o=this.on("changeSelection",(function(){n=!0})),r=this.renderer.on("beforeRender",(function(){n&&(e=i.renderer.container.getBoundingClientRect())})),a=this.renderer.on("afterRender",(function(){if(n&&e&&(i.isFocused()||i.searchBox&&i.searchBox.isFocused())){var t=i.renderer,o=t.$cursorLayer.$pixelPos,r=t.layerConfig,a=o.top-r.offset;null!=(n=o.top>=0&&a+e.top<0||!(o.top<r.height&&o.top+e.top+r.lineHeight>window.innerHeight)&&null)&&(s.style.top=a+"px",s.style.left=o.left+"px",s.style.height=r.lineHeight+"px",s.scrollIntoView(n)),n=e=null}}));this.setAutoScrollEditorIntoView=function(t){t||(delete this.setAutoScrollEditorIntoView,this.off("changeSelection",o),this.renderer.off("afterRender",a),this.renderer.off("beforeRender",r))}}},t.prototype.$resetCursorStyle=function(){var t=this.$cursorStyle||"ace",e=this.renderer.$cursorLayer;e&&(e.setSmoothBlinking(/smooth/.test(t)),e.isBlinking=!this.$readOnly&&"wide"!=t,o.setCssClass(e.element,"ace_slim-cursors",/slim/.test(t)))},t.prototype.prompt=function(t,e,i){var n=this;_.loadModule("ace/ext/prompt",(function(s){s.prompt(n,t,e,i)}))},t}();S.$uid=0,S.prototype.curOp=null,S.prototype.prevOp={},S.prototype.$mergeableCommands=["backspace","del","insertstring"],S.prototype.$toggleWordPairs=[["first","last"],["true","false"],["yes","no"],["width","height"],["top","bottom"],["right","left"],["on","off"],["x","y"],["get","set"],["max","min"],["horizontal","vertical"],["show","hide"],["add","remove"],["up","down"],["before","after"],["even","odd"],["in","out"],["inside","outside"],["next","previous"],["increase","decrease"],["attach","detach"],["&&","||"],["==","!="]],s.implement(S.prototype,f),_.defineOptions(S.prototype,"editor",{selectionStyle:{set:function(t){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:t})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(t){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(t){this.textInput.setReadOnly(t),this.$resetCursorStyle()},initialValue:!1},copyWithEmptySelection:{set:function(t){this.textInput.setCopyWithEmptySelection(t)},initialValue:!1},cursorStyle:{set:function(t){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},enableAutoIndent:{initialValue:!0},autoScrollEditorIntoView:{set:function(t){this.setAutoScrollEditorIntoView(t)}},keyboardHandler:{set:function(t){this.setKeyboardHandler(t)},get:function(){return this.$keybindingId},handlesSet:!0},value:{set:function(t){this.session.setValue(t)},get:function(){return this.getValue()},handlesSet:!0,hidden:!0},session:{set:function(t){this.setSession(t)},get:function(){return this.session},handlesSet:!0,hidden:!0},showLineNumbers:{set:function(t){this.renderer.$gutterLayer.setShowLineNumbers(t),this.renderer.$loop.schedule(this.renderer.CHANGE_GUTTER),t&&this.$relativeLineNumbers?E.attach(this):E.detach(this)},initialValue:!0},relativeLineNumbers:{set:function(t){this.$showLineNumbers&&t?E.attach(this):E.detach(this)}},placeholder:{set:function(t){this.$updatePlaceholder||(this.$updatePlaceholder=function(){var t=this.session&&(this.renderer.$composition||this.session.getLength()>1||this.session.getLine(0).length>0);if(t&&this.renderer.placeholderNode)this.renderer.off("afterRender",this.$updatePlaceholder),o.removeCssClass(this.container,"ace_hasPlaceholder"),this.renderer.placeholderNode.remove(),this.renderer.placeholderNode=null;else if(t||this.renderer.placeholderNode)!t&&this.renderer.placeholderNode&&(this.renderer.placeholderNode.textContent=this.$placeholder||"");else{this.renderer.on("afterRender",this.$updatePlaceholder),o.addCssClass(this.container,"ace_hasPlaceholder");var e=o.createElement("div");e.className="ace_placeholder",e.textContent=this.$placeholder||"",this.renderer.placeholderNode=e,this.renderer.content.appendChild(this.renderer.placeholderNode)}}.bind(this),this.on("input",this.$updatePlaceholder)),this.$updatePlaceholder()}},enableKeyboardAccessibility:{set:function(t){var e,i={name:"blurTextInput",description:"Set focus to the editor content div to allow tabbing through the page",bindKey:"Esc",exec:function(t){t.blur(),t.renderer.scroller.focus()},readOnly:!0},n=function(t){if(t.target==this.renderer.scroller&&t.keyCode===A.enter){t.preventDefault();var e=this.getCursorPosition().row;this.isRowVisible(e)||this.scrollToLine(e,!0,!0),this.focus()}};t?(this.renderer.enableKeyboardAccessibility=!0,this.renderer.keyboardFocusClassName="ace_keyboard-focus",this.textInput.getElement().setAttribute("tabindex",-1),this.textInput.setNumberOfExtraLines(a.isWin?3:0),this.renderer.scroller.setAttribute("tabindex",0),this.renderer.scroller.setAttribute("role","group"),this.renderer.scroller.setAttribute("aria-roledescription",b("editor.scroller.aria-roledescription","editor")),this.renderer.scroller.classList.add(this.renderer.keyboardFocusClassName),this.renderer.scroller.setAttribute("aria-label",b("editor.scroller.aria-label","Editor content, press Enter to start editing, press Escape to exit")),this.renderer.scroller.addEventListener("keyup",n.bind(this)),this.commands.addCommand(i),this.renderer.$gutter.setAttribute("tabindex",0),this.renderer.$gutter.setAttribute("aria-hidden",!1),this.renderer.$gutter.setAttribute("role","group"),this.renderer.$gutter.setAttribute("aria-roledescription",b("editor.gutter.aria-roledescription","editor")),this.renderer.$gutter.setAttribute("aria-label",b("editor.gutter.aria-label","Editor gutter, press Enter to interact with controls using arrow keys, press Escape to exit")),this.renderer.$gutter.classList.add(this.renderer.keyboardFocusClassName),this.renderer.content.setAttribute("aria-hidden",!0),e||(e=new x(this)),e.addListener(),this.textInput.setAriaOptions({setLabel:!0})):(this.renderer.enableKeyboardAccessibility=!1,this.textInput.getElement().setAttribute("tabindex",0),this.textInput.setNumberOfExtraLines(0),this.renderer.scroller.setAttribute("tabindex",-1),this.renderer.scroller.removeAttribute("role"),this.renderer.scroller.removeAttribute("aria-roledescription"),this.renderer.scroller.classList.remove(this.renderer.keyboardFocusClassName),this.renderer.scroller.removeAttribute("aria-label"),this.renderer.scroller.removeEventListener("keyup",n.bind(this)),this.commands.removeCommand(i),this.renderer.content.removeAttribute("aria-hidden"),this.renderer.$gutter.setAttribute("tabindex",-1),this.renderer.$gutter.setAttribute("aria-hidden",!0),this.renderer.$gutter.removeAttribute("role"),this.renderer.$gutter.removeAttribute("aria-roledescription"),this.renderer.$gutter.removeAttribute("aria-label"),this.renderer.$gutter.classList.remove(this.renderer.keyboardFocusClassName),e&&e.removeListener())},initialValue:!1},textInputAriaLabel:{set:function(t){this.$textInputAriaLabel=t},initialValue:""},enableMobileMenu:{set:function(t){this.$enableMobileMenu=t},initialValue:!0},customScrollbar:"renderer",hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",displayIndentGuides:"renderer",highlightIndentGuides:"renderer",showGutter:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",hasCssTransforms:"renderer",maxPixelHeight:"renderer",useTextareaForIME:"renderer",useResizeObserver:"renderer",useSvgGutterIcons:"renderer",showFoldedAnnotations:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimeout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",navigateWithinSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"});var E={getText:function(t,e){return(Math.abs(t.selection.lead.row-e)||e+1+(e<9?"·":""))+""},getWidth:function(t,e,i){return Math.max(e.toString().length,(i.lastRow+1).toString().length,2)*i.characterWidth},update:function(t,e){e.renderer.$loop.schedule(e.renderer.CHANGE_GUTTER)},attach:function(t){t.renderer.$gutterLayer.$renderer=this,t.on("changeSelection",this.update),this.update(null,t)},detach:function(t){t.renderer.$gutterLayer.$renderer==this&&(t.renderer.$gutterLayer.$renderer=null),t.off("changeSelection",this.update),this.update(null,t)}};e.Editor=S})),ace.define("ace/layer/lines",["require","exports","module","ace/lib/dom"],(function(t,e,i){"use strict";var n=t("../lib/dom"),s=function(){function t(t,e){this.element=t,this.canvasHeight=e||5e5,this.element.style.height=2*this.canvasHeight+"px",this.cells=[],this.cellCache=[],this.$offsetCoefficient=0}return t.prototype.moveContainer=function(t){n.translate(this.element,0,-t.firstRowScreen*t.lineHeight%this.canvasHeight-t.offset*this.$offsetCoefficient)},t.prototype.pageChanged=function(t,e){return Math.floor(t.firstRowScreen*t.lineHeight/this.canvasHeight)!==Math.floor(e.firstRowScreen*e.lineHeight/this.canvasHeight)},t.prototype.computeLineTop=function(t,e,i){var n=e.firstRowScreen*e.lineHeight,s=Math.floor(n/this.canvasHeight);return i.documentToScreenRow(t,0)*e.lineHeight-s*this.canvasHeight},t.prototype.computeLineHeight=function(t,e,i){return e.lineHeight*i.getRowLineCount(t)},t.prototype.getLength=function(){return this.cells.length},t.prototype.get=function(t){return this.cells[t]},t.prototype.shift=function(){this.$cacheCell(this.cells.shift())},t.prototype.pop=function(){this.$cacheCell(this.cells.pop())},t.prototype.push=function(t){if(Array.isArray(t)){this.cells.push.apply(this.cells,t);for(var e=n.createFragment(this.element),i=0;i<t.length;i++)e.appendChild(t[i].element);this.element.appendChild(e)}else this.cells.push(t),this.element.appendChild(t.element)},t.prototype.unshift=function(t){if(Array.isArray(t)){this.cells.unshift.apply(this.cells,t);for(var e=n.createFragment(this.element),i=0;i<t.length;i++)e.appendChild(t[i].element);this.element.firstChild?this.element.insertBefore(e,this.element.firstChild):this.element.appendChild(e)}else this.cells.unshift(t),this.element.insertAdjacentElement("afterbegin",t.element)},t.prototype.last=function(){return this.cells.length?this.cells[this.cells.length-1]:null},t.prototype.$cacheCell=function(t){t&&(t.element.remove(),this.cellCache.push(t))},t.prototype.createCell=function(t,e,i,s){var o=this.cellCache.pop();if(!o){var r=n.createElement("div");s&&s(r),this.element.appendChild(r),o={element:r,text:"",row:t}}return o.row=t,o},t}();e.Lines=s})),ace.define("ace/layer/gutter",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/layer/lines","ace/config"],(function(t,e,i){"use strict";var n=t("../lib/dom"),s=t("../lib/oop"),o=t("../lib/lang"),r=t("../lib/event_emitter").EventEmitter,a=t("./lines").Lines,l=t("../config").nls,h=function(){function t(t){this.element=n.createElement("div"),this.element.className="ace_layer ace_gutter-layer",t.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$lines=new a(this.element),this.$lines.$offsetCoefficient=1}return t.prototype.setSession=function(t){this.session&&this.session.off("change",this.$updateAnnotations),this.session=t,t&&t.on("change",this.$updateAnnotations)},t.prototype.addGutterDecoration=function(t,e){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(t,e)},t.prototype.removeGutterDecoration=function(t,e){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(t,e)},t.prototype.setAnnotations=function(t){this.$annotations=[];for(var e=0;e<t.length;e++){var i=t[e],n=i.row,s=this.$annotations[n];s||(s=this.$annotations[n]={text:[],type:[],displayText:[]});var r=i.text,a=i.text,l=i.type;r=r?o.escapeHTML(r):i.html||"",a=a||i.html||"",-1===s.text.indexOf(r)&&(s.text.push(r),s.type.push(l),s.displayText.push(a));var h=i.className;h?s.className=h:"error"===l?s.className=" ace_error":"security"!==l||/\bace_error\b/.test(s.className)?"warning"!==l||/\bace_(error|security)\b/.test(s.className)?"info"!==l||s.className?"hint"!==l||s.className||(s.className=" ace_hint"):s.className=" ace_info":s.className=" ace_warning":s.className=" ace_security"}},t.prototype.$updateAnnotations=function(t){if(this.$annotations.length){var e=t.start.row,i=t.end.row-e;if(0===i);else if("remove"==t.action)this.$annotations.splice(e,i+1,null);else{var n=new Array(i+1);n.unshift(e,1),this.$annotations.splice.apply(this.$annotations,n)}}},t.prototype.update=function(t){this.config=t;var e=this.session,i=t.firstRow,n=Math.min(t.lastRow+t.gutterOffset,e.getLength()-1);this.oldLastRow=n,this.config=t,this.$lines.moveContainer(t),this.$updateCursorRow();for(var s=e.getNextFoldLine(i),o=s?s.start.row:1/0,r=null,a=-1,l=i;;){if(l>o&&(l=s.end.row+1,o=(s=e.getNextFoldLine(l,s))?s.start.row:1/0),l>n){for(;this.$lines.getLength()>a+1;)this.$lines.pop();break}(r=this.$lines.get(++a))?r.row=l:(r=this.$lines.createCell(l,t,this.session,c),this.$lines.push(r)),this.$renderCell(r,t,s,l),l++}this._signal("afterRender"),this.$updateGutterWidth(t)},t.prototype.$updateGutterWidth=function(t){var e=this.session,i=e.gutterRenderer||this.$renderer,n=e.$firstLineNumber,s=this.$lines.last()?this.$lines.last().text:"";(this.$fixedWidth||e.$useWrapMode)&&(s=e.getLength()+n-1);var o=i?i.getWidth(e,s,t):s.toString().length*t.characterWidth,r=this.$padding||this.$computePadding();(o+=r.left+r.right)===this.gutterWidth||isNaN(o)||(this.gutterWidth=o,this.element.parentNode.style.width=this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._signal("changeGutterWidth",o))},t.prototype.$updateCursorRow=function(){if(this.$highlightGutterLine){var t=this.session.selection.getCursor();this.$cursorRow!==t.row&&(this.$cursorRow=t.row)}},t.prototype.updateLineHighlight=function(){if(this.$highlightGutterLine){var t=this.session.selection.cursor.row;if(this.$cursorRow=t,!this.$cursorCell||this.$cursorCell.row!=t){this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ",""));var e=this.$lines.cells;this.$cursorCell=null;for(var i=0;i<e.length;i++){var n=e[i];if(n.row>=this.$cursorRow){if(n.row>this.$cursorRow){var s=this.session.getFoldLine(this.$cursorRow);if(!(i>0&&s&&s.start.row==e[i-1].row))break;n=e[i-1]}n.element.className="ace_gutter-active-line "+n.element.className,this.$cursorCell=n;break}}}}},t.prototype.scrollLines=function(t){var e=this.config;if(this.config=t,this.$updateCursorRow(),this.$lines.pageChanged(e,t))return this.update(t);this.$lines.moveContainer(t);var i=Math.min(t.lastRow+t.gutterOffset,this.session.getLength()-1),n=this.oldLastRow;if(this.oldLastRow=i,!e||n<t.firstRow)return this.update(t);if(i<e.firstRow)return this.update(t);if(e.firstRow<t.firstRow)for(var s=this.session.getFoldedRowCount(e.firstRow,t.firstRow-1);s>0;s--)this.$lines.shift();if(n>i)for(s=this.session.getFoldedRowCount(i+1,n);s>0;s--)this.$lines.pop();t.firstRow<e.firstRow&&this.$lines.unshift(this.$renderLines(t,t.firstRow,e.firstRow-1)),i>n&&this.$lines.push(this.$renderLines(t,n+1,i)),this.updateLineHighlight(),this._signal("afterRender"),this.$updateGutterWidth(t)},t.prototype.$renderLines=function(t,e,i){for(var n=[],s=e,o=this.session.getNextFoldLine(s),r=o?o.start.row:1/0;s>r&&(s=o.end.row+1,r=(o=this.session.getNextFoldLine(s,o))?o.start.row:1/0),!(s>i);){var a=this.$lines.createCell(s,t,this.session,c);this.$renderCell(a,t,o,s),n.push(a),s++}return n},t.prototype.$renderCell=function(t,e,i,s){var o=t.element,r=this.session,a=o.childNodes[0],h=o.childNodes[1],c=o.childNodes[2],d=c.firstChild,u=r.$firstLineNumber,p=r.$breakpoints,g=r.$decorations,f=r.gutterRenderer||this.$renderer,m=this.$showFoldWidgets&&r.foldWidgets,v=i?i.start.row:Number.MAX_VALUE,_=e.lineHeight+"px",y=this.$useSvgGutterIcons?"ace_gutter-cell_svg-icons ":"ace_gutter-cell ",w=this.$useSvgGutterIcons?"ace_icon_svg":"ace_icon",x=(f?f.getText(r,s):s+u).toString();if(this.$highlightGutterLine&&(s==this.$cursorRow||i&&s<this.$cursorRow&&s>=v&&this.$cursorRow<=i.end.row)&&(y+="ace_gutter-active-line ",this.$cursorCell!=t&&(this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ","")),this.$cursorCell=t)),p[s]&&(y+=p[s]),g[s]&&(y+=g[s]),this.$annotations[s]&&s!==v&&(y+=this.$annotations[s].className),m){var b=m[s];null==b&&(b=m[s]=r.getFoldWidget(s))}if(b){var C="ace_fold-widget ace_"+b,A="start"==b&&s==v&&s<i.end.row;if(A){C+=" ace_closed";for(var S="",E=!1,T=s+1;T<=i.end.row;T++)if(this.$annotations[T]){if(" ace_error"===this.$annotations[T].className){E=!0,S=" ace_error_fold";break}" ace_security"===this.$annotations[T].className?(E=!0,S=" ace_security_fold"):" ace_warning"===this.$annotations[T].className&&" ace_security_fold"!==S&&(E=!0,S=" ace_warning_fold")}y+=S}else C+=" ace_open";h.className!=C&&(h.className=C),n.setStyle(h.style,"height",_),n.setStyle(h.style,"display","inline-block"),h.setAttribute("role","button"),h.setAttribute("tabindex","-1");var k=r.getFoldWidgetRange(s);k?h.setAttribute("aria-label",l("gutter.code-folding.range.aria-label","Toggle code folding, rows $0 through $1",[k.start.row+1,k.end.row+1])):i?h.setAttribute("aria-label",l("gutter.code-folding.closed.aria-label","Toggle code folding, rows $0 through $1",[i.start.row+1,i.end.row+1])):h.setAttribute("aria-label",l("gutter.code-folding.open.aria-label","Toggle code folding, row $0",[s+1])),A?(h.setAttribute("aria-expanded","false"),h.setAttribute("title",l("gutter.code-folding.closed.title","Unfold code"))):(h.setAttribute("aria-expanded","true"),h.setAttribute("title",l("gutter.code-folding.open.title","Fold code")))}else h&&(n.setStyle(h.style,"display","none"),h.setAttribute("tabindex","0"),h.removeAttribute("role"),h.removeAttribute("aria-label"));if(E&&this.$showFoldedAnnotations){switch(c.className="ace_gutter_annotation",d.className=w,d.className+=S,n.setStyle(d.style,"height",_),n.setStyle(c.style,"display","block"),n.setStyle(c.style,"height",_),S){case" ace_error_fold":M=l("gutter.annotation.aria-label.error","Error, read annotations row $0",[x]);break;case" ace_security_fold":M=l("gutter.annotation.aria-label.security","Security finding, read annotations row $0",[x]);break;case" ace_warning_fold":M=l("gutter.annotation.aria-label.warning","Warning, read annotations row $0",[x])}c.setAttribute("aria-label",M),c.setAttribute("tabindex","-1"),c.setAttribute("role","button")}else if(this.$annotations[s]){var M;switch(c.className="ace_gutter_annotation",d.className=w,this.$useSvgGutterIcons?d.className+=this.$annotations[s].className:o.classList.add(this.$annotations[s].className.replace(" ","")),n.setStyle(d.style,"height",_),n.setStyle(c.style,"display","block"),n.setStyle(c.style,"height",_),this.$annotations[s].className){case" ace_error":M=l("gutter.annotation.aria-label.error","Error, read annotations row $0",[x]);break;case" ace_security":M=l("gutter.annotation.aria-label.security","Security finding, read annotations row $0",[x]);break;case" ace_warning":M=l("gutter.annotation.aria-label.warning","Warning, read annotations row $0",[x]);break;case" ace_info":M=l("gutter.annotation.aria-label.info","Info, read annotations row $0",[x]);break;case" ace_hint":M=l("gutter.annotation.aria-label.hint","Suggestion, read annotations row $0",[x])}c.setAttribute("aria-label",M),c.setAttribute("tabindex","-1"),c.setAttribute("role","button")}else n.setStyle(c.style,"display","none"),c.removeAttribute("aria-label"),c.removeAttribute("role"),c.setAttribute("tabindex","0");return x!==a.data&&(a.data=x),o.className!=y&&(o.className=y),n.setStyle(t.element.style,"height",this.$lines.computeLineHeight(s,e,r)+"px"),n.setStyle(t.element.style,"top",this.$lines.computeLineTop(s,e,r)+"px"),t.text=x,"none"===c.style.display&&"none"===h.style.display?t.element.setAttribute("aria-hidden",!0):t.element.setAttribute("aria-hidden",!1),t},t.prototype.setHighlightGutterLine=function(t){this.$highlightGutterLine=t},t.prototype.setShowLineNumbers=function(t){this.$renderer=!t&&{getWidth:function(){return 0},getText:function(){return""}}},t.prototype.getShowLineNumbers=function(){return this.$showLineNumbers},t.prototype.setShowFoldWidgets=function(t){t?n.addCssClass(this.element,"ace_folding-enabled"):n.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=t,this.$padding=null},t.prototype.getShowFoldWidgets=function(){return this.$showFoldWidgets},t.prototype.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var t=n.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=(parseInt(t.borderLeftWidth)||0)+(parseInt(t.paddingLeft)||0)+1,this.$padding.right=(parseInt(t.borderRightWidth)||0)+(parseInt(t.paddingRight)||0),this.$padding},t.prototype.getRegion=function(t){var e=this.$padding||this.$computePadding(),i=this.element.getBoundingClientRect();return t.x<e.left+i.left?"markers":this.$showFoldWidgets&&t.x>i.right-e.right?"foldWidgets":void 0},t}();function c(t){var e=document.createTextNode("");t.appendChild(e);var i=n.createElement("span");t.appendChild(i);var s=n.createElement("span");t.appendChild(s);var o=n.createElement("span");return s.appendChild(o),t}h.prototype.$fixedWidth=!1,h.prototype.$highlightGutterLine=!0,h.prototype.$renderer="",h.prototype.$showLineNumbers=!0,h.prototype.$showFoldWidgets=!0,s.implement(h.prototype,r),e.Gutter=h})),ace.define("ace/layer/marker",["require","exports","module","ace/range","ace/lib/dom"],(function(t,e,i){"use strict";var n=t("../range").Range,s=t("../lib/dom"),o=function(){function t(t){this.element=s.createElement("div"),this.element.className="ace_layer ace_marker-layer",t.appendChild(this.element)}return t.prototype.setPadding=function(t){this.$padding=t},t.prototype.setSession=function(t){this.session=t},t.prototype.setMarkers=function(t){this.markers=t},t.prototype.elt=function(t,e){var i=-1!=this.i&&this.element.childNodes[this.i];i?this.i++:(i=document.createElement("div"),this.element.appendChild(i),this.i=-1),i.style.cssText=e,i.className=t},t.prototype.update=function(t){if(t){var e;for(var i in this.config=t,this.i=0,this.markers){var n=this.markers[i];if(n.range){var s=n.range.clipRows(t.firstRow,t.lastRow);if(!s.isEmpty())if(s=s.toScreenRange(this.session),n.renderer){var o=this.$getTop(s.start.row,t),r=this.$padding+s.start.column*t.characterWidth;n.renderer(e,s,r,o,t)}else"fullLine"==n.type?this.drawFullLineMarker(e,s,n.clazz,t):"screenLine"==n.type?this.drawScreenLineMarker(e,s,n.clazz,t):s.isMultiLine()?"text"==n.type?this.drawTextMarker(e,s,n.clazz,t):this.drawMultiLineMarker(e,s,n.clazz,t):this.drawSingleLineMarker(e,s,n.clazz+" ace_start ace_br15",t)}else n.update(e,this,this.session,t)}if(-1!=this.i)for(;this.i<this.element.childElementCount;)this.element.removeChild(this.element.lastChild)}},t.prototype.$getTop=function(t,e){return(t-e.firstRowScreen)*e.lineHeight},t.prototype.drawTextMarker=function(t,e,i,s,o){for(var r=this.session,a=e.start.row,l=e.end.row,h=a,c=0,d=0,u=r.getScreenLastRowColumn(h),p=new n(h,e.start.column,h,d);h<=l;h++)p.start.row=p.end.row=h,p.start.column=h==a?e.start.column:r.getRowWrapIndent(h),p.end.column=u,c=d,d=u,u=h+1<l?r.getScreenLastRowColumn(h+1):h==l?0:e.end.column,this.drawSingleLineMarker(t,p,i+(h==a?" ace_start":"")+" ace_br"+((h==a||h==a+1&&e.start.column?1:0)|(c<d?2:0)|(d>u?4:0)|(h==l?8:0)),s,h==l?0:1,o)},t.prototype.drawMultiLineMarker=function(t,e,i,n,s){var o=this.$padding,r=n.lineHeight,a=this.$getTop(e.start.row,n),l=o+e.start.column*n.characterWidth;if(s=s||"",this.session.$bidiHandler.isBidiRow(e.start.row)?((h=e.clone()).end.row=h.start.row,h.end.column=this.session.getLine(h.start.row).length,this.drawBidiSingleLineMarker(t,h,i+" ace_br1 ace_start",n,null,s)):this.elt(i+" ace_br1 ace_start","height:"+r+"px;right:"+o+"px;top:"+a+"px;left:"+l+"px;"+(s||"")),this.session.$bidiHandler.isBidiRow(e.end.row)){var h;(h=e.clone()).start.row=h.end.row,h.start.column=0,this.drawBidiSingleLineMarker(t,h,i+" ace_br12",n,null,s)}else{a=this.$getTop(e.end.row,n);var c=e.end.column*n.characterWidth;this.elt(i+" ace_br12","height:"+r+"px;width:"+c+"px;top:"+a+"px;left:"+o+"px;"+(s||""))}if(!((r=(e.end.row-e.start.row-1)*n.lineHeight)<=0)){a=this.$getTop(e.start.row+1,n);var d=(e.start.column?1:0)|(e.end.column?0:8);this.elt(i+(d?" ace_br"+d:""),"height:"+r+"px;right:"+o+"px;top:"+a+"px;left:"+o+"px;"+(s||""))}},t.prototype.drawSingleLineMarker=function(t,e,i,n,s,o){if(this.session.$bidiHandler.isBidiRow(e.start.row))return this.drawBidiSingleLineMarker(t,e,i,n,s,o);var r=n.lineHeight,a=(e.end.column+(s||0)-e.start.column)*n.characterWidth,l=this.$getTop(e.start.row,n),h=this.$padding+e.start.column*n.characterWidth;this.elt(i,"height:"+r+"px;width:"+a+"px;top:"+l+"px;left:"+h+"px;"+(o||""))},t.prototype.drawBidiSingleLineMarker=function(t,e,i,n,s,o){var r=n.lineHeight,a=this.$getTop(e.start.row,n),l=this.$padding;this.session.$bidiHandler.getSelections(e.start.column,e.end.column).forEach((function(t){this.elt(i,"height:"+r+"px;width:"+(t.width+(s||0))+"px;top:"+a+"px;left:"+(l+t.left)+"px;"+(o||""))}),this)},t.prototype.drawFullLineMarker=function(t,e,i,n,s){var o=this.$getTop(e.start.row,n),r=n.lineHeight;e.start.row!=e.end.row&&(r+=this.$getTop(e.end.row,n)-o),this.elt(i,"height:"+r+"px;top:"+o+"px;left:0;right:0;"+(s||""))},t.prototype.drawScreenLineMarker=function(t,e,i,n,s){var o=this.$getTop(e.start.row,n),r=n.lineHeight;this.elt(i,"height:"+r+"px;top:"+o+"px;left:0;right:0;"+(s||""))},t}();o.prototype.$padding=0,e.Marker=o})),ace.define("ace/layer/text_util",["require","exports","module"],(function(t,e,i){var n=new Set(["text","rparen","lparen"]);e.isTextToken=function(t){return n.has(t)}})),ace.define("ace/layer/text",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/layer/lines","ace/lib/event_emitter","ace/config","ace/layer/text_util"],(function(t,e,i){"use strict";var n=t("../lib/oop"),s=t("../lib/dom"),o=t("../lib/lang"),r=t("./lines").Lines,a=t("../lib/event_emitter").EventEmitter,l=t("../config").nls,h=t("./text_util").isTextToken,c=function(){function t(t){this.dom=s,this.element=this.dom.createElement("div"),this.element.className="ace_layer ace_text-layer",t.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this),this.$lines=new r(this.element)}return t.prototype.$updateEolChar=function(){var t=this.session.doc,e="\n"==t.getNewLineCharacter()&&"windows"!=t.getNewLineMode()?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=e)return this.EOL_CHAR=e,!0},t.prototype.setPadding=function(t){this.$padding=t,this.element.style.margin="0 "+t+"px"},t.prototype.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},t.prototype.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},t.prototype.$setFontMetrics=function(t){this.$fontMetrics=t,this.$fontMetrics.on("changeCharacterSize",function(t){this._signal("changeCharacterSize",t)}.bind(this)),this.$pollSizeChanges()},t.prototype.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},t.prototype.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},t.prototype.setSession=function(t){this.session=t,t&&this.$computeTabString()},t.prototype.setShowInvisibles=function(t){return this.showInvisibles!=t&&(this.showInvisibles=t,"string"==typeof t?(this.showSpaces=/tab/i.test(t),this.showTabs=/space/i.test(t),this.showEOL=/eol/i.test(t)):this.showSpaces=this.showTabs=this.showEOL=t,this.$computeTabString(),!0)},t.prototype.setDisplayIndentGuides=function(t){return this.displayIndentGuides!=t&&(this.displayIndentGuides=t,this.$computeTabString(),!0)},t.prototype.setHighlightIndentGuides=function(t){return this.$highlightIndentGuides!==t&&(this.$highlightIndentGuides=t,t)},t.prototype.$computeTabString=function(){var t=this.session.getTabSize();this.tabSize=t;for(var e=this.$tabStrings=[0],i=1;i<t+1;i++)this.showTabs?((n=this.dom.createElement("span")).className="ace_invisible ace_invisible_tab",n.textContent=o.stringRepeat(this.TAB_CHAR,i),e.push(n)):e.push(this.dom.createTextNode(o.stringRepeat(" ",i),this.element));if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var n,s="ace_indent-guide",r=this.showSpaces?" ace_invisible ace_invisible_space":"",a=this.showSpaces?o.stringRepeat(this.SPACE_CHAR,this.tabSize):o.stringRepeat(" ",this.tabSize),l=this.showTabs?" ace_invisible ace_invisible_tab":"",h=this.showTabs?o.stringRepeat(this.TAB_CHAR,this.tabSize):a;(n=this.dom.createElement("span")).className=s+r,n.textContent=a,this.$tabStrings[" "]=n,(n=this.dom.createElement("span")).className=s+l,n.textContent=h,this.$tabStrings["\t"]=n}},t.prototype.updateLines=function(t,e,i){if(this.config.lastRow!=t.lastRow||this.config.firstRow!=t.firstRow)return this.update(t);this.config=t;for(var n=Math.max(e,t.firstRow),s=Math.min(i,t.lastRow),o=this.element.childNodes,r=0,a=t.firstRow;a<n;a++){if(l=this.session.getFoldLine(a)){if(l.containsRow(n)){n=l.start.row;break}a=l.end.row}r++}for(var l,h=!1,c=(a=n,(l=this.session.getNextFoldLine(a))?l.start.row:1/0);a>c&&(a=l.end.row+1,c=(l=this.session.getNextFoldLine(a,l))?l.start.row:1/0),!(a>s);){var d=o[r++];if(d){this.dom.removeChildren(d),this.$renderLine(d,a,a==c&&l),h&&(d.style.top=this.$lines.computeLineTop(a,t,this.session)+"px");var u=t.lineHeight*this.session.getRowLength(a)+"px";d.style.height!=u&&(h=!0,d.style.height=u)}a++}if(h)for(;r<this.$lines.cells.length;){var p=this.$lines.cells[r++];p.element.style.top=this.$lines.computeLineTop(p.row,t,this.session)+"px"}},t.prototype.scrollLines=function(t){var e=this.config;if(this.config=t,this.$lines.pageChanged(e,t))return this.update(t);this.$lines.moveContainer(t);var i=t.lastRow,n=e?e.lastRow:-1;if(!e||n<t.firstRow)return this.update(t);if(i<e.firstRow)return this.update(t);if(!e||e.lastRow<t.firstRow)return this.update(t);if(t.lastRow<e.firstRow)return this.update(t);if(e.firstRow<t.firstRow)for(var s=this.session.getFoldedRowCount(e.firstRow,t.firstRow-1);s>0;s--)this.$lines.shift();if(e.lastRow>t.lastRow)for(s=this.session.getFoldedRowCount(t.lastRow+1,e.lastRow);s>0;s--)this.$lines.pop();t.firstRow<e.firstRow&&this.$lines.unshift(this.$renderLinesFragment(t,t.firstRow,e.firstRow-1)),t.lastRow>e.lastRow&&this.$lines.push(this.$renderLinesFragment(t,e.lastRow+1,t.lastRow)),this.$highlightIndentGuide()},t.prototype.$renderLinesFragment=function(t,e,i){for(var n=[],o=e,r=this.session.getNextFoldLine(o),a=r?r.start.row:1/0;o>a&&(o=r.end.row+1,a=(r=this.session.getNextFoldLine(o,r))?r.start.row:1/0),!(o>i);){var l=this.$lines.createCell(o,t,this.session),h=l.element;this.dom.removeChildren(h),s.setStyle(h.style,"height",this.$lines.computeLineHeight(o,t,this.session)+"px"),s.setStyle(h.style,"top",this.$lines.computeLineTop(o,t,this.session)+"px"),this.$renderLine(h,o,o==a&&r),this.$useLineGroups()?h.className="ace_line_group":h.className="ace_line",n.push(l),o++}return n},t.prototype.update=function(t){this.$lines.moveContainer(t),this.config=t;for(var e=t.firstRow,i=t.lastRow,n=this.$lines;n.getLength();)n.pop();n.push(this.$renderLinesFragment(t,e,i))},t.prototype.$renderToken=function(t,e,i,n){for(var s,r=this,a=/(\t)|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\uFEFF\uFFF9-\uFFFC\u2066\u2067\u2068\u202A\u202B\u202D\u202E\u202C\u2069]+)|(\u3000)|([\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3001-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF])/g,c=this.dom.createFragment(this.element),d=0;s=a.exec(n);){var u=s[1],p=s[2],g=s[3],f=s[4],m=s[5];if(r.showSpaces||!p){var v=d!=s.index?n.slice(d,s.index):"";if(d=s.index+s[0].length,v&&c.appendChild(this.dom.createTextNode(v,this.element)),u){var _=r.session.getScreenTabSize(e+s.index);c.appendChild(r.$tabStrings[_].cloneNode(!0)),e+=_-1}else p?r.showSpaces?((w=this.dom.createElement("span")).className="ace_invisible ace_invisible_space",w.textContent=o.stringRepeat(r.SPACE_CHAR,p.length),c.appendChild(w)):c.appendChild(this.dom.createTextNode(p,this.element)):g?((w=this.dom.createElement("span")).className="ace_invisible ace_invisible_space ace_invalid",w.textContent=o.stringRepeat(r.SPACE_CHAR,g.length),c.appendChild(w)):f?(e+=1,(w=this.dom.createElement("span")).style.width=2*r.config.characterWidth+"px",w.className=r.showSpaces?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",w.textContent=r.showSpaces?r.SPACE_CHAR:f,c.appendChild(w)):m&&(e+=1,(w=this.dom.createElement("span")).style.width=2*r.config.characterWidth+"px",w.className="ace_cjk",w.textContent=m,c.appendChild(w))}}if(c.appendChild(this.dom.createTextNode(d?n.slice(d):n,this.element)),h(i.type))t.appendChild(c);else{var y="ace_"+i.type.replace(/\./g," ace_"),w=this.dom.createElement("span");"fold"==i.type&&(w.style.width=i.value.length*this.config.characterWidth+"px",w.setAttribute("title",l("inline-fold.closed.title","Unfold code"))),w.className=y,w.appendChild(c),t.appendChild(w)}return e+n.length},t.prototype.renderIndentGuide=function(t,e,i){var n=e.search(this.$indentGuideRe);if(n<=0||n>=i)return e;if(" "==e[0]){for(var s=(n-=n%this.tabSize)/this.tabSize,o=0;o<s;o++)t.appendChild(this.$tabStrings[" "].cloneNode(!0));return this.$highlightIndentGuide(),e.substr(n)}if("\t"==e[0]){for(o=0;o<n;o++)t.appendChild(this.$tabStrings["\t"].cloneNode(!0));return this.$highlightIndentGuide(),e.substr(n)}return this.$highlightIndentGuide(),e},t.prototype.$highlightIndentGuide=function(){if(this.$highlightIndentGuides&&this.displayIndentGuides){this.$highlightIndentGuideMarker={indentLevel:void 0,start:void 0,end:void 0,dir:void 0};var t=this.session.doc.$lines;if(t){var e=this.session.selection.getCursor(),i=/^\s*/.exec(this.session.doc.getLine(e.row))[0].length,n=Math.floor(i/this.tabSize);if(this.$highlightIndentGuideMarker={indentLevel:n,start:e.row},this.session.$bracketHighlight)for(var s=this.session.$bracketHighlight.ranges,o=0;o<s.length;o++)if(e.row!==s[o].start.row){this.$highlightIndentGuideMarker.end=s[o].start.row,e.row>s[o].start.row?this.$highlightIndentGuideMarker.dir=-1:this.$highlightIndentGuideMarker.dir=1;break}if(!this.$highlightIndentGuideMarker.end&&""!==t[e.row]&&e.column===t[e.row].length)for(this.$highlightIndentGuideMarker.dir=1,o=e.row+1;o<t.length;o++){var r=t[o],a=/^\s*/.exec(r)[0].length;if(""!==r&&(this.$highlightIndentGuideMarker.end=o,a<=i))break}this.$renderHighlightIndentGuide()}}},t.prototype.$clearActiveIndentGuide=function(){for(var t=this.$lines.cells,e=0;e<t.length;e++){var i=t[e].element.childNodes;if(i.length>0)for(var n=0;n<i.length;n++)if(i[n].classList&&i[n].classList.contains("ace_indent-guide-active")){i[n].classList.remove("ace_indent-guide-active");break}}},t.prototype.$setIndentGuideActive=function(t,e){if(""!==this.session.doc.getLine(t.row)){var i=t.element.childNodes;if(i){var n=i[e-1];n&&n.classList&&n.classList.contains("ace_indent-guide")&&n.classList.add("ace_indent-guide-active")}}},t.prototype.$renderHighlightIndentGuide=function(){if(this.$lines){var t=this.$lines.cells;this.$clearActiveIndentGuide();var e=this.$highlightIndentGuideMarker.indentLevel;if(0!==e)if(1===this.$highlightIndentGuideMarker.dir)for(var i=0;i<t.length;i++){var n=t[i];if(this.$highlightIndentGuideMarker.end&&n.row>=this.$highlightIndentGuideMarker.start+1){if(n.row>=this.$highlightIndentGuideMarker.end)break;this.$setIndentGuideActive(n,e)}}else for(i=t.length-1;i>=0;i--)if(n=t[i],this.$highlightIndentGuideMarker.end&&n.row<this.$highlightIndentGuideMarker.start){if(n.row<=this.$highlightIndentGuideMarker.end)break;this.$setIndentGuideActive(n,e)}}},t.prototype.$createLineElement=function(t){var e=this.dom.createElement("div");return e.className="ace_line",e.style.height=this.config.lineHeight+"px",e},t.prototype.$renderWrappedLine=function(t,e,i){var n=0,s=0,r=i[0],a=0,l=this.$createLineElement();t.appendChild(l);for(var h=0;h<e.length;h++){var c=e[h],d=c.value;if(0==h&&this.displayIndentGuides){if(n=d.length,!(d=this.renderIndentGuide(l,d,r)))continue;n-=d.length}if(n+d.length<r)a=this.$renderToken(l,a,c,d),n+=d.length;else{for(;n+d.length>=r;)a=this.$renderToken(l,a,c,d.substring(0,r-n)),d=d.substring(r-n),n=r,l=this.$createLineElement(),t.appendChild(l),l.appendChild(this.dom.createTextNode(o.stringRepeat(" ",i.indent),this.element)),a=0,r=i[++s]||Number.MAX_VALUE;0!=d.length&&(n+=d.length,a=this.$renderToken(l,a,c,d))}}i[i.length-1]>this.MAX_LINE_LENGTH&&this.$renderOverflowMessage(l,a,null,"",!0)},t.prototype.$renderSimpleLine=function(t,e){for(var i=0,n=0;n<e.length;n++){var s=e[n],o=s.value;if(0!=n||!this.displayIndentGuides||(o=this.renderIndentGuide(t,o))){if(i+o.length>this.MAX_LINE_LENGTH)return this.$renderOverflowMessage(t,i,s,o);i=this.$renderToken(t,i,s,o)}}},t.prototype.$renderOverflowMessage=function(t,e,i,n,s){i&&this.$renderToken(t,e,i,n.slice(0,this.MAX_LINE_LENGTH-e));var o=this.dom.createElement("span");o.className="ace_inline_button ace_keyword ace_toggle_wrap",o.textContent=s?"<hide>":"<click to see more...>",t.appendChild(o)},t.prototype.$renderLine=function(t,e,i){if(i||0==i||(i=this.session.getFoldLine(e)),i)var n=this.$getFoldLineTokens(e,i);else n=this.session.getTokens(e);var s=t;if(n.length){var o=this.session.getRowSplitData(e);o&&o.length?(this.$renderWrappedLine(t,n,o),s=t.lastChild):(s=t,this.$useLineGroups()&&(s=this.$createLineElement(),t.appendChild(s)),this.$renderSimpleLine(s,n))}else this.$useLineGroups()&&(s=this.$createLineElement(),t.appendChild(s));if(this.showEOL&&s){i&&(e=i.end.row);var r=this.dom.createElement("span");r.className="ace_invisible ace_invisible_eol",r.textContent=e==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,s.appendChild(r)}},t.prototype.$getFoldLineTokens=function(t,e){var i=this.session,n=[],s=i.getTokens(t);return e.walk((function(t,e,o,r,a){null!=t?n.push({type:"fold",value:t}):(a&&(s=i.getTokens(e)),s.length&&function(t,e,i){for(var s=0,o=0;o+t[s].value.length<e;)if(o+=t[s].value.length,++s==t.length)return;for(o!=e&&((r=t[s].value.substring(e-o)).length>i-e&&(r=r.substring(0,i-e)),n.push({type:t[s].type,value:r}),o=e+r.length,s+=1);o<i&&s<t.length;){var r;(r=t[s].value).length+o>i?n.push({type:t[s].type,value:r.substring(0,i-o)}):n.push(t[s]),o+=r.length,s+=1}}(s,r,o))}),e.end.row,this.session.getLine(e.end.row).length),n},t.prototype.$useLineGroups=function(){return this.session.getUseWrapMode()},t}();c.prototype.EOF_CHAR="¶",c.prototype.EOL_CHAR_LF="¬",c.prototype.EOL_CHAR_CRLF="¤",c.prototype.EOL_CHAR=c.prototype.EOL_CHAR_LF,c.prototype.TAB_CHAR="—",c.prototype.SPACE_CHAR="·",c.prototype.$padding=0,c.prototype.MAX_LINE_LENGTH=1e4,c.prototype.showInvisibles=!1,c.prototype.showSpaces=!1,c.prototype.showTabs=!1,c.prototype.showEOL=!1,c.prototype.displayIndentGuides=!0,c.prototype.$highlightIndentGuides=!0,c.prototype.$tabStrings=[],c.prototype.destroy={},c.prototype.onChangeTabSize=c.prototype.$computeTabString,n.implement(c.prototype,a),e.Text=c})),ace.define("ace/layer/cursor",["require","exports","module","ace/lib/dom"],(function(t,e,i){"use strict";var n=t("../lib/dom"),s=function(){function t(t){this.element=n.createElement("div"),this.element.className="ace_layer ace_cursor-layer",t.appendChild(this.element),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),n.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=this.$updateOpacity.bind(this)}return t.prototype.$updateOpacity=function(t){for(var e=this.cursors,i=e.length;i--;)n.setStyle(e[i].style,"opacity",t?"":"0")},t.prototype.$startCssAnimation=function(){for(var t=this.cursors,e=t.length;e--;)t[e].style.animationDuration=this.blinkInterval+"ms";this.$isAnimating=!0,setTimeout(function(){this.$isAnimating&&n.addCssClass(this.element,"ace_animate-blinking")}.bind(this))},t.prototype.$stopCssAnimation=function(){this.$isAnimating=!1,n.removeCssClass(this.element,"ace_animate-blinking")},t.prototype.setPadding=function(t){this.$padding=t},t.prototype.setSession=function(t){this.session=t},t.prototype.setBlinking=function(t){t!=this.isBlinking&&(this.isBlinking=t,this.restartTimer())},t.prototype.setBlinkInterval=function(t){t!=this.blinkInterval&&(this.blinkInterval=t,this.restartTimer())},t.prototype.setSmoothBlinking=function(t){t!=this.smoothBlinking&&(this.smoothBlinking=t,n.setCssClass(this.element,"ace_smooth-blinking",t),this.$updateCursors(!0),this.restartTimer())},t.prototype.addCursor=function(){var t=n.createElement("div");return t.className="ace_cursor",this.element.appendChild(t),this.cursors.push(t),t},t.prototype.removeCursor=function(){if(this.cursors.length>1){var t=this.cursors.pop();return t.parentNode.removeChild(t),t}},t.prototype.hideCursor=function(){this.isVisible=!1,n.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},t.prototype.showCursor=function(){this.isVisible=!0,n.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},t.prototype.restartTimer=function(){var t=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.$stopCssAnimation(),this.smoothBlinking&&(this.$isSmoothBlinking=!1,n.removeCssClass(this.element,"ace_smooth-blinking")),t(!0),this.isBlinking&&this.blinkInterval&&this.isVisible)if(this.smoothBlinking&&(this.$isSmoothBlinking=!0,setTimeout(function(){this.$isSmoothBlinking&&n.addCssClass(this.element,"ace_smooth-blinking")}.bind(this))),n.HAS_CSS_ANIMATION)this.$startCssAnimation();else{var e=function(){this.timeoutId=setTimeout((function(){t(!1)}),.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval((function(){t(!0),e()}),this.blinkInterval),e()}else this.$stopCssAnimation()},t.prototype.getPixelPosition=function(t,e){if(!this.config||!this.session)return{left:0,top:0};t||(t=this.session.selection.getCursor());var i=this.session.documentToScreenPosition(t);return{left:this.$padding+(this.session.$bidiHandler.isBidiRow(i.row,t.row)?this.session.$bidiHandler.getPosLeft(i.column):i.column*this.config.characterWidth),top:(i.row-(e?this.config.firstRowScreen:0))*this.config.lineHeight}},t.prototype.isCursorInView=function(t,e){return t.top>=0&&t.top<e.maxHeight},t.prototype.update=function(t){this.config=t;var e=this.session.$selectionMarkers,i=0,s=0;void 0!==e&&0!==e.length||(e=[{cursor:null}]),i=0;for(var o=e.length;i<o;i++){var r=this.getPixelPosition(e[i].cursor,!0);if(!((r.top>t.height+t.offset||r.top<0)&&i>1)){var a=this.cursors[s++]||this.addCursor(),l=a.style;this.drawCursor?this.drawCursor(a,r,t,e[i],this.session):this.isCursorInView(r,t)?(n.setStyle(l,"display","block"),n.translate(a,r.left,r.top),n.setStyle(l,"width",Math.round(t.characterWidth)+"px"),n.setStyle(l,"height",t.lineHeight+"px")):n.setStyle(l,"display","none")}}for(;this.cursors.length>s;)this.removeCursor();var h=this.session.getOverwrite();this.$setOverwrite(h),this.$pixelPos=r,this.restartTimer()},t.prototype.$setOverwrite=function(t){t!=this.overwrite&&(this.overwrite=t,t?n.addCssClass(this.element,"ace_overwrite-cursors"):n.removeCssClass(this.element,"ace_overwrite-cursors"))},t.prototype.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)},t}();s.prototype.$padding=0,s.prototype.drawCursor=null,e.Cursor=s})),ace.define("ace/scrollbar",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],(function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=t("./lib/oop"),r=t("./lib/dom"),a=t("./lib/event"),l=t("./lib/event_emitter").EventEmitter,h=32768,c=function(){function t(t,e){this.element=r.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+e,this.inner=r.createElement("div"),this.inner.className="ace_scrollbar-inner",this.inner.textContent=" ",this.element.appendChild(this.inner),t.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,a.addListener(this.element,"scroll",this.onScroll.bind(this)),a.addListener(this.element,"mousedown",a.preventDefault)}return t.prototype.setVisible=function(t){this.element.style.display=t?"":"none",this.isVisible=t,this.coeff=1},t}();o.implement(c.prototype,l);var d=function(t){function e(e,i){var n=t.call(this,e,"-v")||this;return n.scrollTop=0,n.scrollHeight=0,i.$scrollbarWidth=n.width=r.scrollbarWidth(e.ownerDocument),n.inner.style.width=n.element.style.width=(n.width||15)+5+"px",n.$minWidth=0,n}return s(e,t),e.prototype.onScroll=function(){if(!this.skipEvent){if(this.scrollTop=this.element.scrollTop,1!=this.coeff){var t=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-t)/(this.coeff-t)}this._emit("scroll",{data:this.scrollTop})}this.skipEvent=!1},e.prototype.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},e.prototype.setHeight=function(t){this.element.style.height=t+"px"},e.prototype.setScrollHeight=function(t){this.scrollHeight=t,t>h?(this.coeff=h/t,t=h):1!=this.coeff&&(this.coeff=1),this.inner.style.height=t+"px"},e.prototype.setScrollTop=function(t){this.scrollTop!=t&&(this.skipEvent=!0,this.scrollTop=t,this.element.scrollTop=t*this.coeff)},e}(c);d.prototype.setInnerHeight=d.prototype.setScrollHeight;var u=function(t){function e(e,i){var n=t.call(this,e,"-h")||this;return n.scrollLeft=0,n.height=i.$scrollbarWidth,n.inner.style.height=n.element.style.height=(n.height||15)+5+"px",n}return s(e,t),e.prototype.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},e.prototype.getHeight=function(){return this.isVisible?this.height:0},e.prototype.setWidth=function(t){this.element.style.width=t+"px"},e.prototype.setInnerWidth=function(t){this.inner.style.width=t+"px"},e.prototype.setScrollWidth=function(t){this.inner.style.width=t+"px"},e.prototype.setScrollLeft=function(t){this.scrollLeft!=t&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=t)},e}(c);e.ScrollBar=d,e.ScrollBarV=d,e.ScrollBarH=u,e.VScrollBar=d,e.HScrollBar=u})),ace.define("ace/scrollbar_custom",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],(function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=t("./lib/oop"),r=t("./lib/dom"),a=t("./lib/event"),l=t("./lib/event_emitter").EventEmitter;r.importCssString(".ace_editor>.ace_sb-v div, .ace_editor>.ace_sb-h div{\n  position: absolute;\n  background: rgba(128, 128, 128, 0.6);\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  border: 1px solid #bbb;\n  border-radius: 2px;\n  z-index: 8;\n}\n.ace_editor>.ace_sb-v, .ace_editor>.ace_sb-h {\n  position: absolute;\n  z-index: 6;\n  background: none;\n  overflow: hidden!important;\n}\n.ace_editor>.ace_sb-v {\n  z-index: 6;\n  right: 0;\n  top: 0;\n  width: 12px;\n}\n.ace_editor>.ace_sb-v div {\n  z-index: 8;\n  right: 0;\n  width: 100%;\n}\n.ace_editor>.ace_sb-h {\n  bottom: 0;\n  left: 0;\n  height: 12px;\n}\n.ace_editor>.ace_sb-h div {\n  bottom: 0;\n  height: 100%;\n}\n.ace_editor>.ace_sb_grabbed {\n  z-index: 8;\n  background: #000;\n}","ace_scrollbar.css",!1);var h=function(){function t(t,e){this.element=r.createElement("div"),this.element.className="ace_sb"+e,this.inner=r.createElement("div"),this.inner.className="",this.element.appendChild(this.inner),this.VScrollWidth=12,this.HScrollHeight=12,t.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,a.addMultiMouseDownListener(this.element,[500,300,300],this,"onMouseDown")}return t.prototype.setVisible=function(t){this.element.style.display=t?"":"none",this.isVisible=t,this.coeff=1},t}();o.implement(h.prototype,l);var c=function(t){function e(e,i){var n=t.call(this,e,"-v")||this;return n.scrollTop=0,n.scrollHeight=0,n.parent=e,n.width=n.VScrollWidth,n.renderer=i,n.inner.style.width=n.element.style.width=(n.width||15)+"px",n.$minWidth=0,n}return s(e,t),e.prototype.onMouseDown=function(t,e){if("mousedown"===t&&0===a.getButton(e)&&2!==e.detail){if(e.target===this.inner){var i=this,n=e.clientY,s=e.clientY,o=this.thumbTop;a.capture(this.inner,(function(t){n=t.clientY}),(function(){clearInterval(r)}));var r=setInterval((function(){if(void 0!==n){var t=i.scrollTopFromThumbTop(o+n-s);t!==i.scrollTop&&i._emit("scroll",{data:t})}}),20);return a.preventDefault(e)}var l=e.clientY-this.element.getBoundingClientRect().top-this.thumbHeight/2;return this._emit("scroll",{data:this.scrollTopFromThumbTop(l)}),a.preventDefault(e)}},e.prototype.getHeight=function(){return this.height},e.prototype.scrollTopFromThumbTop=function(t){var e=t*(this.pageHeight-this.viewHeight)/(this.slideHeight-this.thumbHeight);return(e>>=0)<0?e=0:e>this.pageHeight-this.viewHeight&&(e=this.pageHeight-this.viewHeight),e},e.prototype.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},e.prototype.setHeight=function(t){this.height=Math.max(0,t),this.slideHeight=this.height,this.viewHeight=this.height,this.setScrollHeight(this.pageHeight,!0)},e.prototype.setScrollHeight=function(t,e){(this.pageHeight!==t||e)&&(this.pageHeight=t,this.thumbHeight=this.slideHeight*this.viewHeight/this.pageHeight,this.thumbHeight>this.slideHeight&&(this.thumbHeight=this.slideHeight),this.thumbHeight<15&&(this.thumbHeight=15),this.inner.style.height=this.thumbHeight+"px",this.scrollTop>this.pageHeight-this.viewHeight&&(this.scrollTop=this.pageHeight-this.viewHeight,this.scrollTop<0&&(this.scrollTop=0),this._emit("scroll",{data:this.scrollTop})))},e.prototype.setScrollTop=function(t){this.scrollTop=t,t<0&&(t=0),this.thumbTop=t*(this.slideHeight-this.thumbHeight)/(this.pageHeight-this.viewHeight),this.inner.style.top=this.thumbTop+"px"},e}(h);c.prototype.setInnerHeight=c.prototype.setScrollHeight;var d=function(t){function e(e,i){var n=t.call(this,e,"-h")||this;return n.scrollLeft=0,n.scrollWidth=0,n.height=n.HScrollHeight,n.inner.style.height=n.element.style.height=(n.height||12)+"px",n.renderer=i,n}return s(e,t),e.prototype.onMouseDown=function(t,e){if("mousedown"===t&&0===a.getButton(e)&&2!==e.detail){if(e.target===this.inner){var i=this,n=e.clientX,s=e.clientX,o=this.thumbLeft;a.capture(this.inner,(function(t){n=t.clientX}),(function(){clearInterval(r)}));var r=setInterval((function(){if(void 0!==n){var t=i.scrollLeftFromThumbLeft(o+n-s);t!==i.scrollLeft&&i._emit("scroll",{data:t})}}),20);return a.preventDefault(e)}var l=e.clientX-this.element.getBoundingClientRect().left-this.thumbWidth/2;return this._emit("scroll",{data:this.scrollLeftFromThumbLeft(l)}),a.preventDefault(e)}},e.prototype.getHeight=function(){return this.isVisible?this.height:0},e.prototype.scrollLeftFromThumbLeft=function(t){var e=t*(this.pageWidth-this.viewWidth)/(this.slideWidth-this.thumbWidth);return(e>>=0)<0?e=0:e>this.pageWidth-this.viewWidth&&(e=this.pageWidth-this.viewWidth),e},e.prototype.setWidth=function(t){this.width=Math.max(0,t),this.element.style.width=this.width+"px",this.slideWidth=this.width,this.viewWidth=this.width,this.setScrollWidth(this.pageWidth,!0)},e.prototype.setScrollWidth=function(t,e){(this.pageWidth!==t||e)&&(this.pageWidth=t,this.thumbWidth=this.slideWidth*this.viewWidth/this.pageWidth,this.thumbWidth>this.slideWidth&&(this.thumbWidth=this.slideWidth),this.thumbWidth<15&&(this.thumbWidth=15),this.inner.style.width=this.thumbWidth+"px",this.scrollLeft>this.pageWidth-this.viewWidth&&(this.scrollLeft=this.pageWidth-this.viewWidth,this.scrollLeft<0&&(this.scrollLeft=0),this._emit("scroll",{data:this.scrollLeft})))},e.prototype.setScrollLeft=function(t){this.scrollLeft=t,t<0&&(t=0),this.thumbLeft=t*(this.slideWidth-this.thumbWidth)/(this.pageWidth-this.viewWidth),this.inner.style.left=this.thumbLeft+"px"},e}(h);d.prototype.setInnerWidth=d.prototype.setScrollWidth,e.ScrollBar=c,e.ScrollBarV=c,e.ScrollBarH=d,e.VScrollBar=c,e.HScrollBar=d})),ace.define("ace/renderloop",["require","exports","module","ace/lib/event"],(function(t,e,i){"use strict";var n=t("./lib/event"),s=function(){function t(t,e){this.onRender=t,this.pending=!1,this.changes=0,this.$recursionLimit=2,this.window=e||window;var i=this;this._flush=function(t){i.pending=!1;var e=i.changes;if(e&&(n.blockIdle(100),i.changes=0,i.onRender(e)),i.changes){if(i.$recursionLimit--<0)return;i.schedule()}else i.$recursionLimit=2}}return t.prototype.schedule=function(t){this.changes=this.changes|t,this.changes&&!this.pending&&(n.nextFrame(this._flush),this.pending=!0)},t.prototype.clear=function(t){var e=this.changes;return this.changes=0,e},t}();e.RenderLoop=s})),ace.define("ace/layer/font_metrics",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/event","ace/lib/useragent","ace/lib/event_emitter"],(function(t,e,i){var n=t("../lib/oop"),s=t("../lib/dom"),o=t("../lib/lang"),r=t("../lib/event"),a=t("../lib/useragent"),l=t("../lib/event_emitter").EventEmitter,h=512,c="function"==typeof ResizeObserver,d=200,u=function(){function t(t){this.el=s.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=s.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=s.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),t.appendChild(this.el),this.$measureNode.textContent=o.stringRepeat("X",h),this.$characterSize={width:0,height:0},c?this.$addObserver():this.checkForSizeChanges()}return t.prototype.$setMeasureNodeStyles=function(t,e){t.width=t.height="auto",t.left=t.top="0px",t.visibility="hidden",t.position="absolute",t.whiteSpace="pre",a.isIE<8?t["font-family"]="inherit":t.font="inherit",t.overflow=e?"hidden":"visible"},t.prototype.checkForSizeChanges=function(t){if(void 0===t&&(t=this.$measureSizes()),t&&(this.$characterSize.width!==t.width||this.$characterSize.height!==t.height)){this.$measureNode.style.fontWeight="bold";var e=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=t,this.charSizes=Object.create(null),this.allowBoldFonts=e&&e.width===t.width&&e.height===t.height,this._emit("changeCharacterSize",{data:t})}},t.prototype.$addObserver=function(){var t=this;this.$observer=new window.ResizeObserver((function(e){t.checkForSizeChanges()})),this.$observer.observe(this.$measureNode)},t.prototype.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer||this.$observer)return this.$pollSizeChangesTimer;var t=this;return this.$pollSizeChangesTimer=r.onIdle((function e(){t.checkForSizeChanges(),r.onIdle(e,500)}),500)},t.prototype.setPolling=function(t){t?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},t.prototype.$measureSizes=function(t){var e={height:(t||this.$measureNode).clientHeight,width:(t||this.$measureNode).clientWidth/h};return 0===e.width||0===e.height?null:e},t.prototype.$measureCharWidth=function(t){return this.$main.textContent=o.stringRepeat(t,h),this.$main.getBoundingClientRect().width/h},t.prototype.getCharacterWidth=function(t){var e=this.charSizes[t];return void 0===e&&(e=this.charSizes[t]=this.$measureCharWidth(t)/this.$characterSize.width),e},t.prototype.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$observer&&this.$observer.disconnect(),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},t.prototype.$getZoom=function(t){return t&&t.parentElement?(Number(window.getComputedStyle(t).zoom)||1)*this.$getZoom(t.parentElement):1},t.prototype.$initTransformMeasureNodes=function(){var t=function(t,e){return["div",{style:"position: absolute;top:"+t+"px;left:"+e+"px;"}]};this.els=s.buildDom([t(0,0),t(d,0),t(0,d),t(d,d)],this.el)},t.prototype.transformCoordinates=function(t,e){function i(t,e,i){var n=t[1]*e[0]-t[0]*e[1];return[(-e[1]*i[0]+e[0]*i[1])/n,(+t[1]*i[0]-t[0]*i[1])/n]}function n(t,e){return[t[0]-e[0],t[1]-e[1]]}function s(t,e){return[t[0]+e[0],t[1]+e[1]]}function o(t,e){return[t*e[0],t*e[1]]}function r(t){var e=t.getBoundingClientRect();return[e.left,e.top]}t&&(t=o(1/this.$getZoom(this.el),t)),this.els||this.$initTransformMeasureNodes();var a=r(this.els[0]),l=r(this.els[1]),h=r(this.els[2]),c=r(this.els[3]),u=i(n(c,l),n(c,h),n(s(l,h),s(c,a))),p=o(1+u[0],n(l,a)),g=o(1+u[1],n(h,a));if(e){var f=e,m=u[0]*f[0]/d+u[1]*f[1]/d+1,v=s(o(f[0],p),o(f[1],g));return s(o(1/m/d,v),a)}var _=n(t,a),y=i(n(p,o(u[0],_)),n(g,o(u[1],_)),_);return o(d,y)},t}();u.prototype.$characterSize={width:0,height:0},n.implement(u.prototype,l),e.FontMetrics=u})),ace.define("ace/css/editor-css",["require","exports","module"],(function(t,e,i){i.exports='\n.ace_br1 {border-top-left-radius    : 3px;}\n.ace_br2 {border-top-right-radius   : 3px;}\n.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}\n.ace_br4 {border-bottom-right-radius: 3px;}\n.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}\n.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}\n.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}\n.ace_br8 {border-bottom-left-radius : 3px;}\n.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}\n.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}\n.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}\n.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\n.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\n.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\n.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}\n\n\n.ace_editor {\n    position: relative;\n    overflow: hidden;\n    padding: 0;\n    font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'Source Code Pro\', \'source-code-pro\', monospace;\n    direction: ltr;\n    text-align: left;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n    forced-color-adjust: none;\n}\n\n.ace_scroller {\n    position: absolute;\n    overflow: hidden;\n    top: 0;\n    bottom: 0;\n    background-color: inherit;\n    -ms-user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n    cursor: text;\n}\n\n.ace_content {\n    position: absolute;\n    box-sizing: border-box;\n    min-width: 100%;\n    contain: style size layout;\n    font-variant-ligatures: no-common-ligatures;\n}\n\n.ace_keyboard-focus:focus {\n    box-shadow: inset 0 0 0 2px #5E9ED6;\n    outline: none;\n}\n\n.ace_dragging .ace_scroller:before{\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    content: \'\';\n    background: rgba(250, 250, 250, 0.01);\n    z-index: 1000;\n}\n.ace_dragging.ace_dark .ace_scroller:before{\n    background: rgba(0, 0, 0, 0.01);\n}\n\n.ace_gutter {\n    position: absolute;\n    overflow : hidden;\n    width: auto;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    cursor: default;\n    z-index: 4;\n    -ms-user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n    contain: style size layout;\n}\n\n.ace_gutter-active-line {\n    position: absolute;\n    left: 0;\n    right: 0;\n}\n\n.ace_scroller.ace_scroll-left:after {\n    content: "";\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;\n    pointer-events: none;\n}\n\n.ace_gutter-cell, .ace_gutter-cell_svg-icons {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    padding-left: 19px;\n    padding-right: 6px;\n    background-repeat: no-repeat;\n}\n\n.ace_gutter-cell_svg-icons .ace_gutter_annotation {\n    margin-left: -14px;\n    float: left;\n}\n\n.ace_gutter-cell .ace_gutter_annotation {\n    margin-left: -19px;\n    float: left;\n}\n\n.ace_gutter-cell.ace_error, .ace_icon.ace_error, .ace_icon.ace_error_fold, .ace_gutter-cell.ace_security, .ace_icon.ace_security, .ace_icon.ace_security_fold {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");\n    background-repeat: no-repeat;\n    background-position: 2px center;\n}\n\n.ace_gutter-cell.ace_warning, .ace_icon.ace_warning, .ace_icon.ace_warning_fold {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");\n    background-repeat: no-repeat;\n    background-position: 2px center;\n}\n\n.ace_gutter-cell.ace_info, .ace_icon.ace_info, .ace_gutter-cell.ace_hint, .ace_icon.ace_hint {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");\n    background-repeat: no-repeat;\n    background-position: 2px center;\n}\n\n.ace_dark .ace_gutter-cell.ace_info, .ace_dark .ace_icon.ace_info, .ace_dark .ace_gutter-cell.ace_hint, .ace_dark .ace_icon.ace_hint {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");\n}\n\n.ace_icon_svg.ace_error {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAxNiI+CjxnIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSJyZWQiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KPGNpcmNsZSBmaWxsPSJub25lIiBjeD0iOCIgY3k9IjgiIHI9IjciIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPGxpbmUgeDE9IjExIiB5MT0iNSIgeDI9IjUiIHkyPSIxMSIvPgo8bGluZSB4MT0iMTEiIHkxPSIxMSIgeDI9IjUiIHkyPSI1Ii8+CjwvZz4KPC9zdmc+");\n    background-color: crimson;\n}\n.ace_icon_svg.ace_security {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8ZyBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iZGFya29yYW5nZSIgZmlsbD0ibm9uZSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgogICAgICAgIDxwYXRoIGNsYXNzPSJzdHJva2UtbGluZWpvaW4tcm91bmQiIGQ9Ik04IDE0LjgzMDdDOCAxNC44MzA3IDIgMTIuOTA0NyAyIDguMDg5OTJWMy4yNjU0OEM1LjMxIDMuMjY1NDggNy45ODk5OSAxLjM0OTE4IDcuOTg5OTkgMS4zNDkxOEM3Ljk4OTk5IDEuMzQ5MTggMTAuNjkgMy4yNjU0OCAxNCAzLjI2NTQ4VjguMDg5OTJDMTQgMTIuOTA0NyA4IDE0LjgzMDcgOCAxNC44MzA3WiIvPgogICAgICAgIDxwYXRoIGQ9Ik0yIDguMDg5OTJWMy4yNjU0OEM1LjMxIDMuMjY1NDggNy45ODk5OSAxLjM0OTE4IDcuOTg5OTkgMS4zNDkxOCIvPgogICAgICAgIDxwYXRoIGQ9Ik0xMy45OSA4LjA4OTkyVjMuMjY1NDhDMTAuNjggMy4yNjU0OCA4IDEuMzQ5MTggOCAxLjM0OTE4Ii8+CiAgICAgICAgPHBhdGggY2xhc3M9InN0cm9rZS1saW5lam9pbi1yb3VuZCIgZD0iTTggNFY5Ii8+CiAgICAgICAgPHBhdGggY2xhc3M9InN0cm9rZS1saW5lam9pbi1yb3VuZCIgZD0iTTggMTBWMTIiLz4KICAgIDwvZz4KPC9zdmc+");\n    background-color: crimson;\n}\n.ace_icon_svg.ace_warning {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAxNiI+CjxnIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSJkYXJrb3JhbmdlIiBzaGFwZS1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiI+Cjxwb2x5Z29uIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHBvaW50cz0iOCAxIDE1IDE1IDEgMTUgOCAxIi8+CjxyZWN0IHg9IjgiIHk9IjEyIiB3aWR0aD0iMC4wMSIgaGVpZ2h0PSIwLjAxIi8+CjxsaW5lIHgxPSI4IiB5MT0iNiIgeDI9IjgiIHkyPSIxMCIvPgo8L2c+Cjwvc3ZnPg==");\n    background-color: darkorange;\n}\n.ace_icon_svg.ace_info {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAxNiI+CjxnIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSJibHVlIiBzaGFwZS1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiI+CjxjaXJjbGUgZmlsbD0ibm9uZSIgY3g9IjgiIGN5PSI4IiByPSI3IiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cjxwb2x5bGluZSBwb2ludHM9IjggMTEgOCA4Ii8+Cjxwb2x5bGluZSBwb2ludHM9IjkgOCA2IDgiLz4KPGxpbmUgeDE9IjEwIiB5MT0iMTEiIHgyPSI2IiB5Mj0iMTEiLz4KPHJlY3QgeD0iOCIgeT0iNSIgd2lkdGg9IjAuMDEiIGhlaWdodD0iMC4wMSIvPgo8L2c+Cjwvc3ZnPg==");\n    background-color: royalblue;\n}\n.ace_icon_svg.ace_hint {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8ZyBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0ic2lsdmVyIiBmaWxsPSJub25lIiBzaGFwZS1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiI+CiAgICAgICAgPHBhdGggY2xhc3M9InN0cm9rZS1saW5lam9pbi1yb3VuZCIgZD0iTTYgMTRIMTAiLz4KICAgICAgICA8cGF0aCBkPSJNOCAxMUg5QzkgOS40NzAwMiAxMiA4LjU0MDAyIDEyIDUuNzYwMDJDMTIuMDIgNC40MDAwMiAxMS4zOSAzLjM2MDAyIDEwLjQzIDIuNjcwMDJDOSAxLjY0MDAyIDcuMDAwMDEgMS42NDAwMiA1LjU3MDAxIDIuNjcwMDJDNC42MTAwMSAzLjM2MDAyIDMuOTggNC40MDAwMiA0IDUuNzYwMDJDNCA4LjU0MDAyIDcuMDAwMDEgOS40NzAwMiA3LjAwMDAxIDExSDhaIi8+CiAgICA8L2c+Cjwvc3ZnPg==");\n    background-color: silver;\n}\n\n.ace_icon_svg.ace_error_fold {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAxNiIgZmlsbD0ibm9uZSI+CiAgPHBhdGggZD0ibSAxOC45Mjk4NTEsNy44Mjk4MDc2IGMgMC4xNDYzNTMsNi4zMzc0NjA0IC02LjMyMzE0Nyw3Ljc3Nzg0NDQgLTcuNDc3OTEyLDcuNzc3ODQ0NCAtMi4xMDcyNzI2LC0wLjEyODc1IDUuMTE3Njc4LDAuMzU2MjQ5IDUuMDUxNjk4LC03Ljg3MDA2MTggLTAuNjA0NjcyLC04LjAwMzk3MzQ5IC03LjA3NzI3MDYsLTcuNTYzMTE4OSAtNC44NTczLC03LjQzMDM5NTU2IDEuNjA2LC0wLjExNTE0MjI1IDYuODk3NDg1LDEuMjYyNTQ1OTYgNy4yODM1MTQsNy41MjI2MTI5NiB6IiBmaWxsPSJjcmltc29uIiBzdHJva2Utd2lkdGg9IjIiLz4KICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0ibSA4LjExNDc1NjIsMi4wNTI5ODI4IGMgMy4zNDkxNjk4LDAgNi4wNjQxMzI4LDIuNjc2ODYyNyA2LjA2NDEzMjgsNS45Nzg5NTMgMCwzLjMwMjExMjIgLTIuNzE0OTYzLDUuOTc4OTIwMiAtNi4wNjQxMzI4LDUuOTc4OTIwMiAtMy4zNDkxNDczLDAgLTYuMDY0MTc3MiwtMi42NzY4MDggLTYuMDY0MTc3MiwtNS45Nzg5MjAyIDAuMDA1MzksLTMuMjk5ODg2MSAyLjcxNzI2NTYsLTUuOTczNjQwOCA2LjA2NDE3NzIsLTUuOTc4OTUzIHogbSAwLC0xLjczNTgyNzE5IGMgLTQuMzIxNDgzNiwwIC03LjgyNDc0MDM4LDMuNDU0MDE4NDkgLTcuODI0NzQwMzgsNy43MTQ3ODAxOSAwLDQuMjYwNzI4MiAzLjUwMzI1Njc4LDcuNzE0NzQ1MiA3LjgyNDc0MDM4LDcuNzE0NzQ1MiA0LjMyMTQ0OTgsMCA3LjgyNDY5OTgsLTMuNDU0MDE3IDcuODI0Njk5OCwtNy43MTQ3NDUyIDAsLTIuMDQ2MDkxNCAtMC44MjQzOTIsLTQuMDA4MzY3MiAtMi4yOTE3NTYsLTUuNDU1MTc0NiBDIDEyLjE4MDIyNSwxLjEyOTk2NDggMTAuMTkwMDEzLDAuMzE3MTU1NjEgOC4xMTQ3NTYyLDAuMzE3MTU1NjEgWiBNIDYuOTM3NDU2Myw4LjI0MDU5ODUgNC42NzE4Njg1LDEwLjQ4NTg1MiA2LjAwODY4MTQsMTEuODc2NzI4IDguMzE3MDAzNSw5LjYwMDc5MTEgMTAuNjI1MzM3LDExLjg3NjcyOCAxMS45NjIxMzgsMTAuNDg1ODUyIDkuNjk2NTUwOCw4LjI0MDU5ODUgMTEuOTYyMTM4LDYuMDA2ODA2NiAxMC41NzMyNDYsNC42Mzc0MzM1IDguMzE3MDAzNSw2Ljg3MzQyOTcgNi4wNjA3NjA3LDQuNjM3NDMzNSA0LjY3MTg2ODUsNi4wMDY4MDY2IFoiIGZpbGw9ImNyaW1zb24iIHN0cm9rZS13aWR0aD0iMiIvPgo8L3N2Zz4=");\n    background-color: crimson;\n}\n.ace_icon_svg.ace_security_fold {\n    -webkit-mask-image: url("data:image/svg+xml;base64,CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMTcgMTQiIGZpbGw9Im5vbmUiPgogICAgPHBhdGggZD0iTTEwLjAwMDEgMTMuNjk5MkMxMC4wMDAxIDEzLjY5OTIgMTEuOTI0MSAxMy40NzYzIDEzIDEyLjY5OTJDMTQuNDEzOSAxMS42NzgxIDE2IDEwLjUgMTYuMTI1MSA2LjgxMTI2VjIuNTg5ODdDMTYuMTI1MSAyLjU0NzY4IDE2LjEyMjEgMi41MDYxOSAxNi4xMTY0IDIuNDY1NTlWMS43MTQ4NUgxNS4yNDE0TDE1LjIzMDcgMS43MTQ4NEwxNC42MjUxIDEuNjk5MjJWNi44MTEyM0MxNC42MjUxIDguNTEwNjEgMTQuNjI1MSA5LjQ2NDYxIDEyLjc4MjQgMTEuNzIxQzEyLjE1ODYgMTIuNDg0OCAxMC4wMDAxIDEzLjY5OTIgMTAuMDAwMSAxMy42OTkyWiIgZmlsbD0iY3JpbXNvbiIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTcuMzM2MDkgMC4zNjc0NzVDNy4wMzIxNCAwLjE1MjY1MiA2LjYyNTQ4IDAuMTUzNjE0IDYuMzIyNTMgMC4zNjk5OTdMNi4zMDg2OSAwLjM3OTU1NEM2LjI5NTUzIDAuMzg4NTg4IDYuMjczODggMC40MDMyNjYgNi4yNDQxNyAwLjQyMjc4OUM2LjE4NDcxIDAuNDYxODYgNi4wOTMyMSAwLjUyMDE3MSA1Ljk3MzEzIDAuNTkxMzczQzUuNzMyNTEgMC43MzQwNTkgNS4zNzk5IDAuOTI2ODY0IDQuOTQyNzkgMS4xMjAwOUM0LjA2MTQ0IDEuNTA5NyAyLjg3NTQxIDEuODgzNzcgMS41ODk4NCAxLjg4Mzc3SDAuNzE0ODQ0VjIuNzU4NzdWNi45ODAxNUMwLjcxNDg0NCA5LjQ5Mzc0IDIuMjg4NjYgMTEuMTk3MyAzLjcwMjU0IDEyLjIxODVDNC40MTg0NSAxMi43MzU1IDUuMTI4NzQgMTMuMTA1MyA1LjY1NzMzIDEzLjM0NTdDNS45MjI4NCAxMy40NjY0IDYuMTQ1NjYgMTMuNTU1OSA2LjMwNDY1IDEzLjYxNjFDNi4zODQyMyAxMy42NDYyIDYuNDQ4MDUgMTMuNjY5IDYuNDkzNDkgMTMuNjg0OEM2LjUxNjIyIDEzLjY5MjcgNi41MzQzOCAxMy42OTg5IDYuNTQ3NjQgMTMuNzAzM0w2LjU2MzgyIDEzLjcwODdMNi41NjkwOCAxMy43MTA0TDYuNTcwOTkgMTMuNzExTDYuODM5ODQgMTMuNzUzM0w2LjU3MjQyIDEzLjcxMTVDNi43NDYzMyAxMy43NjczIDYuOTMzMzUgMTMuNzY3MyA3LjEwNzI3IDEzLjcxMTVMNy4xMDg3IDEzLjcxMUw3LjExMDYxIDEzLjcxMDRMNy4xMTU4NyAxMy43MDg3TDcuMTMyMDUgMTMuNzAzM0M3LjE0NTMxIDEzLjY5ODkgNy4xNjM0NiAxMy42OTI3IDcuMTg2MTkgMTMuNjg0OEM3LjIzMTY0IDEzLjY2OSA3LjI5NTQ2IDEzLjY0NjIgNy4zNzUwMyAxMy42MTYxQzcuNTM0MDMgMTMuNTU1OSA3Ljc1Njg1IDEzLjQ2NjQgOC4wMjIzNiAxMy4zNDU3QzguNTUwOTUgMTMuMTA1MyA5LjI2MTIzIDEyLjczNTUgOS45NzcxNSAxMi4yMTg1QzExLjM5MSAxMS4xOTczIDEyLjk2NDggOS40OTM3NyAxMi45NjQ4IDYuOTgwMThWMi43NTg4QzEyLjk2NDggMi43MTY2IDEyLjk2MTkgMi42NzUxMSAxMi45NTYxIDIuNjM0NTFWMS44ODM3N0gxMi4wODExQzEyLjA3NzUgMS44ODM3NyAxMi4wNzQgMS44ODM3NyAxMi4wNzA0IDEuODgzNzdDMTAuNzk3OSAxLjg4MDA0IDkuNjE5NjIgMS41MTEwMiA4LjczODk0IDEuMTI0ODZDOC43MzUzNCAxLjEyMzI3IDguNzMxNzQgMS4xMjE2OCA4LjcyODE0IDEuMTIwMDlDOC4yOTEwMyAwLjkyNjg2NCA3LjkzODQyIDAuNzM0MDU5IDcuNjk3NzkgMC41OTEzNzNDNy41Nzc3MiAwLjUyMDE3MSA3LjQ4NjIyIDAuNDYxODYgNy40MjY3NiAwLjQyMjc4OUM3LjM5NzA1IDAuNDAzMjY2IDcuMzc1MzkgMC4zODg1ODggNy4zNjIyNCAwLjM3OTU1NEw3LjM0ODk2IDAuMzcwMzVDNy4zNDg5NiAwLjM3MDM1IDcuMzQ4NDcgMC4zNzAwMiA3LjM0NTYzIDAuMzc0MDU0TDcuMzM3NzkgMC4zNjg2NTlMNy4zMzYwOSAwLjM2NzQ3NVpNOC4wMzQ3MSAyLjcyNjkxQzguODYwNCAzLjA5MDYzIDkuOTYwNjYgMy40NjMwOSAxMS4yMDYxIDMuNTg5MDdWNi45ODAxNUgxMS4yMTQ4QzExLjIxNDggOC42Nzk1MyAxMC4xNjM3IDkuOTI1MDcgOC45NTI1NCAxMC43OTk4QzguMzU1OTUgMTEuMjMwNiA3Ljc1Mzc0IDExLjU0NTQgNy4yOTc5NiAxMS43NTI3QzcuMTE2NzEgMTEuODM1MSA2Ljk2MDYyIDExLjg5OTYgNi44Mzk4NCAxMS45NDY5QzYuNzE5MDYgMTEuODk5NiA2LjU2Mjk3IDExLjgzNTEgNi4zODE3MyAxMS43NTI3QzUuOTI1OTUgMTEuNTQ1NCA1LjMyMzczIDExLjIzMDYgNC43MjcxNSAxMC43OTk4QzMuNTE2MDMgOS45MjUwNyAyLjQ2NDg0IDguNjc5NTUgMi40NjQ4NCA2Ljk4MDE4VjMuNTg5MDlDMy43MTczOCAzLjQ2MjM5IDQuODIzMDggMy4wODYzOSA1LjY1MDMzIDIuNzIwNzFDNi4xNDIyOCAyLjUwMzI0IDYuNTQ0ODUgMi4yODUzNyA2LjgzMjU0IDIuMTE2MjRDNy4xMjE4MSAyLjI4NTM1IDcuNTI3IDIuNTAzNTIgOC4wMjE5NiAyLjcyMTMxQzguMDI2MiAyLjcyMzE3IDguMDMwNDUgMi43MjUwNCA4LjAzNDcxIDIuNzI2OTFaTTUuOTY0ODQgMy40MDE0N1Y3Ljc3NjQ3SDcuNzE0ODRWMy40MDE0N0g1Ljk2NDg0Wk01Ljk2NDg0IDEwLjQwMTVWOC42NTE0N0g3LjcxNDg0VjEwLjQwMTVINS45NjQ4NFoiIGZpbGw9ImNyaW1zb24iIHN0cm9rZS13aWR0aD0iMiIvPgo8L3N2Zz4=");\n    background-color: crimson;\n}\n.ace_icon_svg.ace_warning_fold {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAyMCAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNC43NzY5IDE0LjczMzdMOC42NTE5MiAyLjQ4MzY5QzguMzI5NDYgMS44Mzg3NyA3LjQwOTEzIDEuODM4NzcgNy4wODY2NyAyLjQ4MzY5TDAuOTYxNjY5IDE0LjczMzdDMC42NzA3NzUgMTUuMzE1NSAxLjA5MzgzIDE2IDEuNzQ0MjkgMTZIMTMuOTk0M0MxNC42NDQ4IDE2IDE1LjA2NzggMTUuMzE1NSAxNC43NzY5IDE0LjczMzdaTTMuMTYwMDcgMTQuMjVMNy44NjkyOSA0LjgzMTU2TDEyLjU3ODUgMTQuMjVIMy4xNjAwN1pNOC43NDQyOSAxMS42MjVWMTMuMzc1SDYuOTk0MjlWMTEuNjI1SDguNzQ0MjlaTTYuOTk0MjkgMTAuNzVWNy4yNUg4Ljc0NDI5VjEwLjc1SDYuOTk0MjlaIiBmaWxsPSIjRUM3MjExIi8+CjxwYXRoIGQ9Ik0xMS4xOTkxIDIuOTUyMzhDMTAuODgwOSAyLjMxNDY3IDEwLjM1MzcgMS44MDUyNiA5LjcwNTUgMS41MDlMMTEuMDQxIDEuMDY5NzhDMTEuNjg4MyAwLjk0OTgxNCAxMi4zMzcgMS4yNzI2MyAxMi42MzE3IDEuODYxNDFMMTcuNjEzNiAxMS44MTYxQzE4LjM1MjcgMTMuMjkyOSAxNy41OTM4IDE1LjA4MDQgMTYuMDE4IDE1LjU3NDVDMTYuNDA0NCAxNC40NTA3IDE2LjMyMzEgMTMuMjE4OCAxNS43OTI0IDEyLjE1NTVMMTEuMTk5MSAyLjk1MjM4WiIgZmlsbD0iI0VDNzIxMSIvPgo8L3N2Zz4=");\n    background-color: darkorange;\n}\n\n.ace_scrollbar {\n    contain: strict;\n    position: absolute;\n    right: 0;\n    bottom: 0;\n    z-index: 6;\n}\n\n.ace_scrollbar-inner {\n    position: absolute;\n    cursor: text;\n    left: 0;\n    top: 0;\n}\n\n.ace_scrollbar-v{\n    overflow-x: hidden;\n    overflow-y: scroll;\n    top: 0;\n}\n\n.ace_scrollbar-h {\n    overflow-x: scroll;\n    overflow-y: hidden;\n    left: 0;\n}\n\n.ace_print-margin {\n    position: absolute;\n    height: 100%;\n}\n\n.ace_text-input {\n    position: absolute;\n    z-index: 0;\n    width: 0.5em;\n    height: 1em;\n    opacity: 0;\n    background: transparent;\n    -moz-appearance: none;\n    appearance: none;\n    border: none;\n    resize: none;\n    outline: none;\n    overflow: hidden;\n    font: inherit;\n    padding: 0 1px;\n    margin: 0 -1px;\n    contain: strict;\n    -ms-user-select: text;\n    -moz-user-select: text;\n    -webkit-user-select: text;\n    user-select: text;\n    /*with `pre-line` chrome inserts &nbsp; instead of space*/\n    white-space: pre!important;\n}\n.ace_text-input.ace_composition {\n    background: transparent;\n    color: inherit;\n    z-index: 1000;\n    opacity: 1;\n}\n.ace_composition_placeholder { color: transparent }\n.ace_composition_marker { \n    border-bottom: 1px solid;\n    position: absolute;\n    border-radius: 0;\n    margin-top: 1px;\n}\n\n[ace_nocontext=true] {\n    transform: none!important;\n    filter: none!important;\n    clip-path: none!important;\n    mask : none!important;\n    contain: none!important;\n    perspective: none!important;\n    mix-blend-mode: initial!important;\n    z-index: auto;\n}\n\n.ace_layer {\n    z-index: 1;\n    position: absolute;\n    overflow: hidden;\n    /* workaround for chrome bug https://github.com/ajaxorg/ace/issues/2312*/\n    word-wrap: normal;\n    white-space: pre;\n    height: 100%;\n    width: 100%;\n    box-sizing: border-box;\n    /* setting pointer-events: auto; on node under the mouse, which changes\n        during scroll, will break mouse wheel scrolling in Safari */\n    pointer-events: none;\n}\n\n.ace_gutter-layer {\n    position: relative;\n    width: auto;\n    text-align: right;\n    pointer-events: auto;\n    height: 1000000px;\n    contain: style size layout;\n}\n\n.ace_text-layer {\n    font: inherit !important;\n    position: absolute;\n    height: 1000000px;\n    width: 1000000px;\n    contain: style size layout;\n}\n\n.ace_text-layer > .ace_line, .ace_text-layer > .ace_line_group {\n    contain: style size layout;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n}\n\n.ace_hidpi .ace_text-layer,\n.ace_hidpi .ace_gutter-layer,\n.ace_hidpi .ace_content,\n.ace_hidpi .ace_gutter {\n    contain: strict;\n}\n.ace_hidpi .ace_text-layer > .ace_line, \n.ace_hidpi .ace_text-layer > .ace_line_group {\n    contain: strict;\n}\n\n.ace_cjk {\n    display: inline-block;\n    text-align: center;\n}\n\n.ace_cursor-layer {\n    z-index: 4;\n}\n\n.ace_cursor {\n    z-index: 4;\n    position: absolute;\n    box-sizing: border-box;\n    border-left: 2px solid;\n    /* workaround for smooth cursor repaintng whole screen in chrome */\n    transform: translatez(0);\n}\n\n.ace_multiselect .ace_cursor {\n    border-left-width: 1px;\n}\n\n.ace_slim-cursors .ace_cursor {\n    border-left-width: 1px;\n}\n\n.ace_overwrite-cursors .ace_cursor {\n    border-left-width: 0;\n    border-bottom: 1px solid;\n}\n\n.ace_hidden-cursors .ace_cursor {\n    opacity: 0.2;\n}\n\n.ace_hasPlaceholder .ace_hidden-cursors .ace_cursor {\n    opacity: 0;\n}\n\n.ace_smooth-blinking .ace_cursor {\n    transition: opacity 0.18s;\n}\n\n.ace_animate-blinking .ace_cursor {\n    animation-duration: 1000ms;\n    animation-timing-function: step-end;\n    animation-name: blink-ace-animate;\n    animation-iteration-count: infinite;\n}\n\n.ace_animate-blinking.ace_smooth-blinking .ace_cursor {\n    animation-duration: 1000ms;\n    animation-timing-function: ease-in-out;\n    animation-name: blink-ace-animate-smooth;\n}\n    \n@keyframes blink-ace-animate {\n    from, to { opacity: 1; }\n    60% { opacity: 0; }\n}\n\n@keyframes blink-ace-animate-smooth {\n    from, to { opacity: 1; }\n    45% { opacity: 1; }\n    60% { opacity: 0; }\n    85% { opacity: 0; }\n}\n\n.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {\n    position: absolute;\n    z-index: 3;\n}\n\n.ace_marker-layer .ace_selection {\n    position: absolute;\n    z-index: 5;\n}\n\n.ace_marker-layer .ace_bracket {\n    position: absolute;\n    z-index: 6;\n}\n\n.ace_marker-layer .ace_error_bracket {\n    position: absolute;\n    border-bottom: 1px solid #DE5555;\n    border-radius: 0;\n}\n\n.ace_marker-layer .ace_active-line {\n    position: absolute;\n    z-index: 2;\n}\n\n.ace_marker-layer .ace_selected-word {\n    position: absolute;\n    z-index: 4;\n    box-sizing: border-box;\n}\n\n.ace_line .ace_fold {\n    box-sizing: border-box;\n\n    display: inline-block;\n    height: 11px;\n    margin-top: -2px;\n    vertical-align: middle;\n\n    background-image:\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");\n    background-repeat: no-repeat, repeat-x;\n    background-position: center center, top left;\n    color: transparent;\n\n    border: 1px solid black;\n    border-radius: 2px;\n\n    cursor: pointer;\n    pointer-events: auto;\n}\n\n.ace_dark .ace_fold {\n}\n\n.ace_fold:hover{\n    background-image:\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");\n}\n\n.ace_tooltip {\n    background-color: #f5f5f5;\n    border: 1px solid gray;\n    border-radius: 1px;\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\n    color: black;\n    max-width: 100%;\n    padding: 3px 4px;\n    position: fixed;\n    z-index: 999999;\n    box-sizing: border-box;\n    cursor: default;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    line-height: normal;\n    font-style: normal;\n    font-weight: normal;\n    letter-spacing: normal;\n    pointer-events: none;\n    overflow: auto;\n    max-width: min(60em, 66vw);\n    overscroll-behavior: contain;\n}\n.ace_tooltip pre {\n    white-space: pre-wrap;\n}\n\n.ace_tooltip.ace_dark {\n    background-color: #636363;\n    color: #fff;\n}\n\n.ace_tooltip:focus {\n    outline: 1px solid #5E9ED6;\n}\n\n.ace_icon {\n    display: inline-block;\n    width: 18px;\n    vertical-align: top;\n}\n\n.ace_icon_svg {\n    display: inline-block;\n    width: 12px;\n    vertical-align: top;\n    -webkit-mask-repeat: no-repeat;\n    -webkit-mask-size: 12px;\n    -webkit-mask-position: center;\n}\n\n.ace_folding-enabled > .ace_gutter-cell, .ace_folding-enabled > .ace_gutter-cell_svg-icons {\n    padding-right: 13px;\n}\n\n.ace_fold-widget {\n    box-sizing: border-box;\n\n    margin: 0 -12px 0 1px;\n    display: none;\n    width: 11px;\n    vertical-align: top;\n\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");\n    background-repeat: no-repeat;\n    background-position: center;\n\n    border-radius: 3px;\n    \n    border: 1px solid transparent;\n    cursor: pointer;\n}\n\n.ace_folding-enabled .ace_fold-widget {\n    display: inline-block;   \n}\n\n.ace_fold-widget.ace_end {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");\n}\n\n.ace_fold-widget.ace_closed {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");\n}\n\n.ace_fold-widget:hover {\n    border: 1px solid rgba(0, 0, 0, 0.3);\n    background-color: rgba(255, 255, 255, 0.2);\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);\n}\n\n.ace_fold-widget:active {\n    border: 1px solid rgba(0, 0, 0, 0.4);\n    background-color: rgba(0, 0, 0, 0.05);\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);\n}\n/**\n * Dark version for fold widgets\n */\n.ace_dark .ace_fold-widget {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");\n}\n.ace_dark .ace_fold-widget.ace_end {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");\n}\n.ace_dark .ace_fold-widget.ace_closed {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");\n}\n.ace_dark .ace_fold-widget:hover {\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);\n    background-color: rgba(255, 255, 255, 0.1);\n}\n.ace_dark .ace_fold-widget:active {\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);\n}\n\n.ace_inline_button {\n    border: 1px solid lightgray;\n    display: inline-block;\n    margin: -1px 8px;\n    padding: 0 5px;\n    pointer-events: auto;\n    cursor: pointer;\n}\n.ace_inline_button:hover {\n    border-color: gray;\n    background: rgba(200,200,200,0.2);\n    display: inline-block;\n    pointer-events: auto;\n}\n\n.ace_fold-widget.ace_invalid {\n    background-color: #FFB4B4;\n    border-color: #DE5555;\n}\n\n.ace_fade-fold-widgets .ace_fold-widget {\n    transition: opacity 0.4s ease 0.05s;\n    opacity: 0;\n}\n\n.ace_fade-fold-widgets:hover .ace_fold-widget {\n    transition: opacity 0.05s ease 0.05s;\n    opacity:1;\n}\n\n.ace_underline {\n    text-decoration: underline;\n}\n\n.ace_bold {\n    font-weight: bold;\n}\n\n.ace_nobold .ace_bold {\n    font-weight: normal;\n}\n\n.ace_italic {\n    font-style: italic;\n}\n\n\n.ace_error-marker {\n    background-color: rgba(255, 0, 0,0.2);\n    position: absolute;\n    z-index: 9;\n}\n\n.ace_highlight-marker {\n    background-color: rgba(255, 255, 0,0.2);\n    position: absolute;\n    z-index: 8;\n}\n\n.ace_mobile-menu {\n    position: absolute;\n    line-height: 1.5;\n    border-radius: 4px;\n    -ms-user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n    background: white;\n    box-shadow: 1px 3px 2px grey;\n    border: 1px solid #dcdcdc;\n    color: black;\n}\n.ace_dark > .ace_mobile-menu {\n    background: #333;\n    color: #ccc;\n    box-shadow: 1px 3px 2px grey;\n    border: 1px solid #444;\n\n}\n.ace_mobile-button {\n    padding: 2px;\n    cursor: pointer;\n    overflow: hidden;\n}\n.ace_mobile-button:hover {\n    background-color: #eee;\n    opacity:1;\n}\n.ace_mobile-button:active {\n    background-color: #ddd;\n}\n\n.ace_placeholder {\n    position: relative;\n    font-family: arial;\n    transform: scale(0.9);\n    transform-origin: left;\n    white-space: pre;\n    opacity: 0.7;\n    margin: 0 10px;\n    z-index: 1;\n}\n\n.ace_ghost_text {\n    opacity: 0.5;\n    font-style: italic;\n}\n\n.ace_ghost_text_container > div {\n    white-space: pre;\n}\n\n.ghost_text_line_wrapped::after {\n    content: "↩";\n    position: absolute;\n}\n\n.ace_lineWidgetContainer.ace_ghost_text {\n    margin: 0px 4px\n}\n\n.ace_screenreader-only {\n    position:absolute;\n    left:-10000px;\n    top:auto;\n    width:1px;\n    height:1px;\n    overflow:hidden;\n}\n\n.ace_hidden_token {\n    display: none;\n}'})),ace.define("ace/layer/decorators",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event_emitter"],(function(t,e,i){"use strict";var n=t("../lib/dom"),s=t("../lib/oop"),o=t("../lib/event_emitter").EventEmitter,r=function(){function t(t,e){this.canvas=n.createElement("canvas"),this.renderer=e,this.pixelRatio=1,this.maxHeight=e.layerConfig.maxHeight,this.lineHeight=e.layerConfig.lineHeight,this.canvasHeight=t.parent.scrollHeight,this.heightRatio=this.canvasHeight/this.maxHeight,this.canvasWidth=t.width,this.minDecorationHeight=2*this.pixelRatio|0,this.halfMinDecorationHeight=this.minDecorationHeight/2|0,this.canvas.width=this.canvasWidth,this.canvas.height=this.canvasHeight,this.canvas.style.top="0px",this.canvas.style.right="0px",this.canvas.style.zIndex="7px",this.canvas.style.position="absolute",this.colors={},this.colors.dark={error:"rgba(255, 18, 18, 1)",warning:"rgba(18, 136, 18, 1)",info:"rgba(18, 18, 136, 1)"},this.colors.light={error:"rgb(255,51,51)",warning:"rgb(32,133,72)",info:"rgb(35,68,138)"},t.element.appendChild(this.canvas)}return t.prototype.$updateDecorators=function(t){var e=!0===this.renderer.theme.isDark?this.colors.dark:this.colors.light;t&&(this.maxHeight=t.maxHeight,this.lineHeight=t.lineHeight,this.canvasHeight=t.height,(t.lastRow+1)*this.lineHeight<this.canvasHeight?this.heightRatio=1:this.heightRatio=this.canvasHeight/this.maxHeight);var i=this.canvas.getContext("2d"),n=this.renderer.session.$annotations;if(i.clearRect(0,0,this.canvas.width,this.canvas.height),n){var s={info:1,warning:2,error:3};n.forEach((function(t){t.priority=s[t.type]||null})),n=n.sort((function(t,e){return t.priority<e.priority?-1:t.priority>e.priority?1:0}));for(var o=this.renderer.session.$foldData,r=0;r<n.length;r++){var a=n[r].row,l=this.compensateFoldRows(a,o),h=Math.round((a-l)*this.lineHeight*this.heightRatio),c=Math.round((a-l)*this.lineHeight*this.heightRatio),d=Math.round(((a-l)*this.lineHeight+this.lineHeight)*this.heightRatio);if(d-c<this.minDecorationHeight){var u=(c+d)/2|0;u<this.halfMinDecorationHeight?u=this.halfMinDecorationHeight:u+this.halfMinDecorationHeight>this.canvasHeight&&(u=this.canvasHeight-this.halfMinDecorationHeight),c=Math.round(u-this.halfMinDecorationHeight),d=Math.round(u+this.halfMinDecorationHeight)}i.fillStyle=e[n[r].type]||null,i.fillRect(0,h,this.canvasWidth,d-c)}}var p=this.renderer.session.selection.getCursor();p&&(l=this.compensateFoldRows(p.row,o),h=Math.round((p.row-l)*this.lineHeight*this.heightRatio),i.fillStyle="rgba(0, 0, 0, 0.5)",i.fillRect(0,h,this.canvasWidth,2))},t.prototype.compensateFoldRows=function(t,e){var i=0;if(e&&e.length>0)for(var n=0;n<e.length;n++)t>e[n].start.row&&t<e[n].end.row?i+=t-e[n].start.row:t>=e[n].end.row&&(i+=e[n].end.row-e[n].start.row);return i},t}();s.implement(r.prototype,o),e.Decorator=r})),ace.define("ace/virtual_renderer",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/config","ace/layer/gutter","ace/layer/marker","ace/layer/text","ace/layer/cursor","ace/scrollbar","ace/scrollbar","ace/scrollbar_custom","ace/scrollbar_custom","ace/renderloop","ace/layer/font_metrics","ace/lib/event_emitter","ace/css/editor-css","ace/layer/decorators","ace/lib/useragent","ace/layer/text_util"],(function(t,e,i){"use strict";var n=t("./lib/oop"),s=t("./lib/dom"),o=t("./lib/lang"),r=t("./config"),a=t("./layer/gutter").Gutter,l=t("./layer/marker").Marker,h=t("./layer/text").Text,c=t("./layer/cursor").Cursor,d=t("./scrollbar").HScrollBar,u=t("./scrollbar").VScrollBar,p=t("./scrollbar_custom").HScrollBar,g=t("./scrollbar_custom").VScrollBar,f=t("./renderloop").RenderLoop,m=t("./layer/font_metrics").FontMetrics,v=t("./lib/event_emitter").EventEmitter,_=t("./css/editor-css"),y=t("./layer/decorators").Decorator,w=t("./lib/useragent"),x=t("./layer/text_util").isTextToken;s.importCssString(_,"ace_editor.css",!1);var b=function(){function t(t,e){var i=this;this.container=t||s.createElement("div"),s.addCssClass(this.container,"ace_editor"),s.HI_DPI&&s.addCssClass(this.container,"ace_hidpi"),this.setTheme(e),null==r.get("useStrictCSP")&&r.set("useStrictCSP",!1),this.$gutter=s.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.$gutter.setAttribute("aria-hidden","true"),this.scroller=s.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=s.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new a(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new l(this.content);var n=this.$textLayer=new h(this.content);this.canvas=n.element,this.$markerFront=new l(this.content),this.$cursorLayer=new c(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new u(this.container,this),this.scrollBarH=new d(this.container,this),this.scrollBarV.on("scroll",(function(t){i.$scrollAnimation||i.session.setScrollTop(t.data-i.scrollMargin.top)})),this.scrollBarH.on("scroll",(function(t){i.$scrollAnimation||i.session.setScrollLeft(t.data-i.scrollMargin.left)})),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new m(this.container),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.on("changeCharacterSize",(function(t){i.updateCharacterSize(),i.onResize(!0,i.gutterWidth,i.$size.width,i.$size.height),i._signal("changeCharacterSize",t)})),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.margin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$keepTextAreaAtCursor=!w.isIOS,this.$loop=new f(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),this.$addResizeObserver(),r.resetOptions(this),r._signal("renderer",this)}return t.prototype.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin(),s.setStyle(this.scroller.style,"line-height",this.lineHeight+"px")},t.prototype.setSession=function(t){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=t,t&&this.scrollMargin.top&&t.getScrollTop()<=0&&t.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(t),this.$markerBack.setSession(t),this.$markerFront.setSession(t),this.$gutterLayer.setSession(t),this.$textLayer.setSession(t),t&&(this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},t.prototype.updateLines=function(t,e,i){if(void 0===e&&(e=1/0),this.$changedLines?(this.$changedLines.firstRow>t&&(this.$changedLines.firstRow=t),this.$changedLines.lastRow<e&&(this.$changedLines.lastRow=e)):this.$changedLines={firstRow:t,lastRow:e},this.$changedLines.lastRow<this.layerConfig.firstRow){if(!i)return;this.$changedLines.lastRow=this.layerConfig.lastRow}this.$changedLines.firstRow>this.layerConfig.lastRow||this.$loop.schedule(this.CHANGE_LINES)},t.prototype.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar(),this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR)},t.prototype.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},t.prototype.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},t.prototype.updateFull=function(t){t?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},t.prototype.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},t.prototype.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},t.prototype.onResize=function(t,e,i,n){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=t?1:0;var s=this.container;n||(n=s.clientHeight||s.scrollHeight),!n&&this.$maxLines&&this.lineHeight>1&&(s.style.height&&"0px"!=s.style.height||(s.style.height="1px",n=s.clientHeight||s.scrollHeight)),i||(i=s.clientWidth||s.scrollWidth);var o=this.$updateCachedSize(t,e,i,n);if(this.$resizeTimer&&this.$resizeTimer.cancel(),!this.$size.scrollerHeight||!i&&!n)return this.resizing=0;t&&(this.$gutterLayer.$padding=null),t?this.$renderChanges(o|this.$changes,!0):this.$loop.schedule(o|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.$customScrollbar&&this.$updateCustomScrollbar(!0)}},t.prototype.$updateCachedSize=function(t,e,i,n){n-=this.$extraHeight||0;var o=0,r=this.$size,a={width:r.width,height:r.height,scrollerHeight:r.scrollerHeight,scrollerWidth:r.scrollerWidth};if(n&&(t||r.height!=n)&&(r.height=n,o|=this.CHANGE_SIZE,r.scrollerHeight=r.height,this.$horizScroll&&(r.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.setHeight(r.scrollerHeight),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",o|=this.CHANGE_SCROLL),i&&(t||r.width!=i)){o|=this.CHANGE_SIZE,r.width=i,null==e&&(e=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=e,s.setStyle(this.scrollBarH.element.style,"left",e+"px"),s.setStyle(this.scroller.style,"left",e+this.margin.left+"px"),r.scrollerWidth=Math.max(0,i-e-this.scrollBarV.getWidth()-this.margin.h),s.setStyle(this.$gutter.style,"left",this.margin.left+"px");var l=this.scrollBarV.getWidth()+"px";s.setStyle(this.scrollBarH.element.style,"right",l),s.setStyle(this.scroller.style,"right",l),s.setStyle(this.scroller.style,"bottom",this.scrollBarH.getHeight()),this.scrollBarH.setWidth(r.scrollerWidth),(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||t)&&(o|=this.CHANGE_FULL)}return r.$dirty=!i||!n,o&&this._signal("resize",a),o},t.prototype.onGutterResize=function(t){var e=this.$showGutter?t:0;e!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,e,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()||this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):this.$computeLayerConfig()},t.prototype.adjustWrapLimit=function(){var t=this.$size.scrollerWidth-2*this.$padding,e=Math.floor(t/this.characterWidth);return this.session.adjustWrapLimit(e,this.$showPrintMargin&&this.$printMarginColumn)},t.prototype.setAnimatedScroll=function(t){this.setOption("animatedScroll",t)},t.prototype.getAnimatedScroll=function(){return this.$animatedScroll},t.prototype.setShowInvisibles=function(t){this.setOption("showInvisibles",t),this.session.$bidiHandler.setShowInvisibles(t)},t.prototype.getShowInvisibles=function(){return this.getOption("showInvisibles")},t.prototype.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},t.prototype.setDisplayIndentGuides=function(t){this.setOption("displayIndentGuides",t)},t.prototype.getHighlightIndentGuides=function(){return this.getOption("highlightIndentGuides")},t.prototype.setHighlightIndentGuides=function(t){this.setOption("highlightIndentGuides",t)},t.prototype.setShowPrintMargin=function(t){this.setOption("showPrintMargin",t)},t.prototype.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},t.prototype.setPrintMarginColumn=function(t){this.setOption("printMarginColumn",t)},t.prototype.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},t.prototype.getShowGutter=function(){return this.getOption("showGutter")},t.prototype.setShowGutter=function(t){return this.setOption("showGutter",t)},t.prototype.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},t.prototype.setFadeFoldWidgets=function(t){this.setOption("fadeFoldWidgets",t)},t.prototype.setHighlightGutterLine=function(t){this.setOption("highlightGutterLine",t)},t.prototype.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},t.prototype.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var t=s.createElement("div");t.className="ace_layer ace_print-margin-layer",this.$printMarginEl=s.createElement("div"),this.$printMarginEl.className="ace_print-margin",t.appendChild(this.$printMarginEl),this.content.insertBefore(t,this.content.firstChild)}var e=this.$printMarginEl.style;e.left=Math.round(this.characterWidth*this.$printMarginColumn+this.$padding)+"px",e.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},t.prototype.getContainerElement=function(){return this.container},t.prototype.getMouseEventTarget=function(){return this.scroller},t.prototype.getTextAreaContainer=function(){return this.container},t.prototype.$moveTextAreaToCursor=function(){if(!this.$isMousePressed){var t=this.textarea.style,e=this.$composition;if(this.$keepTextAreaAtCursor||e){var i=this.$cursorLayer.$pixelPos;if(i){e&&e.markerRange&&(i=this.$cursorLayer.getPixelPosition(e.markerRange.start,!0));var n=this.layerConfig,o=i.top,r=i.left;o-=n.offset;var a=e&&e.useTextareaForIME||w.isMobile?this.lineHeight:1;if(o<0||o>n.height-a)s.translate(this.textarea,0,0);else{var l=1,h=this.$size.height-a;if(e)if(e.useTextareaForIME){var c=this.textarea.value;l=this.characterWidth*this.session.$getStringScreenWidth(c)[0]}else o+=this.lineHeight+2;else o+=this.lineHeight;(r-=this.scrollLeft)>this.$size.scrollerWidth-l&&(r=this.$size.scrollerWidth-l),r+=this.gutterWidth+this.margin.left,s.setStyle(t,"height",a+"px"),s.setStyle(t,"width",l+"px"),s.translate(this.textarea,Math.min(r,this.$size.scrollerWidth-l),Math.min(o,h))}}}else s.translate(this.textarea,-100,0)}},t.prototype.getFirstVisibleRow=function(){return this.layerConfig.firstRow},t.prototype.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},t.prototype.getLastFullyVisibleRow=function(){var t=this.layerConfig,e=t.lastRow;return this.session.documentToScreenRow(e,0)*t.lineHeight-this.session.getScrollTop()>t.height-t.lineHeight?e-1:e},t.prototype.getLastVisibleRow=function(){return this.layerConfig.lastRow},t.prototype.setPadding=function(t){this.$padding=t,this.$textLayer.setPadding(t),this.$cursorLayer.setPadding(t),this.$markerFront.setPadding(t),this.$markerBack.setPadding(t),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},t.prototype.setScrollMargin=function(t,e,i,n){var s=this.scrollMargin;s.top=0|t,s.bottom=0|e,s.right=0|n,s.left=0|i,s.v=s.top+s.bottom,s.h=s.left+s.right,s.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-s.top),this.updateFull()},t.prototype.setMargin=function(t,e,i,n){var s=this.margin;s.top=0|t,s.bottom=0|e,s.right=0|n,s.left=0|i,s.v=s.top+s.bottom,s.h=s.left+s.right,this.$updateCachedSize(!0,this.gutterWidth,this.$size.width,this.$size.height),this.updateFull()},t.prototype.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},t.prototype.setHScrollBarAlwaysVisible=function(t){this.setOption("hScrollBarAlwaysVisible",t)},t.prototype.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible},t.prototype.setVScrollBarAlwaysVisible=function(t){this.setOption("vScrollBarAlwaysVisible",t)},t.prototype.$updateScrollBarV=function(){var t=this.layerConfig.maxHeight,e=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(t-=(e-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>t-e&&(t=this.scrollTop+e,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(t+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},t.prototype.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},t.prototype.freeze=function(){this.$frozen=!0},t.prototype.unfreeze=function(){this.$frozen=!1},t.prototype.$renderChanges=function(t,e){if(this.$changes&&(t|=this.$changes,this.$changes=0),this.session&&this.container.offsetWidth&&!this.$frozen&&(t||e)){if(this.$size.$dirty)return this.$changes|=t,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender",t),this.session&&this.session.$bidiHandler&&this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var i=this.layerConfig;if(t&this.CHANGE_FULL||t&this.CHANGE_SIZE||t&this.CHANGE_TEXT||t&this.CHANGE_LINES||t&this.CHANGE_SCROLL||t&this.CHANGE_H_SCROLL){if(t|=this.$computeLayerConfig()|this.$loop.clear(),i.firstRow!=this.layerConfig.firstRow&&i.firstRowScreen==this.layerConfig.firstRowScreen){var n=this.scrollTop+(i.firstRow-Math.max(this.layerConfig.firstRow,0))*this.lineHeight;n>0&&(this.scrollTop=n,t|=this.CHANGE_SCROLL,t|=this.$computeLayerConfig()|this.$loop.clear())}i=this.layerConfig,this.$updateScrollBarV(),t&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),s.translate(this.content,-this.scrollLeft,-i.offset);var o=i.width+2*this.$padding+"px",r=i.minHeight+"px";s.setStyle(this.content.style,"width",o),s.setStyle(this.content.style,"height",r)}if(t&this.CHANGE_H_SCROLL&&(s.translate(this.content,-this.scrollLeft,-i.offset),this.scroller.className=this.scrollLeft<=0?"ace_scroller ":"ace_scroller ace_scroll-left ",this.enableKeyboardAccessibility&&(this.scroller.className+=this.keyboardFocusClassName)),t&this.CHANGE_FULL)return this.$changedLines=null,this.$textLayer.update(i),this.$showGutter&&this.$gutterLayer.update(i),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(i),this.$markerBack.update(i),this.$markerFront.update(i),this.$cursorLayer.update(i),this.$moveTextAreaToCursor(),void this._signal("afterRender",t);if(t&this.CHANGE_SCROLL)return this.$changedLines=null,t&this.CHANGE_TEXT||t&this.CHANGE_LINES?this.$textLayer.update(i):this.$textLayer.scrollLines(i),this.$showGutter&&(t&this.CHANGE_GUTTER||t&this.CHANGE_LINES?this.$gutterLayer.update(i):this.$gutterLayer.scrollLines(i)),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(i),this.$markerBack.update(i),this.$markerFront.update(i),this.$cursorLayer.update(i),this.$moveTextAreaToCursor(),void this._signal("afterRender",t);t&this.CHANGE_TEXT?(this.$changedLines=null,this.$textLayer.update(i),this.$showGutter&&this.$gutterLayer.update(i),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(i)):t&this.CHANGE_LINES?((this.$updateLines()||t&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(i),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(i)):t&this.CHANGE_TEXT||t&this.CHANGE_GUTTER?(this.$showGutter&&this.$gutterLayer.update(i),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(i)):t&this.CHANGE_CURSOR&&(this.$highlightGutterLine&&this.$gutterLayer.updateLineHighlight(i),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(i)),t&this.CHANGE_CURSOR&&(this.$cursorLayer.update(i),this.$moveTextAreaToCursor()),t&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(i),t&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(i),this._signal("afterRender",t)}else this.$changes|=t},t.prototype.$autosize=function(){var t=this.session.getScreenLength()*this.lineHeight,e=this.$maxLines*this.lineHeight,i=Math.min(e,Math.max((this.$minLines||1)*this.lineHeight,t))+this.scrollMargin.v+(this.$extraHeight||0);this.$horizScroll&&(i+=this.scrollBarH.getHeight()),this.$maxPixelHeight&&i>this.$maxPixelHeight&&(i=this.$maxPixelHeight);var n=!(i<=2*this.lineHeight)&&t>e;if(i!=this.desiredHeight||this.$size.height!=this.desiredHeight||n!=this.$vScroll){n!=this.$vScroll&&(this.$vScroll=n,this.scrollBarV.setVisible(n));var s=this.container.clientWidth;this.container.style.height=i+"px",this.$updateCachedSize(!0,this.$gutterWidth,s,i),this.desiredHeight=i,this._signal("autosize")}},t.prototype.$computeLayerConfig=function(){var t=this.session,e=this.$size,i=e.height<=2*this.lineHeight,n=this.session.getScreenLength()*this.lineHeight,s=this.$getLongestLine(),o=!i&&(this.$hScrollBarAlwaysVisible||e.scrollerWidth-s-2*this.$padding<0),r=this.$horizScroll!==o;r&&(this.$horizScroll=o,this.scrollBarH.setVisible(o));var a=this.$vScroll;this.$maxLines&&this.lineHeight>1&&this.$autosize();var l=e.scrollerHeight+this.lineHeight,h=!this.$maxLines&&this.$scrollPastEnd?(e.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;n+=h;var c=this.scrollMargin;this.session.setScrollTop(Math.max(-c.top,Math.min(this.scrollTop,n-e.scrollerHeight+c.bottom))),this.session.setScrollLeft(Math.max(-c.left,Math.min(this.scrollLeft,s+2*this.$padding-e.scrollerWidth+c.right)));var d=!i&&(this.$vScrollBarAlwaysVisible||e.scrollerHeight-n+h<0||this.scrollTop>c.top),u=a!==d;u&&(this.$vScroll=d,this.scrollBarV.setVisible(d));var p,g,f=this.scrollTop%this.lineHeight,m=Math.ceil(l/this.lineHeight)-1,v=Math.max(0,Math.round((this.scrollTop-f)/this.lineHeight)),_=v+m,y=this.lineHeight;v=t.screenToDocumentRow(v,0);var w=t.getFoldLine(v);w&&(v=w.start.row),p=t.documentToScreenRow(v,0),g=t.getRowLength(v)*y,_=Math.min(t.screenToDocumentRow(_,0),t.getLength()-1),l=e.scrollerHeight+t.getRowLength(_)*y+g,f=this.scrollTop-p*y;var x=0;return(this.layerConfig.width!=s||r)&&(x=this.CHANGE_H_SCROLL),(r||u)&&(x|=this.$updateCachedSize(!0,this.gutterWidth,e.width,e.height),this._signal("scrollbarVisibilityChanged"),u&&(s=this.$getLongestLine())),this.layerConfig={width:s,padding:this.$padding,firstRow:v,firstRowScreen:p,lastRow:_,lineHeight:y,characterWidth:this.characterWidth,minHeight:l,maxHeight:n,offset:f,gutterOffset:y?Math.max(0,Math.ceil((f+e.height-e.scrollerHeight)/y)):0,height:this.$size.scrollerHeight},this.session.$bidiHandler&&this.session.$bidiHandler.setContentWidth(s-this.$padding),x},t.prototype.$updateLines=function(){if(this.$changedLines){var t=this.$changedLines.firstRow,e=this.$changedLines.lastRow;this.$changedLines=null;var i=this.layerConfig;if(!(t>i.lastRow+1||e<i.firstRow))return e===1/0?(this.$showGutter&&this.$gutterLayer.update(i),void this.$textLayer.update(i)):(this.$textLayer.updateLines(i,t,e),!0)}},t.prototype.$getLongestLine=function(){var t=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(t+=1),this.$textLayer&&t>this.$textLayer.MAX_LINE_LENGTH&&(t=this.$textLayer.MAX_LINE_LENGTH+30),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(t*this.characterWidth))},t.prototype.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},t.prototype.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},t.prototype.addGutterDecoration=function(t,e){this.$gutterLayer.addGutterDecoration(t,e)},t.prototype.removeGutterDecoration=function(t,e){this.$gutterLayer.removeGutterDecoration(t,e)},t.prototype.updateBreakpoints=function(t){this._rows=t,this.$loop.schedule(this.CHANGE_GUTTER)},t.prototype.setAnnotations=function(t){this.$gutterLayer.setAnnotations(t),this.$loop.schedule(this.CHANGE_GUTTER)},t.prototype.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},t.prototype.hideCursor=function(){this.$cursorLayer.hideCursor()},t.prototype.showCursor=function(){this.$cursorLayer.showCursor()},t.prototype.scrollSelectionIntoView=function(t,e,i){this.scrollCursorIntoView(t,i),this.scrollCursorIntoView(e,i)},t.prototype.scrollCursorIntoView=function(t,e,i){if(0!==this.$size.scrollerHeight){var n=this.$cursorLayer.getPixelPosition(t),s=n.left,o=n.top,r=i&&i.top||0,a=i&&i.bottom||0;this.$scrollAnimation&&(this.$stopAnimation=!0);var l=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;l+r>o?(e&&l+r>o+this.lineHeight&&(o-=e*this.$size.scrollerHeight),0===o&&(o=-this.scrollMargin.top),this.session.setScrollTop(o)):l+this.$size.scrollerHeight-a<o+this.lineHeight&&(e&&l+this.$size.scrollerHeight-a<o-this.lineHeight&&(o+=e*this.$size.scrollerHeight),this.session.setScrollTop(o+this.lineHeight+a-this.$size.scrollerHeight));var h=this.scrollLeft,c=2*this.layerConfig.characterWidth;s-c<h?((s-=c)<this.$padding+c&&(s=-this.scrollMargin.left),this.session.setScrollLeft(s)):(s+=c,h+this.$size.scrollerWidth<s+this.characterWidth?this.session.setScrollLeft(Math.round(s+this.characterWidth-this.$size.scrollerWidth)):h<=this.$padding&&s-h<this.characterWidth&&this.session.setScrollLeft(0))}},t.prototype.getScrollTop=function(){return this.session.getScrollTop()},t.prototype.getScrollLeft=function(){return this.session.getScrollLeft()},t.prototype.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},t.prototype.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},t.prototype.scrollToRow=function(t){this.session.setScrollTop(t*this.lineHeight)},t.prototype.alignCursor=function(t,e){"number"==typeof t&&(t={row:t,column:0});var i=this.$cursorLayer.getPixelPosition(t),n=this.$size.scrollerHeight-this.lineHeight,s=i.top-n*(e||0);return this.session.setScrollTop(s),s},t.prototype.$calcSteps=function(t,e){var i,n,s=0,o=this.STEPS,r=[];for(s=0;s<o;++s)r.push((i=s/this.STEPS,n=t,(e-t)*(Math.pow(i-1,3)+1)+n));return r},t.prototype.scrollToLine=function(t,e,i,n){var s=this.$cursorLayer.getPixelPosition({row:t,column:0}).top;e&&(s-=this.$size.scrollerHeight/2);var o=this.scrollTop;this.session.setScrollTop(s),!1!==i&&this.animateScrolling(o,n)},t.prototype.animateScrolling=function(t,e){var i=this.scrollTop;if(this.$animatedScroll){var n=this;if(t!=i){if(this.$scrollAnimation){var s=this.$scrollAnimation.steps;if(s.length&&(t=s[0])==i)return}var o=n.$calcSteps(t,i);this.$scrollAnimation={from:t,to:i,steps:o},clearInterval(this.$timer),n.session.setScrollTop(o.shift()),n.session.$scrollTop=i,this.$timer=setInterval((function(){if(!n.$stopAnimation)return n.session?void(o.length?(n.session.setScrollTop(o.shift()),n.session.$scrollTop=i):null!=i?(n.session.$scrollTop=-1,n.session.setScrollTop(i),i=null):r()):clearInterval(n.$timer);r()}),10)}}function r(){n.$timer=clearInterval(n.$timer),n.$scrollAnimation=null,n.$stopAnimation=!1,e&&e()}},t.prototype.scrollToY=function(t){this.scrollTop!==t&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=t)},t.prototype.scrollToX=function(t){this.scrollLeft!==t&&(this.scrollLeft=t),this.$loop.schedule(this.CHANGE_H_SCROLL)},t.prototype.scrollTo=function(t,e){this.session.setScrollTop(e),this.session.setScrollLeft(t)},t.prototype.scrollBy=function(t,e){e&&this.session.setScrollTop(this.session.getScrollTop()+e),t&&this.session.setScrollLeft(this.session.getScrollLeft()+t)},t.prototype.isScrollableBy=function(t,e){return e<0&&this.session.getScrollTop()>=1-this.scrollMargin.top||e>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom||t<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||t>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right||void 0},t.prototype.pixelToScreenCoordinates=function(t,e){var i;if(this.$hasCssTransforms){i={top:0,left:0};var n=this.$fontMetrics.transformCoordinates([t,e]);t=n[1]-this.gutterWidth-this.margin.left,e=n[0]}else i=this.scroller.getBoundingClientRect();var s=t+this.scrollLeft-i.left-this.$padding,o=s/this.characterWidth,r=Math.floor((e+this.scrollTop-i.top)/this.lineHeight),a=this.$blockCursor?Math.floor(o):Math.round(o);return{row:r,column:a,side:o-a>0?1:-1,offsetX:s}},t.prototype.screenToTextCoordinates=function(t,e){var i;if(this.$hasCssTransforms){i={top:0,left:0};var n=this.$fontMetrics.transformCoordinates([t,e]);t=n[1]-this.gutterWidth-this.margin.left,e=n[0]}else i=this.scroller.getBoundingClientRect();var s=t+this.scrollLeft-i.left-this.$padding,o=s/this.characterWidth,r=this.$blockCursor?Math.floor(o):Math.round(o),a=Math.floor((e+this.scrollTop-i.top)/this.lineHeight);return this.session.screenToDocumentPosition(a,Math.max(r,0),s)},t.prototype.textToScreenCoordinates=function(t,e){var i=this.scroller.getBoundingClientRect(),n=this.session.documentToScreenPosition(t,e),s=this.$padding+(this.session.$bidiHandler.isBidiRow(n.row,t)?this.session.$bidiHandler.getPosLeft(n.column):Math.round(n.column*this.characterWidth)),o=n.row*this.lineHeight;return{pageX:i.left+s-this.scrollLeft,pageY:i.top+o-this.scrollTop}},t.prototype.visualizeFocus=function(){s.addCssClass(this.container,"ace_focus")},t.prototype.visualizeBlur=function(){s.removeCssClass(this.container,"ace_focus")},t.prototype.showComposition=function(t){this.$composition=t,t.cssText||(t.cssText=this.textarea.style.cssText),null==t.useTextareaForIME&&(t.useTextareaForIME=this.$useTextareaForIME),this.$useTextareaForIME?(s.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor(),this.$cursorLayer.element.style.display="none"):t.markerId=this.session.addMarker(t.markerRange,"ace_composition_marker","text")},t.prototype.setCompositionText=function(t){var e=this.session.selection.cursor;this.addToken(t,"composition_placeholder",e.row,e.column),this.$moveTextAreaToCursor()},t.prototype.hideComposition=function(){if(this.$composition){this.$composition.markerId&&this.session.removeMarker(this.$composition.markerId),s.removeCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText=this.$composition.cssText;var t=this.session.selection.cursor;this.removeExtraToken(t.row,t.column),this.$composition=null,this.$cursorLayer.element.style.display=""}},t.prototype.setGhostText=function(t,e){var i=this.session.selection.cursor,n=e||{row:i.row,column:i.column};this.removeGhostText();var o=this.$calculateWrappedTextChunks(t,n);this.addToken(o[0].text,"ghost_text",n.row,n.column),this.$ghostText={text:t,position:{row:n.row,column:n.column}};var r=s.createElement("div");if(o.length>1){var a,l=this.hideTokensAfterPosition(n.row,n.column);o.slice(1).forEach((function(t){var e=s.createElement("div"),i=s.createElement("span");i.className="ace_ghost_text",t.wrapped&&(e.className="ghost_text_line_wrapped"),0===t.text.length&&(t.text=" "),i.appendChild(s.createTextNode(t.text)),e.appendChild(i),r.appendChild(e),a=e})),l.forEach((function(t){var e=s.createElement("span");x(t.type)||(e.className="ace_"+t.type.replace(/\./g," ace_")),e.appendChild(s.createTextNode(t.value)),a.appendChild(e)})),this.$ghostTextWidget={el:r,row:n.row,column:n.column,className:"ace_ghost_text_container"},this.session.widgetManager.addLineWidget(this.$ghostTextWidget);var h=this.$cursorLayer.getPixelPosition(n,!0),c=this.container.getBoundingClientRect().height,d=o.length*this.lineHeight;if(d<c-h.top)return;d<c?this.scrollBy(0,(o.length-1)*this.lineHeight):this.scrollToRow(n.row)}},t.prototype.$calculateWrappedTextChunks=function(t,e){var i=this.$size.scrollerWidth-2*this.$padding,n=Math.floor(i/this.characterWidth)-2;n=n<=0?60:n;for(var s=t.split(/\r?\n/),o=[],r=0;r<s.length;r++){var a=this.session.$getDisplayTokens(s[r],e.column),l=this.session.$computeWrapSplits(a,n,this.session.$tabSize);if(l.length>0){var h=0;l.push(s[r].length);for(var c=0;c<l.length;c++){var d=s[r].slice(h,l[c]);o.push({text:d,wrapped:!0}),h=l[c]}}else o.push({text:s[r],wrapped:!1})}return o},t.prototype.removeGhostText=function(){if(this.$ghostText){var t=this.$ghostText.position;this.removeExtraToken(t.row,t.column),this.$ghostTextWidget&&(this.session.widgetManager.removeLineWidget(this.$ghostTextWidget),this.$ghostTextWidget=null),this.$ghostText=null}},t.prototype.addToken=function(t,e,i,n){var s=this.session;s.bgTokenizer.lines[i]=null;var o={type:e,value:t},r=s.getTokens(i);if(null!=n&&r.length)for(var a=0,l=0;l<r.length;l++){var h=r[l];if(n<=(a+=h.value.length)){var c=h.value.length-(a-n),d=h.value.slice(0,c),u=h.value.slice(c);r.splice(l,1,{type:h.type,value:d},o,{type:h.type,value:u});break}}else r.push(o);this.updateLines(i,i)},t.prototype.hideTokensAfterPosition=function(t,e){for(var i=this.session.getTokens(t),n=0,s=!1,o=[],r=0;r<i.length;r++){var a=i[r];n+=a.value.length,"ghost_text"!==a.type&&(s?(o.push({type:a.type,value:a.value}),a.type="hidden_token"):n===e&&(s=!0))}return this.updateLines(t,t),o},t.prototype.removeExtraToken=function(t,e){this.session.bgTokenizer.lines[t]=null,this.updateLines(t,t)},t.prototype.setTheme=function(t,e){var i=this;if(this.$themeId=t,i._dispatchEvent("themeChange",{theme:t}),t&&"string"!=typeof t)o(t);else{var n=t||this.$options.theme.initialValue;r.loadModule(["theme",n],o)}function o(n){if(i.$themeId!=t)return e&&e();if(!n||!n.cssClass)throw new Error("couldn't load module "+t+" or it didn't call define");n.$id&&(i.$themeId=n.$id),s.importCssString(n.cssText,n.cssClass,i.container),i.theme&&s.removeCssClass(i.container,i.theme.cssClass);var o="padding"in n?n.padding:"padding"in(i.theme||{})?4:i.$padding;i.$padding&&o!=i.$padding&&i.setPadding(o),i.$theme=n.cssClass,i.theme=n,s.addCssClass(i.container,n.cssClass),s.setCssClass(i.container,"ace_dark",n.isDark),i.$size&&(i.$size.width=0,i.$updateSizeAsync()),i._dispatchEvent("themeLoaded",{theme:n}),e&&e(),w.isSafari&&i.scroller&&(i.scroller.style.background="red",i.scroller.style.background="")}},t.prototype.getTheme=function(){return this.$themeId},t.prototype.setStyle=function(t,e){s.setCssClass(this.container,t,!1!==e)},t.prototype.unsetStyle=function(t){s.removeCssClass(this.container,t)},t.prototype.setCursorStyle=function(t){s.setStyle(this.scroller.style,"cursor",t)},t.prototype.setMouseCursor=function(t){s.setStyle(this.scroller.style,"cursor",t)},t.prototype.attachToShadowRoot=function(){s.importCssString(_,"ace_editor.css",this.container)},t.prototype.destroy=function(){this.freeze(),this.$fontMetrics.destroy(),this.$cursorLayer.destroy(),this.removeAllListeners(),this.container.textContent="",this.setOption("useResizeObserver",!1)},t.prototype.$updateCustomScrollbar=function(t){var e=this;this.$horizScroll=this.$vScroll=null,this.scrollBarV.element.remove(),this.scrollBarH.element.remove(),this.$scrollDecorator&&delete this.$scrollDecorator,!0===t?(this.scrollBarV=new g(this.container,this),this.scrollBarH=new p(this.container,this),this.scrollBarV.setHeight(this.$size.scrollerHeight),this.scrollBarH.setWidth(this.$size.scrollerWidth),this.scrollBarV.addEventListener("scroll",(function(t){e.$scrollAnimation||e.session.setScrollTop(t.data-e.scrollMargin.top)})),this.scrollBarH.addEventListener("scroll",(function(t){e.$scrollAnimation||e.session.setScrollLeft(t.data-e.scrollMargin.left)})),this.$scrollDecorator=new y(this.scrollBarV,this),this.$scrollDecorator.$updateDecorators()):(this.scrollBarV=new u(this.container,this),this.scrollBarH=new d(this.container,this),this.scrollBarV.addEventListener("scroll",(function(t){e.$scrollAnimation||e.session.setScrollTop(t.data-e.scrollMargin.top)})),this.scrollBarH.addEventListener("scroll",(function(t){e.$scrollAnimation||e.session.setScrollLeft(t.data-e.scrollMargin.left)})))},t.prototype.$addResizeObserver=function(){if(window.ResizeObserver&&!this.$resizeObserver){var t=this;this.$resizeTimer=o.delayedCall((function(){t.destroyed||t.onResize()}),50),this.$resizeObserver=new window.ResizeObserver((function(e){var i=e[0].contentRect.width,n=e[0].contentRect.height;Math.abs(t.$size.width-i)>1||Math.abs(t.$size.height-n)>1?t.$resizeTimer.delay():t.$resizeTimer.cancel()})),this.$resizeObserver.observe(this.container)}},t}();b.prototype.CHANGE_CURSOR=1,b.prototype.CHANGE_MARKER=2,b.prototype.CHANGE_GUTTER=4,b.prototype.CHANGE_SCROLL=8,b.prototype.CHANGE_LINES=16,b.prototype.CHANGE_TEXT=32,b.prototype.CHANGE_SIZE=64,b.prototype.CHANGE_MARKER_BACK=128,b.prototype.CHANGE_MARKER_FRONT=256,b.prototype.CHANGE_FULL=512,b.prototype.CHANGE_H_SCROLL=1024,b.prototype.$changes=0,b.prototype.$padding=null,b.prototype.$frozen=!1,b.prototype.STEPS=8,n.implement(b.prototype,v),r.defineOptions(b.prototype,"renderer",{useResizeObserver:{set:function(t){!t&&this.$resizeObserver?(this.$resizeObserver.disconnect(),this.$resizeTimer.cancel(),this.$resizeTimer=this.$resizeObserver=null):t&&!this.$resizeObserver&&this.$addResizeObserver()}},animatedScroll:{initialValue:!1},showInvisibles:{set:function(t){this.$textLayer.setShowInvisibles(t)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(t){"number"==typeof t&&(this.$printMarginColumn=t),this.$showPrintMargin=!!t,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(t){this.$gutter.style.display=t?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},useSvgGutterIcons:{set:function(t){this.$gutterLayer.$useSvgGutterIcons=t},initialValue:!1},showFoldedAnnotations:{set:function(t){this.$gutterLayer.$showFoldedAnnotations=t},initialValue:!1},fadeFoldWidgets:{set:function(t){s.setCssClass(this.$gutter,"ace_fade-fold-widgets",t)},initialValue:!1},showFoldWidgets:{set:function(t){this.$gutterLayer.setShowFoldWidgets(t),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(t){this.$textLayer.setDisplayIndentGuides(t)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightIndentGuides:{set:function(t){1==this.$textLayer.setHighlightIndentGuides(t)?this.$textLayer.$highlightIndentGuide():this.$textLayer.$clearActiveIndentGuide(this.$textLayer.$lines.cells)},initialValue:!0},highlightGutterLine:{set:function(t){this.$gutterLayer.setHighlightGutterLine(t),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},hScrollBarAlwaysVisible:{set:function(t){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(t){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(t){"number"==typeof t&&(t+="px"),this.container.style.fontSize=t,this.updateFontSize()},initialValue:12},fontFamily:{set:function(t){this.container.style.fontFamily=t,this.updateFontSize()}},maxLines:{set:function(t){this.updateFull()}},minLines:{set:function(t){this.$minLines<562949953421311||(this.$minLines=0),this.updateFull()}},maxPixelHeight:{set:function(t){this.updateFull()},initialValue:0},scrollPastEnd:{set:function(t){t=+t||0,this.$scrollPastEnd!=t&&(this.$scrollPastEnd=t,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(t){this.$gutterLayer.$fixedWidth=!!t,this.$loop.schedule(this.CHANGE_GUTTER)}},customScrollbar:{set:function(t){this.$updateCustomScrollbar(t)},initialValue:!1},theme:{set:function(t){this.setTheme(t)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0},hasCssTransforms:{},useTextareaForIME:{initialValue:!w.isMobile&&!w.isIE}}),e.VirtualRenderer=b})),ace.define("ace/worker/worker_client",["require","exports","module","ace/lib/oop","ace/lib/net","ace/lib/event_emitter","ace/config"],(function(t,e,i){"use strict";var n=t("../lib/oop"),s=t("../lib/net"),o=t("../lib/event_emitter").EventEmitter,r=t("../config");function a(t){if("undefined"==typeof Worker)return{postMessage:function(){},terminate:function(){}};if(r.get("loadWorkerFromBlob")){var e=function(t){var e="importScripts('"+s.qualifyURL(t)+"');";try{return new Blob([e],{type:"application/javascript"})}catch(t){var i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder);return i.append(e),i.getBlob("application/javascript")}}(t),i=(window.URL||window.webkitURL).createObjectURL(e);return new Worker(i)}return new Worker(t)}var l=function(t){t.postMessage||(t=this.$createWorkerFromOldConfig.apply(this,arguments)),this.$worker=t,this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){n.implement(this,o),this.$createWorkerFromOldConfig=function(e,i,n,s,o){if(t.nameToUrl&&!t.toUrl&&(t.toUrl=t.nameToUrl),r.get("packaged")||!t.toUrl)s=s||r.moduleUrl(i,"worker");else{var l=this.$normalizePath;s=s||l(t.toUrl("ace/worker/worker.js",null,"_"));var h={};e.forEach((function(e){h[e]=l(t.toUrl(e,null,"_").replace(/(\.js)?(\?.*)?$/,""))}))}return this.$worker=a(s),o&&this.send("importScripts",o),this.$worker.postMessage({init:!0,tlns:h,module:i,classname:n}),this.$worker},this.onMessage=function(t){var e=t.data;switch(e.type){case"event":this._signal(e.name,{data:e.data});break;case"call":var i=this.callbacks[e.id];i&&(i(e.data),delete this.callbacks[e.id]);break;case"error":this.reportError(e.data);break;case"log":window.console&&console.log&&console.log.apply(console,e.data)}},this.reportError=function(t){window.console&&console.error&&console.error(t)},this.$normalizePath=function(t){return s.qualifyURL(t)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker.onerror=function(t){t.preventDefault()},this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(t,e){this.$worker.postMessage({command:t,args:e})},this.call=function(t,e,i){if(i){var n=this.callbackId++;this.callbacks[n]=i,e.push(n)}this.send(t,e)},this.emit=function(t,e){try{e.data&&e.data.err&&(e.data.err={message:e.data.err.message,stack:e.data.err.stack,code:e.data.err.code}),this.$worker&&this.$worker.postMessage({event:t,data:{data:e.data}})}catch(t){console.error(t.stack)}},this.attachToDocument=function(t){this.$doc&&this.terminate(),this.$doc=t,this.call("setValue",[t.getValue()]),t.on("change",this.changeListener,!0)},this.changeListener=function(t){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),"insert"==t.action?this.deltaQueue.push(t.start,t.lines):this.deltaQueue.push(t.start,t.end)},this.$sendDeltaQueue=function(){var t=this.deltaQueue;t&&(this.deltaQueue=null,t.length>50&&t.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:t}))}}).call(l.prototype),e.UIWorkerClient=function(t,e,i){var n=null,s=!1,a=Object.create(o),h=[],c=new l({messageBuffer:h,terminate:function(){},postMessage:function(t){h.push(t),n&&(s?setTimeout(d):d())}});c.setEmitSync=function(t){s=t};var d=function(){var t=h.shift();t.command?n[t.command].apply(n,t.args):t.event&&a._signal(t.event,t.data)};return a.postMessage=function(t){c.onMessage({data:t})},a.callback=function(t,e){this.postMessage({type:"call",id:e,data:t})},a.emit=function(t,e){this.postMessage({type:"event",name:t,data:e})},r.loadModule(["worker",e],(function(t){for(n=new t[i](a);h.length;)d()})),c},e.WorkerClient=l,e.createWorker=a})),ace.define("ace/placeholder",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/oop"],(function(t,e,i){"use strict";var n=t("./range").Range,s=t("./lib/event_emitter").EventEmitter,o=t("./lib/oop"),r=function(){function t(t,e,i,n,s,o){var r=this;this.length=e,this.session=t,this.doc=t.getDocument(),this.mainClass=s,this.othersClass=o,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate,!0),this.$others=n,this.$onCursorChange=function(){setTimeout((function(){r.onCursorChange()}))},this.$pos=i;var a=t.getUndoManager().$undoStack||t.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=a.length,this.setup(),t.selection.on("changeCursor",this.$onCursorChange)}return t.prototype.setup=function(){var t=this,e=this.doc,i=this.session;this.selectionBefore=i.selection.toJSON(),i.selection.inMultiSelectMode&&i.selection.toSingleRange(),this.pos=e.createAnchor(this.$pos.row,this.$pos.column);var s=this.pos;s.$insertRight=!0,s.detach(),s.markerId=i.addMarker(new n(s.row,s.column,s.row,s.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach((function(i){var n=e.createAnchor(i.row,i.column);n.$insertRight=!0,n.detach(),t.others.push(n)})),i.setUndoSelect(!1)},t.prototype.showOtherMarkers=function(){if(!this.othersActive){var t=this.session,e=this;this.othersActive=!0,this.others.forEach((function(i){i.markerId=t.addMarker(new n(i.row,i.column,i.row,i.column+e.length),e.othersClass,null,!1)}))}},t.prototype.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var t=0;t<this.others.length;t++)this.session.removeMarker(this.others[t].markerId)}},t.prototype.onUpdate=function(t){if(this.$updating)return this.updateAnchors(t);var e=t;if(e.start.row===e.end.row&&e.start.row===this.pos.row){this.$updating=!0;var i="insert"===t.action?e.end.column-e.start.column:e.start.column-e.end.column,s=e.start.column>=this.pos.column&&e.start.column<=this.pos.column+this.length+1,o=e.start.column-this.pos.column;if(this.updateAnchors(t),s&&(this.length+=i),s&&!this.session.$fromUndo)if("insert"===t.action)for(var r=this.others.length-1;r>=0;r--){var a={row:(l=this.others[r]).row,column:l.column+o};this.doc.insertMergedLines(a,t.lines)}else if("remove"===t.action)for(r=this.others.length-1;r>=0;r--){var l;a={row:(l=this.others[r]).row,column:l.column+o},this.doc.remove(new n(a.row,a.column,a.row,a.column-i))}this.$updating=!1,this.updateMarkers()}},t.prototype.updateAnchors=function(t){this.pos.onChange(t);for(var e=this.others.length;e--;)this.others[e].onChange(t);this.updateMarkers()},t.prototype.updateMarkers=function(){if(!this.$updating){var t=this,e=this.session,i=function(i,s){e.removeMarker(i.markerId),i.markerId=e.addMarker(new n(i.row,i.column,i.row,i.column+t.length),s,null,!1)};i(this.pos,this.mainClass);for(var s=this.others.length;s--;)i(this.others[s],this.othersClass)}},t.prototype.onCursorChange=function(t){if(!this.$updating&&this.session){var e=this.session.selection.getCursor();e.row===this.pos.row&&e.column>=this.pos.column&&e.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",t)):(this.hideOtherMarkers(),this._emit("cursorLeave",t))}},t.prototype.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId),this.hideOtherMarkers(),this.doc.off("change",this.$onUpdate),this.session.selection.off("changeCursor",this.$onCursorChange),this.session.setUndoSelect(!0),this.session=null},t.prototype.cancel=function(){if(-1!==this.$undoStackDepth){for(var t=this.session.getUndoManager(),e=(t.$undoStack||t.$undostack).length-this.$undoStackDepth,i=0;i<e;i++)t.undo(this.session,!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}},t}();o.implement(r.prototype,s),e.PlaceHolder=r})),ace.define("ace/mouse/multi_select_handler",["require","exports","module","ace/lib/event","ace/lib/useragent"],(function(t,e,i){var n=t("../lib/event"),s=t("../lib/useragent");function o(t,e){return t.row==e.row&&t.column==e.column}e.onMouseDown=function(t){var e=t.domEvent,i=e.altKey,r=e.shiftKey,a=e.ctrlKey,l=t.getAccelKey(),h=t.getButton();if(a&&s.isMac&&(h=e.button),t.editor.inMultiSelectMode&&2==h)t.editor.textInput.onContextMenu(t.domEvent);else if(a||i||l){if(0===h){var c,d=t.editor,u=d.selection,p=d.inMultiSelectMode,g=t.getDocumentPosition(),f=u.getCursor(),m=t.inSelection()||u.isEmpty()&&o(g,f),v=t.x,_=t.y,y=d.session,w=d.renderer.pixelToScreenCoordinates(v,_),x=w;if(d.$mouseHandler.$enableJumpToDef)a&&i||l&&i?c=r?"block":"add":i&&d.$blockSelectEnabled&&(c="block");else if(l&&!i){if(c="add",!p&&r)return}else i&&d.$blockSelectEnabled&&(c="block");if(c&&s.isMac&&e.ctrlKey&&d.$mouseHandler.cancelContextMenu(),"add"==c){if(!p&&m)return;if(!p){var b=u.toOrientedRange();d.addSelectionMarker(b)}var C=u.rangeList.rangeAtPoint(g);d.inVirtualSelectionMode=!0,r&&(C=null,b=u.ranges[0]||b,d.removeSelectionMarker(b)),d.once("mouseup",(function(){var t=u.toOrientedRange();C&&t.isEmpty()&&o(C.cursor,t.cursor)?u.substractPoint(t.cursor):(r?u.substractPoint(b.cursor):b&&(d.removeSelectionMarker(b),u.addRange(b)),u.addRange(t)),d.inVirtualSelectionMode=!1}))}else if("block"==c){var A;t.stop(),d.inVirtualSelectionMode=!0;var S=[],E=function(){var t=d.renderer.pixelToScreenCoordinates(v,_),e=y.screenToDocumentPosition(t.row,t.column,t.offsetX);o(x,t)&&o(e,u.lead)||(x=t,d.selection.moveToPosition(e),d.renderer.scrollCursorIntoView(),d.removeSelectionMarkers(S),S=u.rectangularRangeBlock(x,w),d.$mouseHandler.$clickSelection&&1==S.length&&S[0].isEmpty()&&(S[0]=d.$mouseHandler.$clickSelection.clone()),S.forEach(d.addSelectionMarker,d),d.updateSelectionMarkers())};p&&!l?u.toSingleRange():!p&&l&&(A=u.toOrientedRange(),d.addSelectionMarker(A)),r?w=y.documentToScreenPosition(u.lead):u.moveToPosition(g),x={row:-1,column:-1};var T=E;n.capture(d.container,(function(t){v=t.clientX,_=t.clientY}),(function(t){E(),clearInterval(k),d.removeSelectionMarkers(S),S.length||(S=[u.toOrientedRange()]),A&&(d.removeSelectionMarker(A),u.toSingleRange(A));for(var e=0;e<S.length;e++)u.addRange(S[e]);d.inVirtualSelectionMode=!1,d.$mouseHandler.$clickSelection=null}));var k=setInterval((function(){T()}),20);return t.preventDefault()}}}else 0===h&&t.editor.inMultiSelectMode&&t.editor.exitMultiSelectMode()}})),ace.define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],(function(t,e,i){e.defaultCommands=[{name:"addCursorAbove",description:"Add cursor above",exec:function(t){t.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",description:"Add cursor below",exec:function(t){t.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",description:"Add cursor above (skip current)",exec:function(t){t.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",description:"Add cursor below (skip current)",exec:function(t){t.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",description:"Select more before",exec:function(t){t.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",description:"Select more after",exec:function(t){t.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",description:"Select next before",exec:function(t){t.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",description:"Select next after",exec:function(t){t.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"toggleSplitSelectionIntoLines",description:"Split selection into lines",exec:function(t){t.multiSelect.rangeCount>1?t.multiSelect.joinSelections():t.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:!0},{name:"splitSelectionIntoLines",description:"Split into lines",exec:function(t){t.multiSelect.splitIntoLines()},readOnly:!0},{name:"alignCursors",description:"Align cursors",exec:function(t){t.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",description:"Find all",exec:function(t){t.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:!0}],e.multiSelectCommands=[{name:"singleSelection",description:"Single selection",bindKey:"esc",exec:function(t){t.exitMultiSelectMode()},scrollIntoView:"cursor",readOnly:!0,isAvailable:function(t){return t&&t.inMultiSelectMode}}];var n=t("../keyboard/hash_handler").HashHandler;e.keyboardHandler=new n(e.multiSelectCommands)})),ace.define("ace/multi_select",["require","exports","module","ace/range_list","ace/range","ace/selection","ace/mouse/multi_select_handler","ace/lib/event","ace/lib/lang","ace/commands/multi_select_commands","ace/search","ace/edit_session","ace/editor","ace/config"],(function(t,e,i){var n=t("./range_list").RangeList,s=t("./range").Range,o=t("./selection").Selection,r=t("./mouse/multi_select_handler").onMouseDown,a=t("./lib/event"),l=t("./lib/lang"),h=t("./commands/multi_select_commands");e.commands=h.defaultCommands.concat(h.multiSelectCommands);var c=new(0,t("./search").Search),d=t("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(d.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(t,e){if(t){if(!this.inMultiSelectMode&&0===this.rangeCount){var i=this.toOrientedRange();if(this.rangeList.add(i),this.rangeList.add(t),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),e||this.fromOrientedRange(t);this.rangeList.removeAll(),this.rangeList.add(i),this.$onAddRange(i)}t.cursor||(t.cursor=t.end);var n=this.rangeList.add(t);return this.$onAddRange(t),n.length&&this.$onRemoveRange(n),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),e||this.fromOrientedRange(t)}},this.toSingleRange=function(t){t=t||this.ranges[0];var e=this.rangeList.removeAll();e.length&&this.$onRemoveRange(e),t&&this.fromOrientedRange(t)},this.substractPoint=function(t){var e=this.rangeList.substractPoint(t);if(e)return this.$onRemoveRange(e),e[0]},this.mergeOverlappingRanges=function(){var t=this.rangeList.merge();t.length&&this.$onRemoveRange(t)},this.$onAddRange=function(t){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(t),this._signal("addRange",{range:t})},this.$onRemoveRange=function(t){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var e=this.rangeList.ranges.pop();t.push(e),this.rangeCount=0}for(var i=t.length;i--;){var n=this.ranges.indexOf(t[i]);this.ranges.splice(n,1)}this._signal("removeRange",{ranges:t}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),(e=e||this.ranges[0])&&!e.isEqual(this.getRange())&&this.fromOrientedRange(e)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new n,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){for(var t=this.ranges.length?this.ranges:[this.getRange()],e=[],i=0;i<t.length;i++){var n=t[i],o=n.start.row,r=n.end.row;if(o===r)e.push(n.clone());else{for(e.push(new s(o,n.start.column,o,this.session.getLine(o).length));++o<r;)e.push(this.getLineRange(o,!0));e.push(new s(r,0,r,n.end.column))}0!=i||this.isBackwards()||(e=e.reverse())}for(this.toSingleRange(),i=e.length;i--;)this.addRange(e[i])},this.joinSelections=function(){var t=this.rangeList.ranges,e=t[t.length-1],i=s.fromPoints(t[0].start,e.end);this.toSingleRange(),this.setSelectionRange(i,e.cursor==e.start)},this.toggleBlockSelection=function(){if(this.rangeCount>1){var t=this.rangeList.ranges,e=t[t.length-1],i=s.fromPoints(t[0].start,e.end);this.toSingleRange(),this.setSelectionRange(i,e.cursor==e.start)}else{var n=this.session.documentToScreenPosition(this.cursor),o=this.session.documentToScreenPosition(this.anchor);this.rectangularRangeBlock(n,o).forEach(this.addRange,this)}},this.rectangularRangeBlock=function(t,e,i){var n=[],o=t.column<e.column;if(o)var r=t.column,a=e.column,l=t.offsetX,h=e.offsetX;else r=e.column,a=t.column,l=e.offsetX,h=t.offsetX;var c,d,u,p=t.row<e.row;if(p)var g=t.row,f=e.row;else g=e.row,f=t.row;r<0&&(r=0),g<0&&(g=0),g==f&&(i=!0);for(var m=g;m<=f;m++){var v=s.fromPoints(this.session.screenToDocumentPosition(m,r,l),this.session.screenToDocumentPosition(m,a,h));if(v.isEmpty()){if(c&&(u=c,(d=v.end).row==u.row&&d.column==u.column))break;c=v.end}v.cursor=o?v.start:v.end,n.push(v)}if(p&&n.reverse(),!i){for(var _=n.length-1;n[_].isEmpty()&&_>0;)_--;if(_>0)for(var y=0;n[y].isEmpty();)y++;for(var w=_;w>=y;w--)n[w].isEmpty()&&n.splice(w,1)}return n}}.call(o.prototype);var u=t("./editor").Editor;function p(t){t.$multiselectOnSessionChange||(t.$onAddRange=t.$onAddRange.bind(t),t.$onRemoveRange=t.$onRemoveRange.bind(t),t.$onMultiSelect=t.$onMultiSelect.bind(t),t.$onSingleSelect=t.$onSingleSelect.bind(t),t.$multiselectOnSessionChange=e.onSessionChange.bind(t),t.$checkMultiselectChange=t.$checkMultiselectChange.bind(t),t.$multiselectOnSessionChange(t),t.on("changeSession",t.$multiselectOnSessionChange),t.on("mousedown",r),t.commands.addCommands(h.defaultCommands),function(t){if(t.textInput){var e=t.textInput.getElement(),i=!1;a.addListener(e,"keydown",(function(e){var s=18==e.keyCode&&!(e.ctrlKey||e.shiftKey||e.metaKey);t.$blockSelectEnabled&&s?i||(t.renderer.setMouseCursor("crosshair"),i=!0):i&&n()}),t),a.addListener(e,"keyup",n,t),a.addListener(e,"blur",n,t)}function n(e){i&&(t.renderer.setMouseCursor(""),i=!1)}}(t))}(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(t){t.cursor||(t.cursor=t.end);var e=this.getSelectionStyle();return t.marker=this.session.addMarker(t,"ace_selection",e),this.session.$selectionMarkers.push(t),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,t},this.removeSelectionMarker=function(t){if(t.marker){this.session.removeMarker(t.marker);var e=this.session.$selectionMarkers.indexOf(t);-1!=e&&this.session.$selectionMarkers.splice(e,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(t){for(var e=this.session.$selectionMarkers,i=t.length;i--;){var n=t[i];if(n.marker){this.session.removeMarker(n.marker);var s=e.indexOf(n);-1!=s&&e.splice(s,1)}}this.session.selectionMarkerCount=e.length},this.$onAddRange=function(t){this.addSelectionMarker(t.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(t){this.removeSelectionMarkers(t.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(t){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(h.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(t){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(h.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(t){var e=t.command,i=t.editor;if(i.multiSelect){if(e.multiSelectAction)"forEach"==e.multiSelectAction?n=i.forEachSelection(e,t.args):"forEachLine"==e.multiSelectAction?n=i.forEachSelection(e,t.args,!0):"single"==e.multiSelectAction?(i.exitMultiSelectMode(),n=e.exec(i,t.args||{})):n=e.multiSelectAction(i,t.args||{});else{var n=e.exec(i,t.args||{});i.multiSelect.addRange(i.multiSelect.toOrientedRange()),i.multiSelect.mergeOverlappingRanges()}return n}},this.forEachSelection=function(t,e,i){if(!this.inVirtualSelectionMode){var n,s=i&&i.keepOrder,r=1==i||i&&i.$byLines,a=this.session,l=this.selection,h=l.rangeList,c=(s?l:h).ranges;if(!c.length)return t.exec?t.exec(this,e||{}):t(this,e||{});var d=l._eventRegistry;l._eventRegistry={};var u=new o(a);this.inVirtualSelectionMode=!0;for(var p=c.length;p--;){if(r)for(;p>0&&c[p].start.row==c[p-1].end.row;)p--;u.fromOrientedRange(c[p]),u.index=p,this.selection=a.selection=u;var g=t.exec?t.exec(this,e||{}):t(this,e||{});n||void 0===g||(n=g),u.toOrientedRange(c[p])}u.detach(),this.selection=a.selection=l,this.inVirtualSelectionMode=!1,l._eventRegistry=d,l.mergeOverlappingRanges(),l.ranges[0]&&l.fromOrientedRange(l.ranges[0]);var f=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),f&&f.from==f.to&&this.renderer.animateScrolling(f.from),n}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var t="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var e=this.multiSelect.rangeList.ranges,i=[],n=0;n<e.length;n++)i.push(this.session.getTextRange(e[n]));var s=this.session.getDocument().getNewLineCharacter();(t=i.join(s)).length==(i.length-1)*s.length&&(t="")}else this.selection.isEmpty()||(t=this.session.getTextRange(this.getSelectionRange()));return t},this.$checkMultiselectChange=function(t,e){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var i=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&e==this.multiSelect.anchor)return;var n=e==this.multiSelect.anchor?i.cursor==i.start?i.end:i.start:i.cursor;n.row!=e.row||this.session.$clipPositionToDocument(n.row,n.column).column!=e.column?this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange()):this.multiSelect.mergeOverlappingRanges()}},this.findAll=function(t,e,i){if((e=e||{}).needle=t||e.needle,null==e.needle){var n=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();e.needle=this.session.getTextRange(n)}this.$search.set(e);var s=this.$search.findAll(this.session);if(!s.length)return 0;var o=this.multiSelect;i||o.toSingleRange(s[0]);for(var r=s.length;r--;)o.addRange(s[r],!0);return n&&o.rangeList.rangeAtPoint(n.start)&&o.addRange(n,!0),s.length},this.selectMoreLines=function(t,e){var i=this.selection.toOrientedRange(),n=i.cursor==i.end,o=this.session.documentToScreenPosition(i.cursor);this.selection.$desiredColumn&&(o.column=this.selection.$desiredColumn);var r,a=this.session.screenToDocumentPosition(o.row+t,o.column);if(i.isEmpty())h=a;else var l=this.session.documentToScreenPosition(n?i.end:i.start),h=this.session.screenToDocumentPosition(l.row+t,l.column);if(n?(r=s.fromPoints(a,h)).cursor=r.start:(r=s.fromPoints(h,a)).cursor=r.end,r.desiredColumn=o.column,this.selection.inMultiSelectMode){if(e)var c=i.cursor}else this.selection.addRange(i);this.selection.addRange(r),c&&this.selection.substractPoint(c)},this.transposeSelections=function(t){for(var e=this.session,i=e.multiSelect,n=i.ranges,s=n.length;s--;)if((a=n[s]).isEmpty()){var o=e.getWordRange(a.start.row,a.start.column);a.start.row=o.start.row,a.start.column=o.start.column,a.end.row=o.end.row,a.end.column=o.end.column}i.mergeOverlappingRanges();var r=[];for(s=n.length;s--;){var a=n[s];r.unshift(e.getTextRange(a))}for(t<0?r.unshift(r.pop()):r.push(r.shift()),s=n.length;s--;){var l=(a=n[s]).clone();e.replace(a,r[s]),a.start.row=l.start.row,a.start.column=l.start.column}i.fromOrientedRange(i.ranges[0])},this.selectMore=function(t,e,i){var n=this.session,s=n.multiSelect.toOrientedRange();if(!s.isEmpty()||((s=n.getWordRange(s.start.row,s.start.column)).cursor=-1==t?s.start:s.end,this.multiSelect.addRange(s),!i)){var o=n.getTextRange(s),r=function(t,e,i){return c.$options.wrap=!0,c.$options.needle=e,c.$options.backwards=-1==i,c.find(t)}(n,o,t);r&&(r.cursor=-1==t?r.start:r.end,this.session.unfold(r),this.multiSelect.addRange(r),this.renderer.scrollCursorIntoView(null,.5)),e&&this.multiSelect.substractPoint(s.cursor)}},this.alignCursors=function(){var t=this.session,e=t.multiSelect,i=e.ranges,n=-1,o=i.filter((function(t){if(t.cursor.row==n)return!0;n=t.cursor.row}));if(i.length&&o.length!=i.length-1){o.forEach((function(t){e.substractPoint(t.cursor)}));var r=0,a=1/0,h=i.map((function(e){var i=e.cursor,n=t.getLine(i.row).substr(i.column).search(/\S/g);return-1==n&&(n=0),i.column>r&&(r=i.column),n<a&&(a=n),n}));i.forEach((function(e,i){var n=e.cursor,o=r-n.column,c=h[i]-a;o>c?t.insert(n,l.stringRepeat(" ",o-c)):t.remove(new s(n.row,n.column,n.row,n.column-o+c)),e.start.column=e.end.column=r,e.start.row=e.end.row=n.row,e.cursor=e.end})),e.fromOrientedRange(i[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var c=this.selection.getRange(),d=c.start.row,u=c.end.row,p=d==u;if(p){var g,f=this.session.getLength();do{g=this.session.getLine(u)}while(/[=:]/.test(g)&&++u<f);do{g=this.session.getLine(d)}while(/[=:]/.test(g)&&--d>0);d<0&&(d=0),u>=f&&(u=f-1)}var m=this.session.removeFullLines(d,u);m=this.$reAlignText(m,p),this.session.insert({row:d,column:0},m.join("\n")+"\n"),p||(c.start.column=0,c.end.column=m[m.length-1].length),this.selection.setRange(c)}},this.$reAlignText=function(t,e){var i,n,s,o=!0,r=!0;return t.map((function(t){var e=t.match(/(\s*)(.*?)(\s*)([=:].*)/);return e?null==i?(i=e[1].length,n=e[2].length,s=e[3].length,e):(i+n+s!=e[1].length+e[2].length+e[3].length&&(r=!1),i!=e[1].length&&(o=!1),i>e[1].length&&(i=e[1].length),n<e[2].length&&(n=e[2].length),s>e[3].length&&(s=e[3].length),e):[t]})).map(e?h:o?r?function(t){return t[2]?a(i+n-t[2].length)+t[2]+a(s)+t[4].replace(/^([=:])\s+/,"$1 "):t[0]}:h:function(t){return t[2]?a(i)+t[2]+a(s)+t[4].replace(/^([=:])\s+/,"$1 "):t[0]});function a(t){return l.stringRepeat(" ",t)}function h(t){return t[2]?a(i)+t[2]+a(n-t[2].length+s)+t[4].replace(/^([=:])\s+/,"$1 "):t[0]}}}).call(u.prototype),e.onSessionChange=function(t){var e=t.session;e&&!e.multiSelect&&(e.$selectionMarkers=[],e.selection.$initRangeList(),e.multiSelect=e.selection),this.multiSelect=e&&e.multiSelect;var i=t.oldSession;i&&(i.multiSelect.off("addRange",this.$onAddRange),i.multiSelect.off("removeRange",this.$onRemoveRange),i.multiSelect.off("multiSelect",this.$onMultiSelect),i.multiSelect.off("singleSelect",this.$onSingleSelect),i.multiSelect.lead.off("change",this.$checkMultiselectChange),i.multiSelect.anchor.off("change",this.$checkMultiselectChange)),e&&(e.multiSelect.on("addRange",this.$onAddRange),e.multiSelect.on("removeRange",this.$onRemoveRange),e.multiSelect.on("multiSelect",this.$onMultiSelect),e.multiSelect.on("singleSelect",this.$onSingleSelect),e.multiSelect.lead.on("change",this.$checkMultiselectChange),e.multiSelect.anchor.on("change",this.$checkMultiselectChange)),e&&this.inMultiSelectMode!=e.selection.inMultiSelectMode&&(e.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},e.MultiSelect=p,t("./config").defineOptions(u.prototype,"editor",{enableMultiselect:{set:function(t){p(this),t?this.on("mousedown",r):this.off("mousedown",r)},value:!0},enableBlockSelect:{set:function(t){this.$blockSelectEnabled=t},value:!0}})})),ace.define("ace/mode/folding/fold_mode",["require","exports","module","ace/range"],(function(t,e,i){"use strict";var n=t("../../range").Range,s=e.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(t,e,i){var n=t.getLine(i);return this.foldingStartMarker.test(n)?"start":"markbeginend"==e&&this.foldingStopMarker&&this.foldingStopMarker.test(n)?"end":""},this.getFoldWidgetRange=function(t,e,i){return null},this.indentationBlock=function(t,e,i){var s=/\S/,o=t.getLine(e),r=o.search(s);if(-1!=r){for(var a=i||o.length,l=t.getLength(),h=e,c=e;++e<l;){var d=t.getLine(e).search(s);if(-1!=d){if(d<=r){var u=t.getTokenAt(e,0);if(!u||"string"!==u.type)break}c=e}}if(c>h){var p=t.getLine(c).length;return new n(h,a,c,p)}}},this.openingBracketBlock=function(t,e,i,s,o){var r={row:i,column:s+1},a=t.$findClosingBracket(e,r,o);if(a){var l=t.foldWidgets[a.row];return null==l&&(l=t.getFoldWidget(a.row)),"start"==l&&a.row>r.row&&(a.row--,a.column=t.getLine(a.row).length),n.fromPoints(r,a)}},this.closingBracketBlock=function(t,e,i,s,o){var r={row:i,column:s},a=t.$findOpeningBracket(e,r);if(a)return a.column++,r.column--,n.fromPoints(a,r)}}).call(s.prototype)})),ace.define("ace/ext/error_marker",["require","exports","module","ace/line_widgets","ace/lib/dom","ace/range","ace/config"],(function(t,e,i){"use strict";var n=t("../line_widgets").LineWidgets,s=t("../lib/dom"),o=t("../range").Range,r=t("../config").nls;e.showErrorMarker=function(t,e){var i=t.session;i.widgetManager||(i.widgetManager=new n(i),i.widgetManager.attach(t));var a=t.getCursorPosition(),l=a.row,h=i.widgetManager.getWidgetsAtRow(l).filter((function(t){return"errorMarker"==t.type}))[0];h?h.destroy():l-=e;var c,d=function(t,e,i){var n=t.getAnnotations().sort(o.comparePoints);if(n.length){var s=function(t,e,i){for(var n=0,s=t.length-1;n<=s;){var o=n+s>>1,r=i(e,t[o]);if(r>0)n=o+1;else{if(!(r<0))return o;s=o-1}}return-(n+1)}(n,{row:e,column:-1},o.comparePoints);s<0&&(s=-s-1),s>=n.length?s=i>0?0:n.length-1:0===s&&i<0&&(s=n.length-1);var r=n[s];if(r&&i){if(r.row===e){do{r=n[s+=i]}while(r&&r.row===e);if(!r)return n.slice()}var a=[];e=r.row;do{a[i<0?"unshift":"push"](r),r=n[s+=i]}while(r&&r.row==e);return a.length&&a}}}(i,l,e);if(d){var u=d[0];a.column=(u.pos&&"number"!=typeof u.column?u.pos.sc:u.column)||0,a.row=u.row,c=t.renderer.$gutterLayer.$annotations[a.row]}else{if(h)return;c={displayText:[r("error-marker.good-state","Looks good!")],className:"ace_ok"}}t.session.unfold(a.row),t.selection.moveToPosition(a);var p={row:a.row,fixedWidth:!0,coverGutter:!0,el:s.createElement("div"),type:"errorMarker"},g=p.el.appendChild(s.createElement("div")),f=p.el.appendChild(s.createElement("div"));f.className="error_widget_arrow "+c.className;var m=t.renderer.$cursorLayer.getPixelPosition(a).left;f.style.left=m+t.renderer.gutterWidth-5+"px",p.el.className="error_widget_wrapper",g.className="error_widget "+c.className,c.displayText.forEach((function(t,e){g.appendChild(s.createTextNode(t)),e<c.displayText.length-1&&g.appendChild(s.createElement("br"))})),g.appendChild(s.createElement("div"));var v=function(t,e,i){if(0===e&&("esc"===i||"return"===i))return p.destroy(),{command:"null"}};p.destroy=function(){t.$mouseHandler.isMousePressed||(t.keyBinding.removeKeyboardHandler(v),i.widgetManager.removeLineWidget(p),t.off("changeSelection",p.destroy),t.off("changeSession",p.destroy),t.off("mouseup",p.destroy),t.off("change",p.destroy))},t.keyBinding.addKeyboardHandler(v),t.on("changeSelection",p.destroy),t.on("changeSession",p.destroy),t.on("mouseup",p.destroy),t.on("change",p.destroy),t.session.widgetManager.addLineWidget(p),p.el.onmousedown=t.focus.bind(t),t.renderer.scrollCursorIntoView(null,.5,{bottom:p.el.offsetHeight})},s.importCssString("\n    .error_widget_wrapper {\n        background: inherit;\n        color: inherit;\n        border:none\n    }\n    .error_widget {\n        border-top: solid 2px;\n        border-bottom: solid 2px;\n        margin: 5px 0;\n        padding: 10px 40px;\n        white-space: pre-wrap;\n    }\n    .error_widget.ace_error, .error_widget_arrow.ace_error{\n        border-color: #ff5a5a\n    }\n    .error_widget.ace_warning, .error_widget_arrow.ace_warning{\n        border-color: #F1D817\n    }\n    .error_widget.ace_info, .error_widget_arrow.ace_info{\n        border-color: #5a5a5a\n    }\n    .error_widget.ace_ok, .error_widget_arrow.ace_ok{\n        border-color: #5aaa5a\n    }\n    .error_widget_arrow {\n        position: absolute;\n        border: solid 5px;\n        border-top-color: transparent!important;\n        border-right-color: transparent!important;\n        border-left-color: transparent!important;\n        top: -5px;\n    }\n","error_marker.css",!1)})),ace.define("ace/ace",["require","exports","module","ace/lib/dom","ace/range","ace/editor","ace/edit_session","ace/undomanager","ace/virtual_renderer","ace/worker/worker_client","ace/keyboard/hash_handler","ace/placeholder","ace/multi_select","ace/mode/folding/fold_mode","ace/theme/textmate","ace/ext/error_marker","ace/config","ace/loader_build"],(function(t,e,i){"use strict";t("./loader_build")(e);var n=t("./lib/dom"),s=t("./range").Range,o=t("./editor").Editor,r=t("./edit_session").EditSession,a=t("./undomanager").UndoManager,l=t("./virtual_renderer").VirtualRenderer;t("./worker/worker_client"),t("./keyboard/hash_handler"),t("./placeholder"),t("./multi_select"),t("./mode/folding/fold_mode"),t("./theme/textmate"),t("./ext/error_marker"),e.config=t("./config"),e.edit=function(t,i){if("string"==typeof t){var s=t;if(!(t=document.getElementById(s)))throw new Error("ace.edit can't find div #"+s)}if(t&&t.env&&t.env.editor instanceof o)return t.env.editor;var r="";if(t&&/input|textarea/i.test(t.tagName)){var a=t;r=a.value,t=n.createElement("pre"),a.parentNode.replaceChild(t,a)}else t&&(r=t.textContent,t.innerHTML="");var h=e.createEditSession(r),c=new o(new l(t),h,i),d={document:h,editor:c,onResize:c.resize.bind(c,null)};return a&&(d.textarea=a),c.on("destroy",(function(){d.editor.container.env=null})),c.container.env=c.env=d,c},e.createEditSession=function(t,e){var i=new r(t,e);return i.setUndoManager(new a),i},e.Range=s,e.Editor=o,e.EditSession=r,e.UndoManager=a,e.VirtualRenderer=l,e.version=e.config.version})),ace.require(["ace/ace"],(function(e){e&&(e.config.init(!0),e.define=ace.define);var i=function(){return this}();for(var n in i||"undefined"==typeof window||(i=window),i||"undefined"==typeof self||(i=self),i.ace||(i.ace=e),e)e.hasOwnProperty(n)&&(i.ace[n]=e[n]);i.ace.default=i.ace,t&&(t.exports=i.ace)}))},395:(t,e,i)=>{t=i.nmd(t),ace.define("ace/mode/jsdoc_comment_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(t,e,i){"use strict";var n=t("../lib/oop"),s=t("./text_highlight_rules").TextHighlightRules,o=function(){this.$rules={start:[{token:["comment.doc.tag","comment.doc.text","lparen.doc"],regex:"(@(?:param|member|typedef|property|namespace|var|const|callback))(\\s*)({)",push:[{token:"lparen.doc",regex:"{",push:[{include:"doc-syntax"},{token:"rparen.doc",regex:"}|(?=$)",next:"pop"}]},{token:["rparen.doc","text.doc","variable.parameter.doc","lparen.doc","variable.parameter.doc","rparen.doc"],regex:/(})(\s*)(?:([\w=:\/\.]+)|(?:(\[)([\w=:\/\.\-\'\" ]+)(\])))/,next:"pop"},{token:"rparen.doc",regex:"}|(?=$)",next:"pop"},{include:"doc-syntax"},{defaultToken:"text.doc"}]},{token:["comment.doc.tag","text.doc","lparen.doc"],regex:"(@(?:returns?|yields|type|this|suppress|public|protected|private|package|modifies|implements|external|exception|throws|enum|define|extends))(\\s*)({)",push:[{token:"lparen.doc",regex:"{",push:[{include:"doc-syntax"},{token:"rparen.doc",regex:"}|(?=$)",next:"pop"}]},{token:"rparen.doc",regex:"}|(?=$)",next:"pop"},{include:"doc-syntax"},{defaultToken:"text.doc"}]},{token:["comment.doc.tag","text.doc","variable.parameter.doc"],regex:'(@(?:alias|memberof|instance|module|name|lends|namespace|external|this|template|requires|param|implements|function|extends|typedef|mixes|constructor|var|memberof\\!|event|listens|exports|class|constructs|interface|emits|fires|throws|const|callback|borrows|augments))(\\s+)(\\w[\\w#.:/~"\\-]*)?'},{token:["comment.doc.tag","text.doc","variable.parameter.doc"],regex:"(@method)(\\s+)(\\w[\\w.\\(\\)]*)"},{token:"comment.doc.tag",regex:"@access\\s+(?:private|public|protected)"},{token:"comment.doc.tag",regex:"@kind\\s+(?:class|constant|event|external|file|function|member|mixin|module|namespace|typedef)"},{token:"comment.doc.tag",regex:"@\\w+(?=\\s|$)"},o.getTagRule(),{defaultToken:"comment.doc.body",caseInsensitive:!0}],"doc-syntax":[{token:"operator.doc",regex:/[|:]/},{token:"paren.doc",regex:/[\[\]]/}]},this.normalizeRules()};n.inherits(o,s),o.getTagRule=function(t){return{token:"comment.doc.tag.storage.type",regex:"\\b(?:TODO|FIXME|XXX|HACK)\\b"}},o.getStartRule=function(t){return{token:"comment.doc",regex:/\/\*\*(?!\/)/,next:t}},o.getEndRule=function(t){return{token:"comment.doc",regex:"\\*\\/",next:t}},e.JsDocCommentHighlightRules=o})),ace.define("ace/mode/javascript_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/jsdoc_comment_highlight_rules","ace/mode/text_highlight_rules"],(function(t,e,i){"use strict";var n=t("../lib/oop"),s=t("./jsdoc_comment_highlight_rules").JsDocCommentHighlightRules,o=t("./text_highlight_rules").TextHighlightRules,r="[a-zA-Z\\$_¡-￿][a-zA-Z\\d\\$_¡-￿]*",a=function(t){var e={"variable.language":"Array|Boolean|Date|Function|Iterator|Number|Object|RegExp|String|Proxy|Symbol|Namespace|QName|XML|XMLList|ArrayBuffer|Float32Array|Float64Array|Int16Array|Int32Array|Int8Array|Uint16Array|Uint32Array|Uint8Array|Uint8ClampedArray|Error|EvalError|InternalError|RangeError|ReferenceError|StopIteration|SyntaxError|TypeError|URIError|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|eval|isFinite|isNaN|parseFloat|parseInt|JSON|Math|this|arguments|prototype|window|document",keyword:"const|yield|import|get|set|async|await|break|case|catch|continue|default|delete|do|else|finally|for|if|in|of|instanceof|new|return|switch|throw|try|typeof|let|var|while|with|debugger|__parent__|__count__|escape|unescape|with|__proto__|class|enum|extends|super|export|implements|private|public|interface|package|protected|static|constructor","storage.type":"const|let|var|function","constant.language":"null|Infinity|NaN|undefined","support.function":"alert","constant.language.boolean":"true|false"},i=this.createKeywordMapper(e,"identifier"),n="\\\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|u{[0-9a-fA-F]{1,6}}|[0-2][0-7]{0,2}|3[0-7][0-7]?|[4-7][0-7]?|.)",o="(function)(\\s*)(\\*?)",a={token:["identifier","text","paren.lparen"],regex:"(\\b(?!"+Object.values(e).join("|")+"\\b)"+r+")(\\s*)(\\()"};this.$rules={no_regex:[s.getStartRule("doc-start"),h("no_regex"),a,{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"},{token:"constant.numeric",regex:/0(?:[xX][0-9a-fA-F]+|[oO][0-7]+|[bB][01]+)\b/},{token:"constant.numeric",regex:/(?:\d\d*(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+\b)?/},{token:["entity.name.function","text","keyword.operator","text","storage.type","text","storage.type","text","paren.lparen"],regex:"("+r+")(\\s*)(=)(\\s*)"+o+"(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","text","storage.type","text","text","entity.name.function","text","paren.lparen"],regex:"(function)(?:(?:(\\s*)(\\*)(\\s*))|(\\s+))("+r+")(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","punctuation.operator","text","storage.type","text","storage.type","text","paren.lparen"],regex:"("+r+")(\\s*)(:)(\\s*)"+o+"(\\s*)(\\()",next:"function_arguments"},{token:["text","text","storage.type","text","storage.type","text","paren.lparen"],regex:"(:)(\\s*)"+o+"(\\s*)(\\()",next:"function_arguments"},{token:"keyword",regex:"from(?=\\s*('|\"))"},{token:"keyword",regex:"(?:case|do|else|finally|in|instanceof|return|throw|try|typeof|yield|void)\\b",next:"start"},{token:"support.constant",regex:/that\b/},{token:["storage.type","punctuation.operator","support.function.firebug"],regex:/(console)(\.)(warn|info|log|error|debug|time|trace|timeEnd|assert)\b/},{token:i,regex:r},{token:"punctuation.operator",regex:/[.](?![.])/,next:"property"},{token:"storage.type",regex:/=>/,next:"start"},{token:"keyword.operator",regex:/--|\+\+|\.{3}|===|==|=|!=|!==|<+=?|>+=?|!|&&|\|\||\?:|[!$%&*+\-~\/^]=?/,next:"start"},{token:"punctuation.operator",regex:/[?:,;.]/,next:"start"},{token:"paren.lparen",regex:/[\[({]/,next:"start"},{token:"paren.rparen",regex:/[\])}]/},{token:"comment",regex:/^#!.*$/}],property:[{token:"text",regex:"\\s+"},{token:"keyword.operator",regex:/=/},{token:["storage.type","text","storage.type","text","paren.lparen"],regex:o+"(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","text","storage.type","text","text","entity.name.function","text","paren.lparen"],regex:"(function)(?:(?:(\\s*)(\\*)(\\s*))|(\\s+))(\\w+)(\\s*)(\\()",next:"function_arguments"},{token:"punctuation.operator",regex:/[.](?![.])/},{token:"support.function",regex:"prototype"},{token:"support.function",regex:/(s(?:h(?:ift|ow(?:Mod(?:elessDialog|alDialog)|Help))|croll(?:X|By(?:Pages|Lines)?|Y|To)?|t(?:op|rike)|i(?:n|zeToContent|debar|gnText)|ort|u(?:p|b(?:str(?:ing)?)?)|pli(?:ce|t)|e(?:nd|t(?:Re(?:sizable|questHeader)|M(?:i(?:nutes|lliseconds)|onth)|Seconds|Ho(?:tKeys|urs)|Year|Cursor|Time(?:out)?|Interval|ZOptions|Date|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Date|FullYear)|FullYear|Active)|arch)|qrt|lice|avePreferences|mall)|h(?:ome|andleEvent)|navigate|c(?:har(?:CodeAt|At)|o(?:s|n(?:cat|textual|firm)|mpile)|eil|lear(?:Timeout|Interval)?|a(?:ptureEvents|ll)|reate(?:StyleSheet|Popup|EventObject))|t(?:o(?:GMTString|S(?:tring|ource)|U(?:TCString|pperCase)|Lo(?:caleString|werCase))|est|a(?:n|int(?:Enabled)?))|i(?:s(?:NaN|Finite)|ndexOf|talics)|d(?:isableExternalCapture|ump|etachEvent)|u(?:n(?:shift|taint|escape|watch)|pdateCommands)|j(?:oin|avaEnabled)|p(?:o(?:p|w)|ush|lugins.refresh|a(?:ddings|rse(?:Int|Float)?)|r(?:int|ompt|eference))|e(?:scape|nableExternalCapture|val|lementFromPoint|x(?:p|ec(?:Script|Command)?))|valueOf|UTC|queryCommand(?:State|Indeterm|Enabled|Value)|f(?:i(?:nd|lter|le(?:ModifiedDate|Size|CreatedDate|UpdatedDate)|xed)|o(?:nt(?:size|color)|rward|rEach)|loor|romCharCode)|watch|l(?:ink|o(?:ad|g)|astIndexOf)|a(?:sin|nchor|cos|t(?:tachEvent|ob|an(?:2)?)|pply|lert|b(?:s|ort))|r(?:ou(?:nd|teEvents)|e(?:size(?:By|To)|calc|turnValue|place|verse|l(?:oad|ease(?:Capture|Events)))|andom)|g(?:o|et(?:ResponseHeader|M(?:i(?:nutes|lliseconds)|onth)|Se(?:conds|lection)|Hours|Year|Time(?:zoneOffset)?|Da(?:y|te)|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Da(?:y|te)|FullYear)|FullYear|A(?:ttention|llResponseHeaders)))|m(?:in|ove(?:B(?:y|elow)|To(?:Absolute)?|Above)|ergeAttributes|a(?:tch|rgins|x))|b(?:toa|ig|o(?:ld|rderWidths)|link|ack))\b(?=\()/},{token:"support.function.dom",regex:/(s(?:ub(?:stringData|mit)|plitText|e(?:t(?:NamedItem|Attribute(?:Node)?)|lect))|has(?:ChildNodes|Feature)|namedItem|c(?:l(?:ick|o(?:se|neNode))|reate(?:C(?:omment|DATASection|aption)|T(?:Head|extNode|Foot)|DocumentFragment|ProcessingInstruction|E(?:ntityReference|lement)|Attribute))|tabIndex|i(?:nsert(?:Row|Before|Cell|Data)|tem)|open|delete(?:Row|C(?:ell|aption)|T(?:Head|Foot)|Data)|focus|write(?:ln)?|a(?:dd|ppend(?:Child|Data))|re(?:set|place(?:Child|Data)|move(?:NamedItem|Child|Attribute(?:Node)?)?)|get(?:NamedItem|Element(?:sBy(?:Name|TagName|ClassName)|ById)|Attribute(?:Node)?)|blur)\b(?=\()/},{token:"support.constant",regex:/(s(?:ystemLanguage|cr(?:ipts|ollbars|een(?:X|Y|Top|Left))|t(?:yle(?:Sheets)?|atus(?:Text|bar)?)|ibling(?:Below|Above)|ource|uffixes|e(?:curity(?:Policy)?|l(?:ection|f)))|h(?:istory|ost(?:name)?|as(?:h|Focus))|y|X(?:MLDocument|SLDocument)|n(?:ext|ame(?:space(?:s|URI)|Prop))|M(?:IN_VALUE|AX_VALUE)|c(?:haracterSet|o(?:n(?:structor|trollers)|okieEnabled|lorDepth|mp(?:onents|lete))|urrent|puClass|l(?:i(?:p(?:boardData)?|entInformation)|osed|asses)|alle(?:e|r)|rypto)|t(?:o(?:olbar|p)|ext(?:Transform|Indent|Decoration|Align)|ags)|SQRT(?:1_2|2)|i(?:n(?:ner(?:Height|Width)|put)|ds|gnoreCase)|zIndex|o(?:scpu|n(?:readystatechange|Line)|uter(?:Height|Width)|p(?:sProfile|ener)|ffscreenBuffering)|NEGATIVE_INFINITY|d(?:i(?:splay|alog(?:Height|Top|Width|Left|Arguments)|rectories)|e(?:scription|fault(?:Status|Ch(?:ecked|arset)|View)))|u(?:ser(?:Profile|Language|Agent)|n(?:iqueID|defined)|pdateInterval)|_content|p(?:ixelDepth|ort|ersonalbar|kcs11|l(?:ugins|atform)|a(?:thname|dding(?:Right|Bottom|Top|Left)|rent(?:Window|Layer)?|ge(?:X(?:Offset)?|Y(?:Offset)?))|r(?:o(?:to(?:col|type)|duct(?:Sub)?|mpter)|e(?:vious|fix)))|e(?:n(?:coding|abledPlugin)|x(?:ternal|pando)|mbeds)|v(?:isibility|endor(?:Sub)?|Linkcolor)|URLUnencoded|P(?:I|OSITIVE_INFINITY)|f(?:ilename|o(?:nt(?:Size|Family|Weight)|rmName)|rame(?:s|Element)|gColor)|E|whiteSpace|l(?:i(?:stStyleType|n(?:eHeight|kColor))|o(?:ca(?:tion(?:bar)?|lName)|wsrc)|e(?:ngth|ft(?:Context)?)|a(?:st(?:M(?:odified|atch)|Index|Paren)|yer(?:s|X)|nguage))|a(?:pp(?:MinorVersion|Name|Co(?:deName|re)|Version)|vail(?:Height|Top|Width|Left)|ll|r(?:ity|guments)|Linkcolor|bove)|r(?:ight(?:Context)?|e(?:sponse(?:XML|Text)|adyState))|global|x|m(?:imeTypes|ultiline|enubar|argin(?:Right|Bottom|Top|Left))|L(?:N(?:10|2)|OG(?:10E|2E))|b(?:o(?:ttom|rder(?:Width|RightWidth|BottomWidth|Style|Color|TopWidth|LeftWidth))|ufferDepth|elow|ackground(?:Color|Image)))\b/},{token:"identifier",regex:r},{regex:"",token:"empty",next:"no_regex"}],start:[s.getStartRule("doc-start"),h("start"),{token:"string.regexp",regex:"\\/",next:"regex"},{token:"text",regex:"\\s+|^$",next:"start"},{token:"empty",regex:"",next:"no_regex"}],regex:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"string.regexp",regex:"/[sxngimy]*",next:"no_regex"},{token:"invalid",regex:/\{\d+\b,?\d*\}[+*]|[+*$^?][+*]|[$^][?]|\?{3,}/},{token:"constant.language.escape",regex:/\(\?[:=!]|\)|\{\d+\b,?\d*\}|[+*]\?|[()$^+*?.]/},{token:"constant.language.delimiter",regex:/\|/},{token:"constant.language.escape",regex:/\[\^?/,next:"regex_character_class"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp"}],regex_character_class:[{token:"regexp.charclass.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"constant.language.escape",regex:"]",next:"regex"},{token:"constant.language.escape",regex:"-"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp.charachterclass"}],default_parameter:[{token:"string",regex:"'(?=.)",push:[{token:"string",regex:"'|$",next:"pop"},{include:"qstring"}]},{token:"string",regex:'"(?=.)',push:[{token:"string",regex:'"|$',next:"pop"},{include:"qqstring"}]},{token:"constant.language",regex:"null|Infinity|NaN|undefined"},{token:"constant.numeric",regex:/0(?:[xX][0-9a-fA-F]+|[oO][0-7]+|[bB][01]+)\b/},{token:"constant.numeric",regex:/(?:\d\d*(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+\b)?/},{token:"punctuation.operator",regex:",",next:"function_arguments"},{token:"text",regex:"\\s+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],function_arguments:[h("function_arguments"),{token:"variable.parameter",regex:r},{token:"punctuation.operator",regex:","},{token:"text",regex:"\\s+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],qqstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",consumeLineEnd:!0},{token:"string",regex:'"|$',next:"no_regex"},{defaultToken:"string"}],qstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",consumeLineEnd:!0},{token:"string",regex:"'|$",next:"no_regex"},{defaultToken:"string"}]},t&&t.noES6||(this.$rules.no_regex.unshift({regex:"[{}]",onMatch:function(t,e,i){if(this.next="{"==t?this.nextState:"","{"==t&&i.length)i.unshift("start",e);else if("}"==t&&i.length&&(i.shift(),this.next=i.shift(),-1!=this.next.indexOf("string")||-1!=this.next.indexOf("jsx")))return"paren.quasi.end";return"{"==t?"paren.lparen":"paren.rparen"},nextState:"start"},{token:"string.quasi.start",regex:/`/,push:[{token:"constant.language.escape",regex:n},{token:"paren.quasi.start",regex:/\${/,push:"start"},{token:"string.quasi.end",regex:/`/,next:"pop"},{defaultToken:"string.quasi"}]},{token:["variable.parameter","text"],regex:"("+r+")(\\s*)(?=\\=>)"},{token:"paren.lparen",regex:"(\\()(?=[^\\(]+\\s*=>)",next:"function_arguments"},{token:"variable.language",regex:"(?:(?:(?:Weak)?(?:Set|Map))|Promise)\\b"}),this.$rules.function_arguments.unshift({token:"keyword.operator",regex:"=",next:"default_parameter"},{token:"keyword.operator",regex:"\\.{3}"}),this.$rules.property.unshift({token:"support.function",regex:"(findIndex|repeat|startsWith|endsWith|includes|isSafeInteger|trunc|cbrt|log2|log10|sign|then|catch|finally|resolve|reject|race|any|all|allSettled|keys|entries|isInteger)\\b(?=\\()"},{token:"constant.language",regex:"(?:MAX_SAFE_INTEGER|MIN_SAFE_INTEGER|EPSILON)\\b"}),t&&0==t.jsx||l.call(this)),this.embedRules(s,"doc-",[s.getEndRule("no_regex")]),this.normalizeRules()};function l(){var t=r.replace("\\d","\\d\\-"),e={onMatch:function(t,e,i){var n="/"==t.charAt(1)?2:1;return 1==n?(e!=this.nextState?i.unshift(this.next,this.nextState,0):i.unshift(this.next),i[2]++):2==n&&e==this.nextState&&(i[1]--,(!i[1]||i[1]<0)&&(i.shift(),i.shift())),[{type:"meta.tag.punctuation."+(1==n?"":"end-")+"tag-open.xml",value:t.slice(0,n)},{type:"meta.tag.tag-name.xml",value:t.substr(n)}]},regex:"</?(?:"+t+"|(?=>))",next:"jsxAttributes",nextState:"jsx"};this.$rules.start.unshift(e);var i={regex:"{",token:"paren.quasi.start",push:"start"};this.$rules.jsx=[i,e,{include:"reference"},{defaultToken:"string.xml"}],this.$rules.jsxAttributes=[{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",onMatch:function(t,e,i){return e==i[0]&&i.shift(),2==t.length&&(i[0]==this.nextState&&i[1]--,(!i[1]||i[1]<0)&&i.splice(0,2)),this.next=i[0]||"start",[{type:this.token,value:t}]},nextState:"jsx"},i,h("jsxAttributes"),{token:"entity.other.attribute-name.xml",regex:t},{token:"keyword.operator.attribute-equals.xml",regex:"="},{token:"text.tag-whitespace.xml",regex:"\\s+"},{token:"string.attribute-value.xml",regex:"'",stateName:"jsx_attr_q",push:[{token:"string.attribute-value.xml",regex:"'",next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},{token:"string.attribute-value.xml",regex:'"',stateName:"jsx_attr_qq",push:[{token:"string.attribute-value.xml",regex:'"',next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},e],this.$rules.reference=[{token:"constant.language.escape.reference.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}]}function h(t){return[{token:"comment",regex:/\/\*/,next:[s.getTagRule(),{token:"comment",regex:"\\*\\/",next:t||"pop"},{defaultToken:"comment",caseInsensitive:!0}]},{token:"comment",regex:"\\/\\/",next:[s.getTagRule(),{token:"comment",regex:"$|^",next:t||"pop"},{defaultToken:"comment",caseInsensitive:!0}]}]}n.inherits(a,o),e.JavaScriptHighlightRules=a})),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(t,e,i){"use strict";var n=t("../range").Range,s=function(){};(function(){this.checkOutdent=function(t,e){return!!/^\s+$/.test(t)&&/^\s*\}/.test(e)},this.autoOutdent=function(t,e){var i=t.getLine(e).match(/^(\s*\})/);if(!i)return 0;var s=i[1].length,o=t.findMatchingBracket({row:e,column:s});if(!o||o.row==e)return 0;var r=this.$getIndent(t.getLine(o.row));t.replace(new n(e,0,e,s-1),r)},this.$getIndent=function(t){return t.match(/^\s*/)[0]}}).call(s.prototype),e.MatchingBraceOutdent=s})),ace.define("ace/mode/behaviour/xml",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator"],(function(t,e,i){"use strict";var n=t("../../lib/oop"),s=t("../behaviour").Behaviour,o=t("../../token_iterator").TokenIterator;function r(t,e){return t&&t.type.lastIndexOf(e+".xml")>-1}var a=function(){this.add("string_dquotes","insertion",(function(t,e,i,n,s){if('"'==s||"'"==s){var a=s,l=n.doc.getTextRange(i.getSelectionRange());if(""!==l&&"'"!==l&&'"'!=l&&i.getWrapBehavioursEnabled())return{text:a+l+a,selection:!1};var h=i.getCursorPosition(),c=n.doc.getLine(h.row).substring(h.column,h.column+1),d=new o(n,h.row,h.column),u=d.getCurrentToken();if(c==a&&(r(u,"attribute-value")||r(u,"string")))return{text:"",selection:[1,1]};if(u||(u=d.stepBackward()),!u)return;for(;r(u,"tag-whitespace")||r(u,"whitespace");)u=d.stepBackward();var p=!c||c.match(/\s/);if(r(u,"attribute-equals")&&(p||">"==c)||r(u,"decl-attribute-equals")&&(p||"?"==c))return{text:a+a,selection:[1,1]}}})),this.add("string_dquotes","deletion",(function(t,e,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&('"'==o||"'"==o)&&n.doc.getLine(s.start.row).substring(s.start.column+1,s.start.column+2)==o)return s.end.column++,s})),this.add("autoclosing","insertion",(function(t,e,i,n,s){if(">"==s){var a=i.getSelectionRange().start,l=new o(n,a.row,a.column),h=l.getCurrentToken()||l.stepBackward();if(!h||!(r(h,"tag-name")||r(h,"tag-whitespace")||r(h,"attribute-name")||r(h,"attribute-equals")||r(h,"attribute-value")))return;if(r(h,"reference.attribute-value"))return;if(r(h,"attribute-value")){var c=l.getCurrentTokenColumn()+h.value.length;if(a.column<c)return;if(a.column==c){var d=l.stepForward();if(d&&r(d,"attribute-value"))return;l.stepBackward()}}if(/^\s*>/.test(n.getLine(a.row).slice(a.column)))return;for(;!r(h,"tag-name");)if("<"==(h=l.stepBackward()).value){h=l.stepForward();break}var u=l.getCurrentTokenRow(),p=l.getCurrentTokenColumn();if(r(l.stepBackward(),"end-tag-open"))return;var g=h.value;if(u==a.row&&(g=g.substring(0,a.column-p)),this.voidElements&&this.voidElements.hasOwnProperty(g.toLowerCase()))return;return{text:"></"+g+">",selection:[1,1]}}})),this.add("autoindent","insertion",(function(t,e,i,n,s){if("\n"==s){var a=i.getCursorPosition(),l=n.getLine(a.row),h=new o(n,a.row,a.column),c=h.getCurrentToken();if(r(c,"")&&-1!==c.type.indexOf("tag-close")){if("/>"==c.value)return;for(;c&&-1===c.type.indexOf("tag-name");)c=h.stepBackward();if(!c)return;var d=c.value,u=h.getCurrentTokenRow();if(!(c=h.stepBackward())||-1!==c.type.indexOf("end-tag"))return;if(this.voidElements&&!this.voidElements[d]||!this.voidElements){var p=n.getTokenAt(a.row,a.column+1),g=(l=n.getLine(u),this.$getIndent(l)),f=g+n.getTabString();return p&&"</"===p.value?{text:"\n"+f+"\n"+g,selection:[1,f.length,1,f.length]}:{text:"\n"+f}}}}}))};n.inherits(a,s),e.XmlBehaviour=a})),ace.define("ace/mode/behaviour/javascript",["require","exports","module","ace/lib/oop","ace/token_iterator","ace/mode/behaviour/cstyle","ace/mode/behaviour/xml"],(function(t,e,i){"use strict";var n=t("../../lib/oop"),s=t("../../token_iterator").TokenIterator,o=t("../behaviour/cstyle").CstyleBehaviour,r=t("../behaviour/xml").XmlBehaviour,a=function(){var t=new r({closeCurlyBraces:!0}).getBehaviours();this.addBehaviours(t),this.inherit(o),this.add("autoclosing-fragment","insertion",(function(t,e,i,n,o){if(">"==o){var r=i.getSelectionRange().start,a=new s(n,r.row,r.column),l=a.getCurrentToken()||a.stepBackward();if(!l)return;if("<"==l.value)return{text:"></>",selection:[1,1]}}}))};n.inherits(a,o),e.JavaScriptBehaviour=a})),ace.define("ace/mode/folding/xml",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(t,e,i){"use strict";var n=t("../../lib/oop"),s=t("../../range").Range,o=t("./fold_mode").FoldMode,r=e.FoldMode=function(t,e){o.call(this),this.voidElements=t||{},this.optionalEndTags=n.mixin({},this.voidElements),e&&n.mixin(this.optionalEndTags,e)};n.inherits(r,o);var a=function(){this.tagName="",this.closing=!1,this.selfClosing=!1,this.start={row:0,column:0},this.end={row:0,column:0}};function l(t,e){return t.type.lastIndexOf(e+".xml")>-1}(function(){this.getFoldWidget=function(t,e,i){var n=this._getFirstTagInLine(t,i);return n?n.closing||!n.tagName&&n.selfClosing?"markbeginend"===e?"end":"":!n.tagName||n.selfClosing||this.voidElements.hasOwnProperty(n.tagName.toLowerCase())||this._findEndTagInLine(t,i,n.tagName,n.end.column)?"":"start":this.getCommentFoldWidget(t,i)},this.getCommentFoldWidget=function(t,e){return/comment/.test(t.getState(e))&&/<!-/.test(t.getLine(e))?"start":""},this._getFirstTagInLine=function(t,e){for(var i=t.getTokens(e),n=new a,s=0;s<i.length;s++){var o=i[s];if(l(o,"tag-open")){if(n.end.column=n.start.column+o.value.length,n.closing=l(o,"end-tag-open"),!(o=i[++s]))return null;if(n.tagName=o.value,""===o.value){if(!(o=i[++s]))return null;n.tagName=o.value}for(n.end.column+=o.value.length,s++;s<i.length;s++)if(o=i[s],n.end.column+=o.value.length,l(o,"tag-close")){n.selfClosing="/>"==o.value;break}return n}if(l(o,"tag-close"))return n.selfClosing="/>"==o.value,n;n.start.column+=o.value.length}return null},this._findEndTagInLine=function(t,e,i,n){for(var s=t.getTokens(e),o=0,r=0;r<s.length;r++){var a=s[r];if(!((o+=a.value.length)<n-1)&&l(a,"end-tag-open")&&(l(a=s[r+1],"tag-name")&&""===a.value&&(a=s[r+2]),a&&a.value==i))return!0}return!1},this.getFoldWidgetRange=function(t,e,i){if(!this._getFirstTagInLine(t,i))return this.getCommentFoldWidget(t,i)&&t.getCommentFoldRange(i,t.getLine(i).length);var n=t.getMatchingTags({row:i,column:0});return n?new s(n.openTag.end.row,n.openTag.end.column,n.closeTag.start.row,n.closeTag.start.column):void 0}}).call(r.prototype)})),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(t,e,i){"use strict";var n=t("../../lib/oop"),s=t("../../range").Range,o=t("./fold_mode").FoldMode,r=e.FoldMode=function(t){t&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+t.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+t.end)))};n.inherits(r,o),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(t,e,i){var n=t.getLine(i);if(this.singleLineBlockCommentRe.test(n)&&!this.startRegionRe.test(n)&&!this.tripleStarBlockCommentRe.test(n))return"";var s=this._getFoldWidgetBase(t,e,i);return!s&&this.startRegionRe.test(n)?"start":s},this.getFoldWidgetRange=function(t,e,i,n){var s,o=t.getLine(i);if(this.startRegionRe.test(o))return this.getCommentRegionBlock(t,o,i);if(s=o.match(this.foldingStartMarker)){var r=s.index;if(s[1])return this.openingBracketBlock(t,s[1],i,r);var a=t.getCommentFoldRange(i,r+s[0].length,1);return a&&!a.isMultiLine()&&(n?a=this.getSectionRange(t,i):"all"!=e&&(a=null)),a}return"markbegin"!==e&&(s=o.match(this.foldingStopMarker))?(r=s.index+s[0].length,s[1]?this.closingBracketBlock(t,s[1],i,r):t.getCommentFoldRange(i,r,-1)):void 0},this.getSectionRange=function(t,e){for(var i=t.getLine(e),n=i.search(/\S/),o=e,r=i.length,a=e+=1,l=t.getLength();++e<l;){var h=(i=t.getLine(e)).search(/\S/);if(-1!==h){if(n>h)break;var c=this.getFoldWidgetRange(t,"all",e);if(c){if(c.start.row<=o)break;if(c.isMultiLine())e=c.end.row;else if(n==h)break}a=e}}return new s(o,r,a,t.getLine(a).length)},this.getCommentRegionBlock=function(t,e,i){for(var n=e.search(/\s*$/),o=t.getLength(),r=i,a=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,l=1;++i<o;){e=t.getLine(i);var h=a.exec(e);if(h&&(h[1]?l--:l++,!l))break}if(i>r)return new s(r,n,i,e.length)}}.call(r.prototype)})),ace.define("ace/mode/folding/javascript",["require","exports","module","ace/lib/oop","ace/mode/folding/xml","ace/mode/folding/cstyle"],(function(t,e,i){"use strict";var n=t("../../lib/oop"),s=t("./xml").FoldMode,o=t("./cstyle").FoldMode,r=e.FoldMode=function(t){t&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+t.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+t.end))),this.xmlFoldMode=new s};n.inherits(r,o),function(){this.getFoldWidgetRangeBase=this.getFoldWidgetRange,this.getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(t,e,i){return this.getFoldWidgetBase(t,e,i)||this.xmlFoldMode.getFoldWidget(t,e,i)},this.getFoldWidgetRange=function(t,e,i,n){return this.getFoldWidgetRangeBase(t,e,i,n)||this.xmlFoldMode.getFoldWidgetRange(t,e,i)}}.call(r.prototype)})),ace.define("ace/mode/javascript",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/javascript_highlight_rules","ace/mode/matching_brace_outdent","ace/worker/worker_client","ace/mode/behaviour/javascript","ace/mode/folding/javascript"],(function(t,e,i){"use strict";var n=t("../lib/oop"),s=t("./text").Mode,o=t("./javascript_highlight_rules").JavaScriptHighlightRules,r=t("./matching_brace_outdent").MatchingBraceOutdent,a=t("../worker/worker_client").WorkerClient,l=t("./behaviour/javascript").JavaScriptBehaviour,h=t("./folding/javascript").FoldMode,c=function(){this.HighlightRules=o,this.$outdent=new r,this.$behaviour=new l,this.foldingRules=new h};n.inherits(c,s),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.$quotes={'"':'"',"'":"'","`":"`"},this.$pairQuotesAfter={"`":/\w/},this.getNextLineIndent=function(t,e,i){var n=this.$getIndent(e),s=this.getTokenizer().getLineTokens(e,t),o=s.tokens,r=s.state;if(o.length&&"comment"==o[o.length-1].type)return n;if("start"==t||"no_regex"==t)e.match(/^.*(?:\bcase\b.*:|[\{\(\[])\s*$/)&&(n+=i);else if("doc-start"==t&&("start"==r||"no_regex"==r))return"";return n},this.checkOutdent=function(t,e,i){return this.$outdent.checkOutdent(e,i)},this.autoOutdent=function(t,e,i){this.$outdent.autoOutdent(e,i)},this.createWorker=function(t){var e=new a(["ace"],"ace/mode/javascript_worker","JavaScriptWorker");return e.attachToDocument(t.getDocument()),e.on("annotate",(function(e){t.setAnnotations(e.data)})),e.on("terminate",(function(){t.clearAnnotations()})),e},this.$id="ace/mode/javascript",this.snippetFileId="ace/snippets/javascript"}.call(c.prototype),e.Mode=c})),ace.require(["ace/mode/javascript"],(function(e){t&&(t.exports=e)}))},658:(t,e,i)=>{t=i.nmd(t),ace.define("ace/theme/github_dark-css",["require","exports","module"],(function(t,e,i){i.exports=".ace-github-dark .ace_gutter {\n  background: #24292e;\n  color: #7388b5\n}\n\n.ace-github-dark .ace_print-margin {\n  width: 1px;\n  background: #00204b\n}\n\n.ace-github-dark {\n  background-color: #24292e;\n  color: #FFFFFF\n}\n\n.ace-github-dark .ace_constant.ace_other,\n.ace-github-dark .ace_cursor {\n  color: #FFFFFF\n}\n\n.ace-github-dark .ace_marker-layer .ace_selection {\n  background: #003F8E\n}\n\n.ace-github-dark.ace_multiselect .ace_selection.ace_start {\n  box-shadow: 0 0 3px 0px #24292e;\n}\n\n.ace-github-dark .ace_marker-layer .ace_step {\n  background: rgb(127, 111, 19)\n}\n\n.ace-github-dark .ace_marker-layer .ace_bracket {\n  margin: -1px 0 0 -1px;\n  border: 1px solid #404F7D\n}\n\n.ace-github-dark .ace_marker-layer .ace_active-line {\n  background: #00346E\n}\n\n.ace-github-dark .ace_gutter-active-line {\n  background-color: #24292e\n}\n\n.ace-github-dark .ace_marker-layer .ace_selected-word {\n  border: 1px solid #003F8E\n}\n\n.ace-github-dark .ace_invisible {\n  color: #404F7D\n}\n\n.ace-github-dark .ace_keyword,\n.ace-github-dark .ace_meta,\n.ace-github-dark .ace_storage,\n.ace-github-dark .ace_storage.ace_type,\n.ace-github-dark .ace_support.ace_type {\n  color: #ff7b72\n}\n\n.ace-github-dark .ace_keyword.ace_operator {\n  color: #79c0ff\n}\n\n.ace-github-dark .ace_constant.ace_character,\n.ace-github-dark .ace_constant.ace_language,\n.ace-github-dark .ace_constant.ace_numeric,\n.ace-github-dark .ace_keyword.ace_other.ace_unit,\n.ace-github-dark .ace_support.ace_constant,\n.ace-github-dark .ace_variable.ace_parameter {\n  color: #FFC58F\n}\n\n.ace-github-dark .ace_invalid {\n  color: #FFFFFF;\n  background-color: #F99DA5\n}\n\n.ace-github-dark .ace_invalid.ace_deprecated {\n  color: #FFFFFF;\n  background-color: #ff7b72\n}\n\n.ace-github-dark .ace_fold {\n  background-color: #BBDAFF;\n  border-color: #FFFFFF\n}\n\n.ace-github-dark .ace_entity.ace_name.ace_function,\n.ace-github-dark .ace_support.ace_function,\n.ace-github-dark .ace_variable {\n  color: #BBDAFF\n}\n\n.ace-github-dark .ace_support.ace_class,\n.ace-github-dark .ace_support.ace_type {\n  color: #FFEEAD\n}\n\n.ace-github-dark .ace_heading,\n.ace-github-dark .ace_markup.ace_heading,\n.ace-github-dark .ace_string {\n  color: #9fcef6\n}\n\n.ace-github-dark .ace_entity.ace_name.ace_tag,\n.ace-github-dark .ace_entity.ace_other.ace_attribute-name,\n.ace-github-dark .ace_meta.ace_tag,\n.ace-github-dark .ace_string.ace_regexp,\n.ace-github-dark .ace_variable {\n  color: #FF9DA4\n}\n\n.ace-github-dark .ace_comment {\n  color: #7285B7\n}\n\n.ace-github-dark .ace_indent-guide {\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWNgYGBgYJDzqfwPAANXAeNsiA+ZAAAAAElFTkSuQmCC) right repeat-y\n}\n\n.ace-github-dark .ace_indent-guide-active {\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQIW2PQ1dX9zzBz5sz/ABCcBFFentLlAAAAAElFTkSuQmCC) right repeat-y;\n}\n\n.ace-github-dark .ace_constant.ace_buildin {\n  color: #0086B3;\n}\n\n.ace-github-dark .ace_variable.ace_language {\n  color: #ffffff;\n}\n  "})),ace.define("ace/theme/github_dark",["require","exports","module","ace/theme/github_dark-css","ace/lib/dom"],(function(t,e,i){e.isDark=!0,e.cssClass="ace-github-dark",e.cssText=t("./github_dark-css"),t("../lib/dom").importCssString(e.cssText,e.cssClass,!1)})),ace.require(["ace/theme/github_dark"],(function(e){t&&(t.exports=e)}))},424:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(537),s=i.n(n),o=i(645),r=i.n(o)()(s());r.push([t.id,"#sandbox-editor {\n  position: absolute;\n  bottom: 10px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: calc(100% - 20px);\n  /* Adjust width to leave space on both sides */\n  max-width: 100%;\n  /* Ensure it doesn't exceed the container width */\n}\n\n#editor {\n  width: 100%;\n  height: 150px;\n  margin-bottom: 10px;\n  font-size: 14px;\n  display: flex;\n  flex-direction: column;\n}\n\n#output {\n  width: 100%;\n  height: 150px;\n  font-size: 14px;\n  /* Add space below the terminal */\n  display: flex;\n  flex-direction: column;\n  background-color: #1d1a1a;\n  color: #fff3f3;\n}\n\n#sandbox-pause,\n#sandbox-deploy,\n#sandbox-collapse,\n#sandbox-fullscreen {\n  background-color: #ffcc00;\n  color: #000000;\n  border: 3px solid #ff6600;\n  /* Adjust border color for pause */\n  border-radius: 0;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 14px;\n  text-shadow: 1px 1px #ff6600;\n  transition: transform 0.1s;\n}\n\n.flex {\n  display: flex;\n}\n\n.flex-col {\n  flex-direction: column;\n}\n\n.flex-row {\n  flex-direction: row;\n}\n\n.gap-4 {\n  gap: 16px;\n}\n\n.justify-stretch {\n  justify-content: stretch;\n}\n\n.w-full {\n  width: 100%;\n}\n\n.w-60 {\n  width: 60%;\n}\n\n#rootDiv:has(#main-menu) {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n}\n\n#main-menu {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  width: 60%;\n}\n\n#h1-SS {\n  font-size: 100px;\n  font-family: 'Press Start 2P', cursive;\n  color: #6e1ca5;\n  text-shadow: 1px 1px #000000;\n  margin: 0;\n}\n\n.button {\n  border-radius: 0;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 32px;\n  transition: transform 0.1s;\n}\n\n.button:hover {\n  transform: scale(0.95);\n}\n\n.button.blue {\n  background-color: #4469e0;\n  color: #000000;\n  border: 3px solid #7279b8;\n}\n\n.button.blue:hover {\n  background-color: #7279b8;\n}\n\n.button.yellow {\n  background-color: #ffcc00;\n  color: #000000;\n  border: 3px solid #ff6600;\n  text-shadow: 1px 1px #ff6600;\n}\n\n.button.yellow:hover {\n  transform: scale(0.95);\n  background-color: #ff6600;\n}\n\n#sandbox-button,\n#level-select {\n  border-radius: 0;\n  width: 60%;\n}\n\n#go-fullscreen {\n  width: calc(50% - 16px);\n}\n\n#level-one {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  background-color: #4469e0;\n  color: #000000;\n  border: 3px solid #7279b8;\n  border-radius: 0;\n  width: 100%;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 48px;\n  text-shadow: 1px 1px #4c59d1;\n  transition: transform 0.1s;\n}\n\n#level-one:hover {\n  transform: scale(0.95);\n  background-color: #7279b8;\n}\n\n#level-two {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  background-color: #4469e0;\n  color: #000000;\n  border: 3px solid #7279b8;\n  border-radius: 0;\n  width: 100%;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 48px;\n  text-shadow: 1px 1px #4c59d1;\n  transition: transform 0.1s;\n}\n\n#level-two:hover {\n  transform: scale(0.95);\n  background-color: #7279b8;\n}\n\n#sandbox-back {\n  background-color: #ce3434;\n  color: #000000;\n  border: 3px solid #9c0000;\n  /* Adjust border color for pause */\n  border-radius: 0;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 14px;\n  text-shadow: 1px 1px #000000;\n  transition: transform 0.1s;\n}\n\n#switch {\n  background-color: #000000;\n  color: #ffffff;\n  border: 3px solid #1d1a1a;\n  /* Adjust border color for pause */\n  border-radius: 0;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 14px;\n  text-shadow: 1px 1px #1d1a1a;\n  transition: transform 0.1s;\n}\n\n#switch:hover {\n  transform: scale(0.95);\n  background-color: #35312e;\n}\n\n#go-fullscreen,\n#toggle-physics {\n  font-size: 16px;\n  flex: 1;\n}\n\n#sandbox-fullscreen:hover {\n  transform: scale(0.95);\n  background-color: #ff6600;\n}\n\n#sandbox-collapse:hover {\n  transform: scale(0.95);\n  background-color: #ff6600;\n}\n\n#sandbox-pause:hover {\n  transform: scale(0.95);\n  background-color: #ff6600;\n}\n\n#sandbox-deploy {\n  background-color: #0fb647;\n  border: 3px solid #032c13;\n  /* Adjust border color for deploy */\n  text-shadow: 1px 1px #032c13;\n}\n\n#sandbox-deploy:hover {\n  transform: scale(0.95);\n  background-color: #ff6600;\n}","",{version:3,sources:["webpack://./src/index.css"],names:[],mappings:"AAAA;EACE,kBAAkB;EAClB,YAAY;EACZ,SAAS;EACT,2BAA2B;EAC3B,wBAAwB;EACxB,8CAA8C;EAC9C,eAAe;EACf,iDAAiD;AACnD;;AAEA;EACE,WAAW;EACX,aAAa;EACb,mBAAmB;EACnB,eAAe;EACf,aAAa;EACb,sBAAsB;AACxB;;AAEA;EACE,WAAW;EACX,aAAa;EACb,eAAe;EACf,iCAAiC;EACjC,aAAa;EACb,sBAAsB;EACtB,yBAAyB;EACzB,cAAc;AAChB;;AAEA;;;;EAIE,yBAAyB;EACzB,cAAc;EACd,yBAAyB;EACzB,kCAAkC;EAClC,gBAAgB;EAChB,iBAAiB;EACjB,sCAAsC;EACtC,eAAe;EACf,4BAA4B;EAC5B,0BAA0B;AAC5B;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE,mBAAmB;AACrB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,WAAW;AACb;;AAEA;EACE,UAAU;AACZ;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,uBAAuB;AACzB;;AAEA;EACE,aAAa;EACb,sBAAsB;EACtB,mBAAmB;EACnB,uBAAuB;EACvB,YAAY;EACZ,UAAU;AACZ;;AAEA;EACE,gBAAgB;EAChB,sCAAsC;EACtC,cAAc;EACd,4BAA4B;EAC5B,SAAS;AACX;;AAEA;EACE,gBAAgB;EAChB,iBAAiB;EACjB,sCAAsC;EACtC,eAAe;EACf,0BAA0B;AAC5B;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE,yBAAyB;EACzB,cAAc;EACd,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,cAAc;EACd,yBAAyB;EACzB,4BAA4B;AAC9B;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;AAC3B;;AAEA;;EAEE,gBAAgB;EAChB,UAAU;AACZ;;AAEA;EACE,uBAAuB;AACzB;;AAEA;EACE,aAAa;EACb,sBAAsB;EACtB,QAAQ;EACR,yBAAyB;EACzB,cAAc;EACd,yBAAyB;EACzB,gBAAgB;EAChB,WAAW;EACX,iBAAiB;EACjB,sCAAsC;EACtC,eAAe;EACf,4BAA4B;EAC5B,0BAA0B;AAC5B;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;AAC3B;;AAEA;EACE,aAAa;EACb,sBAAsB;EACtB,QAAQ;EACR,yBAAyB;EACzB,cAAc;EACd,yBAAyB;EACzB,gBAAgB;EAChB,WAAW;EACX,iBAAiB;EACjB,sCAAsC;EACtC,eAAe;EACf,4BAA4B;EAC5B,0BAA0B;AAC5B;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,cAAc;EACd,yBAAyB;EACzB,kCAAkC;EAClC,gBAAgB;EAChB,iBAAiB;EACjB,sCAAsC;EACtC,eAAe;EACf,4BAA4B;EAC5B,0BAA0B;AAC5B;;AAEA;EACE,yBAAyB;EACzB,cAAc;EACd,yBAAyB;EACzB,kCAAkC;EAClC,gBAAgB;EAChB,iBAAiB;EACjB,sCAAsC;EACtC,eAAe;EACf,4BAA4B;EAC5B,0BAA0B;AAC5B;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;AAC3B;;AAEA;;EAEE,eAAe;EACf,OAAO;AACT;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;AAC3B;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;AAC3B;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,yBAAyB;EACzB,mCAAmC;EACnC,4BAA4B;AAC9B;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;AAC3B",sourcesContent:["#sandbox-editor {\n  position: absolute;\n  bottom: 10px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: calc(100% - 20px);\n  /* Adjust width to leave space on both sides */\n  max-width: 100%;\n  /* Ensure it doesn't exceed the container width */\n}\n\n#editor {\n  width: 100%;\n  height: 150px;\n  margin-bottom: 10px;\n  font-size: 14px;\n  display: flex;\n  flex-direction: column;\n}\n\n#output {\n  width: 100%;\n  height: 150px;\n  font-size: 14px;\n  /* Add space below the terminal */\n  display: flex;\n  flex-direction: column;\n  background-color: #1d1a1a;\n  color: #fff3f3;\n}\n\n#sandbox-pause,\n#sandbox-deploy,\n#sandbox-collapse,\n#sandbox-fullscreen {\n  background-color: #ffcc00;\n  color: #000000;\n  border: 3px solid #ff6600;\n  /* Adjust border color for pause */\n  border-radius: 0;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 14px;\n  text-shadow: 1px 1px #ff6600;\n  transition: transform 0.1s;\n}\n\n.flex {\n  display: flex;\n}\n\n.flex-col {\n  flex-direction: column;\n}\n\n.flex-row {\n  flex-direction: row;\n}\n\n.gap-4 {\n  gap: 16px;\n}\n\n.justify-stretch {\n  justify-content: stretch;\n}\n\n.w-full {\n  width: 100%;\n}\n\n.w-60 {\n  width: 60%;\n}\n\n#rootDiv:has(#main-menu) {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n}\n\n#main-menu {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  width: 60%;\n}\n\n#h1-SS {\n  font-size: 100px;\n  font-family: 'Press Start 2P', cursive;\n  color: #6e1ca5;\n  text-shadow: 1px 1px #000000;\n  margin: 0;\n}\n\n.button {\n  border-radius: 0;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 32px;\n  transition: transform 0.1s;\n}\n\n.button:hover {\n  transform: scale(0.95);\n}\n\n.button.blue {\n  background-color: #4469e0;\n  color: #000000;\n  border: 3px solid #7279b8;\n}\n\n.button.blue:hover {\n  background-color: #7279b8;\n}\n\n.button.yellow {\n  background-color: #ffcc00;\n  color: #000000;\n  border: 3px solid #ff6600;\n  text-shadow: 1px 1px #ff6600;\n}\n\n.button.yellow:hover {\n  transform: scale(0.95);\n  background-color: #ff6600;\n}\n\n#sandbox-button,\n#level-select {\n  border-radius: 0;\n  width: 60%;\n}\n\n#go-fullscreen {\n  width: calc(50% - 16px);\n}\n\n#level-one {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  background-color: #4469e0;\n  color: #000000;\n  border: 3px solid #7279b8;\n  border-radius: 0;\n  width: 100%;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 48px;\n  text-shadow: 1px 1px #4c59d1;\n  transition: transform 0.1s;\n}\n\n#level-one:hover {\n  transform: scale(0.95);\n  background-color: #7279b8;\n}\n\n#level-two {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  background-color: #4469e0;\n  color: #000000;\n  border: 3px solid #7279b8;\n  border-radius: 0;\n  width: 100%;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 48px;\n  text-shadow: 1px 1px #4c59d1;\n  transition: transform 0.1s;\n}\n\n#level-two:hover {\n  transform: scale(0.95);\n  background-color: #7279b8;\n}\n\n#sandbox-back {\n  background-color: #ce3434;\n  color: #000000;\n  border: 3px solid #9c0000;\n  /* Adjust border color for pause */\n  border-radius: 0;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 14px;\n  text-shadow: 1px 1px #000000;\n  transition: transform 0.1s;\n}\n\n#switch {\n  background-color: #000000;\n  color: #ffffff;\n  border: 3px solid #1d1a1a;\n  /* Adjust border color for pause */\n  border-radius: 0;\n  padding: 8px 16px;\n  font-family: 'Press Start 2P', cursive;\n  font-size: 14px;\n  text-shadow: 1px 1px #1d1a1a;\n  transition: transform 0.1s;\n}\n\n#switch:hover {\n  transform: scale(0.95);\n  background-color: #35312e;\n}\n\n#go-fullscreen,\n#toggle-physics {\n  font-size: 16px;\n  flex: 1;\n}\n\n#sandbox-fullscreen:hover {\n  transform: scale(0.95);\n  background-color: #ff6600;\n}\n\n#sandbox-collapse:hover {\n  transform: scale(0.95);\n  background-color: #ff6600;\n}\n\n#sandbox-pause:hover {\n  transform: scale(0.95);\n  background-color: #ff6600;\n}\n\n#sandbox-deploy {\n  background-color: #0fb647;\n  border: 3px solid #032c13;\n  /* Adjust border color for deploy */\n  text-shadow: 1px 1px #032c13;\n}\n\n#sandbox-deploy:hover {\n  transform: scale(0.95);\n  background-color: #ff6600;\n}"],sourceRoot:""}]);const a=r},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",n=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),n&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),n&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,n,s,o){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(n)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(r[l]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);n&&r[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),s&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=s):c[4]="".concat(s)),e.push(c))}},e}},537:t=>{"use strict";t.exports=function(t){var e=t[1],i=t[3];if(!i)return e;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),o="/*# ".concat(s," */");return[e].concat([o]).join("\n")}return[e].join("\n")}},882:(t,e,i)=>{"use strict";i.r(e),i.d(e,{ActionContext:()=>a,ActionQueue:()=>l,ActionSequence:()=>h,ActionsComponent:()=>c,ActionsSystem:()=>d,ActivateEvent:()=>u,Actor:()=>p,AddedComponent:()=>g,AddedEntity:()=>f,AffineMatrix:()=>m,Animation:()=>v,AnimationDirection:()=>_,AnimationEvents:()=>y,AnimationStrategy:()=>w,ArcadeSolver:()=>x,AudioContextFactory:()=>b,Axes:()=>C,Axis:()=>A,BaseAlign:()=>S,Blink:()=>E,BodyComponent:()=>T,BoundingBox:()=>k,BroadphaseStrategy:()=>M,BrowserComponent:()=>$,BrowserEvents:()=>L,Buttons:()=>R,Camera:()=>I,CameraEvents:()=>D,Canvas:()=>P,Circle:()=>B,CircleCollider:()=>F,Clock:()=>O,ClosestLine:()=>N,ClosestLineJumpTable:()=>z,Collider:()=>W,ColliderComponent:()=>H,CollisionContact:()=>U,CollisionEndEvent:()=>j,CollisionGroup:()=>V,CollisionGroupManager:()=>G,CollisionJumpTable:()=>K,CollisionPostSolveEvent:()=>Y,CollisionPreSolveEvent:()=>q,CollisionResolutionStrategy:()=>X,CollisionStartEvent:()=>Z,CollisionSystem:()=>Q,CollisionType:()=>J,Color:()=>tt,ColorBlindFlags:()=>et,ColorBlindnessMode:()=>it,ColorBlindnessPostProcessor:()=>nt,Component:()=>st,CompositeCollider:()=>ot,Configurable:()=>rt,ConsoleAppender:()=>at,ContactConstraintPoint:()=>lt,ContactEndEvent:()=>ht,ContactStartEvent:()=>ct,CoordPlane:()=>dt,DeactivateEvent:()=>ut,Debug:()=>pt,DebugGraphicsComponent:()=>gt,DebugSystem:()=>ft,DebugText:()=>mt,DegreeOfFreedom:()=>vt,Delay:()=>_t,Detector:()=>yt,Die:()=>wt,Direction:()=>xt,DisplayMode:()=>bt,DynamicTree:()=>Ct,DynamicTreeCollisionProcessor:()=>At,EX_VERSION:()=>St,EaseBy:()=>Et,EaseTo:()=>Tt,EasingFunctions:()=>kt,EdgeCollider:()=>Mt,ElasticToActorStrategy:()=>$t,EmitterType:()=>Lt,Engine:()=>Rt,EngineEvents:()=>It,EnterTriggerEvent:()=>Dt,EnterViewPortEvent:()=>Pt,Entity:()=>Bt,EntityEvents:()=>Ft,EntityManager:()=>Ot,EventDispatcher:()=>Nt,EventEmitter:()=>zt,EventTypes:()=>Wt,Events:()=>Ht,ExResponse:()=>Ut,ExcaliburGraphicsContext2DCanvas:()=>jt,ExcaliburGraphicsContextWebGL:()=>Vt,ExitTriggerEvent:()=>Gt,ExitViewPortEvent:()=>Kt,Fade:()=>Yt,Flags:()=>qt,Follow:()=>Xt,Font:()=>Zt,FontCache:()=>Qt,FontStyle:()=>Jt,FontUnit:()=>te,FpsSampler:()=>ee,FrameStats:()=>ie,Future:()=>ne,GameEvent:()=>se,GameStartEvent:()=>oe,GameStopEvent:()=>re,Gamepad:()=>ae,GamepadAxisEvent:()=>le,GamepadButtonEvent:()=>he,GamepadConnectEvent:()=>ce,GamepadDisconnectEvent:()=>de,Gamepads:()=>ue,Gif:()=>pe,GlobalCoordinates:()=>ge,Graphic:()=>fe,GraphicsComponent:()=>me,GraphicsGroup:()=>ve,GraphicsLayer:()=>_e,GraphicsLayers:()=>ye,GraphicsSystem:()=>we,HiddenEvent:()=>xe,ImageFiltering:()=>be,ImageSource:()=>Ce,InitializeEvent:()=>Ae,Input:()=>Se,InputMapper:()=>Ee,Integrator:()=>Te,IsometricEntityComponent:()=>ke,IsometricEntitySystem:()=>Me,IsometricMap:()=>$e,IsometricTile:()=>Le,KeyEvent:()=>Re,Keyboard:()=>Ie,Keys:()=>De,KillEvent:()=>Pe,Label:()=>Be,LimitCameraBoundsStrategy:()=>Fe,Line:()=>Oe,LineSegment:()=>Ne,Loader:()=>ze,LoaderEvents:()=>We,LockCameraToActorAxisStrategy:()=>He,LockCameraToActorStrategy:()=>Ue,LogLevel:()=>je,Logger:()=>Ve,Material:()=>Ge,Matrix:()=>Ke,MatrixLocations:()=>Ye,MediaEvent:()=>qe,Meet:()=>Xe,MotionComponent:()=>Ze,MotionSystem:()=>Qe,MoveBy:()=>Je,MoveTo:()=>ti,NativePointerButton:()=>ei,NativeSoundEvent:()=>ii,NativeSoundProcessedEvent:()=>ni,Observable:()=>si,OffscreenSystem:()=>oi,Pair:()=>ri,ParallaxComponent:()=>ai,ParallelActions:()=>li,ParseGif:()=>hi,Particle:()=>ci,ParticleEmitter:()=>di,ParticleTransform:()=>ui,Physics:()=>pi,PhysicsStats:()=>gi,PhysicsWorld:()=>fi,PointerButton:()=>mi,PointerComponent:()=>vi,PointerEvent:()=>_i,PointerEventReceiver:()=>yi,PointerScope:()=>wi,PointerSystem:()=>xi,PointerType:()=>bi,Polygon:()=>Ci,PolygonCollider:()=>Ai,Pool:()=>Si,PostCollisionEvent:()=>Ei,PostDebugDrawEvent:()=>Ti,PostDrawEvent:()=>ki,PostFrameEvent:()=>Mi,PostKillEvent:()=>$i,PostUpdateEvent:()=>Li,PreCollisionEvent:()=>Ri,PreDebugDrawEvent:()=>Ii,PreDrawEvent:()=>Di,PreFrameEvent:()=>Pi,PreKillEvent:()=>Bi,PreUpdateEvent:()=>Fi,Projection:()=>Oi,QuadIndexBuffer:()=>Ni,Query:()=>zi,QueryManager:()=>Wi,RadiusAroundActorStrategy:()=>Hi,Random:()=>Ui,Raster:()=>ji,Ray:()=>Vi,RealisticSolver:()=>Gi,Rectangle:()=>Ki,RemovedComponent:()=>Yi,RemovedEntity:()=>qi,Repeat:()=>Xi,RepeatForever:()=>Zi,Resolution:()=>Qi,Resource:()=>Ji,ResourceEvents:()=>tn,RotateBy:()=>en,RotateTo:()=>nn,RotationType:()=>sn,ScaleBy:()=>on,ScaleTo:()=>rn,Scene:()=>an,SceneEvents:()=>ln,Screen:()=>hn,ScreenAppender:()=>cn,ScreenElement:()=>dn,ScreenShader:()=>un,ScrollPreventionMode:()=>pn,Semaphore:()=>gn,Shader:()=>fn,Shape:()=>mn,Side:()=>vn,Sound:()=>_n,SoundEvents:()=>yn,Sprite:()=>wn,SpriteFont:()=>xn,SpriteSheet:()=>bn,StandardClock:()=>Cn,StateMachine:()=>An,StrategyContainer:()=>Sn,Stream:()=>En,System:()=>Tn,SystemManager:()=>kn,SystemType:()=>Mn,TagComponent:()=>$n,TestClock:()=>Ln,Text:()=>Rn,TextAlign:()=>In,TextureLoader:()=>Dn,Tile:()=>Pn,TileMap:()=>Bn,TileMapEvents:()=>Fn,Timer:()=>On,Toaster:()=>Nn,Transform:()=>zn,TransformComponent:()=>Wn,TreeNode:()=>Hn,Trigger:()=>Un,TriggerEvents:()=>jn,TwoPI:()=>Vn,Util:()=>Gn,Vector:()=>Kn,VectorView:()=>Yn,VertexBuffer:()=>qn,VertexLayout:()=>Xn,VisibleEvent:()=>Zn,WebAudio:()=>Qn,WebAudioInstance:()=>Jn,WheelDeltaMode:()=>ts,WheelEvent:()=>es,World:()=>is,canonicalizeAngle:()=>ns,clamp:()=>ss,createId:()=>os,frac:()=>rs,hasGraphicsTick:()=>as,hasOnInitialize:()=>ls,hasOnPostUpdate:()=>hs,hasOnPreUpdate:()=>cs,hasPostDraw:()=>ds,hasPreDraw:()=>us,has_initialize:()=>ps,has_postupdate:()=>gs,has_preupdate:()=>fs,isAddedComponent:()=>ms,isAddedSystemEntity:()=>vs,isRemoveSystemEntity:()=>_s,isRemovedComponent:()=>ys,isScreenElement:()=>ws,maxMessages:()=>xs,obsolete:()=>bs,pixelSnapEpsilon:()=>Cs,randomInRange:()=>As,randomIntInRange:()=>Ss,range:()=>Es,resetObsoleteCounter:()=>Ts,sign:()=>ks,toDegrees:()=>Ms,toRadians:()=>$s,vec:()=>Ls,webgl:()=>Rs});var n={4662:(t,e,i)=>{i(3430);var n=i(8791);t.exports=n("Array","sort")},8343:(t,e,i)=>{i(4769);var n=i(9276);t.exports=n.Object.keys},7111:(t,e,i)=>{var n=i(6733),s=i(9821),o=TypeError;t.exports=function(t){if(n(t))return t;throw o(s(t)+" is not a function")}},1176:(t,e,i)=>{var n=i(5052),s=String,o=TypeError;t.exports=function(t){if(n(t))return t;throw o(s(t)+" is not an object")}},9540:(t,e,i)=>{var n=i(905),s=i(3231),o=i(9646),r=function(t){return function(e,i,r){var a,l=n(e),h=o(l),c=s(r,h);if(t&&i!=i){for(;h>c;)if((a=l[c++])!=a)return!0}else for(;h>c;c++)if((t||c in l)&&l[c]===i)return t||c||0;return!t&&-1}};t.exports={includes:r(!0),indexOf:r(!1)}},6038:(t,e,i)=>{var n=i(4229);t.exports=function(t,e){var i=[][t];return!!i&&n((function(){i.call(null,e||function(){return 1},1)}))}},9794:(t,e,i)=>{var n=i(3231),s=i(9646),o=i(2324),r=Array,a=Math.max;t.exports=function(t,e,i){for(var l=s(t),h=n(e,l),c=n(void 0===i?l:i,l),d=r(a(c-h,0)),u=0;h<c;h++,u++)o(d,u,t[h]);return d.length=u,d}},3867:(t,e,i)=>{var n=i(9794),s=Math.floor,o=function(t,e){var i=t.length,l=s(i/2);return i<8?r(t,e):a(t,o(n(t,0,l),e),o(n(t,l),e),e)},r=function(t,e){for(var i,n,s=t.length,o=1;o<s;){for(n=o,i=t[o];n&&e(t[n-1],i)>0;)t[n]=t[--n];n!==o++&&(t[n]=i)}return t},a=function(t,e,i,n){for(var s=e.length,o=i.length,r=0,a=0;r<s||a<o;)t[r+a]=r<s&&a<o?n(e[r],i[a])<=0?e[r++]:i[a++]:r<s?e[r++]:i[a++];return t};t.exports=o},7079:(t,e,i)=>{var n=i(5968),s=n({}.toString),o=n("".slice);t.exports=function(t){return o(s(t),8,-1)}},1589:(t,e,i)=>{var n=i(1601),s=i(6733),o=i(7079),r=i(95)("toStringTag"),a=Object,l="Arguments"==o(function(){return arguments}());t.exports=n?o:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=a(t),r))?i:l?o(e):"Object"==(n=o(e))&&s(e.callee)?"Arguments":n}},7081:(t,e,i)=>{var n=i(8270),s=i(4826),o=i(7933),r=i(1787);t.exports=function(t,e,i){for(var a=s(e),l=r.f,h=o.f,c=0;c<a.length;c++){var d=a[c];n(t,d)||i&&n(i,d)||l(t,d,h(e,d))}}},5762:(t,e,i)=>{var n=i(7400),s=i(1787),o=i(5358);t.exports=n?function(t,e,i){return s.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},5358:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},2324:(t,e,i)=>{var n=i(9310),s=i(1787),o=i(5358);t.exports=function(t,e,i){var r=n(e);r in t?s.f(t,r,o(0,i)):t[r]=i}},4768:(t,e,i)=>{var n=i(6733),s=i(1787),o=i(6039),r=i(8400);t.exports=function(t,e,i,a){a||(a={});var l=a.enumerable,h=void 0!==a.name?a.name:e;if(n(i)&&o(i,h,a),a.global)l?t[e]=i:r(e,i);else{try{a.unsafe?t[e]&&(l=!0):delete t[e]}catch(t){}l?t[e]=i:s.f(t,e,{value:i,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},8400:(t,e,i)=>{var n=i(9859),s=Object.defineProperty;t.exports=function(t,e){try{s(n,t,{value:e,configurable:!0,writable:!0})}catch(i){n[t]=e}return e}},9563:(t,e,i)=>{var n=i(9821),s=TypeError;t.exports=function(t,e){if(!delete t[e])throw s("Cannot delete property "+n(e)+" of "+n(t))}},7400:(t,e,i)=>{var n=i(4229);t.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},3777:t=>{var e="object"==typeof document&&document.all,i=void 0===e&&void 0!==e;t.exports={all:e,IS_HTMLDDA:i}},2635:(t,e,i)=>{var n=i(9859),s=i(5052),o=n.document,r=s(o)&&s(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},2671:(t,e,i)=>{var n=i(598).match(/firefox\/(\d+)/i);t.exports=!!n&&+n[1]},8506:(t,e,i)=>{var n=i(598);t.exports=/MSIE|Trident/.test(n)},598:t=>{t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},5884:(t,e,i)=>{var n,s,o=i(9859),r=i(598),a=o.process,l=o.Deno,h=a&&a.versions||l&&l.version,c=h&&h.v8;c&&(s=(n=c.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!s&&r&&(!(n=r.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=r.match(/Chrome\/(\d+)/))&&(s=+n[1]),t.exports=s},9811:(t,e,i)=>{var n=i(598).match(/AppleWebKit\/(\d+)\./);t.exports=!!n&&+n[1]},8791:(t,e,i)=>{var n=i(9859),s=i(5968);t.exports=function(t,e){return s(n[t].prototype[e])}},3837:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3103:(t,e,i)=>{var n=i(9859),s=i(7933).f,o=i(5762),r=i(4768),a=i(8400),l=i(7081),h=i(6541);t.exports=function(t,e){var i,c,d,u,p,g=t.target,f=t.global,m=t.stat;if(i=f?n:m?n[g]||a(g,{}):(n[g]||{}).prototype)for(c in e){if(u=e[c],d=t.dontCallGetSet?(p=s(i,c))&&p.value:i[c],!h(f?c:g+(m?".":"#")+c,t.forced)&&void 0!==d){if(typeof u==typeof d)continue;l(u,d)}(t.sham||d&&d.sham)&&o(u,"sham",!0),r(i,c,u,t)}}},4229:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},7188:(t,e,i)=>{var n=i(4229);t.exports=!n((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},266:(t,e,i)=>{var n=i(7188),s=Function.prototype.call;t.exports=n?s.bind(s):function(){return s.apply(s,arguments)}},1805:(t,e,i)=>{var n=i(7400),s=i(8270),o=Function.prototype,r=n&&Object.getOwnPropertyDescriptor,a=s(o,"name"),l=a&&"something"===function(){}.name,h=a&&(!n||n&&r(o,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:h}},5968:(t,e,i)=>{var n=i(7188),s=Function.prototype,o=s.call,r=n&&s.bind.bind(o,o);t.exports=n?r:function(t){return function(){return o.apply(t,arguments)}}},1333:(t,e,i)=>{var n=i(9859),s=i(6733);t.exports=function(t,e){return arguments.length<2?(i=n[t],s(i)?i:void 0):n[t]&&n[t][e];var i}},5300:(t,e,i)=>{var n=i(7111),s=i(9650);t.exports=function(t,e){var i=t[e];return s(i)?void 0:n(i)}},9859:function(t,e,i){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof i.g&&i.g)||function(){return this}()||this||Function("return this")()},8270:(t,e,i)=>{var n=i(5968),s=i(2991),o=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(s(t),e)}},5977:t=>{t.exports={}},4394:(t,e,i)=>{var n=i(7400),s=i(4229),o=i(2635);t.exports=!n&&!s((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},9337:(t,e,i)=>{var n=i(5968),s=i(4229),o=i(7079),r=Object,a=n("".split);t.exports=s((function(){return!r("z").propertyIsEnumerable(0)}))?function(t){return"String"==o(t)?a(t,""):r(t)}:r},8511:(t,e,i)=>{var n=i(5968),s=i(6733),o=i(5353),r=n(Function.toString);s(o.inspectSource)||(o.inspectSource=function(t){return r(t)}),t.exports=o.inspectSource},6407:(t,e,i)=>{var n,s,o,r=i(1180),a=i(9859),l=i(5052),h=i(5762),c=i(8270),d=i(5353),u=i(4399),p=i(5977),g="Object already initialized",f=a.TypeError,m=a.WeakMap;if(r||d.state){var v=d.state||(d.state=new m);v.get=v.get,v.has=v.has,v.set=v.set,n=function(t,e){if(v.has(t))throw f(g);return e.facade=t,v.set(t,e),e},s=function(t){return v.get(t)||{}},o=function(t){return v.has(t)}}else{var _=u("state");p[_]=!0,n=function(t,e){if(c(t,_))throw f(g);return e.facade=t,h(t,_,e),e},s=function(t){return c(t,_)?t[_]:{}},o=function(t){return c(t,_)}}t.exports={set:n,get:s,has:o,enforce:function(t){return o(t)?s(t):n(t,{})},getterFor:function(t){return function(e){var i;if(!l(e)||(i=s(e)).type!==t)throw f("Incompatible receiver, "+t+" required");return i}}}},6733:(t,e,i)=>{var n=i(3777),s=n.all;t.exports=n.IS_HTMLDDA?function(t){return"function"==typeof t||t===s}:function(t){return"function"==typeof t}},6541:(t,e,i)=>{var n=i(4229),s=i(6733),o=/#|\.prototype\./,r=function(t,e){var i=l[a(t)];return i==c||i!=h&&(s(e)?n(e):!!e)},a=r.normalize=function(t){return String(t).replace(o,".").toLowerCase()},l=r.data={},h=r.NATIVE="N",c=r.POLYFILL="P";t.exports=r},9650:t=>{t.exports=function(t){return null==t}},5052:(t,e,i)=>{var n=i(6733),s=i(3777),o=s.all;t.exports=s.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:n(t)||t===o}:function(t){return"object"==typeof t?null!==t:n(t)}},4231:t=>{t.exports=!1},9395:(t,e,i)=>{var n=i(1333),s=i(6733),o=i(1321),r=i(6969),a=Object;t.exports=r?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return s(e)&&o(e.prototype,a(t))}},9646:(t,e,i)=>{var n=i(4237);t.exports=function(t){return n(t.length)}},6039:(t,e,i)=>{var n=i(5968),s=i(4229),o=i(6733),r=i(8270),a=i(7400),l=i(1805).CONFIGURABLE,h=i(8511),c=i(6407),d=c.enforce,u=c.get,p=String,g=Object.defineProperty,f=n("".slice),m=n("".replace),v=n([].join),_=a&&!s((function(){return 8!==g((function(){}),"length",{value:8}).length})),y=String(String).split("String"),w=t.exports=function(t,e,i){"Symbol("===f(p(e),0,7)&&(e="["+m(p(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),i&&i.getter&&(e="get "+e),i&&i.setter&&(e="set "+e),(!r(t,"name")||l&&t.name!==e)&&(a?g(t,"name",{value:e,configurable:!0}):t.name=e),_&&i&&r(i,"arity")&&t.length!==i.arity&&g(t,"length",{value:i.arity});try{i&&r(i,"constructor")&&i.constructor?a&&g(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var n=d(t);return r(n,"source")||(n.source=v(y,"string"==typeof e?e:"")),t};Function.prototype.toString=w((function(){return o(this)&&u(this).source||h(this)}),"toString")},917:t=>{var e=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?i:e)(n)}},1787:(t,e,i)=>{var n=i(7400),s=i(4394),o=i(7137),r=i(1176),a=i(9310),l=TypeError,h=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d="enumerable",u="configurable",p="writable";e.f=n?o?function(t,e,i){if(r(t),e=a(e),r(i),"function"==typeof t&&"prototype"===e&&"value"in i&&p in i&&!i[p]){var n=c(t,e);n&&n[p]&&(t[e]=i.value,i={configurable:u in i?i[u]:n[u],enumerable:d in i?i[d]:n[d],writable:!1})}return h(t,e,i)}:h:function(t,e,i){if(r(t),e=a(e),r(i),s)try{return h(t,e,i)}catch(t){}if("get"in i||"set"in i)throw l("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},7933:(t,e,i)=>{var n=i(7400),s=i(266),o=i(9195),r=i(5358),a=i(905),l=i(9310),h=i(8270),c=i(4394),d=Object.getOwnPropertyDescriptor;e.f=n?d:function(t,e){if(t=a(t),e=l(e),c)try{return d(t,e)}catch(t){}if(h(t,e))return r(!s(o.f,t,e),t[e])}},8151:(t,e,i)=>{var n=i(140),s=i(3837).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,s)}},894:(t,e)=>{e.f=Object.getOwnPropertySymbols},1321:(t,e,i)=>{var n=i(5968);t.exports=n({}.isPrototypeOf)},140:(t,e,i)=>{var n=i(5968),s=i(8270),o=i(905),r=i(9540).indexOf,a=i(5977),l=n([].push);t.exports=function(t,e){var i,n=o(t),h=0,c=[];for(i in n)!s(a,i)&&s(n,i)&&l(c,i);for(;e.length>h;)s(n,i=e[h++])&&(~r(c,i)||l(c,i));return c}},5632:(t,e,i)=>{var n=i(140),s=i(3837);t.exports=Object.keys||function(t){return n(t,s)}},9195:(t,e)=>{var i={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,s=n&&!i.call({1:2},1);e.f=s?function(t){var e=n(this,t);return!!e&&e.enumerable}:i},2914:(t,e,i)=>{var n=i(266),s=i(6733),o=i(5052),r=TypeError;t.exports=function(t,e){var i,a;if("string"===e&&s(i=t.toString)&&!o(a=n(i,t)))return a;if(s(i=t.valueOf)&&!o(a=n(i,t)))return a;if("string"!==e&&s(i=t.toString)&&!o(a=n(i,t)))return a;throw r("Can't convert object to primitive value")}},4826:(t,e,i)=>{var n=i(1333),s=i(5968),o=i(8151),r=i(894),a=i(1176),l=s([].concat);t.exports=n("Reflect","ownKeys")||function(t){var e=o.f(a(t)),i=r.f;return i?l(e,i(t)):e}},9276:(t,e,i)=>{var n=i(9859);t.exports=n},8885:(t,e,i)=>{var n=i(9650),s=TypeError;t.exports=function(t){if(n(t))throw s("Can't call method on "+t);return t}},4399:(t,e,i)=>{var n=i(3036),s=i(1441),o=n("keys");t.exports=function(t){return o[t]||(o[t]=s(t))}},5353:(t,e,i)=>{var n=i(9859),s=i(8400),o="__core-js_shared__",r=n[o]||s(o,{});t.exports=r},3036:(t,e,i)=>{var n=i(4231),s=i(5353);(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.32.0",mode:n?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.0/LICENSE",source:"https://github.com/zloirock/core-js"})},4860:(t,e,i)=>{var n=i(5884),s=i(4229),o=i(9859).String;t.exports=!!Object.getOwnPropertySymbols&&!s((function(){var t=Symbol();return!o(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},3231:(t,e,i)=>{var n=i(3329),s=Math.max,o=Math.min;t.exports=function(t,e){var i=n(t);return i<0?s(i+e,0):o(i,e)}},905:(t,e,i)=>{var n=i(9337),s=i(8885);t.exports=function(t){return n(s(t))}},3329:(t,e,i)=>{var n=i(917);t.exports=function(t){var e=+t;return e!=e||0===e?0:n(e)}},4237:(t,e,i)=>{var n=i(3329),s=Math.min;t.exports=function(t){return t>0?s(n(t),9007199254740991):0}},2991:(t,e,i)=>{var n=i(8885),s=Object;t.exports=function(t){return s(n(t))}},2066:(t,e,i)=>{var n=i(266),s=i(5052),o=i(9395),r=i(5300),a=i(2914),l=i(95),h=TypeError,c=l("toPrimitive");t.exports=function(t,e){if(!s(t)||o(t))return t;var i,l=r(t,c);if(l){if(void 0===e&&(e="default"),i=n(l,t,e),!s(i)||o(i))return i;throw h("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},9310:(t,e,i)=>{var n=i(2066),s=i(9395);t.exports=function(t){var e=n(t,"string");return s(e)?e:e+""}},1601:(t,e,i)=>{var n={};n[i(95)("toStringTag")]="z",t.exports="[object z]"===String(n)},3326:(t,e,i)=>{var n=i(1589),s=String;t.exports=function(t){if("Symbol"===n(t))throw TypeError("Cannot convert a Symbol value to a string");return s(t)}},9821:t=>{var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},1441:(t,e,i)=>{var n=i(5968),s=0,o=Math.random(),r=n(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+r(++s+o,36)}},6969:(t,e,i)=>{var n=i(4860);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7137:(t,e,i)=>{var n=i(7400),s=i(4229);t.exports=n&&s((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},1180:(t,e,i)=>{var n=i(9859),s=i(6733),o=n.WeakMap;t.exports=s(o)&&/native code/.test(String(o))},95:(t,e,i)=>{var n=i(9859),s=i(3036),o=i(8270),r=i(1441),a=i(4860),l=i(6969),h=n.Symbol,c=s("wks"),d=l?h.for||h:h&&h.withoutSetter||r;t.exports=function(t){return o(c,t)||(c[t]=a&&o(h,t)?h[t]:d("Symbol."+t)),c[t]}},3430:(t,e,i)=>{var n=i(3103),s=i(5968),o=i(7111),r=i(2991),a=i(9646),l=i(9563),h=i(3326),c=i(4229),d=i(3867),u=i(6038),p=i(2671),g=i(8506),f=i(5884),m=i(9811),v=[],_=s(v.sort),y=s(v.push),w=c((function(){v.sort(void 0)})),x=c((function(){v.sort(null)})),b=u("sort"),C=!c((function(){if(f)return f<70;if(!(p&&p>3)){if(g)return!0;if(m)return m<603;var t,e,i,n,s="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(n=0;n<47;n++)v.push({k:e+n,v:i})}for(v.sort((function(t,e){return e.v-t.v})),n=0;n<v.length;n++)e=v[n].k.charAt(0),s.charAt(s.length-1)!==e&&(s+=e);return"DGBEFHACIJK"!==s}}));n({target:"Array",proto:!0,forced:w||!x||!b||!C},{sort:function(t){void 0!==t&&o(t);var e=r(this);if(C)return void 0===t?_(e):_(e,t);var i,n,s=[],c=a(e);for(n=0;n<c;n++)n in e&&y(s,e[n]);for(d(s,function(t){return function(e,i){return void 0===i?-1:void 0===e?1:void 0!==t?+t(e,i)||0:h(e)>h(i)?1:-1}}(t)),i=a(s),n=0;n<i;)e[n]=s[n++];for(;n<c;)l(e,n++);return e}})},4769:(t,e,i)=>{var n=i(3103),s=i(2991),o=i(5632);n({target:"Object",stat:!0,forced:i(4229)((function(){o(1)}))},{keys:function(t){return o(s(t))}})},1388:(t,e,i)=>{i.d(e,{Z:()=>a});var n=i(272),s=i.n(n),o=i(2609),r=i.n(o)()(s());r.push([t.id,"/* Buttons styles start */\n\nbutton#excalibur-play {\n  display: inline-block;\n  position: relative;\n  z-index: 999;\n  border-radius: 6px;\n  border: none;\n  /*border: 3px solid;\n    border-color: white;\n    box-shadow: 0 0 10px #ccc;*/\n  padding: 1rem 1.5rem 1rem 4rem;\n  margin: 0;\n  text-decoration: none;\n  background: #00b233;\n  color: #ffffff;\n  font-family: sans-serif;\n  font-size: 2rem;\n  white-space: nowrap;\n  line-height: 1;\n  cursor: pointer;\n  text-align: center;\n  transition: background 250ms ease-in-out, transform 150ms ease;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\n  animation: excalibur-button-fadein 200ms;\n}\n\n/*\nbutton#excalibur-play {\n  display: none;\n}*/\n\nbutton#excalibur-play:after {\n  position: absolute;\n  content: '';\n  border: 8px solid;\n  border-color: transparent transparent transparent white;\n  left: 35px;\n  top: 24px;\n  width: 0;\n  height: 0;\n}\n\nbutton#excalibur-play:before {\n  position: absolute;\n  content: '';\n  border: 3px solid;\n  left: 19px;\n  top: 14px;\n  border-radius: 20px;\n  width: 30px;\n  height: 30px;\n}\n\nbutton#excalibur-play:hover,\nbutton#excalibur-play:focus {\n  background: #00982c;\n}\n\nbutton#excalibur-play:focus {\n  outline: 1px solid #fff;\n  outline-offset: -4px;\n}\n\nbutton#excalibur-play:active {\n  transform: scale(0.99);\n}\n\n@keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Firefox < 16 */\n@-moz-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Safari, Chrome and Opera > 12.1 */\n@-webkit-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Internet Explorer */\n@-ms-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Opera < 12.1 */\n@-o-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n","",{version:3,sources:["webpack://./Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:["/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  white-space: nowrap;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n"],sourceRoot:""}]);const a=r},7379:(t,e,i)=>{i.d(e,{Z:()=>a});var n=i(272),s=i.n(n),o=i(2609),r=i.n(o)()(s());r.push([t.id,"\n#ex-toast-container {\n  position: absolute;\n  height: 0;\n  min-width: 50%;\n  left: 50%;\n  top: 0;\n}\n\n.ex-toast-message {\n  left: -50%;\n  position: relative;\n  display: flex;\n  justify-content: space-between;\n\n\n  padding: 10px;\n  margin-top: 5px;\n  font-size: 18px;\n  font-family: sans-serif;\n  border-radius: 6px;\n  border: 3px solid #b7b779;\n  background-color: rgb(253, 253, 192);\n}\n\n\n.ex-toast-message button {\n  align-self: flex-start;\n}","",{version:3,sources:["webpack://./Util/Toaster.css"],names:[],mappings:";AACA;EACE,kBAAkB;EAClB,SAAS;EACT,cAAc;EACd,SAAS;EACT,MAAM;AACR;;AAEA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,8BAA8B;;;EAG9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,uBAAuB;EACvB,kBAAkB;EAClB,yBAAyB;EACzB,oCAAoC;AACtC;;;AAGA;EACE,sBAAsB;AACxB",sourcesContent:["\r\n#ex-toast-container {\r\n  position: absolute;\r\n  height: 0;\r\n  min-width: 50%;\r\n  left: 50%;\r\n  top: 0;\r\n}\r\n\r\n.ex-toast-message {\r\n  left: -50%;\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: space-between;\r\n\r\n\r\n  padding: 10px;\r\n  margin-top: 5px;\r\n  font-size: 18px;\r\n  font-family: sans-serif;\r\n  border-radius: 6px;\r\n  border: 3px solid #b7b779;\r\n  background-color: rgb(253, 253, 192);\r\n}\r\n\r\n\r\n.ex-toast-message button {\r\n  align-self: flex-start;\r\n}"],sourceRoot:""}]);const a=r},2609:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",n=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),n&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),n&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,n,s,o){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(n)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(r[l]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);n&&r[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),s&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=s):c[4]="".concat(s)),e.push(c))}},e}},272:t=>{t.exports=function(t){var e=t[1],i=t[3];if(!i)return e;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),o="/*# ".concat(s," */");return[e].concat([o]).join("\n")}return[e].join("\n")}}},s={};function o(t){var e=s[t];if(void 0!==e)return e.exports;var i=s[t]={id:t,exports:{}};return n[t].call(i.exports,i,i.exports,o),i.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{o.d(r,{fWn:()=>_n,Ia8:()=>Ki,rqv:()=>lo,hLI:()=>yn,yyv:()=>Cs,tX5:()=>G,vtX:()=>An,r7K:()=>Ii,lCh:()=>Kn,cE4:()=>It,fwF:()=>us,sce:()=>hs,AQ6:()=>ds,_c7:()=>cs,KUs:()=>os,Ajp:()=>Ce,dkO:()=>l,RDh:()=>Dn,_H9:()=>en,mxs:()=>un,OmD:()=>Ri,kBf:()=>At,C4F:()=>Je,NQt:()=>Ws,JjN:()=>Hs,EK_:()=>a,V1s:()=>Wn,xHm:()=>zn,Xz7:()=>Re,Cdc:()=>ji,FKn:()=>Ci,SUY:()=>qs,ab2:()=>xi,GfZ:()=>bi,YMS:()=>_i,oyv:()=>$i,aUb:()=>Ai,SdD:()=>j,JUv:()=>di,jEj:()=>co,TFq:()=>Ei,HDU:()=>H,R_y:()=>W,ydN:()=>Qe,t50:()=>U,s$$:()=>ls,v2G:()=>Ge,Ilk:()=>wt,s9i:()=>Fs,dxL:()=>$s,LLX:()=>Bs,wA2:()=>ri,R_p:()=>yi,IQ$:()=>gs,I5F:()=>et,X8$:()=>rs,FR6:()=>z,U8o:()=>N,kbG:()=>ei,iS_:()=>K,cGG:()=>Os,RPN:()=>Mn,skb:()=>xs,SLU:()=>Kt,RdJ:()=>Li,cNu:()=>gn,gU7:()=>Ve,LSk:()=>fn,Nmp:()=>sn,d1Y:()=>we,xrL:()=>fi,sRW:()=>vi,cmV:()=>Mo,qWz:()=>dn,N0Q:()=>cn,q8b:()=>Gi,ynB:()=>Ti,jT9:()=>Fn,wAz:()=>fs,D4V:()=>no,NLr:()=>eo,N6H:()=>X,W1A:()=>q,JHW:()=>Oi,ZZ$:()=>Fi,v2K:()=>Zn,pBf:()=>so,vpe:()=>m,GMl:()=>s,zW2:()=>t,B0K:()=>Ie,Nv7:()=>ye,C_p:()=>me,MUA:()=>Z,xqU:()=>Y,pTp:()=>pn,vUK:()=>g,j9l:()=>mn,Zxw:()=>bn,v51:()=>xn,Hdx:()=>nn,Z$d:()=>Ji,iqV:()=>Ys,o$7:()=>Ns,olM:()=>St,Zm$:()=>v,$QH:()=>x,i78:()=>b,nJg:()=>J,h6u:()=>D,hts:()=>I,j88:()=>L,VME:()=>R,fy2:()=>Q,nt:()=>wo,Ukr:()=>Us,zsu:()=>zt,oA6:()=>Hi,TVh:()=>ps,TwZ:()=>zi,GTT:()=>Wi,xxj:()=>ws,XdK:()=>B,Jmb:()=>Ht,cXo:()=>jt,Dm5:()=>V,IIB:()=>n,ebW:()=>to,zI0:()=>ti,LYD:()=>As,cEG:()=>Ss,SEl:()=>ao,t9V:()=>ro,ez5:()=>st,N1d:()=>ot,R8U:()=>c,SKZ:()=>_,__J:()=>oo,RI$:()=>Nn,x12:()=>So,ccz:()=>wi,aNw:()=>Ue,XrL:()=>He,xwn:()=>Bn,dNK:()=>Pn,ini:()=>h,YdH:()=>tt,F5T:()=>ue,y3G:()=>Rt,l57:()=>Ct,xn0:()=>Be,t2V:()=>vn,uxB:()=>ci,cpd:()=>ss,fiy:()=>Xi,$XZ:()=>Zi,UG6:()=>Rs,uqK:()=>Fe,STE:()=>Oe,y$z:()=>li,mAD:()=>Es,sOq:()=>ui,hUw:()=>kn,_0G:()=>ho,Sqs:()=>Ao,hpZ:()=>_s,Vol:()=>ys,vYX:()=>ms,wIZ:()=>ii,cBi:()=>zs,c30:()=>Ts,MPV:()=>Is,RFv:()=>Vi,Ux6:()=>js,rxy:()=>Ks,I$c:()=>d,kfC:()=>bs,VjY:()=>Ds,mgq:()=>Eo,YVA:()=>ki,Kgp:()=>ce,HH$:()=>O,M_d:()=>E,rgh:()=>A,Ra6:()=>$,KhR:()=>w,BS5:()=>k,xhz:()=>F,xOq:()=>S,a9j:()=>C,bHk:()=>M,CgK:()=>y,cuY:()=>T,kvE:()=>pi,SBu:()=>re,AE_:()=>Jn,ctO:()=>ts,OLH:()=>On,kky:()=>at,nSF:()=>Le,zHn:()=>mi,zwx:()=>as,AeJ:()=>Ui,hLz:()=>Pi,D9g:()=>qn,wA:()=>Yi,jhr:()=>qi,GVs:()=>xe,_zO:()=>Ft,LXZ:()=>Bt,w6$:()=>rn,mhV:()=>on,MOD:()=>Qi,kwd:()=>ln,Lmr:()=>an,xsS:()=>Ms,K5l:()=>ks,lLr:()=>be,Z$r:()=>it,IXb:()=>En,SGH:()=>Ps,SMj:()=>io,L34:()=>ko,exe:()=>Jt,bnF:()=>Mi,MFA:()=>bt,$uU:()=>We,Sap:()=>ze,jyi:()=>Wt,E03:()=>Gt,V6q:()=>Vt,rg2:()=>Xs,DVW:()=>De,nVo:()=>In,F6N:()=>Co,xP7:()=>Gn,Odq:()=>es,Zif:()=>Vn,ZGJ:()=>ai,MJk:()=>Zs,xvT:()=>Cn,PHM:()=>tn,dpR:()=>Ut,n9L:()=>Rn,KwO:()=>Ln,SxM:()=>$n,B7y:()=>Tn,x7r:()=>Js,wx7:()=>oi,Uvn:()=>hi,OFT:()=>gi,xzN:()=>jn,CcZ:()=>Hn,M5Z:()=>lt,ZrN:()=>u,OWs:()=>_t,dF9:()=>ni,oZy:()=>te,rD2:()=>ee,VHo:()=>P,ohE:()=>Ae,R$E:()=>Pe,xQN:()=>Ls,AdJ:()=>Vs,q3I:()=>is,Pab:()=>ut,uZ5:()=>dt,McK:()=>f,F9c:()=>ht,k0b:()=>Ni,hnT:()=>po,RSJ:()=>vo,Mku:()=>fo,h90:()=>yo,rms:()=>_o,ErP:()=>uo,aVg:()=>mo,lPc:()=>go,Z8E:()=>Di,_N2:()=>Yn,yFn:()=>Xn,lNv:()=>Bi,cu9:()=>Sn,MZQ:()=>Ke,FUM:()=>Ze,BxR:()=>ge,vdf:()=>mt,iaL:()=>vt,w6H:()=>ft,Q4c:()=>qe,Xxe:()=>ct,Uxb:()=>pt,Yr5:()=>gt,Bhw:()=>yt,yOA:()=>e});var t={};o.r(t),o.d(t,{ActivateEvent:()=>G,CollisionEndEvent:()=>j,CollisionPostSolveEvent:()=>H,CollisionPreSolveEvent:()=>W,CollisionStartEvent:()=>U,ContactEndEvent:()=>z,ContactStartEvent:()=>N,DeactivateEvent:()=>K,EnterTriggerEvent:()=>X,EnterViewPortEvent:()=>q,EventTypes:()=>s,ExitTriggerEvent:()=>Z,ExitViewPortEvent:()=>Y,GameEvent:()=>v,GameStartEvent:()=>x,GameStopEvent:()=>b,GamepadAxisEvent:()=>D,GamepadButtonEvent:()=>I,GamepadConnectEvent:()=>L,GamepadDisconnectEvent:()=>R,HiddenEvent:()=>B,InitializeEvent:()=>V,KillEvent:()=>_,PostCollisionEvent:()=>O,PostDebugDrawEvent:()=>E,PostDrawEvent:()=>A,PostFrameEvent:()=>$,PostKillEvent:()=>w,PostUpdateEvent:()=>k,PreCollisionEvent:()=>F,PreDebugDrawEvent:()=>S,PreDrawEvent:()=>C,PreFrameEvent:()=>M,PreKillEvent:()=>y,PreUpdateEvent:()=>T,VisibleEvent:()=>P});var e={};o.r(e),o.d(e,{getAttributeComponentSize:()=>Zt,getAttributePointerType:()=>Qt,getGlTypeSizeBytes:()=>Xt});var i={};o.r(i),o.d(i,{circle:()=>Me,line:()=>Se,point:()=>Ee,roundRect:()=>ke,vector:()=>Te});var n={};o.r(n),o.d(n,{Axes:()=>l,Buttons:()=>a,Gamepad:()=>J,Gamepads:()=>Q,KeyEvent:()=>st,Keyboard:()=>ot,Keys:()=>c,NativePointerButton:()=>Rs,PointerButton:()=>Is,PointerComponent:()=>Vi,PointerEvent:()=>js,PointerEventReceiver:()=>Ks,PointerScope:()=>d,PointerSystem:()=>bs,PointerType:()=>Ds,WheelDeltaMode:()=>Ls,WheelEvent:()=>Vs});var s,a,l,h,c,d,u={};function p(){if("undefined"==typeof window&&(window={audioContext:function(){}}),"undefined"==typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setInterval(t,1e3/60)}),"undefined"==typeof window||window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),"undefined"!=typeof window&&!window.AudioContext){if(window.webkitAudioContext){const t=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(e){return new Promise(((i,n)=>{t.call(this,e,i,n)}))}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}"undefined"==typeof window||window.devicePixelRatio||(window.devicePixelRatio=window.devicePixelRatio||1)}o.r(u),o.d(u,{ConsoleAppender:()=>et,DrawUtil:()=>i,EasingFunctions:()=>Gi,LogLevel:()=>h,Logger:()=>tt,Observable:()=>li,ScreenAppender:()=>it,addItemToArray:()=>Tt,contains:()=>Mt,delay:()=>Lt,fail:()=>$t,getPosition:()=>Et,removeItemFromArray:()=>kt}),o(4662),o(8343);class g{static useCanvasGraphicsContext(){g.enable("use-canvas-context")}static freeze(){g._FROZEN=!0}static _reset(){g._FROZEN=!1,g._FLAGS={}}static enable(t){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");g._FLAGS[t]=!0}static disable(t){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");g._FLAGS[t]=!1}static isEnabled(t){return!!g._FLAGS[t]}static show(){return Object.keys(g._FLAGS)}}function f(t,e){return{type:t,value:e}}g._FROZEN=!1,g._FLAGS={};class m{constructor(){this._paused=!1,this._listeners={},this._listenersOnce={},this._pipes=[]}clear(){this._listeners={},this._listenersOnce={},this._pipes.length=0}on(t,e){var i;return this._listeners[t]=null!==(i=this._listeners[t])&&void 0!==i?i:[],this._listeners[t].push(e),{close:()=>this.off(t,e)}}once(t,e){var i;return this._listenersOnce[t]=null!==(i=this._listenersOnce[t])&&void 0!==i?i:[],this._listenersOnce[t].push(e),{close:()=>this.off(t,e)}}off(t,e){var i,n,s,o;if(e){const r=null===(i=this._listeners[t])||void 0===i?void 0:i.indexOf(e);r>-1&&(null===(n=this._listeners[t])||void 0===n||n.splice(r,1));const a=null===(s=this._listenersOnce[t])||void 0===s?void 0:s.indexOf(e);a>-1&&(null===(o=this._listenersOnce[t])||void 0===o||o.splice(a,1))}else delete this._listeners[t]}emit(t,e){var i;if(this._paused)return;null===(i=this._listeners[t])||void 0===i||i.forEach((t=>t(e)));const n=this._listenersOnce[t];this._listenersOnce[t]=[],n&&n.forEach((t=>t(e))),this._pipes.forEach((i=>{i.emit(t,e)}))}pipe(t){if(this===t)throw Error("Cannot pipe to self");return this._pipes.push(t),{close:()=>{const e=this._pipes.indexOf(t);e>-1&&this._pipes.splice(e,1)}}}unpipe(t){const e=this._pipes.indexOf(t);e>-1&&this._pipes.splice(e,1)}pause(){this._paused=!0}unpause(){this._paused=!1}}!function(t){t.Kill="kill",t.PreKill="prekill",t.PostKill="postkill",t.PreDraw="predraw",t.PostDraw="postdraw",t.PreDebugDraw="predebugdraw",t.PostDebugDraw="postdebugdraw",t.PreUpdate="preupdate",t.PostUpdate="postupdate",t.PreFrame="preframe",t.PostFrame="postframe",t.PreCollision="precollision",t.CollisionStart="collisionstart",t.CollisionEnd="collisionend",t.PostCollision="postcollision",t.Initialize="initialize",t.Activate="activate",t.Deactivate="deactivate",t.ExitViewport="exitviewport",t.EnterViewport="enterviewport",t.ExitTrigger="exit",t.EnterTrigger="enter",t.Connect="connect",t.Disconnect="disconnect",t.Button="button",t.Axis="axis",t.Visible="visible",t.Hidden="hidden",t.Start="start",t.Stop="stop",t.PointerUp="pointerup",t.PointerDown="pointerdown",t.PointerMove="pointermove",t.PointerEnter="pointerenter",t.PointerLeave="pointerleave",t.PointerCancel="pointercancel",t.PointerWheel="pointerwheel",t.Up="up",t.Down="down",t.Move="move",t.Enter="enter",t.Leave="leave",t.Cancel="cancel",t.Wheel="wheel",t.Press="press",t.Release="release",t.Hold="hold",t.PointerDragStart="pointerdragstart",t.PointerDragEnd="pointerdragend",t.PointerDragEnter="pointerdragenter",t.PointerDragLeave="pointerdragleave",t.PointerDragMove="pointerdragmove"}(s||(s={}));class v{constructor(){this._bubbles=!0}get bubbles(){return this._bubbles}set bubbles(t){this._bubbles=t}stopPropagation(){this.bubbles=!1}}class _ extends v{constructor(t){super(),this.target=t}}class y extends v{constructor(t){super(),this.target=t}}class w extends v{constructor(t){super(),this.target=t}}class x extends v{constructor(t){super(),this.target=t}}class b extends v{constructor(t){super(),this.target=t}}class C extends v{constructor(t,e,i){super(),this.ctx=t,this.delta=e,this.target=i}}class A extends v{constructor(t,e,i){super(),this.ctx=t,this.delta=e,this.target=i}}class S extends v{constructor(t,e){super(),this.ctx=t,this.target=e}}class E extends v{constructor(t,e){super(),this.ctx=t,this.target=e}}class T extends v{constructor(t,e,i){super(),this.engine=t,this.delta=e,this.target=i}}class k extends v{constructor(t,e,i){super(),this.engine=t,this.delta=e,this.target=i}}class M extends v{constructor(t,e){super(),this.engine=t,this.prevStats=e,this.target=t}}class $ extends v{constructor(t,e){super(),this.engine=t,this.stats=e,this.target=t}}class L extends v{constructor(t,e){super(),this.index=t,this.gamepad=e,this.target=e}}class R extends v{constructor(t,e){super(),this.index=t,this.gamepad=e,this.target=e}}class I extends v{constructor(t,e,i){super(),this.button=t,this.value=e,this.target=i}}class D extends v{constructor(t,e,i){super(),this.axis=t,this.value=e,this.target=i}}class P extends v{constructor(t){super(),this.target=t}}class B extends v{constructor(t){super(),this.target=t}}class F extends v{constructor(t,e,i,n){super(),this.other=e,this.side=i,this.intersection=n,this.target=t}}class O extends v{constructor(t,e,i,n){super(),this.other=e,this.side=i,this.intersection=n,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class N{constructor(t,e,i){this.target=t,this.other=e,this.contact=i}}class z{constructor(t,e){this.target=t,this.other=e}}class W{constructor(t,e,i,n,s){this.target=t,this.other=e,this.side=i,this.intersection=n,this.contact=s}}class H{constructor(t,e,i,n,s){this.target=t,this.other=e,this.side=i,this.intersection=n,this.contact=s}}class U extends v{constructor(t,e,i){super(),this.other=e,this.contact=i,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class j extends v{constructor(t,e){super(),this.other=e,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class V extends v{constructor(t,e){super(),this.engine=t,this.target=e}}class G extends v{constructor(t,e){super(),this.context=t,this.target=e}}class K extends v{constructor(t,e){super(),this.context=t,this.target=e}}class Y extends v{constructor(t){super(),this.target=t}}class q extends v{constructor(t){super(),this.target=t}}class X extends v{constructor(t,e){super(),this.target=t,this.actor=e}}class Z extends v{constructor(t,e){super(),this.target=t,this.actor=e}}class Q{constructor(){this.events=new m,this.enabled=!1,this.supported=!!navigator.getGamepads,this._gamePadTimeStamps=[0,0,0,0],this._oldPads=[],this._pads=[],this._initSuccess=!1,this._navigator=navigator,this._minimumConfiguration=null}init(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}setMinimumGamepadConfiguration(t){this._enableAndUpdate(),this._minimumConfiguration=t}_enableAndUpdate(){this.enabled||(this.enabled=!0,this.update())}_isGamepadValid(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;const e=t.axes.filter((t=>void 0!==typeof t)).length,i=t.buttons.filter((t=>void 0!==typeof t)).length;return e>=this._minimumConfiguration.axis&&i>=this._minimumConfiguration.buttons&&t.connected}emit(t,e){this.events.emit(t,e)}on(t,e){return this._enableAndUpdate(),this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this._enableAndUpdate(),this.events.off(t,e)}update(){if(!this.enabled||!this.supported)return;this.init();const t=this._navigator.getGamepads();for(let e=0;e<t.length;e++){if(!t[e]){const t=this.at(e);t.connected&&this.events.emit("disconnect",new R(e,t)),t.connected=!1;continue}if(!this.at(e).connected&&this._isGamepadValid(t[e])&&this.events.emit("connect",new L(e,this.at(e))),this.at(e).connected=!0,this.at(e).update(),t[e].timestamp&&t[e].timestamp===this._gamePadTimeStamps[e])continue;let i,n,s,o,r;for(i in this._gamePadTimeStamps[e]=t[e].timestamp,this.at(e).navigatorGamepad=t[e],a)n=a[i],"number"==typeof n&&t[e].buttons[n]&&(r=t[e].buttons[n].value,r!==this._oldPads[e].getButton(n)&&(t[e].buttons[n].pressed?(this.at(e).updateButton(n,r),this.at(e).events.emit("button",new I(n,r,this.at(e)))):this.at(e).updateButton(n,0)));for(s in l)o=l[s],"number"==typeof o&&(r=t[e].axes[o],r!==this._oldPads[e].getAxes(o)&&(this.at(e).updateAxes(o,r),this.at(e).events.emit("axis",new D(o,r,this.at(e)))));this._oldPads[e]=this._clonePad(t[e])}}at(t){if(this._enableAndUpdate(),t>=this._pads.length)for(let e=this._pads.length-1,i=t;e<i;e++)this._pads.push(new J),this._oldPads.push(new J);return this._pads[t]}getValidGamepads(){this._enableAndUpdate();const t=[];for(let e=0;e<this._pads.length;e++)this._isGamepadValid(this.at(e).navigatorGamepad)&&this.at(e).connected&&t.push(this.at(e));return t}count(){return this._pads.filter((t=>t.connected)).length}_clonePads(t){const e=[];for(let i=0,n=t.length;i<n;i++)e.push(this._clonePad(t[i]));return e}_clonePad(t){let e,i;const n=new J;if(!t)return n;for(e=0,i=t.buttons.length;e<i;e++)t.buttons[e]&&n.updateButton(e,t.buttons[e].value);for(e=0,i=t.axes.length;e<i;e++)n.updateAxes(e,t.axes[e]);return n}}Q.MinAxisMoveThreshold=.05;class J{constructor(){this.events=new m,this.connected=!1,this._axes=new Array(4),this._buttons=new Array(16),this._buttonsUp=new Array(16),this._buttonsDown=new Array(16);for(let t=0;t<this._buttons.length;t++)this._buttons[t]=0;for(let t=0;t<this._axes.length;t++)this._axes[t]=0}update(){this._buttonsDown=new Array(16),this._buttonsUp=new Array(16)}isButtonPressed(t,e=1){return this._buttons[t]>=e}isButtonHeld(t,e=1){return this._buttons[t]>=e}wasButtonPressed(t,e=1){return this._buttonsDown[t]>=e}wasButtonReleased(t){return Boolean(this._buttonsUp[t])}getButton(t){return this._buttons[t]}getAxes(t){const e=this._axes[t];return Math.abs(e)<Q.MinAxisMoveThreshold?0:e}updateButton(t,e){0===e&&this._buttons[t]?this._buttonsUp[t]=1:this._buttonsDown[t]=e,this._buttons[t]=e}updateAxes(t,e){this._axes[t]=e}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}}!function(t){t[t.Face1=0]="Face1",t[t.Face2=1]="Face2",t[t.Face3=2]="Face3",t[t.Face4=3]="Face4",t[t.LeftBumper=4]="LeftBumper",t[t.RightBumper=5]="RightBumper",t[t.LeftTrigger=6]="LeftTrigger",t[t.RightTrigger=7]="RightTrigger",t[t.Select=8]="Select",t[t.Start=9]="Start",t[t.LeftStick=10]="LeftStick",t[t.RightStick=11]="RightStick",t[t.DpadUp=12]="DpadUp",t[t.DpadDown=13]="DpadDown",t[t.DpadLeft=14]="DpadLeft",t[t.DpadRight=15]="DpadRight"}(a||(a={})),function(t){t[t.LeftStickX=0]="LeftStickX",t[t.LeftStickY=1]="LeftStickY",t[t.RightStickX=2]="RightStickX",t[t.RightStickY=3]="RightStickY"}(l||(l={})),function(t){t[t.Debug=0]="Debug",t[t.Info=1]="Info",t[t.Warn=2]="Warn",t[t.Error=3]="Error",t[t.Fatal=4]="Fatal"}(h||(h={}));class tt{constructor(){if(this._appenders=[],this.defaultLevel=h.Info,tt._INSTANCE)throw new Error("Logger is a singleton");return tt._INSTANCE=this,tt._INSTANCE.addAppender(new et),tt._INSTANCE}static getInstance(){return null==tt._INSTANCE&&(tt._INSTANCE=new tt),tt._INSTANCE}addAppender(t){this._appenders.push(t)}clearAppenders(){this._appenders.length=0}_log(t,e){null==t&&(t=this.defaultLevel);const i=this._appenders.length;for(let n=0;n<i;n++)t>=this.defaultLevel&&this._appenders[n].log(t,e)}debug(...t){this._log(h.Debug,t)}info(...t){this._log(h.Info,t)}warn(...t){this._log(h.Warn,t)}error(...t){this._log(h.Error,t)}fatal(...t){this._log(h.Fatal,t)}}tt._INSTANCE=null;class et{log(t,e){if(!console&&!console.log&&console.warn&&console.error)return;const i=[];i.unshift.apply(i,e),i.unshift("["+h[t]+"] : "),t<h.Warn?console.log.apply?console.log.apply(console,i):console.log(i.join(" ")):t<h.Error?console.warn.apply?console.warn.apply(console,i):console.warn(i.join(" ")):console.error.apply?console.error.apply(console,i):console.error(i.join(" "))}}class it{constructor(t,e){this._messages=[],this._canvas=document.createElement("canvas"),this._canvas.width=t||window.innerWidth,this._canvas.height=e||window.innerHeight,this._canvas.style.position="absolute",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas)}log(t,e){const i=e.join(",");this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._messages.unshift("["+h[t]+"] : "+i);let n=10,s=1;for(let t=0;t<this._messages.length;t++)this._ctx.fillStyle="rgba(255,255,255,"+s.toFixed(2)+")",this._ctx.fillText(this._messages[t],200,n),n+=10,s=s>0?s-.05:0}}function nt(){try{const t=()=>{};window.top.addEventListener("blur",t),window.top.removeEventListener("blur",t)}catch(t){return!0}return!1}!function(t){t.Num0="Numpad0",t.Num1="Numpad1",t.Num2="Numpad2",t.Num3="Numpad3",t.Num4="Numpad4",t.Num5="Numpad5",t.Num6="Numpad6",t.Num7="Numpad7",t.Num8="Numpad8",t.Num9="Numpad9",t.NumAdd="NumpadAdd",t.NumSubtract="NumpadSubtract",t.NumMultiply="NumpadMultiply",t.NumDivide="NumpadDivide",t.NumDecimal="NumpadDecimal",t.Numpad0="Numpad0",t.Numpad1="Numpad1",t.Numpad2="Numpad2",t.Numpad3="Numpad3",t.Numpad4="Numpad4",t.Numpad5="Numpad5",t.Numpad6="Numpad6",t.Numpad7="Numpad7",t.Numpad8="Numpad8",t.Numpad9="Numpad9",t.NumpadAdd="NumpadAdd",t.NumpadSubtract="NumpadSubtract",t.NumpadMultiply="NumpadMultiply",t.NumpadDivide="NumpadDivide",t.NumpadDecimal="NumpadDecimal",t.NumLock="NumLock",t.ShiftLeft="ShiftLeft",t.ShiftRight="ShiftRight",t.AltLeft="AltLeft",t.AltRight="AltRight",t.ControlLeft="ControlLeft",t.ControlRight="ControlRight",t.MetaLeft="MetaLeft",t.MetaRight="MetaRight",t.Key0="Digit0",t.Key1="Digit1",t.Key2="Digit2",t.Key3="Digit3",t.Key4="Digit4",t.Key5="Digit5",t.Key6="Digit6",t.Key7="Digit7",t.Key8="Digit8",t.Key9="Digit9",t.Digit0="Digit0",t.Digit1="Digit1",t.Digit2="Digit2",t.Digit3="Digit3",t.Digit4="Digit4",t.Digit5="Digit5",t.Digit6="Digit6",t.Digit7="Digit7",t.Digit8="Digit8",t.Digit9="Digit9",t.F1="F1",t.F2="F2",t.F3="F3",t.F4="F4",t.F5="F5",t.F6="F6",t.F7="F7",t.F8="F8",t.F9="F9",t.F10="F10",t.F11="F11",t.F12="F12",t.A="KeyA",t.B="KeyB",t.C="KeyC",t.D="KeyD",t.E="KeyE",t.F="KeyF",t.G="KeyG",t.H="KeyH",t.I="KeyI",t.J="KeyJ",t.K="KeyK",t.L="KeyL",t.M="KeyM",t.N="KeyN",t.O="KeyO",t.P="KeyP",t.Q="KeyQ",t.R="KeyR",t.S="KeyS",t.T="KeyT",t.U="KeyU",t.V="KeyV",t.W="KeyW",t.X="KeyX",t.Y="KeyY",t.Z="KeyZ",t.KeyA="KeyA",t.KeyB="KeyB",t.KeyC="KeyC",t.KeyD="KeyD",t.KeyE="KeyE",t.KeyF="KeyF",t.KeyG="KeyG",t.KeyH="KeyH",t.KeyI="KeyI",t.KeyJ="KeyJ",t.KeyK="KeyK",t.KeyL="KeyL",t.KeyM="KeyM",t.KeyN="KeyN",t.KeyO="KeyO",t.KeyP="KeyP",t.KeyQ="KeyQ",t.KeyR="KeyR",t.KeyS="KeyS",t.KeyT="KeyT",t.KeyU="KeyU",t.KeyV="KeyV",t.KeyW="KeyW",t.KeyX="KeyX",t.KeyY="KeyY",t.KeyZ="KeyZ",t.Semicolon="Semicolon",t.Quote="Quote",t.Comma="Comma",t.Minus="Minus",t.Period="Period",t.Slash="Slash",t.Equal="Equal",t.BracketLeft="BracketLeft",t.Backslash="Backslash",t.BracketRight="BracketRight",t.Backquote="Backquote",t.Up="ArrowUp",t.Down="ArrowDown",t.Left="ArrowLeft",t.Right="ArrowRight",t.ArrowUp="ArrowUp",t.ArrowDown="ArrowDown",t.ArrowLeft="ArrowLeft",t.ArrowRight="ArrowRight",t.Space="Space",t.Backspace="Backspace",t.Delete="Delete",t.Esc="Escape",t.Escape="Escape",t.Enter="Enter",t.NumpadEnter="NumpadEnter",t.ContextMenu="ContextMenu"}(c||(c={}));class st extends v{constructor(t,e,i){super(),this.key=t,this.value=e,this.originalEvent=i}}class ot{constructor(){this.events=new m,this._keys=[],this._keysUp=[],this._keysDown=[],this._releaseAllKeys=t=>{for(const e of this._keys){const i=new st(e,t.key,t);this.events.emit("up",i),this.events.emit("release",i)}this._keysUp=Array.from(new Set(this._keys.concat(this._keysUp))),this._keys.length=0},this._handleKeyDown=t=>{t.metaKey||!this._keys.includes(c.MetaLeft)&&!this._keys.includes(c.MetaRight)||this._releaseAllKeys(t);const e=t.code;if(-1===this._keys.indexOf(e)){this._keys.push(e),this._keysDown.push(e);const i=new st(e,t.key,t);this.events.emit("down",i),this.events.emit("press",i)}},this._handleKeyUp=t=>{const e=t.code,i=this._keys.indexOf(e);this._keys.splice(i,1),this._keysUp.push(e);const n=new st(e,t.key,t);this.events.emit("up",n),this.events.emit("release",n),"Meta"===t.key&&this._releaseAllKeys(t)}}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}init(t){let{global:e}=t;const{grabWindowFocus:i}=t;e||(nt()?(e=window,i&&window.focus(),tt.getInstance().warn("Excalibur might be in a cross-origin iframe, in order to receive keyboard events it must be in focus")):e=window.top),e.addEventListener("blur",(()=>{this._keys.length=0})),e.addEventListener("keyup",this._handleKeyUp),e.addEventListener("keydown",this._handleKeyDown)}update(){this._keysDown.length=0,this._keysUp.length=0;for(let t=0;t<this._keys.length;t++)this.events.emit("hold",new st(this._keys[t]))}getKeys(){return this._keys}wasPressed(t){return this._keysDown.indexOf(t)>-1}isHeld(t){return this._keys.indexOf(t)>-1}wasReleased(t){return this._keysUp.indexOf(t)>-1}triggerEvent(t,e,i){"down"===t&&this._handleKeyDown(new KeyboardEvent("keydown",{code:e,key:null!=i?i:null})),"up"===t&&this._handleKeyUp(new KeyboardEvent("keyup",{code:e,key:null!=i?i:null}))}}!function(t){t.Canvas="Canvas",t.Document="Document"}(d||(d={}));const rt=4294967295;class at{constructor(t){this.seed=t,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(t||Date.now())>>>0;for(let t=1;t<this._n;t++){const e=this._mt[t-1]^this._mt[t-1]>>>this._w-2;this._mt[t]=(this._f*((4294901760&e)>>>16)<<16)+this._f*(65535&e)+t>>>0}this._index=this._n}_twist(){const t=[0,this._a];let e=0,i=0;for(;i<this._n-this._m;i++)e=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+this._m]^e>>>1^t[1&e]&rt;for(;i<this._n-1;i++)e=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+(this._m-this._n)]^e>>>1^t[1&e]&rt;e=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^e>>>1^t[1&e]&rt,this._index=0}nextInt(){this._index>=this._n&&this._twist();let t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,t^=t>>>this._l,t>>>0}next(){return this.nextInt()*(1/4294967296)}floating(t,e){return(e-t)*this.next()+t}integer(t,e){return Math.floor((e-t+1)*this.next()+t)}bool(t=.5){return this.next()<=t}pickOne(t){return t[this.integer(0,t.length-1)]}pickSet(t,e,i=!1){return i?this._pickSetWithDuplicates(t,e):this._pickSetWithoutDuplicates(t,e)}_pickSetWithoutDuplicates(t,e){if(e>t.length||e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(e===t.length)return t;const i=new Array(e);let n=0;const s=t.slice(0);for(;n<e;){const t=this.integer(0,s.length-1);i[n++]=s[t],s.splice(t,1)}return i}_pickSetWithDuplicates(t,e){if(e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");const i=new Array(e);for(let n=0;n<e;n++)i[n]=this.pickOne(t);return i}shuffle(t){const e=t.slice(0);let i=null;for(let t=0;t<e.length-2;t++){const n=this.integer(t,e.length-1);i=e[t],e[t]=e[n],e[n]=i}return e}range(t,e,i){const n=new Array(t);for(let s=0;s<t;s++)n[s]=this.integer(e,i);return n}d4(){return this.integer(1,4)}d6(){return this.integer(1,6)}d8(){return this.integer(1,8)}d10(){return this.integer(1,10)}d12(){return this.integer(1,12)}d20(){return this.integer(1,20)}}const lt=2*Math.PI;function ht(t){return t>=0?t-Math.floor(t):t-Math.ceil(t)}function ct(t){return 0===t?0:t<0?-1:1}function dt(t,e,i){return Math.min(Math.max(e,t),i)}function ut(t){let e=t;if(t>lt)for(;e>lt;)e-=lt;if(t<0)for(;e<0;)e+=lt;return e}function pt(t){return 180/Math.PI*t}function gt(t){return t/180*Math.PI}const ft=(t,e)=>Array.from(new Array(e-t+1),((e,i)=>i+t));function mt(t,e,i=new at){return i?i.floating(t,e):t+Math.random()*(e-t)}function vt(t,e,i=new at){return i?i.integer(t,e):Math.round(mt(t,e))}class _t{static get Zero(){return new _t(0,0)}static get One(){return new _t(1,1)}static get Half(){return new _t(.5,.5)}static get Up(){return new _t(0,-1)}static get Down(){return new _t(0,1)}static get Left(){return new _t(-1,0)}static get Right(){return new _t(1,0)}static fromAngle(t){return new _t(Math.cos(t),Math.sin(t))}static isValid(t){return null!=t&&!isNaN(t.x)&&!isNaN(t.y)&&t.x!==1/0&&t.y!==1/0&&t.x!==-1/0&&t.y!==-1/0}static distance(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}static min(t,e){return new _t(Math.min(t.x,e.x),Math.min(t.y,e.y))}static max(t,e){return new _t(Math.max(t.x,e.x),Math.max(t.y,e.y))}constructor(t,e){this._x=0,this._y=0,this._x=t,this._y=e}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}setTo(t,e){this.x=t,this.y=e}equals(t,e=.001){return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e}distance(t){if(!t)return Math.sqrt(this.x*this.x+this.y*this.y);const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}squareDistance(t){t||(t=_t.Zero);const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}clampMagnitude(t){const e=dt(this.size,0,t);return this.size=e,this}get size(){return this.distance()}set size(t){const e=this.normalize().scale(t);this.setTo(e.x,e.y)}normalize(){const t=this.distance();return t>0?new _t(this.x/t,this.y/t):new _t(0,1)}average(t){return this.add(t).scale(.5)}scale(t,e){const i=e||new _t(0,0);return t instanceof _t?(i.x=this.x*t.x,i.y=this.y*t.y):(i.x=this.x*t,i.y=this.y*t),i}add(t,e){return e?(e.x=this.x+t.x,e.y=this.y+t.y,e):new _t(this.x+t.x,this.y+t.y)}sub(t){return new _t(this.x-t.x,this.y-t.y)}addEqual(t){return this.setTo(this.x+t.x,this.y+t.y),this}subEqual(t){return this.setTo(this.x-t.x,this.y-t.y),this}scaleEqual(t){return this.setTo(this.x*t,this.y*t),this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return t instanceof _t?this.x*t.y-this.y*t.x:"number"==typeof t?new _t(t*this.y,-t*this.x):void 0}static cross(t,e){return new _t(-t*e.y,t*e.x)}perpendicular(){return new _t(this.y,-this.x)}normal(){return this.perpendicular().normalize()}negate(){return this.scale(-1)}toAngle(){return Math.atan2(this.y,this.x)}rotate(t,e){e||(e=new _t(0,0));const i=Math.sin(t),n=Math.cos(t),s=n*(this.x-e.x)-i*(this.y-e.y)+e.x,o=i*(this.x-e.x)+n*(this.y-e.y)+e.y;return new _t(s,o)}clone(t){const e=null!=t?t:new _t(0,0);return e.x=this.x,e.y=this.y,e}toString(t){return t?`(${this.x.toFixed(t)}, ${this.y.toFixed(t)})`:`(${this.x}, ${this.y})`}}function yt(t,e){return new _t(t,e)}class wt{constructor(t,e,i,n){this.r=t,this.g=e,this.b=i,this.a=null!=n?n:1}static fromRGB(t,e,i,n){return new wt(t,e,i,n)}static fromRGBString(t){let e=null;if(e=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i)){const t=parseInt(e[1],10),i=parseInt(e[2],10),n=parseInt(e[3],10);let s=1;return e[4]&&(s=parseFloat(e[4])),new wt(t,i,n,s)}throw new Error("Invalid rgb/a string: "+t)}static fromHex(t){let e=null;if(e=t.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){const t=parseInt(e[1],16),i=parseInt(e[2],16),n=parseInt(e[3],16);let s=1;return e[4]&&(s=parseInt(e[4],16)/255),new wt(t,i,n,s)}throw new Error("Invalid hex string: "+t)}static fromHSL(t,e,i,n=1){return new xt(t,e,i,n).toRGBA()}lighten(t=.1){const e=xt.fromRGBA(this.r,this.g,this.b,this.a);return e.l+=(1-e.l)*t,e.toRGBA()}darken(t=.1){const e=xt.fromRGBA(this.r,this.g,this.b,this.a);return e.l-=e.l*t,e.toRGBA()}saturate(t=.1){const e=xt.fromRGBA(this.r,this.g,this.b,this.a);return e.s+=e.s*t,e.toRGBA()}desaturate(t=.1){const e=xt.fromRGBA(this.r,this.g,this.b,this.a);return e.s-=e.s*t,e.toRGBA()}multiply(t){const e=t.r/255*this.r/255*255,i=t.g/255*this.g/255*255,n=t.b/255*this.b/255*255,s=t.a*this.a;return new wt(e,i,n,s)}screen(t){const e=t.invert(),i=t.invert();return e.multiply(i).invert()}invert(){return new wt(255-this.r,255-this.g,255-this.b,1-this.a)}average(t){const e=(t.r+this.r)/2,i=(t.g+this.g)/2,n=(t.b+this.b)/2,s=(t.a+this.a)/2;return new wt(e,i,n,s)}equal(t){return this.toString()===t.toString()}toString(t="rgb"){switch(t){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}_componentToHex(t){const e=t.toString(16);return 1===e.length?"0"+e:e}toHex(){return"#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b)}toRGBA(){const t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return void 0!==this.a||null!==this.a?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}toHSLA(){return xt.fromRGBA(this.r,this.g,this.b,this.a).toString()}fillStyle(){return this.toString()}clone(){return new wt(this.r,this.g,this.b,this.a)}static get Black(){return wt.fromHex("#000000")}static get White(){return wt.fromHex("#FFFFFF")}static get Gray(){return wt.fromHex("#808080")}static get LightGray(){return wt.fromHex("#D3D3D3")}static get DarkGray(){return wt.fromHex("#A9A9A9")}static get Yellow(){return wt.fromHex("#FFFF00")}static get Orange(){return wt.fromHex("#FFA500")}static get Red(){return wt.fromHex("#FF0000")}static get Vermilion(){return wt.fromHex("#FF5B31")}static get Rose(){return wt.fromHex("#FF007F")}static get Magenta(){return wt.fromHex("#FF00FF")}static get Violet(){return wt.fromHex("#7F00FF")}static get Blue(){return wt.fromHex("#0000FF")}static get Azure(){return wt.fromHex("#007FFF")}static get Cyan(){return wt.fromHex("#00FFFF")}static get Viridian(){return wt.fromHex("#59978F")}static get Green(){return wt.fromHex("#00FF00")}static get Chartreuse(){return wt.fromHex("#7FFF00")}static get Transparent(){return wt.fromHex("#FFFFFF00")}static get ExcaliburBlue(){return wt.fromHex("#176BAA")}}class xt{constructor(t,e,i,n){this.h=t,this.s=e,this.l=i,this.a=n}static hue2rgb(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}static fromRGBA(t,e,i,n){t/=255,e/=255,i/=255;const s=Math.max(t,e,i),o=Math.min(t,e,i);let r,a;const l=(s+o)/2;if(s===o)r=a=0;else{const n=s-o;switch(a=l>.5?n/(2-s-o):n/(s+o),s){case t:r=(e-i)/n+(e<i?6:0);break;case e:r=(i-t)/n+2;break;case i:r=(t-e)/n+4}r/=6}return new xt(r,a,l,n)}toRGBA(){let t,e,i;if(0===this.s)t=e=i=this.l;else{const n=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,s=2*this.l-n;t=xt.hue2rgb(s,n,this.h+1/3),e=xt.hue2rgb(s,n,this.h),i=xt.hue2rgb(s,n,this.h-1/3)}return new wt(255*t,255*e,255*i,this.a)}toString(){return`hsla(${this.h.toFixed(0)}, ${this.s.toFixed(0)}, ${this.l.toFixed(0)}, ${this.a.toFixed(0)})`}}var bt,Ct;!function(t){t.None="None",t.Top="Top",t.Bottom="Bottom",t.Left="Left",t.Right="Right"}(bt||(bt={})),function(t){t.getOpposite=function(e){return e===t.Top?t.Bottom:e===t.Bottom?t.Top:e===t.Left?t.Right:e===t.Right?t.Left:t.None},t.fromDirection=function(e){const i=[_t.Left,_t.Right,_t.Up,_t.Down],n=[t.Left,t.Right,t.Top,t.Bottom];let s=-Number.MAX_VALUE,o=-1;for(let t=0;t<i.length;t++)i[t].dot(e)>s&&(s=i[t].dot(e),o=t);return n[o]}}(bt||(bt={}));class At{constructor(t=0,e=0,i=0,n=0){"object"==typeof t?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):"number"==typeof t&&(this.left=t,this.top=e,this.right=i,this.bottom=n)}clone(){return new At(this.left,this.top,this.right,this.bottom)}static getSideFromIntersection(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?bt.Right:bt.Left:t.y<0?bt.Bottom:bt.Top:bt.None}static fromPoints(t){let e=1/0,i=1/0,n=-1/0,s=-1/0;for(let o=0;o<t.length;o++)t[o].x<e&&(e=t[o].x),t[o].x>n&&(n=t[o].x),t[o].y<i&&(i=t[o].y),t[o].y>s&&(s=t[o].y);return new At(e,i,n,s)}static fromDimension(t,e,i=_t.Half,n=_t.Zero){return new At(-t*i.x+n.x,-e*i.y+n.y,t-t*i.x+n.x,e-e*i.y+n.y)}get width(){return this.right-this.left}get height(){return this.bottom-this.top}hasZeroDimensions(){return 0===this.width||0===this.height}get center(){return new _t((this.left+this.right)/2,(this.top+this.bottom)/2)}translate(t){return new At(this.left+t.x,this.top+t.y,this.right+t.x,this.bottom+t.y)}rotate(t,e=_t.Zero){const i=this.getPoints().map((i=>i.rotate(t,e)));return At.fromPoints(i)}scale(t,e=_t.Zero){const i=this.translate(e);return new At(i.left*t.x,i.top*t.y,i.right*t.x,i.bottom*t.y)}transform(t){const e=t.data[0]*this.left,i=t.data[1]*this.left,n=t.data[0]*this.right,s=t.data[1]*this.right,o=t.data[2]*this.top,r=t.data[3]*this.top,a=t.data[2]*this.bottom,l=t.data[3]*this.bottom,h=t.getPosition(),c=Math.min(e,n)+Math.min(o,a)+h.x,d=Math.min(i,s)+Math.min(r,l)+h.y,u=Math.max(e,n)+Math.max(o,a)+h.x,p=Math.max(i,s)+Math.max(r,l)+h.y;return new At({left:c,top:d,right:u,bottom:p})}getPerimeter(){return 2*(this.width+this.height)}getPoints(){const t=[];return t.push(new _t(this.left,this.top)),t.push(new _t(this.right,this.top)),t.push(new _t(this.right,this.bottom)),t.push(new _t(this.left,this.bottom)),t}rayCast(t,e=1/0){let i=-1/0,n=1/0;const s=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,o=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,r=(this.left-t.pos.x)*s,a=(this.right-t.pos.x)*s;i=Math.min(r,a),n=Math.max(r,a);const l=(this.top-t.pos.y)*o,h=(this.bottom-t.pos.y)*o;return i=Math.max(i,Math.min(l,h)),n=Math.min(n,Math.max(l,h)),n>=Math.max(0,i)&&i<e}rayCastTime(t,e=1/0){let i=-1/0,n=1/0;const s=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,o=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,r=(this.left-t.pos.x)*s,a=(this.right-t.pos.x)*s;i=Math.min(r,a),n=Math.max(r,a);const l=(this.top-t.pos.y)*o,h=(this.bottom-t.pos.y)*o;return i=Math.max(i,Math.min(l,h)),n=Math.min(n,Math.max(l,h)),n>=Math.max(0,i)&&i<e?i:-1}contains(t){return t instanceof _t?this.left<=t.x&&this.top<=t.y&&this.bottom>=t.y&&this.right>=t.x:t instanceof At&&this.left<=t.left&&this.top<=t.top&&t.bottom<=this.bottom&&t.right<=this.right}combine(t){return new At(Math.min(this.left,t.left),Math.min(this.top,t.top),Math.max(this.right,t.right),Math.max(this.bottom,t.bottom))}get dimensions(){return new _t(this.width,this.height)}overlaps(t,e){const i=e||0;if(t.hasZeroDimensions())return this.contains(t);if(this.hasZeroDimensions())return t.contains(this);const n=this.combine(t);return n.width+i<t.width+this.width&&n.height+i<t.height+this.height}intersect(t){const e=this.combine(t);if(e.width<t.width+this.width&&e.height<t.height+this.height&&!e.dimensions.equals(t.dimensions)&&!e.dimensions.equals(this.dimensions)){let e=0;e=this.right>=t.left&&this.right<=t.right?t.left-this.right:t.right-this.left;let i=0;return i=this.top<=t.bottom&&this.top>=t.top?t.bottom-this.top:t.top-this.bottom,Math.abs(e)<Math.abs(i)?new _t(e,0):new _t(0,i)}if(e.dimensions.equals(t.dimensions)||e.dimensions.equals(this.dimensions)){let e=0;e=this.width-t.width>=0?this.right-t.right<=t.left-this.left?t.left-this.right:t.right-this.left:t.right-this.right<=this.left-t.left?this.left-t.right:this.right-t.left;let i=0;return i=this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?t.top-this.bottom:t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?this.top-t.bottom:this.bottom-t.top,Math.abs(e)<Math.abs(i)?new _t(e,0):new _t(0,i)}return null}intersectWithSide(t){const e=this.intersect(t);return At.getSideFromIntersection(e)}draw(t,e=wt.Yellow){t.debug.drawRect(this.left,this.top,this.width,this.height,{color:e})}}class St{constructor(){this._isCompleted=!1,this.promise=new Promise(((t,e)=>{this._resolver=t,this._rejecter=e}))}get isCompleted(){return this._isCompleted}resolve(t){this._isCompleted||(this._isCompleted=!0,this._resolver(t))}reject(t){this._isCompleted||(this._isCompleted=!0,this._rejecter(t))}}function Et(t){let e=0,i=0;const n=t=>{e+=t.offsetLeft,t.offsetParent&&n(t.offsetParent)},s=t=>{i+=t.offsetTop,t.offsetParent&&s(t.offsetParent)};return n(t),s(t),new _t(e,i)}function Tt(t,e){return-1===e.indexOf(t)&&(e.push(t),!0)}function kt(t,e){let i=-1;return(i=e.indexOf(t))>-1&&(e.splice(i,1),!0)}function Mt(t,e){for(let i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}function $t(t){throw new Error(t)}function Lt(t,e){var i;const n=new St;return(null!==(i=null==e?void 0:e.schedule.bind(e))&&void 0!==i?i:setTimeout)((()=>{n.resolve()}),t),n.promise}!function(t){t[t.X=12]="X",t[t.Y=13]="Y"}(Ct||(Ct={}));class Rt{constructor(){this.data=new Float32Array(16),this._scaleX=1,this._scaleSignX=1,this._scaleY=1,this._scaleSignY=1}static ortho(t,e,i,n,s,o){const r=new Rt;return r.data[0]=2/(e-t),r.data[1]=0,r.data[2]=0,r.data[3]=0,r.data[4]=0,r.data[5]=2/(n-i),r.data[6]=0,r.data[7]=0,r.data[8]=0,r.data[9]=0,r.data[10]=-2/(o-s),r.data[11]=0,r.data[12]=-(e+t)/(e-t),r.data[13]=-(n+i)/(n-i),r.data[14]=-(o+s)/(o-s),r.data[15]=1,r}clone(t){const e=t||new Rt;return e.data[0]=this.data[0],e.data[1]=this.data[1],e.data[2]=this.data[2],e.data[3]=this.data[3],e.data[4]=this.data[4],e.data[5]=this.data[5],e.data[6]=this.data[6],e.data[7]=this.data[7],e.data[8]=this.data[8],e.data[9]=this.data[9],e.data[10]=this.data[10],e.data[11]=this.data[11],e.data[12]=this.data[12],e.data[13]=this.data[13],e.data[14]=this.data[14],e.data[15]=this.data[15],e}toDOMMatrix(){return new DOMMatrix([...this.data])}static fromFloat32Array(t){const e=new Rt;return e.data=t,e}static identity(){const t=new Rt;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}static translation(t,e){const i=Rt.identity();return i.data[12]=t,i.data[13]=e,i}static scale(t,e){const i=Rt.identity();return i.data[0]=t,i.data[5]=e,i.data[10]=1,i.data[15]=1,i}static rotation(t){const e=Rt.identity();return e.data[0]=Math.cos(t),e.data[4]=-Math.sin(t),e.data[1]=Math.sin(t),e.data[5]=Math.cos(t),e}multiply(t,e){if(t instanceof _t){const i=e||new _t(0,0),n=t,s=n.x*this.data[0]+n.y*this.data[4]+this.data[12],o=n.x*this.data[1]+n.y*this.data[5]+this.data[13];return i.x=s,i.y=o,i}{const i=e||new Rt,n=t,s=this.data[0],o=this.data[1],r=this.data[2],a=this.data[3],l=this.data[4],h=this.data[5],c=this.data[6],d=this.data[7],u=this.data[8],p=this.data[9],g=this.data[10],f=this.data[11],m=this.data[12],v=this.data[13],_=this.data[14],y=this.data[15],w=n.data[0],x=n.data[1],b=n.data[2],C=n.data[3],A=n.data[4],S=n.data[5],E=n.data[6],T=n.data[7],k=n.data[8],M=n.data[9],$=n.data[10],L=n.data[11],R=n.data[12],I=n.data[13],D=n.data[14],P=n.data[15];i.data[0]=s*w+l*x+u*b+m*C,i.data[1]=o*w+h*x+p*b+v*C,i.data[2]=r*w+c*x+g*b+_*C,i.data[3]=a*w+d*x+f*b+y*C,i.data[4]=s*A+l*S+u*E+m*T,i.data[5]=o*A+h*S+p*E+v*T,i.data[6]=r*A+c*S+g*E+_*T,i.data[7]=a*A+d*S+f*E+y*T,i.data[8]=s*k+l*M+u*$+m*L,i.data[9]=o*k+h*M+p*$+v*L,i.data[10]=r*k+c*M+g*$+_*L,i.data[11]=a*k+d*M+f*$+y*L,i.data[12]=s*R+l*I+u*D+m*P,i.data[13]=o*R+h*I+p*D+v*P,i.data[14]=r*R+c*I+g*D+_*P,i.data[15]=a*R+d*I+f*D+y*P;const B=this.getScale();return i._scaleSignX=ct(B.x)*ct(i._scaleSignX),i._scaleSignY=ct(B.y)*ct(i._scaleSignY),i}}translate(t,e){const i=this.data[0],n=this.data[1],s=this.data[2],o=this.data[3],r=this.data[4],a=this.data[5],l=this.data[6],h=this.data[7],c=this.data[8],d=this.data[9],u=this.data[10],p=this.data[11],g=this.data[12],f=this.data[13],m=this.data[14],v=this.data[15];return this.data[12]=i*t+r*e+0*c+1*g,this.data[13]=n*t+a*e+0*d+1*f,this.data[14]=s*t+l*e+0*u+1*m,this.data[15]=o*t+h*e+0*p+1*v,this}setPosition(t,e){this.data[12]=t,this.data[13]=e}getPosition(){return yt(this.data[12],this.data[13])}rotate(t){const e=this.data[0],i=this.data[1],n=this.data[2],s=this.data[3],o=this.data[4],r=this.data[5],a=this.data[6],l=this.data[7],h=Math.sin(t),c=Math.cos(t);return this.data[0]=c*e+h*o,this.data[1]=c*i+h*r,this.data[2]=c*n+h*a,this.data[3]=c*s+h*l,this.data[4]=c*o-h*e,this.data[5]=c*r-h*i,this.data[6]=c*a-h*n,this.data[7]=c*l-h*s,this}scale(t,e){const i=this.data[0],n=this.data[1],s=this.data[2],o=this.data[3],r=this.data[4],a=this.data[5],l=this.data[6],h=this.data[7];return this.data[0]=i*t,this.data[1]=n*t,this.data[2]=s*t,this.data[3]=o*t,this.data[4]=r*e,this.data[5]=a*e,this.data[6]=l*e,this.data[7]=h*e,this}setRotation(t){const e=this.getScale(),i=Math.sin(t),n=Math.cos(t);this.data[0]=n*e.x,this.data[1]=i*e.y,this.data[4]=-i*e.x,this.data[5]=n*e.y}getRotation(){return ut(Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX()))}getScaleX(){const t=yt(this.data[0],this.data[4]).size;return this._scaleSignX*t}getScaleY(){const t=yt(this.data[1],this.data[5]).size;return this._scaleSignY*t}getScale(){return yt(this.getScaleX(),this.getScaleY())}setScaleX(t){if(this._scaleX===t)return;this._scaleSignX=ct(t);const e=yt(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[4]=e.y*t,this._scaleX=t}setScaleY(t){if(this._scaleY===t)return;this._scaleSignY=ct(t);const e=yt(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[5]=e.y*t,this._scaleY=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}getBasisDeterminant(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}getAffineInverse(t){const e=1/this.getBasisDeterminant(),i=this.data[0],n=this.data[4],s=this.data[1],o=this.data[5],r=t||Rt.identity();r.data[0]=o*e,r.data[1]=-s*e,r.data[4]=-n*e,r.data[5]=i*e;const a=this.data[12],l=this.data[13];return r.data[12]=-(a*r.data[0]+l*r.data[4]),r.data[13]=-(a*r.data[1]+l*r.data[5]),r}isIdentity(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&0===this.data[3]&&0===this.data[4]&&1===this.data[5]&&0===this.data[6]&&0===this.data[7]&&0===this.data[8]&&0===this.data[9]&&1===this.data[10]&&0===this.data[11]&&0===this.data[12]&&0===this.data[13]&&0===this.data[14]&&1===this.data[15]}toString(){return`\n[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]\n[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]\n[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]\n[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]\n`}}class It{constructor(){this.data=new Float64Array(6),this._scale=new Float64Array([1,1]),this._scaleSignX=1,this._scaleSignY=1}toDOMMatrix(){return new DOMMatrix([...this.data])}static identity(){const t=new It;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}static translation(t,e){const i=It.identity();return i.data[4]=t,i.data[5]=e,i}static scale(t,e){const i=It.identity();return i.data[0]=t,i.data[3]=e,i._scale[0]=t,i._scale[1]=e,i}static rotation(t){const e=It.identity();return e.data[0]=Math.cos(t),e.data[1]=Math.sin(t),e.data[2]=-Math.sin(t),e.data[3]=Math.cos(t),e}setPosition(t,e){this.data[4]=t,this.data[5]=e}getPosition(){return yt(this.data[4],this.data[5])}rotate(t){const e=this.data[0],i=this.data[1],n=this.data[2],s=this.data[3],o=Math.sin(t),r=Math.cos(t);return this.data[0]=r*e+o*n,this.data[1]=r*i+o*s,this.data[2]=r*n-o*e,this.data[3]=r*s-o*i,this}translate(t,e){const i=this.data[0],n=this.data[1],s=this.data[2],o=this.data[3],r=this.data[4],a=this.data[5];return this.data[4]=i*t+s*e+r,this.data[5]=n*t+o*e+a,this}scale(t,e){const i=this.data[0],n=this.data[1],s=this.data[2],o=this.data[3];return this.data[0]=i*t,this.data[1]=n*t,this.data[2]=s*e,this.data[3]=o*e,this._scale[0]=t,this._scale[1]=e,this}determinant(){return this.data[0]*this.data[3]-this.data[1]*this.data[2]}inverse(t){const e=1/this.determinant(),i=this.data[0],n=this.data[2],s=this.data[1],o=this.data[3],r=t||It.identity();r.data[0]=o*e,r.data[1]=-s*e,r.data[2]=-n*e,r.data[3]=i*e;const a=this.data[4],l=this.data[5];return r.data[4]=-(a*r.data[0]+l*r.data[2]),r.data[5]=-(a*r.data[1]+l*r.data[3]),r}multiply(t,e){if(t instanceof _t){const i=e||new _t(0,0),n=t,s=n.x*this.data[0]+n.y*this.data[2]+this.data[4],o=n.x*this.data[1]+n.y*this.data[3]+this.data[5];return i.x=s,i.y=o,i}{const i=e||new It,n=t,s=this.data[0],o=this.data[1],r=this.data[2],a=this.data[3],l=this.data[4],h=this.data[5],c=n.data[0],d=n.data[1],u=n.data[2],p=n.data[3],g=n.data[4],f=n.data[5];i.data[0]=s*c+r*d,i.data[1]=o*c+a*d,i.data[2]=s*u+r*p,i.data[3]=o*u+a*p,i.data[4]=s*g+r*f+l,i.data[5]=o*g+a*f+h;const m=this.getScale();return i._scaleSignX=ct(m.x)*ct(i._scaleSignX),i._scaleSignY=ct(m.y)*ct(i._scaleSignY),i}}to4x4(){const t=new Rt;return t.data[0]=this.data[0],t.data[1]=this.data[1],t.data[2]=0,t.data[3]=0,t.data[4]=this.data[2],t.data[5]=this.data[3],t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=this.data[4],t.data[13]=this.data[5],t.data[14]=0,t.data[15]=1,t}setRotation(t){const e=this.getScale(),i=Math.sin(t),n=Math.cos(t);this.data[0]=n*e.x,this.data[1]=i*e.y,this.data[2]=-i*e.x,this.data[3]=n*e.y}getRotation(){return ut(Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX()))}getScaleX(){const t=yt(this.data[0],this.data[2]).distance();return this._scaleSignX*t}getScaleY(){const t=yt(this.data[1],this.data[3]).distance();return this._scaleSignY*t}getScale(){return yt(this.getScaleX(),this.getScaleY())}setScaleX(t){if(t===this._scale[0])return;this._scaleSignX=ct(t);const e=yt(this.data[0]*this._scaleSignX,this.data[2]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[2]=e.y*t,this._scale[0]=t}setScaleY(t){if(t===this._scale[1])return;this._scaleSignY=ct(t);const e=yt(this.data[1]*this._scaleSignY,this.data[3]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[3]=e.y*t,this._scale[1]=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}isIdentity(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&1===this.data[3]&&0===this.data[4]&&0===this.data[5]}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}clone(t){const e=t||new It;return e.data[0]=this.data[0],e.data[1]=this.data[1],e.data[2]=this.data[2],e.data[3]=this.data[3],e.data[4]=this.data[4],e.data[5]=this.data[5],e}toString(){return`\n[${this.data[0]} ${this.data[2]} ${this.data[4]}]\n[${this.data[1]} ${this.data[3]} ${this.data[5]}]\n[0 0 1]\n`}}class Dt{constructor(){this._transforms=[],this._currentTransform=It.identity()}save(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}restore(){this._currentTransform=this._transforms.pop()}translate(t,e){return this._currentTransform.translate(t,e)}rotate(t){return this._currentTransform.rotate(t)}scale(t,e){return this._currentTransform.scale(t,e)}set current(t){this._currentTransform=t}get current(){return this._currentTransform}}class Pt{constructor(){this._states=[],this._currentState=this._getDefaultState()}_getDefaultState(){return{opacity:1,z:0,tint:wt.White,material:null}}_cloneState(){return{opacity:this._currentState.opacity,z:this._currentState.z,tint:this._currentState.tint.clone(),material:this._currentState.material}}save(){this._states.push(this._currentState),this._currentState=this._cloneState()}restore(){this._currentState=this._states.pop()}get current(){return this._currentState}set current(t){this._currentState=t}}const Bt={Complete:"complete",Load:"load",LoadStart:"loadstart",Progress:"progress",Error:"error"};class Ft{constructor(t,e,i=!1){this.path=t,this.responseType=e,this.bustCache=i,this.data=null,this.logger=tt.getInstance(),this.events=new m}isLoaded(){return null!==this.data}_cacheBust(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t}load(){return new Promise(((t,e)=>{if(null!==this.data)return this.logger.debug("Already have data for resource",this.path),this.events.emit("complete",this.data),void t(this.data);const i=new XMLHttpRequest;i.open("GET",this.bustCache?this._cacheBust(this.path):this.path,!0),i.responseType=this.responseType,i.addEventListener("loadstart",(t=>this.events.emit("loadstart",t))),i.addEventListener("progress",(t=>this.events.emit("progress",t))),i.addEventListener("error",(t=>this.events.emit("error",t))),i.addEventListener("load",(t=>this.events.emit("load",t))),i.addEventListener("load",(()=>{if(0!==i.status&&200!==i.status)return this.logger.error("Failed to load resource ",this.path," server responded with error code",i.status),this.events.emit("error",i.response),void e(new Error(i.statusText));this.data=i.response,this.events.emit("complete",this.data),this.logger.debug("Completed loading resource",this.path),t(this.data)})),i.send()}))}}function Ot(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:(t,i,n)=>(t[i]!==n&&(t[i]=n,"string"==typeof i&&"_"!==i[0]&&e(t)),!0),get:(t,e)=>"__isProxy"===e||t[e]}):t}function Nt(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:(t,i,n)=>(t[i]=n,"string"==typeof i&&"_"!==i[0]&&e(t),!0),get:(t,e)=>"__isProxy"===e||t[e]}):t}class zt{isStale(){return this._transformStale}get flipHorizontal(){return this._flipHorizontal}set flipHorizontal(t){this._flipHorizontal=t,this._transformStale=!0}get flipVertical(){return this._flipVertical}set flipVertical(t){this._flipVertical=t,this._transformStale=!0}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this._transformStale=!0}get scale(){return this._scale}set scale(t){this._scale=Ot(t,(()=>{this._transformStale=!0})),this._transformStale=!0}get origin(){return this._origin}set origin(t){this._origin=Ot(t,(()=>{this._transformStale=!0})),this._transformStale=!0}constructor(t){var e,i,n,s,o,r;this.id=zt._ID++,this.transform=It.identity(),this.tint=null,this._transformStale=!0,this.showDebug=!1,this._flipHorizontal=!1,this._flipVertical=!1,this._rotation=0,this.opacity=1,this._scale=_t.One,this._origin=null,this._width=0,this._height=0,t&&(this.origin=null!==(e=t.origin)&&void 0!==e?e:this.origin,this.flipHorizontal=null!==(i=t.flipHorizontal)&&void 0!==i?i:this.flipHorizontal,this.flipVertical=null!==(n=t.flipVertical)&&void 0!==n?n:this.flipVertical,this.rotation=null!==(s=t.rotation)&&void 0!==s?s:this.rotation,this.opacity=null!==(o=t.opacity)&&void 0!==o?o:this.opacity,this.scale=null!==(r=t.scale)&&void 0!==r?r:this.scale)}cloneGraphicOptions(){return{origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null}}get width(){return Math.abs(this._width*this.scale.x)}get height(){return Math.abs(this._height*this.scale.y)}set width(t){this._width=t,this._transformStale=!0}set height(t){this._height=t,this._transformStale=!0}get localBounds(){return At.fromDimension(this.width,this.height,_t.Zero)}draw(t,e,i){this._preDraw(t,e,i),this._drawImage(t,0,0),this._postDraw(t)}_preDraw(t,e,i){t.save(),t.translate(e,i),this._transformStale&&(this.transform.reset(),this.transform.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(this.transform),this._flip(this.transform),this._transformStale=!1),t.multiply(this.transform),t.opacity=t.opacity*this.opacity,this.tint&&(t.tint=this.tint)}_rotate(t){var e;const i=this.scale.x>0?1:-1,n=this.scale.y>0?1:-1,s=null!==(e=this.origin)&&void 0!==e?e:yt(this.width/2,this.height/2);t.translate(s.x,s.y),t.rotate(this.rotation),t.scale(i,n),t.translate(-s.x,-s.y)}_flip(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))}_postDraw(t){this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}zt._ID=0;class Wt extends zt{static from(t){return new Wt({image:t})}constructor(t){var e,i;super(t),this._logger=tt.getInstance(),this._dirty=!0,this._logNotLoadedWarning=!1,this.image=t.image;const{width:n,height:s}=t;this.sourceView=null!==(e=t.sourceView)&&void 0!==e?e:{x:0,y:0,width:null!=n?n:0,height:null!=s?s:0},this.destSize=null!==(i=t.destSize)&&void 0!==i?i:{width:null!=n?n:0,height:null!=s?s:0},this._updateSpriteDimensions(),this.image.ready.then((()=>{this._updateSpriteDimensions()}))}get width(){return Math.abs(this.destSize.width*this.scale.x)}get height(){return Math.abs(this.destSize.height*this.scale.y)}set width(t){t/=Math.abs(this.scale.x),this.destSize.width=t,super.width=Math.ceil(this.destSize.width)}set height(t){t/=Math.abs(this.scale.y),this.destSize.height=t,super.height=Math.ceil(this.destSize.height)}_updateSpriteDimensions(){var t,e,i,n,s,o;const{width:r,height:a}=this.image;this.sourceView.width=(null===(t=this.sourceView)||void 0===t?void 0:t.width)||r,this.sourceView.height=(null===(e=this.sourceView)||void 0===e?void 0:e.height)||a,this.destSize.width=(null===(i=this.destSize)||void 0===i?void 0:i.width)||(null===(n=this.sourceView)||void 0===n?void 0:n.width)||r,this.destSize.height=(null===(s=this.destSize)||void 0===s?void 0:s.height)||(null===(o=this.sourceView)||void 0===o?void 0:o.height)||a,this.width=Math.ceil(this.destSize.width)*this.scale.x,this.height=Math.ceil(this.destSize.height)*this.scale.y}_preDraw(t,e,i){this.image.isLoaded()&&this._dirty&&(this._dirty=!1,this._updateSpriteDimensions()),super._preDraw(t,e,i)}_drawImage(t,e,i){this.image.isLoaded()?t.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,e,i,this.destSize.width,this.destSize.height):(this._logNotLoadedWarning||this._logger.warn(`ImageSource ${this.image.path} is not yet loaded and won't be drawn. Please call .load() or include in a Loader.\n\nRead https://excaliburjs.com/docs/imagesource for more information.`),this._logNotLoadedWarning=!0)}clone(){return new Wt({image:this.image,sourceView:{...this.sourceView},destSize:{...this.destSize},...this.cloneGraphicOptions()})}}var Ht;!function(t){t.Pixel="Pixel",t.Blended="Blended"}(Ht||(Ht={}));class Ut{constructor(t){this._textureMap=new Map,this._gl=t,Ut._MAX_TEXTURE_SIZE=t.getParameter(t.MAX_TEXTURE_SIZE)}get(t){return this._textureMap.get(t)}has(t){return this._textureMap.has(t)}load(t,e,i=!1){const n=this._gl;if(!n)return null;let s=null;if(this.has(t)&&(s=this.get(t)),s)return i&&(n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),s;s=n.createTexture(),Ut.checkImageSizeSupportedAndLog(t),n.bindTexture(n.TEXTURE_2D,s),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);const o=null!=e?e:Ut.filtering;return n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,o===Ht.Pixel?n.NEAREST:n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,o===Ht.Pixel?n.NEAREST:n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),this._textureMap.set(t,s),s}delete(t){const e=this._gl;if(!e)return null;let i=null;this.has(t)&&(i=this.get(t),e.deleteTexture(i))}static checkImageSizeSupportedAndLog(t){var e;const i=null!==(e=t.dataset.originalSrc)&&void 0!==e?e:"internal canvas bitmap";return t.width>Ut._MAX_TEXTURE_SIZE||t.height>Ut._MAX_TEXTURE_SIZE?(Ut._LOGGER.error(`The image [${i}] provided to Excalibur is too large for the device's maximum texture size of (${Ut._MAX_TEXTURE_SIZE}x${Ut._MAX_TEXTURE_SIZE}) please resize to an image for excalibur to render properly.\n\nImages will likely render as black rectangles.\n\nRead more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!1):((t.width>4096||t.height>4096)&&Ut._LOGGER.warn(`The image [${i}] provided to excalibur is too large may not work on all mobile devices, it is recommended you resize images to a maximum (4096x4096).\n\nImages will likely render as black rectangles on some mobile platforms.\n\nRead more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!0)}}Ut._LOGGER=tt.getInstance(),Ut.filtering=Ht.Blended,Ut._MAX_TEXTURE_SIZE=4096;class jt{get width(){return this.image.naturalWidth}get height(){return this.image.naturalHeight}isLoaded(){return this._src||(this._src=this.data.src),!!this._src}get image(){return this.data}constructor(t,e=!1,i){this.path=t,this._logger=tt.getInstance(),this.data=new Image,this._readyFuture=new St,this.ready=this._readyFuture.promise,this._resource=new Ft(t,"blob",e),this.filtering=i,(t.endsWith(".svg")||t.endsWith(".gif"))&&this._logger.warn(`Image type is not fully supported, you may have mixed results ${t}. Fully supported: jpg, bmp, and png`)}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}async load(){if(this.isLoaded())return this.data;try{let t;if(this.path.includes("data:image/"))t=this.path;else{const e=await this._resource.load();t=URL.createObjectURL(e)}const e=new Image,i=new St;e.onload=()=>i.resolve(),e.src=t,e.setAttribute("data-original-src",this.path),await i.promise,this.data=e,Ut.checkImageSizeSupportedAndLog(this.data)}catch(t){throw`Error loading ImageSource from path '${this.path}' with error [${t.message}]`}return this.data.setAttribute("filtering",this.filtering),this._readyFuture.resolve(this.data),this.data}toSprite(){return Wt.from(this)}unload(){this.data=new Image}}class Vt{constructor(t){this._logger=tt.getInstance(),this.sprites=[];const{sprites:e,rows:i,columns:n}=t;this.sprites=e,this.rows=null!=i?i:1,this.columns=null!=n?n:this.sprites.length}getSprite(t,e){if(t>=this.columns||t<0)return this._logger.warn(`No sprite exists in the SpriteSheet at (${t}, ${e}), x: ${t} should be between 0 and ${this.columns-1}`),null;if(e>=this.rows||e<0)return this._logger.warn(`No sprite exists in the SpriteSheet at (${t}, ${e}), y: ${e} should be between 0 and ${this.rows-1}`),null;const i=t+e*this.columns;return this.sprites[i]}static fromImageSourceWithSourceViews(t){const e=t.sourceViews.map((e=>new Wt({image:t.image,sourceView:e})));return new Vt({sprites:e})}static fromImageSource(t){var e;const i=[];t.spacing=null!==(e=t.spacing)&&void 0!==e?e:{};const{image:n,grid:{rows:s,columns:o,spriteWidth:r,spriteHeight:a},spacing:{originOffset:l,margin:h}}=t,c={x:0,y:0,...l},d={x:0,y:0,...h};for(let t=0;t<o;t++)for(let e=0;e<s;e++)i[t+e*o]=new Wt({image:n,sourceView:{x:t*r+d.x*t+c.x,y:e*a+d.y*e+c.y,width:r,height:a},destSize:{height:a,width:r}});return new Vt({sprites:i,rows:s,columns:o})}clone(){return new Vt({sprites:this.sprites.map((t=>t.clone())),rows:this.rows,columns:this.columns})}}class Gt extends zt{constructor(t){super(t),this._text="",this.alphabet="",this.shadow=null,this.caseInsensitive=!1,this.spacing=0,this._logger=tt.getInstance(),this._alreadyWarnedAlphabet=!1,this._alreadyWarnedSpriteSheet=!1;const{alphabet:e,spriteSheet:i,caseInsensitive:n,spacing:s,shadow:o}=t;this.alphabet=e,this.spriteSheet=i,this.caseInsensitive=null!=n?n:this.caseInsensitive,this.spacing=null!=s?s:this.spacing,this.shadow=null!=o?o:this.shadow}_getCharacterSprites(t){const e=[],i=this.caseInsensitive?t.toLocaleLowerCase():t,n=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet;for(let t=0;t<i.length;t++){const s=i[t];let o=n.indexOf(s);-1===o&&(o=0,this._alreadyWarnedAlphabet||(this._logger.warn(`SpriteFont - Cannot find letter '${s}' in configured alphabet '${n}'.`),this._logger.warn("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."),this._alreadyWarnedAlphabet=!0));const r=this.spriteSheet.sprites[o];r?e.push(r):this._alreadyWarnedSpriteSheet||(this._logger.warn(`SpriteFont - Cannot find sprite for '${s}' at index '${o}' in configured SpriteSheet`),this._logger.warn("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."),this._alreadyWarnedSpriteSheet=!0)}return e}measureText(t,e){const i=this._getLinesFromText(t,e),n=i.reduce(((t,e)=>t.length>e.length?t:e)),s=this._getCharacterSprites(n);let o=0,r=0;for(const t of s)o+=t.width+this.spacing,r=Math.max(r,t.height);return At.fromDimension(o,r*i.length,_t.Zero)}_drawImage(t,e,i,n){let s=0,o=0,r=0;const a=this._getLinesFromText(this._text,n);for(const n of a){for(const a of this._getCharacterSprites(n))a.draw(t,e+s,i+o),s+=a.width+this.spacing,r=Math.max(r,a.height);s=0,o+=r}}render(t,e,i,n,s,o){this._text=e;const r=this.measureText(e,o);this.width=r.width,this.height=r.height,this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this._preDraw(t,n,s),this._drawImage(t,0,0,o),this._postDraw(t),t.restore()),this._preDraw(t,n,s),this._drawImage(t,0,0,o),this._postDraw(t)}clone(){return new Gt({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}_getLinesFromText(t,e){if(this._cachedText===t&&this._cachedRenderWidth===e)return this._cachedLines;const i=t.split("\n");if(null==e)return i;for(let t=0;t<i.length;t++){let n=i[t],s="";if(this.measureText(n).width>e){for(;this.measureText(n).width>e;)s=n[n.length-1]+s,n=n.slice(0,-1);i[t]=n,i[t+1]=s}}return this._cachedText=t,this._cachedLines=i,this._cachedRenderWidth=e,i}}class Kt{constructor(){this.fontSheet="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAwCAYAAAD+f6R/AAAAAXNSR0IArs4c6QAABcJJREFUeJztnemu7CgMhGE07//KmT9NhrAFVzkQndQntXRP3/bCZkwCSQhCCCGEEEIIIYQQQog/TRz953Ecx/nDGIe/vdNhlc9tIz605Fk/ZmWfsO1hn9Gxuv1KHbvb3iL/VN+d1WORbyr7yR/5b9M4vjNeqko6jPJHq5wGHU151o9J2Udse9hndCxuv0rH7rY3yD/Wdyf13MrnQeDfkZIUSGKM4ff3cWN82pEZuTyQGX2IxeyR63va//8VNCYCq+1yEkLtWyagXv1P1r1H+110gP3PzT4gT8uW/mdQ8mUG8E9DqOz4MS9ICKGbXpS2BpnIrRzYeS96cll08INlCMl2/glzdcfazuuPqQO03lmqrBHsf272Q6NODXj6zzZIJd/LAHYTg3Mays5gBi7ZR27fOgs0yj8rm36DLMFiPgkAdXHKOwUQeMCQ/adSh/qBQrT/tPxbAwA9+DOZEILPAATSuHMgTv7+Auk/df2lHPCZLvMSLJe34LkEQ9PwXF1SRTllMYgvIaflqyVAjLGbsiCDcOK76jflxZ+sINPyROc5071yKWK5CJTV3dMp6+tBlyCtNlhAq/+XbWoBDcRNXYBMzD4VvQygSuPYC2jGGaSSOxXfy3dTUEsanIvNeepm38N/hssSALTPZnAXfwIYRJn2b7UBcw0FKX+nDdAMpm2j9WVnxrUa7TXaVAca/B+TgaAVh6R/rH0P/5m01dt/RLYViJn+w/bhVX2P7f/duqom5qb02pRLCLGIMgBU1wCEEN9BAUCID6MAIMSHUQAQ4sMoAAjxYRQAhPgwd1uB0fuZ7H3cnn2P+9mr/Pe4B8/eB/fwP4eRtci/0f6OfTCPt/9oHwC6G6y19RHZDumxmwzR4eE/s/2Tte/q/+XLdc9DeJ19diesQc/j7Z8fCe4tAS4CxZ7sp7eiJi7HiZmjmOTGJs+93CbS3nP0XIPH3vW8/qz6QPnX2QdsV/1uw/iZYvg8ACeHd28rpPzfNfhL+7vkw/4Ou9s+Onhbv91elpKZ48Dl6bzpwwibHigRArf+Ptk9+L3Y1Q5OB4LgCeSBw1iuB3GeJh1/HrX/zF0A9Mk+u45zMkc3r4rWPomma5+p/514LB+Zo93MErJ1JHxXPzByGa/licRYVKbpeQCoQ6Q8yxuCwJF9IPsoDkHAo/3Tx26cvA4EtJ/n04w8QOq/mrR7ddfLAC5BYFNlVI/0CnOVUflOpvJUQMx9AIMIW/nWDM67/qw0+95v9goBqD9j+72u/KD9U89IbnQbMIR2Zbneh5zUY7Hdk7XIP3UffVb+r+wDYAZLq+1n1+C7y3/ny2r7p5yeByDEh9HzAIQQJwoAQnwYBQAhPowCgBBjoNu3hNxSFACE6INuKvPajPZ4EFEAEKINcybGYzOd247WEd3TgA2jlmjEyrd+j9hvfVbD2PWQ3ZmGlu2HyO8og8eBuNUvNYWoDgMVpwHTJoLWdz1Y+ZYOy5uF7t6PPruZxANrud1lQXkP0jsGz/Yz+vGGMuygFyhSPcJnc1pMnQZElc+cRnoAlxdTvoDuK7puqF7uCQy+3fyFMiA02/vJQHh7DQDogMPTSGFNA56HTzbZ9yAfBOb1Zyo3qGM3MfMZ3f76huXf6xlmAHknMlLNXsBBBvbljIz9Uyz5Y5TzIBLR/qy/rNyrZ8+L/0BZ0m+tgXD0OK5XZxC/9P7I/g4hVFvzXf1/6i5A7+3AlijMPBLMZfCvuAp7A9rY56ApHitmLQc7c8bOv6ftAxlM9Xp35nkEK7nJetBsaMhtAAAuOLQGXwhh2dXQnn1rZ/a42BI3dL7L+jkFAbQddwdA9Ah35yMKhgEgVT46EFh5D4jz+OgavNKxeBCd1wDSJ/97oR8eoJkLi9t9/BDgDHTJ5NE7Dnzechh914OVv9M1K9PCqsfqb88XVg9qN9lm6nG176UPu+zn17GOxuO0vOWEEC/j+LFKTgghlvEfYJaLS+SA2O0AAAAASUVORK5CYII=",this.size=16,this.load()}load(){return this._imageSource=new jt(this.fontSheet),this._imageSource.load().then((()=>{this._spriteSheet=Vt.fromImageSource({image:this._imageSource,grid:{rows:3,columns:16,spriteWidth:16,spriteHeight:16}}),this._spriteFont=new Gt({alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&.\"?-()+ ",caseInsensitive:!0,spriteSheet:this._spriteSheet,spacing:-6})}))}write(t,e,i){this._imageSource.isLoaded()&&this._spriteFont.render(t,e,null,i.x,i.y)}}class Yt{constructor(t,e){this._gl=t,this._texture=e}use(){const t=this._gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._texture)}disable(){const t=this._gl;t.bindTexture(t.TEXTURE_2D,null)}}class qt{constructor(t){this.width=t.width,this.height=t.height,this._gl=t.gl,this._setupFramebuffer()}setResolution(t,e){const i=this._gl;this.width=t,this.height=e,i.bindTexture(i.TEXTURE_2D,this._frameTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.width,this.height,0,i.RGBA,i.UNSIGNED_BYTE,null)}get frameBuffer(){return this._frameBuffer}get frameTexture(){return this._frameTexture}_setupFramebuffer(){const t=this._gl;this._frameTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._frameTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const e=t.COLOR_ATTACHMENT0;this._frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,e,t.TEXTURE_2D,this._frameTexture,0),this.disable()}toRenderSource(){return new Yt(this._gl,this._frameTexture)}use(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.viewport(0,0,this.width,this.height)}disable(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null)}}function Xt(t,e){switch(e){case t.FLOAT:return 4;case t.SHORT:case t.UNSIGNED_SHORT:return 2;case t.BYTE:case t.UNSIGNED_BYTE:default:return 1}}function Zt(t,e){switch(e){case t.LOW_FLOAT:case t.HIGH_FLOAT:case t.FLOAT:return 1;case t.FLOAT_VEC2:return 2;case t.FLOAT_VEC3:return 3;case t.FLOAT_VEC4:return 4;case t.BYTE:case t.UNSIGNED_BYTE:case t.UNSIGNED_SHORT:case t.SHORT:default:return 1}}function Qt(t,e){switch(e){case t.LOW_FLOAT:case t.HIGH_FLOAT:case t.FLOAT:case t.FLOAT_VEC2:case t.FLOAT_VEC3:case t.FLOAT_VEC4:return t.FLOAT;case t.BYTE:return t.BYTE;case t.UNSIGNED_BYTE:return t.UNSIGNED_BYTE;case t.SHORT:return t.SHORT;case t.UNSIGNED_SHORT:return t.UNSIGNED_SHORT;default:return t.FLOAT}}class Jt{get compiled(){return this._compiled}constructor(t){this._logger=tt.getInstance(),this.uniforms={},this.attributes={},this._compiled=!1;const{gl:e,vertexSource:i,fragmentSource:n}=t;this._gl=e,this.vertexSource=i,this.fragmentSource=n}use(){this._gl.useProgram(this.program),Jt._ACTIVE_SHADER_INSTANCE=this}isCurrentlyBound(){return Jt._ACTIVE_SHADER_INSTANCE===this}compile(){const t=this._gl,e=this._compileShader(t,this.vertexSource,t.VERTEX_SHADER),i=this._compileShader(t,this.fragmentSource,t.FRAGMENT_SHADER);this.program=this._createProgram(t,e,i);const n=this.getAttributes();for(const t of n)this.attributes[t.name]=t;const s=this.getUniforms();for(const t of s)this.uniforms[t.name]=t;return this._compiled=!0,this.program}getUniforms(){const t=this._gl,e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),i=[];for(let n=0;n<e;n++){const e=t.getActiveUniform(this.program,n),s=t.getUniformLocation(this.program,e.name);i.push({name:e.name,glType:e.type,location:s})}return i}getAttributes(){const t=this._gl,e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),i=[];for(let n=0;n<e;n++){const e=t.getActiveAttrib(this.program,n),s=t.getAttribLocation(this.program,e.name);i.push({name:e.name,glType:Qt(t,e.type),size:Zt(t,e.type),location:s,normalized:!1})}return i}setTexture(t,e){const i=this._gl;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e)}setUniformInt(t,e){this.setUniform("uniform1i",t,~~e)}trySetUniformInt(t,e){return this.trySetUniform("uniform1i",t,~~e)}setUniformIntArray(t,e){this.setUniform("uniform1iv",t,e)}trySetUniformIntArray(t,e){return this.trySetUniform("uniform1iv",t,e)}setUniformBoolean(t,e){this.setUniform("uniform1i",t,e?1:0)}trySetUniformBoolean(t,e){return this.trySetUniform("uniform1i",t,e?1:0)}setUniformFloat(t,e){this.setUniform("uniform1f",t,e)}trySetUniformFloat(t,e){return this.trySetUniform("uniform1f",t,e)}setUniformFloatArray(t,e){this.setUniform("uniform1fv",t,e)}trySetUniformFloatArray(t,e){return this.trySetUniform("uniform1fv",t,e)}setUniformFloatVector(t,e){this.setUniform("uniform2f",t,e.x,e.y)}trySetUniformFloatVector(t,e){return this.trySetUniform("uniform2f",t,e.x,e.y)}setUniformFloatColor(t,e){this.setUniform("uniform4f",t,e.r/255,e.g/255,e.b/255,e.a)}trySetUniformFloatColor(t,e){return this.trySetUniform("uniform4f",t,e.r/255,e.g/255,e.b/255,e.a)}setUniformMatrix(t,e){this.setUniform("uniformMatrix4fv",t,!1,e.data)}trySetUniformMatrix(t,e){return this.trySetUniform("uniformMatrix4fv",t,!1,e.data)}setUniform(t,e,...i){if(!this._compiled)throw Error(`Must compile shader before setting a uniform ${t}:${e}`);if(!this.isCurrentlyBound())throw Error("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms");const n=this._gl.getUniformLocation(this.program,e);if(!n)throw Error(`Uniform ${t}:${e} doesn't exist or is not used in the shader source code, unused uniforms are optimized away by most browsers`);{const e=[n,...i];this._gl[t].apply(this._gl,e)}}trySetUniform(t,e,...i){if(!this._compiled)return this._logger.warn(`Must compile shader before setting a uniform ${t}:${e}`),!1;if(!this.isCurrentlyBound())return this._logger.warn("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms"),!1;const n=this._gl.getUniformLocation(this.program,e);if(!n)return!1;{const e=[n,...i];this._gl[t].apply(this._gl,e)}return!0}_createProgram(t,e,i){const n=t.createProgram();if(null===n)throw Error("Could not create graphics shader program");if(t.attachShader(n,e),t.attachShader(n,i),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS))throw Error(`Could not link the program: [${t.getProgramInfoLog(n)}]`);return n}_compileShader(t,e,i){const n=t.VERTEX_SHADER===i?"vertex":"fragment",s=t.createShader(i);if(null===s)throw Error(`Could not build shader: [${e}]`);if(t.shaderSource(s,e),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS)){const i=t.getShaderInfoLog(s);throw Error(`Could not compile ${n} shader:\n\n${i}${this._processSourceForError(e,i)}`)}return s}_processSourceForError(t,e){const i=t.split("\n"),n=e.search(/\d:\d/),s=e.indexOf(" ",n),[o,r]=e.slice(n,s).split(":").map((t=>Number(t)));for(let t=0;t<i.length;t++)i[t]=`${t+1}: ${i[t]}${r===t+1?" <----- ERROR!":""}`;return"\n\nSource:\n"+i.join("\n")}}Jt._ACTIVE_SHADER_INSTANCE=null;class te{constructor(t){this.type="dynamic";const{gl:e,size:i,type:n,data:s}=t;if(this._gl=e,this.buffer=this._gl.createBuffer(),!s&&!i)throw Error("Must either provide data or a size to the VertexBuffer");this.bufferData=s||new Float32Array(i),this.type=null!=n?n:this.type,e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,this.bufferData,"static"===this.type?e.STATIC_DRAW:e.DYNAMIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}upload(t){const e=this._gl;e.bindBuffer(e.ARRAY_BUFFER,this.buffer),t?e.bufferSubData(e.ARRAY_BUFFER,0,this.bufferData,0,t):e.bufferData(e.ARRAY_BUFFER,this.bufferData,"static"===this.type?e.STATIC_DRAW:e.DYNAMIC_DRAW)}}class ee{get vertexBuffer(){return this._vertexBuffer}get attributes(){return this._attributes}constructor(t){this._logger=tt.getInstance(),this._layout=[],this._attributes=[],this._vertexTotalSizeBytes=0;const{gl:e,shader:i,vertexBuffer:n,attributes:s}=t;this._gl=e,this._vertexBuffer=n,this._attributes=s,this._shader=i,i&&this.initialize()}get totalVertexSizeBytes(){return this._vertexTotalSizeBytes}set shader(t){t&&this._shader!==t&&(this._shader=t,this.initialize())}get shader(){return this._shader}initialize(){if(!this._shader)return;if(!this._shader.compiled)throw Error("Shader not compiled, shader must be compiled before defining a vertex layout");this._layout.length=0;const t=this._shader.attributes;for(const e of this._attributes){const i=t[e[0]];if(!i)throw Error(`The attribute named: ${e[0]} size ${e[1]} not found in the shader source code:\n ${this._shader.vertexSource}`);if(i.size!==e[1])throw Error(`VertexLayout size definition for attribute: [${e[0]}, ${e[1]}], doesnt match shader source size ${i.size}:\n ${this._shader.vertexSource}`);this._layout.push(i)}let e=0;for(const t of this._layout){const i=Xt(this._gl,t.glType);this._vertexTotalSizeBytes+=i*t.size,e+=t.size}this._vertexBuffer.bufferData.length%e!=0&&this._logger.warn(`The vertex component size (${e})  does divide evenly into the specified vertex buffer (${this._vertexBuffer.bufferData.length})`)}use(t=!1,e){if(!this._shader)throw Error("No shader is associated with this vertex layout, a shader must be set");const i=this._gl;if(!this._shader.isCurrentlyBound())throw Error("Shader associated with this vertex layout is not active! Call shader.use() before layout.use()");this._vertexBuffer.bind(),t&&this._vertexBuffer.upload(e);let n=0;for(const t of this._layout)i.vertexAttribPointer(t.location,t.size,t.glType,t.normalized,this.totalVertexSizeBytes,n),i.enableVertexAttribArray(t.location),n+=Xt(i,t.glType)*t.size}}class ie{static clear(){ie.DrawCallCount=0,ie.DrawnImagesCount=0}}ie.DrawCallCount=0,ie.DrawnImagesCount=0;class ne{constructor(){this.type="ex.line",this.priority=0,this._maxLines=10922,this._vertexIndex=0,this._lineCount=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new Jt({gl:t,vertexSource:"#version 300 es\r\nin vec2 a_position;\r\nin vec4 a_color;\r\n\r\nout lowp vec4 v_color;\r\n\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Passthrough the color\r\n   v_color = a_color;\r\n}",fragmentSource:"#version 300 es\r\nprecision mediump float;\r\n\r\n// Color\r\nin lowp vec4 v_color;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  fragColor = v_color;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._vertexBuffer=new te({gl:t,size:12*this._maxLines,type:"dynamic"}),this._layout=new ee({gl:t,vertexBuffer:this._vertexBuffer,shader:this._shader,attributes:[["a_position",2],["a_color",4]]})}draw(t,e,i){this._isFull()&&this.flush(),this._lineCount++;const n=this._context.getTransform(),s=n.multiply(t),o=n.multiply(e),r=this._vertexBuffer.bufferData;r[this._vertexIndex++]=s.x,r[this._vertexIndex++]=s.y,r[this._vertexIndex++]=i.r/255,r[this._vertexIndex++]=i.g/255,r[this._vertexIndex++]=i.b/255,r[this._vertexIndex++]=i.a,r[this._vertexIndex++]=o.x,r[this._vertexIndex++]=o.y,r[this._vertexIndex++]=i.r/255,r[this._vertexIndex++]=i.g/255,r[this._vertexIndex++]=i.b/255,r[this._vertexIndex++]=i.a}_isFull(){return this._lineCount>=this._maxLines}hasPendingDraws(){return 0!==this._lineCount}flush(){if(0===this._lineCount)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.LINES,0,2*this._lineCount),ie.DrawnImagesCount+=this._lineCount,ie.DrawCallCount++,this._vertexIndex=0,this._lineCount=0}}class se{constructor(){this.type="ex.point",this.priority=0,this._maxPoints=10922,this._pointCount=0,this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new Jt({gl:t,vertexSource:"#version 300 es\r\nin vec2 a_position;\r\nin vec4 a_color;\r\nin float a_size;\r\nout lowp vec4 v_color;\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n  gl_PointSize = a_size * 2.0;\r\n  v_color = a_color;\r\n}",fragmentSource:'#version 300 es\r\n\r\nprecision mediump float;\r\nin lowp vec4 v_color;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  float r = 0.0, delta = 0.0, alpha = 1.0;\r\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r\n  r = dot(cxy, cxy);\r\n\r\n  delta = fwidth(r);\r\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\r\n  // "premultiply" the color by alpha\r\n  vec4 color = v_color;\r\n  color.a = color.a * alpha;\r\n  color.rgb = color.rgb * color.a;\r\n  fragColor = color;\r\n}'}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._buffer=new te({gl:t,size:7*this._maxPoints,type:"dynamic"}),this._layout=new ee({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_color",4],["a_size",1]]})}draw(t,e,i){this._isFull()&&this.flush(),this._pointCount++;const n=this._context.getTransform(),s=this._context.opacity,o=this._context.snapToPixel,r=n.multiply(t);o&&(r.x=~~(r.x+ge),r.y=~~(r.y+ge));const a=this._buffer.bufferData;a[this._vertexIndex++]=r.x,a[this._vertexIndex++]=r.y,a[this._vertexIndex++]=e.r/255,a[this._vertexIndex++]=e.g/255,a[this._vertexIndex++]=e.b/255,a[this._vertexIndex++]=e.a*s,a[this._vertexIndex++]=i*Math.max(n.getScaleX(),n.getScaleY())}_isFull(){return this._pointCount>=this._maxPoints}hasPendingDraws(){return 0!==this._pointCount}flush(){if(0===this._pointCount)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.POINTS,0,this._pointCount),ie.DrawnImagesCount+=this._pointCount,ie.DrawCallCount++,this._pointCount=0,this._vertexIndex=0}}class oe{constructor(t){this._gl=t,this._shader=new Jt({gl:t,vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\nin vec2 a_texcoord;\r\nout vec2 v_texcoord;\r\n\r\nvoid main() {\r\n  gl_Position = vec4(a_position, 0.0, 1.0);\r\n\r\n  // Pass the texcoord to the fragment shader.\r\n  v_texcoord = a_texcoord;\r\n}",fragmentSource:"#version 300 es\r\nprecision mediump float;\r\n\r\n// Passed in from the vertex shader.\r\nin vec2 v_texcoord;\r\n\r\n// The texture.\r\nuniform sampler2D u_texture;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n   fragColor = texture(u_texture, v_texcoord);\r\n}"}),this._shader.compile(),this._buffer=new te({gl:t,type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new ee({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}renderWithPostProcessor(t){const e=this._gl;t.getShader().use(),t.getLayout().use(),e.drawArrays(e.TRIANGLES,0,6)}renderToScreen(){const t=this._gl;this._shader.use(),this._layout.use(),t.drawArrays(t.TRIANGLES,0,6)}}class re{constructor(t,e,i){this._logger=tt.getInstance(),this._gl=t,this.buffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer);const n=6*e;if(i){const i=65535,s=Math.floor((i-1)/4);this.bufferGlType=t.UNSIGNED_SHORT,this.bufferData=new Uint16Array(n),e>s&&this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${s}) requested quads(${e})`)}else this.bufferData=new Uint32Array(n);let s=0;for(let t=0;t<n;t+=6)this.bufferData[t+0]=s+0,this.bufferData[t+1]=s+1,this.bufferData[t+2]=s+2,this.bufferData[t+3]=s+2,this.bufferData[t+4]=s+1,this.bufferData[t+5]=s+3,s+=4;t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}get size(){return this.bufferData.length}upload(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer)}}class ae{constructor(){this.type="ex.image",this.priority=0,this._maxImages=10922,this._maxTextures=0,this._imageCount=0,this._textures=[],this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),125);const i=this._transformFragmentSource("#version 300 es\r\nprecision mediump float;\r\n\r\n// UV coord\r\nin vec2 v_texcoord;\r\n\r\n// Texture index\r\nin lowp float v_textureIndex;\r\n\r\n// Textures in the current draw\r\nuniform sampler2D u_textures[%%count%%];\r\n\r\n// Opacity\r\nin float v_opacity;\r\n\r\nin vec4 v_tint;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n   // In order to support the most efficient sprite batching, we have multiple\r\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\r\n   // that do not apply to a particular sprite.\r\n\r\n   vec4 color = vec4(1.0, 0, 0, 1.0);\r\n\r\n   // GLSL is templated out to pick the right texture and set the vec4 color\r\n   %%texture_picker%%\r\n\r\n   color.rgb = color.rgb * v_opacity;\r\n   color.a = color.a * v_opacity;\r\n   fragColor = color * v_tint;\r\n}",this._maxTextures);this._shader=new Jt({gl:t,fragmentSource:i,vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\n// Opacity \r\nin float a_opacity;\r\nout float v_opacity;\r\n\r\n// UV coordinate\r\nin vec2 a_texcoord;\r\nout vec2 v_texcoord;\r\n\r\n// Texture number\r\nin lowp float a_textureIndex;\r\nout lowp float v_textureIndex;\r\n\r\nin vec4 a_tint;\r\nout vec4 v_tint;\r\n\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the UV coord to the fragment shader\r\n   v_texcoord = a_texcoord;\r\n   // Pass through the texture number to the fragment shader\r\n   v_textureIndex = a_textureIndex;\r\n   // Pass through the tint\r\n   v_tint = a_tint;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._shader.setUniformIntArray("u_textures",[...Array(this._maxTextures)].map(((t,e)=>e))),this._buffer=new te({gl:t,size:40*this._maxImages,type:"dynamic"}),this._layout=new ee({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_opacity",1],["a_texcoord",2],["a_textureIndex",1],["a_tint",4]]}),this._quads=new re(t,this._maxImages,!0)}_transformFragmentSource(t,e){let i=t.replace("%%count%%",e.toString()),n="";for(let t=0;t<e;t++)n+=0===t?`if (v_textureIndex <= ${t}.5) {\n`:`   else if (v_textureIndex <= ${t}.5) {\n`,n+=`      color = texture(u_textures[${t}], v_texcoord);\n`,n+="   }\n";return i=i.replace("%%texture_picker%%",n),i}_addImageAsTexture(t){const e=t.getAttribute("filtering");let i=null;e!==Ht.Blended&&e!==Ht.Pixel||(i=e);const n="true"===t.getAttribute("forceUpload"),s=this._context.textureLoader.load(t,i,n);t.removeAttribute("forceUpload"),-1===this._textures.indexOf(s)&&this._textures.push(s)}_bindTextures(t){for(let e=0;e<this._maxTextures;e++)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this._textures[e]||this._textures[0])}_getTextureIdForImage(t){if(t){const e=this._context.textureLoader.get(t);return this._textures.indexOf(e)}return-1}_isFull(){return this._imageCount>=this._maxImages||this._textures.length>=this._maxTextures}draw(t,e,i,n,s,o,r,a,l){var h,c,d,u;this._isFull()&&this.flush(),this._imageCount++,this._addImageAsTexture(t);let p=(null==t?void 0:t.width)||n||0,g=(null==t?void 0:t.height)||s||0,f=[0,0,null!==(h=null!=n?n:null==t?void 0:t.width)&&void 0!==h?h:0,null!==(c=null!=s?s:null==t?void 0:t.height)&&void 0!==c?c:0],m=[null!=e?e:1,null!=i?i:1];void 0!==o&&void 0!==r&&void 0!==a&&void 0!==l&&(f=[null!=e?e:1,null!=i?i:1,null!==(d=null!=n?n:null==t?void 0:t.width)&&void 0!==d?d:0,null!==(u=null!=s?s:null==t?void 0:t.height)&&void 0!==u?u:0],m=[o,r],p=a,g=l),e=f[0],i=f[1];const v=f[2],_=f[3],y=this._context.getTransform(),w=this._context.opacity,x=this._context.snapToPixel;let b=yt(m[0],m[1]),C=yt(m[0]+p,m[1]),A=yt(m[0],m[1]+g),S=yt(m[0]+p,m[1]+g);b=y.multiply(b),C=y.multiply(C),A=y.multiply(A),S=y.multiply(S),x&&(b.x=~~(b.x+ge),b.y=~~(b.y+ge),C.x=~~(C.x+ge),C.y=~~(C.y+ge),A.x=~~(A.x+ge),A.y=~~(A.y+ge),S.x=~~(S.x+ge),S.y=~~(S.y+ge));const E=this._context.tint,T=this._getTextureIdForImage(t),k=t.width||p,M=t.height||g,$=e/k,L=i/M,R=(e+v-.01)/k,I=(i+_-.01)/M,D=this._layout.vertexBuffer.bufferData;D[this._vertexIndex++]=b.x,D[this._vertexIndex++]=b.y,D[this._vertexIndex++]=w,D[this._vertexIndex++]=$,D[this._vertexIndex++]=L,D[this._vertexIndex++]=T,D[this._vertexIndex++]=E.r/255,D[this._vertexIndex++]=E.g/255,D[this._vertexIndex++]=E.b/255,D[this._vertexIndex++]=E.a,D[this._vertexIndex++]=A.x,D[this._vertexIndex++]=A.y,D[this._vertexIndex++]=w,D[this._vertexIndex++]=$,D[this._vertexIndex++]=I,D[this._vertexIndex++]=T,D[this._vertexIndex++]=E.r/255,D[this._vertexIndex++]=E.g/255,D[this._vertexIndex++]=E.b/255,D[this._vertexIndex++]=E.a,D[this._vertexIndex++]=C.x,D[this._vertexIndex++]=C.y,D[this._vertexIndex++]=w,D[this._vertexIndex++]=R,D[this._vertexIndex++]=L,D[this._vertexIndex++]=T,D[this._vertexIndex++]=E.r/255,D[this._vertexIndex++]=E.g/255,D[this._vertexIndex++]=E.b/255,D[this._vertexIndex++]=E.a,D[this._vertexIndex++]=S.x,D[this._vertexIndex++]=S.y,D[this._vertexIndex++]=w,D[this._vertexIndex++]=R,D[this._vertexIndex++]=I,D[this._vertexIndex++]=T,D[this._vertexIndex++]=E.r/255,D[this._vertexIndex++]=E.g/255,D[this._vertexIndex++]=E.b/255,D[this._vertexIndex++]=E.a}hasPendingDraws(){return 0!==this._imageCount}flush(){if(0===this._imageCount)return;const t=this._gl;this._shader.use(),this._layout.use(!0,40*this._imageCount),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._bindTextures(t),this._quads.bind(),t.drawElements(t.TRIANGLES,6*this._imageCount,this._quads.bufferGlType,0),ie.DrawnImagesCount+=this._imageCount,ie.DrawCallCount++,this._imageCount=0,this._vertexIndex=0,this._textures.length=0}}class le{constructor(){this.type="ex.rectangle",this.priority=0,this._maxRectangles=10922,this._rectangleCount=0,this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new Jt({gl:t,fragmentSource:"#version 300 es\r\n\r\nprecision mediump float;\r\n\r\n// UV coord\r\nin vec2 v_uv;\r\n\r\nin vec2 v_size; // in pixels\r\n\r\n// Color coord to blend with image\r\nin lowp vec4 v_color;\r\n\r\n// Stroke color if used\r\nin lowp vec4 v_strokeColor;\r\n\r\n// Stroke thickness if used\r\nin lowp float v_strokeThickness; // in pixels\r\n\r\n// Opacity\r\nin float v_opacity;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\r\n    vec2 uv = v_uv;\r\n    vec2 fragCoord = uv * v_size;\r\n    float maxX = v_size.x - v_strokeThickness;\r\n    float minX = v_strokeThickness;\r\n    float maxY = v_size.y - v_strokeThickness;\r\n    float minY = v_strokeThickness;\r\n\r\n    if (fragCoord.x < maxX && fragCoord.x > minX &&\r\n        fragCoord.y < maxY && fragCoord.y > minY) {\r\n      fragColor = v_color;\r\n    } else {\r\n      fragColor = v_strokeColor;\r\n    }\r\n    fragColor.a *= v_opacity;\r\n    fragColor.rgb *= fragColor.a;\r\n\r\n    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\r\n    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\r\n\r\n    // float fHalfBorderDist      = 0.0;\r\n    // float fHalfBorderThickness = 0.0;\r\n\r\n    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \r\n    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\r\n    // {\r\n    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\r\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r\n    // }\r\n    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \r\n    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\r\n    // {\r\n    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\r\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r\n    // }\r\n    // else\r\n    // {\r\n    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\r\n    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\r\n    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\r\n        \r\n    //     float ellipse_ab    = v_radius-v_strokeThickness;\r\n    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\r\n    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \r\n            \r\n    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\r\n    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\r\n    // }\r\n\r\n    // vec4 v4FromColor = v_strokeColor;\r\n    // v4FromColor.rgb *= v4FromColor.a;\r\n    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\r\n    // if (fHalfBorderDist < 0.0) {\r\n    //     v4ToColor = v_color;\r\n    //     v4ToColor.rgb *= v4ToColor.a;\r\n    // }\r\n\r\n    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\r\n\r\n    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\r\n    // gl_FragColor = finalColor;\r\n}",vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\n// UV coordinate\r\nin vec2 a_uv;\r\nout vec2 v_uv;\r\n\r\nin vec2 a_size;\r\nout vec2 v_size;\r\n\r\n// Opacity \r\nin float a_opacity;\r\nout float v_opacity;\r\n\r\nin vec4 a_color;\r\nout vec4 v_color;\r\n\r\nin vec4 a_strokeColor;\r\nout vec4 v_strokeColor;\r\n\r\nin float a_strokeThickness;\r\nout float v_strokeThickness;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Pass through UV coords\r\n   v_uv = a_uv;\r\n   // Pass through size\r\n   v_size = a_size;\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the color to the fragment shader\r\n   v_color = a_color;\r\n   // Pass through the stroke color to the fragment shader\r\n   v_strokeColor = a_strokeColor;\r\n   // Pass through the stroke thickenss to the fragment shader\r\n   v_strokeThickness = a_strokeThickness;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._buffer=new te({gl:t,size:64*this._maxRectangles,type:"dynamic"}),this._layout=new ee({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_size",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new re(t,this._maxRectangles,!0)}_isFull(){return this._rectangleCount>=this._maxRectangles}draw(...t){t[0]instanceof _t&&t[1]instanceof _t?this.drawLine.apply(this,t):this.drawRectangle.apply(this,t)}drawLine(t,e,i,n=1){this._isFull()&&this.flush(),this._rectangleCount++;const s=this._context.getTransform(),o=this._context.opacity,r=this._context.snapToPixel,a=e.sub(t),l=a.size,h=a.normalize().perpendicular(),c=n/2,d=s.multiply(h.scale(c).add(t)),u=s.multiply(h.scale(-c).add(t)),p=s.multiply(h.scale(c).add(e)),g=s.multiply(h.scale(-c).add(e));r&&(d.x=~~(d.x+ge),d.y=~~(d.y+ge),p.x=~~(p.x+ge),p.y=~~(p.y+ge),u.x=~~(u.x+ge),u.y=~~(u.y+ge),g.x=~~(g.x+ge),g.y=~~(g.y+ge));const f=wt.Transparent,m=this._layout.vertexBuffer.bufferData;m[this._vertexIndex++]=d.x,m[this._vertexIndex++]=d.y,m[this._vertexIndex++]=0,m[this._vertexIndex++]=0,m[this._vertexIndex++]=l,m[this._vertexIndex++]=n,m[this._vertexIndex++]=o,m[this._vertexIndex++]=i.r/255,m[this._vertexIndex++]=i.g/255,m[this._vertexIndex++]=i.b/255,m[this._vertexIndex++]=i.a,m[this._vertexIndex++]=f.r/255,m[this._vertexIndex++]=f.g/255,m[this._vertexIndex++]=f.b/255,m[this._vertexIndex++]=f.a,m[this._vertexIndex++]=0,m[this._vertexIndex++]=u.x,m[this._vertexIndex++]=u.y,m[this._vertexIndex++]=0,m[this._vertexIndex++]=1,m[this._vertexIndex++]=l,m[this._vertexIndex++]=n,m[this._vertexIndex++]=o,m[this._vertexIndex++]=i.r/255,m[this._vertexIndex++]=i.g/255,m[this._vertexIndex++]=i.b/255,m[this._vertexIndex++]=i.a,m[this._vertexIndex++]=f.r/255,m[this._vertexIndex++]=f.g/255,m[this._vertexIndex++]=f.b/255,m[this._vertexIndex++]=f.a,m[this._vertexIndex++]=0,m[this._vertexIndex++]=p.x,m[this._vertexIndex++]=p.y,m[this._vertexIndex++]=1,m[this._vertexIndex++]=0,m[this._vertexIndex++]=l,m[this._vertexIndex++]=n,m[this._vertexIndex++]=o,m[this._vertexIndex++]=i.r/255,m[this._vertexIndex++]=i.g/255,m[this._vertexIndex++]=i.b/255,m[this._vertexIndex++]=i.a,m[this._vertexIndex++]=f.r/255,m[this._vertexIndex++]=f.g/255,m[this._vertexIndex++]=f.b/255,m[this._vertexIndex++]=f.a,m[this._vertexIndex++]=0,m[this._vertexIndex++]=g.x,m[this._vertexIndex++]=g.y,m[this._vertexIndex++]=1,m[this._vertexIndex++]=1,m[this._vertexIndex++]=l,m[this._vertexIndex++]=n,m[this._vertexIndex++]=o,m[this._vertexIndex++]=i.r/255,m[this._vertexIndex++]=i.g/255,m[this._vertexIndex++]=i.b/255,m[this._vertexIndex++]=i.a,m[this._vertexIndex++]=f.r/255,m[this._vertexIndex++]=f.g/255,m[this._vertexIndex++]=f.b/255,m[this._vertexIndex++]=f.a,m[this._vertexIndex++]=0}drawRectangle(t,e,i,n,s=wt.Transparent,o=0){this._isFull()&&this.flush(),this._rectangleCount++;const r=this._context.getTransform(),a=this._context.opacity,l=this._context.snapToPixel,h=r.multiply(t.add(yt(0,0))),c=r.multiply(t.add(yt(e,0))),d=r.multiply(t.add(yt(e,i))),u=r.multiply(t.add(yt(0,i)));l&&(h.x=~~(h.x+ge),h.y=~~(h.y+ge),c.x=~~(c.x+ge),c.y=~~(c.y+ge),u.x=~~(u.x+ge),u.y=~~(u.y+ge),d.x=~~(d.x+ge),d.y=~~(d.y+ge));const p=this._layout.vertexBuffer.bufferData;p[this._vertexIndex++]=h.x,p[this._vertexIndex++]=h.y,p[this._vertexIndex++]=0,p[this._vertexIndex++]=0,p[this._vertexIndex++]=e,p[this._vertexIndex++]=i,p[this._vertexIndex++]=a,p[this._vertexIndex++]=n.r/255,p[this._vertexIndex++]=n.g/255,p[this._vertexIndex++]=n.b/255,p[this._vertexIndex++]=n.a,p[this._vertexIndex++]=s.r/255,p[this._vertexIndex++]=s.g/255,p[this._vertexIndex++]=s.b/255,p[this._vertexIndex++]=s.a,p[this._vertexIndex++]=o,p[this._vertexIndex++]=u.x,p[this._vertexIndex++]=u.y,p[this._vertexIndex++]=0,p[this._vertexIndex++]=1,p[this._vertexIndex++]=e,p[this._vertexIndex++]=i,p[this._vertexIndex++]=a,p[this._vertexIndex++]=n.r/255,p[this._vertexIndex++]=n.g/255,p[this._vertexIndex++]=n.b/255,p[this._vertexIndex++]=n.a,p[this._vertexIndex++]=s.r/255,p[this._vertexIndex++]=s.g/255,p[this._vertexIndex++]=s.b/255,p[this._vertexIndex++]=s.a,p[this._vertexIndex++]=o,p[this._vertexIndex++]=c.x,p[this._vertexIndex++]=c.y,p[this._vertexIndex++]=1,p[this._vertexIndex++]=0,p[this._vertexIndex++]=e,p[this._vertexIndex++]=i,p[this._vertexIndex++]=a,p[this._vertexIndex++]=n.r/255,p[this._vertexIndex++]=n.g/255,p[this._vertexIndex++]=n.b/255,p[this._vertexIndex++]=n.a,p[this._vertexIndex++]=s.r/255,p[this._vertexIndex++]=s.g/255,p[this._vertexIndex++]=s.b/255,p[this._vertexIndex++]=s.a,p[this._vertexIndex++]=o,p[this._vertexIndex++]=d.x,p[this._vertexIndex++]=d.y,p[this._vertexIndex++]=1,p[this._vertexIndex++]=1,p[this._vertexIndex++]=e,p[this._vertexIndex++]=i,p[this._vertexIndex++]=a,p[this._vertexIndex++]=n.r/255,p[this._vertexIndex++]=n.g/255,p[this._vertexIndex++]=n.b/255,p[this._vertexIndex++]=n.a,p[this._vertexIndex++]=s.r/255,p[this._vertexIndex++]=s.g/255,p[this._vertexIndex++]=s.b/255,p[this._vertexIndex++]=s.a,p[this._vertexIndex++]=o}hasPendingDraws(){return 0!==this._rectangleCount}flush(){if(0===this._rectangleCount)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,6*this._rectangleCount,this._quads.bufferGlType,0),ie.DrawnImagesCount+=this._rectangleCount,ie.DrawCallCount++,this._rectangleCount=0,this._vertexIndex=0}}class he{constructor(){this.type="ex.circle",this.priority=0,this._maxCircles=10922,this._circleCount=0,this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new Jt({gl:t,fragmentSource:"#version 300 es\r\nprecision highp float;\r\n\r\n// UV coord\r\nin vec2 v_uv;\r\n\r\n// Color coord to blend with image\r\nin lowp vec4 v_color;\r\n\r\n// Stroke color if used\r\nin lowp vec4 v_strokeColor;\r\n\r\n// Stroke thickness if used\r\nin lowp float v_strokeThickness;\r\n\r\n// Opacity\r\nin float v_opacity;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  // make (0, 0) the center the uv \r\n  vec2 uv = v_uv * 2.0 - 1.0;\r\n\r\n  vec4 color = v_color;\r\n  vec4 strokeColor = v_strokeColor;\r\n\r\n  // circle border is at radius 1.0 \r\n  // dist is > 0 when inside the circle \r\n  float d = length(uv);\r\n  float dist = 1.0 - length(uv);\r\n\r\n  // Fade based on fwidth\r\n  float fade = fwidth(dot(uv, uv));\r\n\r\n  // if dist is greater than 0 step to 1;\r\n  // when we cross this 0 threshold add a smooth fade\r\n  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\r\n\r\n  // if dist is greater than the stroke thickness step to 1\r\n  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\r\n\r\n  strokeColor.a *= fill * stroke;\r\n  strokeColor.rgb *= strokeColor.a;\r\n\r\n  color.a *= fill * (1.0 - stroke);\r\n  color.rgb *= color.a;\r\n\r\n  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\r\n  finalColor.rgb = finalColor.rgb * v_opacity;\r\n  finalColor.a = finalColor.a * v_opacity;\r\n  fragColor = finalColor;\r\n}",vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\n// UV coordinate\r\nin vec2 a_uv;\r\nout vec2 v_uv;\r\n\r\n// Opacity \r\nin float a_opacity;\r\nout float v_opacity;\r\n\r\nin vec4 a_color;\r\nout vec4 v_color;\r\n\r\nin vec4 a_strokeColor;\r\nout vec4 v_strokeColor;\r\n\r\nin float a_strokeThickness;\r\nout float v_strokeThickness;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Pass through UV coords\r\n   v_uv = a_uv;\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the color to the fragment shader\r\n   v_color = a_color;\r\n   // Pass through the stroke color to the fragment shader\r\n   v_strokeColor = a_strokeColor;\r\n   // Pass through the stroke thickenss to the fragment shader\r\n   v_strokeThickness = a_strokeThickness;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._buffer=new te({gl:t,size:56*this._maxCircles,type:"dynamic"}),this._layout=new ee({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new re(t,this._maxCircles,!0)}_isFull(){return this._circleCount>=this._maxCircles}draw(t,e,i,n=wt.Transparent,s=0){this._isFull()&&this.flush(),this._circleCount++;const o=this._context.getTransform(),r=this._context.opacity,a=this._context.snapToPixel,l=o.multiply(t.add(yt(-e,-e))),h=o.multiply(t.add(yt(e,-e))),c=o.multiply(t.add(yt(e,e))),d=o.multiply(t.add(yt(-e,e)));a&&(l.x=~~(l.x+ge),l.y=~~(l.y+ge),h.x=~~(h.x+ge),h.y=~~(h.y+ge),d.x=~~(d.x+ge),d.y=~~(d.y+ge),c.x=~~(c.x+ge),c.y=~~(c.y+ge));const u=this._layout.vertexBuffer.bufferData;u[this._vertexIndex++]=l.x,u[this._vertexIndex++]=l.y,u[this._vertexIndex++]=0,u[this._vertexIndex++]=0,u[this._vertexIndex++]=r,u[this._vertexIndex++]=i.r/255,u[this._vertexIndex++]=i.g/255,u[this._vertexIndex++]=i.b/255,u[this._vertexIndex++]=i.a,u[this._vertexIndex++]=n.r/255,u[this._vertexIndex++]=n.g/255,u[this._vertexIndex++]=n.b/255,u[this._vertexIndex++]=n.a,u[this._vertexIndex++]=s/e,u[this._vertexIndex++]=d.x,u[this._vertexIndex++]=d.y,u[this._vertexIndex++]=0,u[this._vertexIndex++]=1,u[this._vertexIndex++]=r,u[this._vertexIndex++]=i.r/255,u[this._vertexIndex++]=i.g/255,u[this._vertexIndex++]=i.b/255,u[this._vertexIndex++]=i.a,u[this._vertexIndex++]=n.r/255,u[this._vertexIndex++]=n.g/255,u[this._vertexIndex++]=n.b/255,u[this._vertexIndex++]=n.a,u[this._vertexIndex++]=s/e,u[this._vertexIndex++]=h.x,u[this._vertexIndex++]=h.y,u[this._vertexIndex++]=1,u[this._vertexIndex++]=0,u[this._vertexIndex++]=r,u[this._vertexIndex++]=i.r/255,u[this._vertexIndex++]=i.g/255,u[this._vertexIndex++]=i.b/255,u[this._vertexIndex++]=i.a,u[this._vertexIndex++]=n.r/255,u[this._vertexIndex++]=n.g/255,u[this._vertexIndex++]=n.b/255,u[this._vertexIndex++]=n.a,u[this._vertexIndex++]=s/e,u[this._vertexIndex++]=c.x,u[this._vertexIndex++]=c.y,u[this._vertexIndex++]=1,u[this._vertexIndex++]=1,u[this._vertexIndex++]=r,u[this._vertexIndex++]=i.r/255,u[this._vertexIndex++]=i.g/255,u[this._vertexIndex++]=i.b/255,u[this._vertexIndex++]=i.a,u[this._vertexIndex++]=n.r/255,u[this._vertexIndex++]=n.g/255,u[this._vertexIndex++]=n.b/255,u[this._vertexIndex++]=n.a,u[this._vertexIndex++]=s/e}hasPendingDraws(){return 0!==this._circleCount}flush(){if(0===this._circleCount)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,6*this._circleCount,this._quads.bufferGlType,0),ie.DrawnImagesCount+=this._circleCount,ie.DrawCallCount++,this._circleCount=0,this._vertexIndex=0}}class ce{constructor(t,e,i=100){this.builder=t,this.recycler=e,this.maxObjects=i,this.totalAllocations=0,this.index=0,this.objects=[],this.disableWarnings=!1,this._logger=tt.getInstance()}preallocate(){for(let t=0;t<this.maxObjects;t++)this.objects[t]=this.builder()}using(t){const e=t(this);return e?this.done(...e):this.done()}borrow(t){t(this.get()),this.index--}get(...t){return this.index===this.maxObjects&&(this.disableWarnings||this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=2*this.maxObjects),this.objects[this.index]?this.recycler(this.objects[this.index++],...t):(this.totalAllocations++,this.objects[this.index++]=this.builder(...t))}done(...t){this.index=0;for(const e of t){const t=this.objects.indexOf(e);this.objects[t]=this.builder(),this.totalAllocations++}return t}}class de{constructor(){this.z=0,this.priority=0,this.transform=It.identity(),this.state={z:0,opacity:1,tint:wt.White,material:null}}}class ue{constructor(t){this._color=wt.Transparent,this._initialized=!1;const{color:e,name:i,vertexSource:n,fragmentSource:s}=t;this._name=i,this._vertexSource=null!=n?n:"#version 300 es\nin vec2 a_position;\n\nin vec2 a_uv;\nout vec2 v_uv;\n\nuniform mat4 u_matrix;\nuniform mat4 u_transform;\n\nvoid main() {\n  // Set the vertex position using the ortho & transform matrix\n  gl_Position = u_matrix * u_transform * vec4(a_position, 0.0, 1.0);\n\n  // Pass through the UV coord to the fragment shader\n  v_uv = a_uv;\n}\n",this._fragmentSource=s,this._color=null!=e?e:this._color}initialize(t,e){this._initialized||(this._shader=e.createShader({vertexSource:this._vertexSource,fragmentSource:this._fragmentSource}),this._shader.compile(),this._initialized=!0)}get name(){var t;return null!==(t=this._name)&&void 0!==t?t:"anonymous material"}getShader(){return this._shader}use(){if(!this._initialized)throw Error(`Material ${this.name} not yet initialized, use the ExcaliburGraphicsContext.createMaterial() to work around this.`);this._shader.use(),this._shader.trySetUniformFloatColor("u_color",this._color)}}class pe{constructor(){this.type="ex.material",this.priority=0,this._textures=[]}initialize(t,e){this._gl=t,this._context=e,this._buffer=new te({gl:t,size:16,type:"dynamic"}),this._layout=new ee({gl:t,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2]]}),this._quads=new re(t,1,!0)}draw(t,e,i,n,s,o,r,a,l){var h,c,d,u;const p=this._gl,g=this._context.material;g.initialize(p,this._context);const f=this._context.getTransform(),m=this._context.opacity,v=g.getShader(),_=this._layout.vertexBuffer.bufferData;let y=0,w=(null==t?void 0:t.width)||n||0,x=(null==t?void 0:t.height)||s||0,b=[0,0,null!==(h=null!=n?n:null==t?void 0:t.width)&&void 0!==h?h:0,null!==(c=null!=s?s:null==t?void 0:t.height)&&void 0!==c?c:0],C=[null!=e?e:1,null!=i?i:1];void 0!==o&&void 0!==r&&void 0!==a&&void 0!==l&&(b=[null!=e?e:1,null!=i?i:1,null!==(d=null!=n?n:null==t?void 0:t.width)&&void 0!==d?d:0,null!==(u=null!=s?s:null==t?void 0:t.height)&&void 0!==u?u:0],C=[o,r],w=a,x=l),e=b[0],i=b[1];const A=b[2],S=b[3],E=yt(C[0],C[1]),T=yt(C[0]+w,C[1]),k=yt(C[0],C[1]+x),M=yt(C[0]+w,C[1]+x),$=t.width||w,L=t.height||x,R=e/$,I=i/L,D=(e+A-.01)/$,P=(i+S-.01)/L;_[y++]=E.x,_[y++]=E.y,_[y++]=R,_[y++]=I,_[y++]=k.x,_[y++]=k.y,_[y++]=R,_[y++]=P,_[y++]=T.x,_[y++]=T.y,_[y++]=D,_[y++]=I,_[y++]=M.x,_[y++]=M.y,_[y++]=D,_[y++]=P;const B=this._addImageAsTexture(t);g.use(),this._layout.shader=v,this._layout.use(!0),v.trySetUniformFloat("u_opacity",m),v.trySetUniformFloatVector("u_resolution",yt(this._context.width,this._context.height)),v.trySetUniformFloatVector("u_size",yt(A,S)),v.trySetUniformMatrix("u_matrix",this._context.ortho),v.trySetUniformMatrix("u_transform",f.to4x4()),p.activeTexture(p.TEXTURE0+0),p.bindTexture(p.TEXTURE_2D,B),v.trySetUniformInt("u_graphic",0),this._quads.bind(),p.drawElements(p.TRIANGLES,6,this._quads.bufferGlType,0)}_addImageAsTexture(t){const e=t.getAttribute("filtering");let i=null;e!==Ht.Blended&&e!==Ht.Pixel||(i=e);const n="true"===t.getAttribute("forceUpload"),s=this._context.textureLoader.load(t,i,n);return t.removeAttribute("forceUpload"),-1===this._textures.indexOf(s)&&this._textures.push(s),s}hasPendingDraws(){return!1}flush(){}}const ge=1e-4;class fe{constructor(t){this._webglCtx=t,this._debugText=new Kt}drawRect(t,e,i,n,s={color:wt.Black}){this.drawLine(yt(t,e),yt(t+i,e),{...s}),this.drawLine(yt(t+i,e),yt(t+i,e+n),{...s}),this.drawLine(yt(t+i,e+n),yt(t,e+n),{...s}),this.drawLine(yt(t,e+n),yt(t,e),{...s})}drawLine(t,e,i={color:wt.Black}){this._webglCtx.draw("ex.line",t,e,i.color)}drawPoint(t,e={color:wt.Black,size:5}){this._webglCtx.draw("ex.point",t,e.color,e.size)}drawText(t,e){this._debugText.write(this._webglCtx,t,e)}}class me{get z(){return this._state.current.z}set z(t){this._state.current.z=t}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get width(){return this.__gl.canvas.width}get height(){return this.__gl.canvas.height}get ortho(){return this._ortho}checkIfResolutionSupported(t){let e=!0;return(t.width>4096||t.height>4096)&&(e=!1),e}constructor(t){this._logger=tt.getInstance(),this._renderers=new Map,this._isDrawLifecycle=!1,this.useDrawSorting=!0,this._drawCallPool=new ce((()=>new de),(t=>(t.priority=0,t.z=0,t.renderer=void 0,t.args=void 0,t)),4e3),this._drawCalls=[],this._postProcessTargets=[],this._postprocessors=[],this._transform=new Dt,this._state=new Pt,this.snapToPixel=!1,this.smoothing=!1,this.backgroundColor=wt.ExcaliburBlue,this._alreadyWarnedDrawLifecycle=!1,this.debug=new fe(this),this._totalPostProcessorTime=0;const{canvasElement:e,enableTransparency:i,smoothing:n,snapToPixel:s,backgroundColor:o,useDrawSorting:r}=t;if(this.__gl=e.getContext("webgl2",{antialias:null!=n?n:this.smoothing,premultipliedAlpha:!1,alpha:null==i||i,depth:!0,powerPreference:"high-performance"}),!this.__gl)throw Error("Failed to retrieve webgl context from browser");this.textureLoader=new Ut(this.__gl),this.snapToPixel=null!=s?s:this.snapToPixel,this.smoothing=null!=n?n:this.smoothing,this.backgroundColor=null!=o?o:this.backgroundColor,this.useDrawSorting=null!=r?r:this.useDrawSorting,this._drawCallPool.disableWarnings=!0,this._drawCallPool.preallocate(),this._init()}_init(){const t=this.__gl;this._ortho=Rt.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.register(new ae),this.register(new pe),this.register(new le),this.register(new he),this.register(new se),this.register(new ne),this._screenRenderer=new oe(t),this._renderTarget=new qt({gl:t,width:t.canvas.width,height:t.canvas.height}),this._postProcessTargets=[new qt({gl:t,width:t.canvas.width,height:t.canvas.height}),new qt({gl:t,width:t.canvas.width,height:t.canvas.height})]}register(t){this._renderers.set(t.type,t),t.initialize(this.__gl,this)}get(t){return this._renderers.get(t)}_isCurrentRenderer(t){return!this._currentRenderer||this._currentRenderer===t}beginDrawLifecycle(){this._isDrawLifecycle=!0}endDrawLifecycle(){this._isDrawLifecycle=!1}draw(t,...e){this._isDrawLifecycle||this._alreadyWarnedDrawLifecycle||(this._logger.warn("Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.\nIf you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler."),this._alreadyWarnedDrawLifecycle=!0);const i=this._renderers.get(t);if(!i)throw Error(`No renderer with name ${t} has been registered`);if(this.useDrawSorting){const n=this._drawCallPool.get();n.z=this._state.current.z,n.priority=i.priority,n.renderer=t,this.getTransform().clone(n.transform),n.state.z=this._state.current.z,n.state.opacity=this._state.current.opacity,n.state.tint=this._state.current.tint,n.state.material=this._state.current.material,n.args=e,this._drawCalls.push(n)}else this._currentRenderer||(this._currentRenderer=i),this._isCurrentRenderer(i)||this._currentRenderer.flush(),i.draw(...e),this._currentRenderer=i}resetTransform(){this._transform.current=It.identity()}updateViewport(t){const e=this.__gl;this._ortho=this._ortho=Rt.ortho(0,t.width,t.height,0,400,-400),this._renderTarget.setResolution(e.canvas.width,e.canvas.height),this._postProcessTargets[0].setResolution(e.canvas.width,e.canvas.height),this._postProcessTargets[1].setResolution(e.canvas.width,e.canvas.height)}drawImage(t,e,i,n,s,o,r,a,l){if(0!==n&&0!==s&&0!==a&&0!==l&&0!==t.width&&0!==t.height)return t?void(this._state.current.material?this.draw("ex.material",t,e,i,n,s,o,r,a,l):this.draw("ex.image",t,e,i,n,s,o,r,a,l)):(tt.getInstance().warn("Cannot draw a null or undefined image"),void(console.trace&&console.trace()))}drawLine(t,e,i,n=1){this.draw("ex.rectangle",t,e,i,n)}drawRectangle(t,e,i,n,s,o){this.draw("ex.rectangle",t,e,i,n,s,o)}drawCircle(t,e,i,n,s){this.draw("ex.circle",t,e,i,n,s)}save(){this._transform.save(),this._state.save()}restore(){this._transform.restore(),this._state.restore()}translate(t,e){this._transform.translate(this.snapToPixel?~~(t+ge):t,this.snapToPixel?~~(e+ge):e)}rotate(t){this._transform.rotate(t)}scale(t,e){this._transform.scale(t,e)}transform(t){this._transform.current=t}getTransform(){return this._transform.current}multiply(t){this._transform.current.multiply(t,this._transform.current)}addPostProcessor(t){this._postprocessors.push(t),t.initialize(this.__gl)}removePostProcessor(t){const e=this._postprocessors.indexOf(t);-1!==e&&this._postprocessors.splice(e,1)}clearPostProcessors(){this._postprocessors.length=0}updatePostProcessors(t){for(const e of this._postprocessors){const i=e.getShader();i.use();const n=i.getUniforms();this._totalPostProcessorTime+=t,n.find((t=>"u_time_ms"===t.name))&&i.setUniformFloat("u_time_ms",this._totalPostProcessorTime),n.find((t=>"u_elapsed_ms"===t.name))&&i.setUniformFloat("u_elapsed_ms",t),n.find((t=>"u_resolution"===t.name))&&i.setUniformFloatVector("u_resolution",yt(this.width,this.height)),e.onUpdate&&e.onUpdate(t)}}set material(t){this._state.current.material=t}get material(){return this._state.current.material}createMaterial(t){const e=new ue(t);return e.initialize(this.__gl,this),e}createShader(t){const e=this.__gl,{vertexSource:i,fragmentSource:n}=t,s=new Jt({gl:e,vertexSource:i,fragmentSource:n});return s.compile(),s}clear(){const t=this.__gl;this._renderTarget.use(),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT)}flush(){const t=this.__gl;if(this._renderTarget.use(),this.useDrawSorting){const t=new Map;for(const[e]of this._renderers){const i=this._drawCalls.findIndex((t=>t.renderer===e));t.set(e,i)}this._drawCalls.sort(((e,i)=>{const n=e.z-i.z,s=t.get(e.renderer)-t.get(i.renderer),o=e.priority-i.priority;return 0===n?0===o?s:o:n}));const e=this._transform.current,i=this._state.current;if(this._drawCalls.length){let t=this._drawCalls[0].renderer,e=this._renderers.get(t);for(let i=0;i<this._drawCalls.length;i++)this._transform.current=this._drawCalls[i].transform,this._state.current=this._drawCalls[i].state,this._drawCalls[i].renderer!==t&&(e.flush(),t=this._drawCalls[i].renderer,e=this._renderers.get(t)),e.draw(...this._drawCalls[i].args);e.hasPendingDraws()&&e.flush()}this._transform.current=e,this._state.current=i,this._drawCallPool.done(),this._drawCalls.length=0}else for(const t of this._renderers.values())t.hasPendingDraws()&&t.flush();this._renderTarget.disable(),this._renderTarget.toRenderSource().use();for(let t=0;t<this._postprocessors.length;t++)this._postProcessTargets[t%2].use(),this._screenRenderer.renderWithPostProcessor(this._postprocessors[t]),this._postProcessTargets[t%2].toRenderSource().use();t.bindFramebuffer(t.FRAMEBUFFER,null),this._screenRenderer.renderToScreen()}}const ve=1e-4;class _e{constructor(t){this._ex=t,this._debugText=new Kt}drawRect(t,e,i,n){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~(t+ve):t,this._ex.snapToPixel?~~(e+ve):e,this._ex.snapToPixel?~~(i+ve):i,this._ex.snapToPixel?~~(n+ve):n),this._ex.__ctx.restore()}drawLine(t,e,i={color:wt.Black}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=i.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~(t.x+ve):t.x,this._ex.snapToPixel?~~(t.y+ve):t.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~(e.x+ve):e.x,this._ex.snapToPixel?~~(e.y+ve):e.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawPoint(t,e={color:wt.Black,size:5}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=e.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~(t.x+ve):t.x,this._ex.snapToPixel?~~(t.y+ve):t.y,e.size,0,2*Math.PI),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawText(t,e){this._debugText.write(this._ex,t,e)}}class ye{get width(){return this.__ctx.canvas.width}get height(){return this.__ctx.canvas.height}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get smoothing(){return this.__ctx.imageSmoothingEnabled}set smoothing(t){this.__ctx.imageSmoothingEnabled=t}constructor(t){this.useDrawSorting=!1,this.z=0,this.backgroundColor=wt.ExcaliburBlue,this._state=new Pt,this.snapToPixel=!1,this.debug=new _e(this);const{canvasElement:e,enableTransparency:i,snapToPixel:n,smoothing:s,backgroundColor:o}=t;this.__ctx=e.getContext("2d",{alpha:null==i||i}),this.backgroundColor=null!=o?o:this.backgroundColor,this.snapToPixel=null!=n?n:this.snapToPixel,this.smoothing=null!=s?s:this.smoothing}resetTransform(){this.__ctx.resetTransform()}updateViewport(t){}drawImage(t,e,i,n,s,o,r,a,l){if(0===n||0===s)return;if(0===a||0===l)return;if(0===t.width||0===t.height)return;this.__ctx.globalAlpha=this.opacity;const h=[t,e,i,n,s,o,r,a,l].filter((t=>void 0!==t)).map((t=>"number"==typeof t&&this.snapToPixel?~~t:t));this.__ctx.drawImage.apply(this.__ctx,h),ie.DrawCallCount++,ie.DrawnImagesCount=1}drawLine(t,e,i,n=1){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=i.toString(),this.__ctx.moveTo(this.snapToPixel?~~(t.x+ve):t.x,this.snapToPixel?~~(t.y+ve):t.y),this.__ctx.lineTo(this.snapToPixel?~~(e.x+ve):e.x,this.snapToPixel?~~(e.y+ve):e.y),this.__ctx.lineWidth=n,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}drawRectangle(t,e,i,n){this.__ctx.save(),this.__ctx.fillStyle=n.toString(),this.__ctx.fillRect(this.snapToPixel?~~(t.x+ve):t.x,this.snapToPixel?~~(t.y+ve):t.y,this.snapToPixel?~~(e+ve):e,this.snapToPixel?~~(i+ve):i),this.__ctx.restore()}drawCircle(t,e,i,n,s){this.__ctx.save(),this.__ctx.beginPath(),n&&(this.__ctx.strokeStyle=n.toString()),s&&(this.__ctx.lineWidth=s),this.__ctx.fillStyle=i.toString(),this.__ctx.arc(this.snapToPixel?~~(t.x+ve):t.x,this.snapToPixel?~~(t.y+ve):t.y,e,0,2*Math.PI),this.__ctx.fill(),n&&this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}save(){this.__ctx.save()}restore(){this.__ctx.restore()}translate(t,e){this.__ctx.translate(this.snapToPixel?~~(t+ve):t,this.snapToPixel?~~(e+ve):e)}rotate(t){this.__ctx.rotate(t)}scale(t,e){this.__ctx.scale(t,e)}getTransform(){throw new Error("Not implemented")}multiply(t){this.__ctx.setTransform(this.__ctx.getTransform().multiply(t.toDOMMatrix()))}addPostProcessor(t){}removePostProcessor(t){}clearPostProcessors(){}updatePostProcessors(t){}beginDrawLifecycle(){}endDrawLifecycle(){}set material(t){this._state.current.material=t}get material(){return this._state.current.material}createMaterial(t){return null}clear(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),ie.clear()}flush(){}}var we;!function(t){t.Fixed="Fixed",t.FitContainerAndFill="FitContainerAndFill",t.FitScreenAndFill="FitScreenAndFill",t.FitContainerAndZoom="FitContainerAndZoom",t.FitScreenAndZoom="FitScreenAndZoom",t.FitScreen="FitScreen",t.FillScreen="FillScreen",t.FitContainer="FitContainer",t.FillContainer="FillContainer"}(we||(we={}));class xe{static get SVGA(){return{width:800,height:600}}static get Standard(){return{width:1920,height:1080}}static get Atari2600(){return{width:160,height:192}}static get GameBoy(){return{width:160,height:144}}static get GameBoyAdvance(){return{width:240,height:160}}static get NintendoDS(){return{width:256,height:192}}static get NES(){return{width:256,height:224}}static get SNES(){return{width:256,height:244}}}class be{constructor(t){var e,i,n;this._antialiasing=!0,this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=tt.getInstance(),this._fullscreenChangeHandler=()=>{this._isFullScreen=!this._isFullScreen,this._logger.debug("Fullscreen Change",this._isFullScreen)},this._pixelRatioChangeHandler=()=>{this._logger.debug("Pixel Ratio Change",window.devicePixelRatio),this._listenForPixelRatio(),this._devicePixelRatio=this._calculateDevicePixelRatio(),this.applyResolutionAndViewport()},this._resizeHandler=()=>{const t=this.parent;this._logger.debug("View port resized"),this._setResolutionAndViewportByDisplayMode(t),this.applyResolutionAndViewport()},this._devicePixelRatio=this._calculateDevicePixelRatio(),this._alreadyWarned=!1,this._contentArea=new At,this.viewport=t.viewport,this.resolution=null!==(e=t.resolution)&&void 0!==e?e:{...this.viewport},this._contentResolution=this.resolution,this._displayMode=null!==(i=t.displayMode)&&void 0!==i?i:we.Fixed,this._canvas=t.canvas,this.graphicsContext=t.context,this._antialiasing=null!==(n=t.antialiasing)&&void 0!==n?n:this._antialiasing,this._browser=t.browser,this._pixelRatioOverride=t.pixelRatio,this._applyDisplayMode(),this._listenForPixelRatio(),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler),this.applyResolutionAndViewport()}_listenForPixelRatio(){this._mediaQueryList&&!this._mediaQueryList.addEventListener&&this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener?this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler,{once:!0}):this._mediaQueryList.addListener(this._pixelRatioChangeHandler)}dispose(){this._isDisposed||(this._isDisposed=!0,this._browser.window.off("resize",this._resizeHandler),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener?this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler):this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler))}_calculateDevicePixelRatio(){return window.devicePixelRatio<1?1:window.devicePixelRatio||1}get pixelRatio(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}get isHiDpi(){return 1!==this.pixelRatio}get displayMode(){return this._displayMode}get canvas(){return this._canvas}get parent(){switch(this.displayMode){case we.FillContainer:case we.FitContainer:case we.FitContainerAndFill:case we.FitContainerAndZoom:return this.canvas.parentElement||document.body;default:return window}}get resolution(){return this._resolution}set resolution(t){this._resolution=t}get viewport(){return this._viewport?this._viewport:this._resolution}set viewport(t){this._viewport=t}get aspectRatio(){return this._resolution.width/this._resolution.height}get scaledWidth(){return this._resolution.width*this.pixelRatio}get scaledHeight(){return this._resolution.height*this.pixelRatio}setCurrentCamera(t){this._camera=t}pushResolutionAndViewport(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution={...this.resolution},this.viewport={...this.viewport}}peekViewport(){return this._viewportStack[this._viewportStack.length-1]}peekResolution(){return this._resolutionStack[this._resolutionStack.length-1]}popResolutionAndViewport(){this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop()}applyResolutionAndViewport(){this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this.graphicsContext instanceof me&&(this.graphicsContext.checkIfResolutionSupported({width:this.scaledWidth,height:this.scaledHeight})||this._alreadyWarned||(this._alreadyWarned=!0,this._logger.warn(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) and pixel ratio (${this.pixelRatio}) are too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly. Try reducing the resolution or disabling Hi DPI scaling to avoid this (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`))),this._antialiasing?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",""===this._canvas.style.imageRendering&&(this._canvas.style.imageRendering="crisp-edges")),this._canvas.style.width=this.viewport.width+"px",this._canvas.style.height=this.viewport.height+"px",this.graphicsContext.updateViewport(this.resolution),this.graphicsContext.resetTransform(),this.graphicsContext.smoothing=this._antialiasing,this.graphicsContext instanceof ye&&this.graphicsContext.scale(this.pixelRatio,this.pixelRatio)}get antialiasing(){return this._antialiasing}set antialiasing(t){this._antialiasing=t,this.graphicsContext.smoothing=this._antialiasing}get isFullScreen(){return this._isFullScreen}goFullScreen(t){if(t){const e=document.getElementById(t);if(e)return e.requestFullscreen()}return this._canvas.requestFullscreen()}exitFullScreen(){return document.exitFullscreen()}pageToScreenCoordinates(t){let e=t.x,i=t.y;if(this._isFullScreen||(e-=Et(this._canvas).x,i-=Et(this._canvas).y),this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const t=window.innerWidth/this.aspectRatio;i=(i-(window.innerHeight-t)/2)/t*this.viewport.height,e=e/window.innerWidth*this.viewport.width}else{const t=window.innerHeight*this.aspectRatio;e=(e-(window.innerWidth-t)/2)/t*this.viewport.width,i=i/window.innerHeight*this.viewport.height}return e=e/this.viewport.width*this.resolution.width,i=i/this.viewport.height*this.resolution.height,new _t(e,i)}screenToPageCoordinates(t){let e=t.x,i=t.y;if(e=e/this.resolution.width*this.viewport.width,i=i/this.resolution.height*this.viewport.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const t=window.innerWidth/this.aspectRatio,n=(window.innerHeight-t)/2;i=i/this.viewport.height*t+n,e=e/this.viewport.width*window.innerWidth}else{const t=window.innerHeight*this.aspectRatio,n=(window.innerWidth-t)/2;e=e/this.viewport.width*t+n,i=i/this.viewport.height*window.innerHeight}return this._isFullScreen||(e+=Et(this._canvas).x,i+=Et(this._canvas).y),new _t(e,i)}screenToWorldCoordinates(t){return this._camera?this._camera.inverse.multiply(t):t.sub(yt(this.resolution.width/2,this.resolution.height/2))}worldToScreenCoordinates(t){return this._camera?this._camera.transform.multiply(t):t.add(yt(this.resolution.width/2,this.resolution.height/2))}pageToWorldCoordinates(t){const e=this.pageToScreenCoordinates(t);return this.screenToWorldCoordinates(e)}worldToPageCoordinates(t){const e=this.worldToScreenCoordinates(t);return this.screenToPageCoordinates(e)}getWorldBounds(){return At.fromDimension(this.resolution.width,this.resolution.height,_t.Half).scale(yt(1/this._camera.zoom,1/this._camera.zoom)).rotate(this._camera.rotation).translate(this._camera.pos)}get canvasWidth(){return this.canvas.width}get halfCanvasWidth(){return this.canvas.width/2}get canvasHeight(){return this.canvas.height}get halfCanvasHeight(){return this.canvas.height/2}get drawWidth(){return this._camera?this.resolution.width/this._camera.zoom:this.resolution.width}get halfDrawWidth(){return this.drawWidth/2}get drawHeight(){return this._camera?this.resolution.height/this._camera.zoom:this.resolution.height}get halfDrawHeight(){return this.drawHeight/2}get center(){return yt(this.halfDrawWidth,this.halfDrawHeight)}get contentArea(){return this._contentArea}_computeFit(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=this.aspectRatio;let e=0,i=0;window.innerWidth/t<window.innerHeight?(e=window.innerWidth,i=window.innerWidth/t):(e=window.innerHeight*t,i=window.innerHeight),this.viewport={width:e,height:i},this._contentArea=At.fromDimension(this.resolution.width,this.resolution.height,_t.Zero)}_computeFitScreenAndFill(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=window.innerWidth,e=window.innerHeight;this._computeFitAndFill(t,e)}_computeFitContainerAndFill(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=this.canvas.parentElement,e=t.clientWidth,i=t.clientHeight;this._computeFitAndFill(e,i)}_computeFitAndFill(t,e){if(this.viewport={width:t,height:e},t/e<=this._contentResolution.width/this._contentResolution.height){this.resolution={width:t*this._contentResolution.width/t,height:t*this._contentResolution.width/t*e/t};const i=(this.resolution.height-this._contentResolution.height)/2;this._contentArea=new At({top:i,left:0,right:this._contentResolution.width,bottom:this.resolution.height-i})}else{this.resolution={width:e*this._contentResolution.height/e*t/e,height:e*this._contentResolution.height/e};const i=(this.resolution.width-this._contentResolution.width)/2;this._contentArea=new At({top:0,left:i,right:this.resolution.width-i,bottom:this._contentResolution.height})}}_computeFitScreenAndZoom(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";const t=window.innerWidth,e=window.innerHeight;this._computeFitAndZoom(t,e)}_computeFitContainerAndZoom(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";const t=this.canvas.parentElement;t.style.position="relative",t.style.overflow="hidden";const e=t.clientWidth,i=t.clientHeight;this._computeFitAndZoom(e,i)}_computeFitAndZoom(t,e){const i=this.aspectRatio;let n=0,s=0;t/i<e?(n=t,s=t/i):(n=e*i,s=e);const o=t/n,r=e/s,a=Math.max(o,r),l=n*a,h=s*a;this.canvas.style.left=l>t?-(l-t)/2+"px":"",this.canvas.style.top=h>e?-(h-e)/2+"px":"",this.viewport={width:l,height:h};const c=At.fromDimension(this.viewport.width,this.viewport.height,_t.Zero);if(this.viewport.width>t){const e=(this.viewport.width-t)/this.viewport.width*this.resolution.width;c.top=0,c.left=e/2,c.right=this.resolution.width-e/2,c.bottom=this.resolution.height}if(this.viewport.height>e){const t=(this.viewport.height-e)/this.viewport.height*this.resolution.height;c.top=t/2,c.left=0,c.bottom=this.resolution.height-t/2,c.right=this.resolution.width}this._contentArea=c}_computeFitContainer(){const t=this.aspectRatio;let e=0,i=0;const n=this.canvas.parentElement;n.clientWidth/t<n.clientHeight?(e=n.clientWidth,i=n.clientWidth/t):(e=n.clientHeight*t,i=n.clientHeight),this.viewport={width:e,height:i},this._contentArea=At.fromDimension(this.resolution.width,this.resolution.height,_t.Zero)}_applyDisplayMode(){this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver((()=>{this._resizeHandler()})),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler)}_setResolutionAndViewportByDisplayMode(t){this.displayMode===we.FillContainer&&(this.resolution={width:t.clientWidth,height:t.clientHeight},this.viewport=this.resolution),this.displayMode===we.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this._contentArea=At.fromDimension(this.resolution.width,this.resolution.height,_t.Zero),this.displayMode===we.FitScreen&&this._computeFit(),this.displayMode===we.FitContainer&&this._computeFitContainer(),this.displayMode===we.FitScreenAndFill&&this._computeFitScreenAndFill(),this.displayMode===we.FitContainerAndFill&&this._computeFitContainerAndFill(),this.displayMode===we.FitScreenAndZoom&&this._computeFitScreenAndZoom(),this.displayMode===we.FitContainerAndZoom&&this._computeFitContainerAndZoom()}}class Ce{static create(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}Ce._INSTANCE=null;class Ae{static unlock(){return new Promise(((t,e)=>{if(Ae._UNLOCKED||!Ce.create())return t(!0);const i=setTimeout((()=>{tt.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),t(!1)}),200),n=Ce.create();n.resume().then((()=>{const e=n.createBuffer(1,1,22050),s=n.createBufferSource();let o=!1;s.buffer=e,s.connect(n.destination),s.onended=()=>o=!0,s.start(0),setTimeout((()=>{!function(t){return!!t.playbackState}(s)?(n.currentTime>0||o)&&(Ae._UNLOCKED=!0):s.playbackState!==s.PLAYING_STATE&&s.playbackState!==s.FINISHED_STATE||(Ae._UNLOCKED=!0)}),0),clearTimeout(i),t(!0)}),(()=>{e()}))}))}static isUnlocked(){return this._UNLOCKED}}function Se(t,e=wt.Red,i,n,s,o,r=1,a="butt"){t.save(),t.beginPath(),t.lineWidth=r,t.lineCap=a,t.strokeStyle=e.toString(),t.moveTo(i,n),t.lineTo(s,o),t.closePath(),t.stroke(),t.restore()}function Ee(t,e=wt.Red,i){t.beginPath(),t.strokeStyle=e.toString(),t.arc(i.x,i.y,5,0,2*Math.PI),t.closePath(),t.stroke()}function Te(t,e,i,n,s=1){const o=e?e.toString():"blue",r=n.scale(s);t.beginPath(),t.strokeStyle=o,t.moveTo(i.x,i.y),t.lineTo(i.x+r.x,i.y+r.y),t.closePath(),t.stroke()}function ke(t,e,i,n,s,o=5,r=wt.White,a=null){let l;if("number"==typeof o)l={tl:o,tr:o,br:o,bl:o};else{const t={tl:0,tr:0,br:0,bl:0};for(const e in t)if(t.hasOwnProperty(e)){const i=e;l[i]=o[i]||t[i]}}t.beginPath(),t.moveTo(e+l.tl,i),t.lineTo(e+n-l.tr,i),t.quadraticCurveTo(e+n,i,e+n,i+l.tr),t.lineTo(e+n,i+s-l.br),t.quadraticCurveTo(e+n,i+s,e+n-l.br,i+s),t.lineTo(e+l.bl,i+s),t.quadraticCurveTo(e,i+s,e,i+s-l.bl),t.lineTo(e,i+l.tl),t.quadraticCurveTo(e,i,e+l.tl,i),t.closePath(),a&&(t.fillStyle=a.toString(),t.fill()),r&&(t.strokeStyle=r.toString(),t.stroke())}function Me(t,e,i,n,s=wt.White,o=null){t.beginPath(),t.arc(e,i,n,0,2*Math.PI),t.closePath(),o&&(t.fillStyle=o.toString(),t.fill()),s&&(t.strokeStyle=s.toString(),t.stroke())}Ae._UNLOCKED=!1;var $e=o(1388);class Le extends zt{constructor(t){var e,i,n,s,o,r,a,l,h,c;super(t),this.filtering=null,this.lineCap="butt",this.quality=1,this._dirty=!0,this._smoothing=!1,this._color=Ot(wt.Black,(()=>this.flagDirty())),this._lineWidth=1,this._lineDash=[],this._padding=0,t&&(this.quality=null!==(e=t.quality)&&void 0!==e?e:this.quality,this.color=null!==(i=t.color)&&void 0!==i?i:wt.Black,this.strokeColor=null==t?void 0:t.strokeColor,this.smoothing=null!==(n=t.smoothing)&&void 0!==n?n:this.smoothing,this.lineWidth=null!==(s=t.lineWidth)&&void 0!==s?s:this.lineWidth,this.lineDash=null!==(o=t.lineDash)&&void 0!==o?o:this.lineDash,this.lineCap=null!==(r=t.lineCap)&&void 0!==r?r:this.lineCap,this.padding=null!==(a=t.padding)&&void 0!==a?a:this.padding,this.filtering=null!==(l=t.filtering)&&void 0!==l?l:this.filtering),this._bitmap=document.createElement("canvas");const d=null!==(h=null==t?void 0:t.width)&&void 0!==h?h:this._bitmap.width,u=null!==(c=null==t?void 0:t.height)&&void 0!==c?c:this._bitmap.height;this.width=d,this.height=u;const p=this._bitmap.getContext("2d");if(!p)throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic");this._ctx=p}cloneRasterOptions(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,lineCap:this.lineCap,quality:this.quality,padding:this.padding}}get dirty(){return this._dirty}flagDirty(){this._dirty=!0}get width(){return Math.abs(this._getTotalWidth()*this.scale.x)}set width(t){t/=Math.abs(this.scale.x),this._bitmap.width=t,this._originalWidth=t,this.flagDirty()}get height(){return Math.abs(this._getTotalHeight()*this.scale.y)}set height(t){t/=Math.abs(this.scale.y),this._bitmap.height=t,this._originalHeight=t,this.flagDirty()}_getTotalWidth(){var t;return 1*((null!==(t=this._originalWidth)&&void 0!==t?t:this._bitmap.width)+2*this.padding)}_getTotalHeight(){var t;return 1*((null!==(t=this._originalHeight)&&void 0!==t?t:this._bitmap.height)+2*this.padding)}get localBounds(){return At.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,_t.Zero)}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this.flagDirty()}get color(){return this._color}set color(t){this.flagDirty(),this._color=Ot(t,(()=>this.flagDirty()))}get strokeColor(){return this._strokeColor}set strokeColor(t){this.flagDirty(),this._strokeColor=Ot(t,(()=>this.flagDirty()))}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this.flagDirty()}get lineDash(){return this._lineDash}set lineDash(t){this._lineDash=t,this.flagDirty()}get padding(){return this._padding}set padding(t){this._padding=t,this.flagDirty()}rasterize(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperties(this._ctx),this.execute(this._ctx),this._ctx.restore()}_applyRasterProperties(t){var e,i,n;this._bitmap.width=this._getTotalWidth()*this.quality,this._bitmap.height=this._getTotalHeight()*this.quality,this._bitmap.setAttribute("filtering",this.filtering),this._bitmap.setAttribute("forceUpload","true"),t.scale(this.quality,this.quality),t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash(null!==(e=this.lineDash)&&void 0!==e?e:t.getLineDash()),t.lineCap=this.lineCap,t.strokeStyle=null===(i=this.strokeColor)||void 0===i?void 0:i.toString(),t.fillStyle=null===(n=this.color)||void 0===n?void 0:n.toString()}_drawImage(t,e,i){this._dirty&&this.rasterize(),t.scale(1/this.quality,1/this.quality),t.drawImage(this._bitmap,e,i)}}class Re extends Le{get ctx(){return this._ctx}constructor(t){super(t),this._options=t}clone(){return new Re({...this._options,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){var e,i;(null===(e=this._options)||void 0===e?void 0:e.draw)&&(null===(i=this._options)||void 0===i||i.draw(t)),this._options.cache||this.flagDirty()}}class Ie{}Ie.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};class De{constructor(){this.states=new Map}get currentState(){return this._currentState}set currentState(t){this._currentState=t}static create(t,e){const i=new De;i.data=e;for(const e in t.states)i.states.set(e,{name:e,...t.states[e]});for(const t of i.states.values())for(const e of t.transitions)if("*"!==e&&!i.states.has(e))throw Error(`Invalid state machine, state [${t.name}] has a transition to another state that doesn't exist [${e}]`);return i.currentState=i.startState=i.states.get(t.start),i}in(t){return this.currentState.name===t}go(t,e){var i,n;if(this.currentState.transitions.includes(t)||this.currentState.transitions.includes("*")){const s=this.states.get(t);return(!this.currentState.onExit||!1!==(null===(i=this.currentState)||void 0===i?void 0:i.onExit({to:s.name,data:this.data})))&&((!(null==s?void 0:s.onEnter)||!1!==(null==s?void 0:s.onEnter({from:this.currentState.name,eventData:e,data:this.data})))&&(this.currentState=s,(null===(n=this.currentState)||void 0===n?void 0:n.onState)&&this.currentState.onState(),!0))}return!1}update(t){this.currentState.onUpdate&&this.currentState.onUpdate(this.data,t)}save(t){localStorage.setItem(t,JSON.stringify({currentState:this.currentState.name,data:this.data}))}restore(t){const e=JSON.parse(localStorage.getItem(t));this.currentState=this.states.get(e.currentState),this.data=e.data}}class Pe{_createNewBufferSource(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.value=this._playbackRate,this._instance.connect(this._volumeNode),this._volumeNode.connect(this._audioContext.destination)}_handleEnd(){this.loop||(this._instance.onended=()=>{this._playingResolve(!0)})}set loop(t){this._loop=t,this._instance&&(this._instance.loop=t,this.loop||(this._instance.onended=()=>{this._playingResolve(!0)}))}get loop(){return this._loop}set volume(t){t=dt(t,0,1),this._volume=t,this._stateMachine.in("PLAYING")&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}get volume(){return this._volume}get duration(){var t;return null!==(t=this._duration)&&void 0!==t?t:this.getTotalPlaybackDuration()}set duration(t){this._duration=t}constructor(t){this._src=t,this._audioContext=Ce.create(),this._volumeNode=this._audioContext.createGain(),this._playingPromise=new Promise((t=>{this._playingResolve=t})),this._stateMachine=De.create({start:"STOPPED",states:{PLAYING:{onEnter:({data:t})=>{this._createNewBufferSource(),this._handleEnd(),this.loop?this._instance.start(0,t.pausedAt*this._playbackRate):this._instance.start(0,t.pausedAt*this._playbackRate,this.duration),t.startedAt=this._audioContext.currentTime-t.pausedAt,t.pausedAt=0},onState:()=>this._playStarted(),onExit:({to:t})=>{"STOPPED"===t&&this._playingResolve(!0),this._instance.onended=null,this._instance.disconnect(),this._instance.stop(0),this._instance=null},transitions:["STOPPED","PAUSED","SEEK"]},SEEK:{onEnter:({eventData:t,data:e})=>{e.pausedAt=(null!=t?t:0)/this._playbackRate,e.startedAt=0},transitions:["*"]},STOPPED:{onEnter:({data:t})=>{t.pausedAt=0,t.startedAt=0,this._playingResolve(!0)},transitions:["PLAYING","PAUSED","SEEK"]},PAUSED:{onEnter:({data:t})=>{t.pausedAt=this._audioContext.currentTime-t.startedAt},transitions:["PLAYING","STOPPED","SEEK"]}}},{startedAt:0,pausedAt:0}),this._volume=1,this._loop=!1,this._playStarted=()=>{},this._playbackRate=1,this._createNewBufferSource()}isPlaying(){return this._stateMachine.in("PLAYING")}isPaused(){return this._stateMachine.in("PAUSED")||this._stateMachine.in("SEEK")}play(t=(()=>{})){return this._playStarted=t,this._stateMachine.go("PLAYING"),this._playingPromise}pause(){this._stateMachine.go("PAUSED")}stop(){this._stateMachine.go("STOPPED")}seek(t){this._stateMachine.go("PAUSED"),this._stateMachine.go("SEEK",t)}getTotalPlaybackDuration(){return this._src.duration}getPlaybackPosition(){const{pausedAt:t,startedAt:e}=this._stateMachine.data;return t?t*this._playbackRate:e?(this._audioContext.currentTime-e)*this._playbackRate:0}set playbackRate(t){this._instance.playbackRate.value=this._playbackRate=t}get playbackRate(){return this._instance.playbackRate.value}}class Be extends v{set bubbles(t){}get bubbles(){return!1}get _path(){return null}set _path(t){}constructor(t,e="MediaEvent"){super(),this.target=t,this._name=e}stopPropagation(){}action(){}propagate(){}layPath(t){}}class Fe extends Be{constructor(t,e){super(t,"NativeSoundEvent"),this.track=e}}class Oe extends Be{constructor(t,e){super(t,"NativeSoundProcessedEvent"),this._processedData=e,this.data=this._processedData}}function Ne(t){try{const e=new Audio,i=/.*\.([A-Za-z0-9]+)(?:(?:\?|\#).*)*$/,n=t.match(i)[1];return!!e.canPlayType("audio/"+n)}catch(t){return tt.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",t),!1}}const ze={VolumeChange:"volumechange",Processed:"processed",Pause:"pause",Stop:"stop",PlaybackEnd:"playbackend",Resume:"resume",PlaybackStart:"playbackstart"};class We{set loop(t){this._loop=t;for(const t of this._tracks)t.loop=this._loop;this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}get loop(){return this._loop}set volume(t){this._volume=t;for(const t of this._tracks)t.volume=this._volume;this.events.emit("volumechange",new Fe(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}get volume(){return this._volume}get duration(){return this._duration}set duration(t){this._duration=t}get instances(){return this._tracks}get path(){return this._resource.path}set path(t){this._resource.path=t}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}constructor(...t){this.events=new m,this.logger=tt.getInstance(),this._loop=!1,this._volume=1,this._isStopped=!1,this._tracks=[],this._wasPlayingOnHidden=!1,this._playbackRate=1,this._audioContext=Ce.create(),this._resource=new Ft("",Ie.type.arraybuffer);for(const e of t)if(Ne(e)){this.path=e;break}this.path||(this.logger.warn("This browser does not support any of the audio files specified:",t.join(", ")),this.logger.warn("Attempting to use",t[0]),this.path=t[0])}isLoaded(){return!!this.data}async load(){var t,e;if(this.data)return this.data;const i=await this._resource.load(),n=await this.decodeAudio(i.slice(0));return this._duration=null!==(e=null!==(t=this._duration)&&void 0!==t?t:null==n?void 0:n.duration)&&void 0!==e?e:void 0,this.events.emit("processed",new Oe(this,n)),this.data=n}async decodeAudio(t){try{return await this._audioContext.decodeAudioData(t.slice(0))}catch(t){return this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),await Promise.reject()}}wireEngine(t){t&&(this._engine=t,this._engine.on("hidden",(()=>{t.pauseAudioWhenHidden&&this.isPlaying()&&(this._wasPlayingOnHidden=!0,this.pause())})),this._engine.on("visible",(()=>{t.pauseAudioWhenHidden&&this._wasPlayingOnHidden&&(this.play(),this._wasPlayingOnHidden=!1)})),this._engine.on("start",(()=>{this._isStopped=!1})),this._engine.on("stop",(()=>{this.stop(),this._isStopped=!0})))}instanceCount(){return this._tracks.length}isPlaying(){return this._tracks.some((t=>t.isPlaying()))}isPaused(){return this._tracks.some((t=>t.isPaused()))}play(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this.isPaused()?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}pause(){if(this.isPlaying()){for(const t of this._tracks)t.pause();this.events.emit("pause",new Fe(this)),this.logger.debug("Paused all instances of sound",this.path)}}stop(){for(const t of this._tracks)t.stop();this.events.emit("stop",new Fe(this)),this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._tracks.forEach((t=>{t.playbackRate=this._playbackRate}))}seek(t,e=0){0===this._tracks.length&&this._getTrackInstance(this.data),this._tracks[e].seek(t)}getTotalPlaybackDuration(){return this.data.duration}getPlaybackPosition(t=0){return this._tracks.length?this._tracks[t].getPlaybackPosition():0}getTrackId(t){return this._tracks.indexOf(t)}async _resumePlayback(){if(this.isPaused){const t=[];for(const e of this._tracks)t.push(e.play().then((()=>(this.events.emit("playbackend",new Fe(this,e)),this._tracks.splice(this.getTrackId(e),1),!0))));this.events.emit("resume",new Fe(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),await Promise.all(t)}return!0}async _startPlayback(){const t=await this._getTrackInstance(this.data),e=await t.play((()=>{this.events.emit("playbackstart",new Fe(this,t)),this.logger.debug("Playing new instance for sound",this.path)}));return this.events.emit("playbackend",new Fe(this,t)),this._tracks.splice(this.getTrackId(t),1),e}_getTrackInstance(t){const e=new Pe(t);return e.loop=this.loop,e.volume=this.volume,e.duration=this.duration,e.playbackRate=this._playbackRate,this._tracks.push(e),e}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}}const He={};class Ue{get _image(){return this._imageElement||(this._imageElement=new Image,this._imageElement.src=this.logo),this._imageElement}get playButtonRootElement(){return this._playButtonRootElement}get playButtonElement(){return this._playButtonElement}get _playButton(){const t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}constructor(t){this.events=new m,this.canvas=new Re({filtering:Ht.Blended,smoothing:!0,cache:!0,draw:this.draw.bind(this)}),this._resourceList=[],this._index=0,this._playButtonShown=!1,this._resourceCount=0,this._numLoaded=0,this._progressCounts={},this._totalCounts={},this.logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAB2CAYAAABxhGI9AAAACXBIWXMAAAsSAAALEgHS3X78AAAKnUlEQVR42u3dP2wjSx0H8N8hJIonIRmJjsq0SBR+BQ1dcqKhe0lD77SvSwpKkJKGPulpktfRIMUdEqKIqV57rpAokM4dbSiyq7ONPTP7x39ifz7SFbnEnp3xer47O7uzH15fXwMA6OYHmgAABCoACFQAEKgAgEAFAIEKAAIVAAQqACBQAUCgAoBABQCBCgAIVAAQqAAgUAFAoAIAAhUABCoACFQAEKgAgECFLbmOiNeFf2PbAyz68Pr6qhUgbRwR92v+/zwiJrYHMEKFMmcN///UtgcQqFBk1PD/97U9Qx8VCFSgu4EmAIEKAAIVAAQqACBQ4Z25jojP8eX+0WtNAgIVaOY+Im5j+eKh24h41jQgUIEyZ7F5NaPU7wCBCiwYd/w9cOB+qAlgJ3KLLow0EV198803RWvJfvfddx+0lhEqHKu5JgAjVCBvlhmFzjQRXUekHz9+TP79y8uLRjNChXfvoePvAYEKxNtj1e42/O5JoIJABcrdRMRVLM+X3kTEpaaB988cKuzWg9EobTWdMx0Oly8uN4dqhAoARqgnaN3arHfqu7OyH8ItKLVB/P+CEfMTHyGPY3npx1m8zWGDEeoBfUk/xdti57dr/r1Wv2+6EPow3tZ5rRdS72s1neuF97xvWd+XTH0/V+UMttDWqbI/r2nrxfp+jv2uSjSO7S+OXy/A/3lN+9xX5T5HxEUPZZ0tfB71+w57eJ/HFu+z+jkv1u92YX9fbI/HhX3JA9rp5MPr66tWaG9UfUGbrHIzi7cLUyYFf/tpTady03EEeL8mUJ6i7MKYNvWNqr4Pe2jradXO60LrvPAz2PQ5RPX684ah8dxD+2zantnCgVipSVV+m/tgB9W2DDq2Sx/vM95wcHhZhWVJm8yrv58cSgfTdc70+++/X/r522+/tUKSEepBqo+om4ZLPerMjUwuNnQCtx1GWJtee1FwdD5uWd86xLs8UaVt2aNEO1/saZ/Z5rYMW4zq6v34rGV9Bg3q2eZ9SkeNm9qwyUh30OPIHYFKx5FG03C7znSOqYBq+qW/zpQ3anH037TNHluG6f0WPsPhHvab4QFty7ogOeuxDYcNy2/zu2214WNYWxmBurNO8bGn97pNBOO8xy/9uCorZZ4I2r4C7aJgO7ZV9iE49Dm6NvOWx+pWE9CUq3zbdTp9doz38TbXtzqH9RT5CyWe422OaZoZGeZCabrhPQY9HjwsjpTvCg4YtlE2+Ta/j2bzn8fqrDqgm+6yUHOmAvWUjAtGhbNYvsBknDnqH1Qhc7VmxHgeb/NbudA5j/UXlYwif2p6luhAc9teu1npiHKnDs8if6tCm7JLX3NKpgttXe9ruc9mHMd7a83iwdxF5vt8tutARaCeklRnNK9C8WnNF7geJQ4T4XG3JhSnVdilQrG+yOnrlVHfsEGYzhNBn7Lu6tS7+HJafJQ4EMiNlNqWXZ9WPvVgnVYHG5M1ByDXkT6leX2EgTqJtyt45yv7S2qO3sEZjZhDLXeR+YKdJ0Zdk8QocvH9N732KrNtq+FZ/zzIHABcJrYpd+Xv14lOd5ap76SgrduW/VTQ1qcQpqnbgu4ifZvUMNpd9XuoZmvCtPaQ2Y/BCHVLgbrJTeRPDdVf6pfMKDU2fOkHmVFFfXr3MsouLsnNvV5kRoe5+s431PeuoKPqWnaurY/ZPBEeqwceN4l96iwO6H7Mjq4y7VGPVNe10VaZMzVCPVWpI/Z6FZbcv5fMqGCU+dLfFGzj58jP8+bCdJCo7yzKTwdOF0bu9Ug7V4c+yz7FJfYeGoysUss0HssIdVZwYLDujMqlESoCdTtGsZtbHnJBeNdDSJSs0jTKdMJN1HNX54Wv7bvsU9NkVJVa13dX+/wuArV0X/l5RHyo/lnfF4G6p6DrS0kHdtXhy35TGErDPYZUn2WfWqDOo/lVqdMD2O/hKJhD7S/odukymq9s02QN4EEPR/zbaOumZc+r15zK1Zqznl9jsfiemTM1QmV3HUuTkedlg9HIQzRbUD93dfC+2tpj2fIHEH2+RqCCQH13gZq7hWXTNpVu19OB1fc9nQ0AKOKUb5lU0P1kDyOneoWk0lOZ9cIP0x7qu8+2BhCoR2wYu1+e7DmaXzBSsu5vaX1ne2zrpmUPTmxf7PM1Dm4y/vC7ny7Nif7+z/9ZmtM0Z3panPLtPmra9f16bcK0Dpbnwk43Vd/RHtu6zfNQTy1QBy3aqG2g9nVmxml+BOoJyT3NpWmn9xhfFnu4bvDa+44BXhqqfdf3uUF9+yz77AT31Yue2mjecYQ62NLfgkA9ghHqLNEhNem4H1c6vdyDxhf/bpz5m4coW/c39wi6VH2bPtHlcaV9cvXts+zxCe6rTeqc2ndL7uGd93QwM9bFcAzMoZZ7SgTBbWx+asui61h/iq1+RmjqdbnQXQ3T1DNQ63V/U9ucqm/pMzPb1rePsk/1iTOjgvatR4W3Lc8ULB78pELyrnAfeTcj1NU509/86mfJ33/8+Mf00a05UyPUEw7UVCeWG/WNEiExyHRMt5ltW30izUPk18ytt7lNfc8i//DvtvXto+ySA5BjljsLUF8lPkqMPEtW1JomDsiGBZ9Byb4NAvUITSN9GuwsIj6t6UTOqk7jJREkmzqli8xIs96udSO20sX0H1vW92IL9e1a9rgqVyf91gbPsTy9UD9n9lOkT8k+RfkFR5PMNqxOcdSf32PBvg3vilO+zdxE+okx9Wm0ph36XYsRZCpMF993GOk5qvqB3Dct6jvssb67KvuUNJ3frw92bhr8/STSF0JdRPMLpUCgnsgo9S76PZ246ZFk1wWvK5m3vVoYvW1Sz7nN91jfXbQ1ZQc7TW6HeaoOalypG/8/p/rP1aNAc6ZHzSnfdqPUPhdy2PQw6Nz9gSVhuhiqueUHR3uu7y7K3rdDX4u46ZrPbUa0IFBZ0seKQ3XQTRt2vm3W/a2DbNKys++rvm3ep6+y1x2UdP3bWU9lzra47U1GmlctX/sQ23t+aOlByLTh/4NAPaCRxtcdO5HLSJ/6vNtCwGx67VPmPbvWd1q9frKHtp4kAqRJ2HR9j762JfX3bZ//elPtj13PPDx1+D5tqk/Xi6NO8SHz7MmH19dXrdBNfVFP6T2PT1UHNit87/t4m5+aRH+nQBdvqyhZDKJLfZs8h7XPsqdV2ZOV+tanKB8aln0dyxdAXbV4j4gvt4oMOrbP6vbU73NW7TMlbdTnPrWpfqXfh9HKZ9vke7KuTeZRNtXRSe6+1FV//ce/ln5eXfsXgcqXzr6+9261M3moOoa7E6nvTZTfy7iNsmfb7kjfgXGsvxe0vihsEts9HTquPpt1q1vtahu2TqAiUAEEKj0zhwoARqgAu/OnX/442WH+9xc/Wvr58re/Tr7f41/+ZsRqhAoACFQAEKgAcHjMoQJskJsz/eqrr5Z+vvr7v5fmQFevAl5lztQIFQAQqAAgUAHgIJlDBdhgdQ41N2eKESoAIFABQKACwFEwhwoARqgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAEKgAgUAFAoAKAQAUAgQoACFQAEKgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAQqAAgUAFAoAKAQAUAlvwPcFDns1DsH4sAAAAASUVORK5CYII=",this.logoWidth=468,this.logoHeight=118,this.loadingBarColor=wt.White,this.backgroundColor="#176BAA",this.suppressPlayButton=!1,this._playButtonStyles=$e.Z.toString(),this.playButtonText="Play game",this.startButtonFactory=()=>{let t=document.getElementById("excalibur-play");return t||(t=document.createElement("button")),t.id="excalibur-play",t.textContent=this.playButtonText,t.style.display="none",t},this._loadingFuture=new St,t&&this.addResources(t)}wireEngine(t){this._engine=t,this.canvas.width=this._engine.canvas.width,this.canvas.height=this._engine.canvas.height}addResource(t){const e=this._index++;this._resourceList.push(t),this._progressCounts[e]=0,this._totalCounts[e]=1,this._resourceCount++}addResources(t){let e=0;const i=t.length;for(;e<i;e++)this.addResource(t[e])}isLoaded(){return this._numLoaded===this._resourceCount}async showPlayButton(){var t,e;if(!this.suppressPlayButton){const t=()=>{this._positionPlayButton()};(null===(e=this._engine)||void 0===e?void 0:e.browser)&&this._engine.browser.window.on("resize",t),this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",(t=>{"Enter"===t.key&&this._playButton.click()})),this._positionPlayButton();const i=new Promise((e=>{const i=i=>{var n;i.stopPropagation(),this.hidePlayButton(),(null===(n=this._engine)||void 0===n?void 0:n.browser)&&this._engine.browser.window.off("resize",t),e()};this._playButton.addEventListener("click",i),this._playButton.addEventListener("touchend",i),this._playButton.addEventListener("pointerup",i)}));return await i}this.hidePlayButton(),await Lt(500,null===(t=this._engine)||void 0===t?void 0:t.clock)}hidePlayButton(){this._playButtonShown=!1,this._playButton.style.display="none"}dispose(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}update(t,e){}areResourcesLoaded(){return this._loadingFuture.promise}async load(){var t,e;await(null===(t=this._image)||void 0===t?void 0:t.decode()),this.canvas.flagDirty(),await Promise.all(this._resourceList.map((async t=>{await t.load().finally((()=>{this._numLoaded++,this.canvas.flagDirty()}))})));for(const t of this._resourceList)t instanceof We&&t.wireEngine(this._engine);return this._loadingFuture.resolve(),await Lt(200,null===(e=this._engine)||void 0===e?void 0:e.clock),this.canvas.flagDirty(),await this.showPlayButton(),await Ae.unlock(),this.data=this._resourceList}markResourceComplete(){this._numLoaded++}get progress(){return this._resourceCount>0?dt(this._numLoaded,0,this._resourceCount)/this._resourceCount:1}_positionPlayButton(){if(this._engine){const t=this._engine.screen.viewport.height,e=this._engine.screen.viewport.width;if(this._playButtonRootElement){const i=this._engine.canvas.offsetLeft,n=this._engine.canvas.offsetTop,s=this._playButton.clientWidth,o=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left=`${this.playButtonPosition.x}px`,this._playButtonRootElement.style.top=`${this.playButtonPosition.y}px`):(this._playButtonRootElement.style.left=i+e/2-s/2+"px",this._playButtonRootElement.style.top=n+t/2-o/2+100+"px")}}}draw(t){const e=this._engine.canvasHeight/this._engine.pixelRatio,i=this._engine.canvasWidth/this._engine.pixelRatio;this._positionPlayButton(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,i,e);let n=e/2;const s=Math.min(this.logoWidth,.75*i);let o=i/2-s/2;this.logoPosition&&(o=this.logoPosition.x,n=this.logoPosition.y);const r=Math.floor(s*(this.logoHeight/this.logoWidth)),a=this._engine.getAntialiasing();if(this._engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,o,n,s,r):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,o,n-r-20,s,r),!this.suppressPlayButton&&this._playButtonShown)return void this._engine.setAntialiasing(a);let l=o,h=n;this.loadingBarPosition&&(l=this.loadingBarPosition.x,h=this.loadingBarPosition.y),t.lineWidth=2,ke(t,l,h,s,20,10,this.loadingBarColor);const c=s*this.progress-10;ke(t,l+5,h+5,c>10?c:10,10,5,null,this.loadingBarColor),this._engine.setAntialiasing(a)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}}const je={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"};class Ve{constructor(){this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){const t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},arrayBufferSupport:function(){const t=new XMLHttpRequest;t.open("GET","/");try{t.responseType="arraybuffer"}catch(t){return!1}return"arraybuffer"===t.responseType},dataUrlSupport:function(){return 0===document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){const t=document.createElement("a").style;return t.cssText="background-color:rgba(150,255,150,.5)",(""+t.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){const t=document.createElement("canvas");return!(!t.getContext||!t.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}getBrowserFeatures(){return null===this._features&&(this._features=this._loadBrowserFeatures()),this._features}logBrowserFeatures(){let t="%cSUPPORTED BROWSER FEATURES\n==========================%c\n";const e=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],i=this.getBrowserFeatures();for(const n of Object.keys(je))i[n]?(t+="(%c✓%c)",e.push("font-weight: bold; color: green"),e.push("font-weight: normal; color: inherit")):(t+="(%c✗%c)",e.push("font-weight: bold; color: red"),e.push("font-weight: normal; color: inherit")),t+=" "+je[n]+"\n";e.unshift(t),console.log.apply(console,e)}_loadBrowserFeatures(){return{canvas:(()=>this._criticalTests.canvasSupport())(),arraybuffer:(()=>this._criticalTests.arrayBufferSupport())(),dataurl:(()=>this._criticalTests.dataUrlSupport())(),objecturl:(()=>this._criticalTests.objectUrlSupport())(),rgba:(()=>this._criticalTests.rgbaSupport())(),webaudio:(()=>this._warningTest.webAudioSupport())(),webgl:(()=>this._warningTest.webglSupport())(),gamepadapi:!!navigator.getGamepads}}test(){let t=!1;for(const e in this._criticalTests)this._criticalTests[e].call(this)||(this.failedTests.push(e),tt.getInstance().error("Critical browser feature missing, Excalibur requires:",e),t=!0);if(t)return!1;for(const t in this._warningTest)this._warningTest[t]()||tt.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",t);return!0}}var Ge;!function(t){t.PreventCollision="PreventCollision",t.Passive="Passive",t.Active="Active",t.Fixed="Fixed"}(Ge||(Ge={}));const Ke=5,Ye={},qe=()=>{for(const t in Ye)Ye[t]=0},Xe=(t,e)=>{const i=g.isEnabled("suppress-obsolete-message");Ye[t]<Ke&&!i&&(tt.getInstance().warn(t),console.trace&&e.showStackTrace&&console.trace()),Ye[t]++};function Ze(t){return t={message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrace:!1,...t},function(e,i,n){if(n&&"function"!=typeof n.value&&"function"!=typeof n.get&&"function"!=typeof n.set)throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");const s=`${e.name||""}${e.name&&i?".":""}${i||""} is marked obsolete: ${t.message}`+(t.alternateMethod?` Use ${t.alternateMethod} instead`:"");Ye[s]||(Ye[s]=0);const o=n?{...n}:e;if(!n){class e extends o{constructor(...e){Xe(s,t),super(...e)}}return e}return n&&n.value?(o.value=function(){return Xe(s,t),n.value.apply(this,arguments)},o):(n&&n.get&&(o.get=function(){return Xe(s,t),n.get.apply(this,arguments)}),n&&n.set&&(o.set=function(){return Xe(s,t),n.set.apply(this,arguments)}),o)}}var Qe,Je,ti,ei;!function(t){t.Arcade="arcade",t.Realistic="realistic"}(Qe||(Qe={})),function(t){t[t.DynamicAABBTree=0]="DynamicAABBTree"}(Je||(Je={})),function(t){t[t.Euler=0]="Euler"}(ti||(ti={}));class ii{static get gravity(){return ii.acc}static set gravity(t){ii.acc=t}static useArcadePhysics(){ii.collisionResolutionStrategy=Qe.Arcade}static useRealisticPhysics(){ii.collisionResolutionStrategy=Qe.Realistic}static get dynamicTreeVelocityMultiplyer(){return ii.dynamicTreeVelocityMultiplier}static set dynamicTreeVelocityMultiplyer(t){ii.dynamicTreeVelocityMultiplier=t}}ii.acc=new _t(0,0),ii.enabled=!0,ii.broadphaseStrategy=Je.DynamicAABBTree,ii.collisionResolutionStrategy=Qe.Arcade,ii.defaultMass=10,ii.integrator=ti.Euler,ii.dynamicTreeVelocityMultiplier=2,ii.boundsPadding=5,ii.positionIterations=3,ii.velocityIterations=8,ii.slop=1,ii.steeringFactor=.2,ii.warmStart=!0,ii.bodiesCanSleepByDefault=!1,ii.surfaceEpsilon=.1,ii.sleepEpsilon=.07,ii.wakeThreshold=3*ii.sleepEpsilon,ii.sleepBias=.9,ii.checkForFastBodies=!0,ii.disableMinimumSpeedForFastBody=!1,function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);o>3&&r&&Object.defineProperty(e,i,r)}([Ze({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"dynamicTreeVelocityMultiplier"})],ii,"dynamicTreeVelocityMultiplyer",null),function(t){t.World="world",t.Screen="screen"}(ei||(ei={}));class ni extends _t{constructor(t){super(0,0),this._getX=t.getX,this._getY=t.getY,this._setX=t.setX,this._setY=t.setY}get x(){return this._x=this._getX()}set x(t){this._setX(t),this._x=t}get y(){return this._y=this._getY()}set y(t){this._setY(t),this._y=t}}class si extends _t{constructor(t,e){super(t.x,t.y),this.original=t,this.change=e}get x(){return this._x=this.original.x}set x(t){this.change(t,this._y),this._x=this.original.x=t}get y(){return this._y=this.original.y}set y(t){this.change(this._x,t),this._y=this.original.y=t}}class oi{constructor(){this._parent=null,this._children=[],this._pos=yt(0,0),this._rotation=0,this._scale=yt(1,1),this._isDirty=!1,this._isInverseDirty=!1,this._matrix=It.identity(),this._inverse=It.identity()}get parent(){return this._parent}set parent(t){if(this._parent){const t=this._parent._children.indexOf(this);t>-1&&this._parent._children.splice(t,1)}this._parent=t,this._parent&&this._parent._children.push(this),this.flagDirty()}get children(){return this._children}set pos(t){t.equals(this._pos)||(this._pos.x=t.x,this._pos.y=t.y,this.flagDirty())}get pos(){return new si(this._pos,((t,e)=>{t===this._pos.x&&e===this._pos.y||this.flagDirty()}))}set globalPos(t){let e=t.clone();this.parent&&(e=this.parent.inverse.multiply(t)),e.equals(this._pos)||(this._pos=e,this.flagDirty())}get globalPos(){return new ni({getX:()=>this.matrix.data[4],getY:()=>this.matrix.data[5],setX:t=>{if(this.parent){const{x:e}=this.parent.inverse.multiply(yt(t,this.pos.y));this.pos.x=e}else this.pos.x=t;t!==this.matrix.data[4]&&this.flagDirty()},setY:t=>{if(this.parent){const{y:e}=this.parent.inverse.multiply(yt(this.pos.x,t));this.pos.y=e}else this.pos.y=t;t!==this.matrix.data[5]&&this.flagDirty()}})}set rotation(t){const e=ut(t);e!==this._rotation&&this.flagDirty(),this._rotation=e}get rotation(){return this._rotation}set globalRotation(t){let e=0;this.parent&&(e=this.parent.globalRotation);const i=ut(t+e);i!==this._rotation&&this.flagDirty(),this._rotation=i}get globalRotation(){return this.parent?this.matrix.getRotation():this.rotation}set scale(t){t.equals(this._scale)||(this._scale.x=t.x,this._scale.y=t.y,this.flagDirty())}get scale(){return new si(this._scale,((t,e)=>{t===this._scale.x&&e===this._scale.y||this.flagDirty()}))}set globalScale(t){let e=yt(1,1);this.parent&&(e=this.parent.globalScale),this.scale=t.scale(yt(1/e.x,1/e.y))}get globalScale(){return new ni({getX:()=>this.parent?this.matrix.getScaleX():this.scale.x,getY:()=>this.parent?this.matrix.getScaleY():this.scale.y,setX:t=>{if(this.parent){const e=this.parent.globalScale.x;this.scale.x=t/e}else this.scale.x=t},setY:t=>{if(this.parent){const e=this.parent.globalScale.y;this.scale.y=t/e}else this.scale.y=t}})}get matrix(){return this._isDirty&&(null===this.parent?this._matrix=this._calculateMatrix():this._matrix=this.parent.matrix.multiply(this._calculateMatrix()),this._isDirty=!1),this._matrix}get inverse(){return this._isInverseDirty&&(this._inverse=this.matrix.inverse(),this._isInverseDirty=!1),this._inverse}_calculateMatrix(){return It.identity().translate(this.pos.x,this.pos.y).rotate(this.rotation).scale(this.scale.x,this.scale.y)}flagDirty(){this._isDirty=!0,this._isInverseDirty=!0;for(let t=0;t<this._children.length;t++)this._children[t].flagDirty()}apply(t){return this.matrix.multiply(t)}applyInverse(t){return this.inverse.multiply(t)}setTransform(t,e,i){this._pos.x=t.x,this._pos.y=t.y,this._rotation=ut(e),this._scale.x=i.x,this._scale.y=i.y,this.flagDirty()}clone(t){const e=null!=t?t:new oi;return this._pos.clone(e._pos),e._rotation=this._rotation,this._scale.clone(e._scale),e.flagDirty(),e}}class ri{constructor(){this.owner=null}clone(){const t=new this.constructor;for(const i in this)if(this.hasOwnProperty(i)){const n=this[i];(null==(e=n)?void 0:e.clone)&&"owner"!==i&&"clone"!==i?t[i]=n.clone():t[i]=n}var e;return t}}class ai extends ri{constructor(t,e){super(),this.type=t,this.value=e}}class li{constructor(){this.observers=[],this.subscriptions=[]}register(t){this.observers.push(t)}subscribe(t){this.subscriptions.push(t)}unregister(t){const e=this.observers.indexOf(t);-1!==e&&this.observers.splice(e,1)}unsubscribe(t){const e=this.subscriptions.indexOf(t);-1!==e&&this.subscriptions.splice(e,1)}notifyAll(t){const e=this.observers.length;for(let i=0;i<e;i++)this.observers[i].notify(t);const i=this.subscriptions.length;for(let e=0;e<i;e++)this.subscriptions[e](t)}clear(){this.observers.length=0,this.subscriptions.length=0}}class hi extends ri{constructor(){super(...arguments),this.type="ex.transform",this._transform=new oi,this._addChildTransform=t=>{const e=t.get(hi);e&&(e._transform.parent=this._transform)},this.zIndexChanged$=new li,this._z=0,this.coordPlane=ei.World}get(){return this._transform}onAdd(t){for(const e of t.children)this._addChildTransform(e);t.childrenAdded$.subscribe((t=>this._addChildTransform(t))),t.childrenRemoved$.subscribe((t=>{const e=t.get(hi);e&&(e._transform.parent=null)}))}onRemove(t){this._transform.parent=null}get z(){return this._z}set z(t){const e=this._z;this._z=t,e!==t&&this.zIndexChanged$.notifyAll(t)}get pos(){return this._transform.pos}set pos(t){this._transform.pos=t}get globalPos(){return this._transform.globalPos}set globalPos(t){this._transform.globalPos=t}get rotation(){return this._transform.rotation}set rotation(t){this._transform.rotation=t}get globalRotation(){return this._transform.globalRotation}set globalRotation(t){this._transform.globalRotation=t}get scale(){return this._transform.scale}set scale(t){this._transform.scale=t}get globalScale(){return this._transform.globalScale}set globalScale(t){this._transform.globalScale=t}applyInverse(t){return this._transform.applyInverse(t)}apply(t){return this._transform.apply(t)}clone(){const t=new hi;return t._transform=this._transform.clone(),t._z=this._z,t}}class ci extends ri{constructor(){super(...arguments),this.type="ex.motion",this.vel=_t.Zero,this.acc=_t.Zero,this.scaleFactor=_t.Zero,this.angularVelocity=0,this.torque=0,this.inertia=1}}class di{constructor(t,e,i){this._name=t,this._category=e,this._mask=i}get name(){return this._name}get category(){return this._category}get mask(){return this._mask}canCollide(t){return 0!=(this.category&t.mask)&&0!=(t.category&this.mask)}invert(){return new di("~("+this.name+")",~this.category,~this.mask)}static combine(t){const e=t.map((t=>t.name)).join("+"),i=t.reduce(((t,e)=>e.category|t),0);return new di(e,i,~i)}static collidesWith(t){return di.combine(t).invert()}}di.All=new di("Collide with all groups",-1,-1);class ui{constructor(t,e){this.colliderA=t,this.colliderB=e,this.id=null,this.id=ui.calculatePairHash(t.id,e.id)}static canCollide(t,e){var i,n;const s=null===(i=null==t?void 0:t.owner)||void 0===i?void 0:i.get(Ri),o=null===(n=null==e?void 0:e.owner)||void 0===n?void 0:n.get(Ri);return!(t.id===e.id||t.owner&&e.owner&&t.owner.id===e.owner.id||t.localBounds.hasZeroDimensions()||e.localBounds.hasZeroDimensions()||!s||!o||!s.group.canCollide(o.group)||s.collisionType===Ge.Fixed&&o.collisionType===Ge.Fixed||o.collisionType===Ge.PreventCollision||s.collisionType===Ge.PreventCollision||!s.active||!o.active)}get canCollide(){const t=this.colliderA,e=this.colliderB;return ui.canCollide(t,e)}collide(){return this.colliderA.collide(this.colliderB)}hasCollider(t){return t===this.colliderA||t===this.colliderB}static calculatePairHash(t,e){return t.value<e.value?`#${t.value}+${e.value}`:`#${e.value}+${t.value}`}}class pi{constructor(t,e){this.min=t,this.max=e}overlaps(t){return this.max>t.min&&t.max>this.min}getOverlap(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0}}class gi{constructor(t){this.parent=t,this.parent=t||null,this.data=null,this.bounds=new At,this.left=null,this.right=null,this.height=0}isLeaf(){return!this.left&&!this.right}}class fi{constructor(t=new At(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)){this.worldBounds=t,this.root=null,this.nodes={}}_insert(t){if(null===this.root)return this.root=t,void(this.root.parent=null);const e=t.bounds;let i=this.root;for(;!i.isLeaf();){const t=i.left,n=i.right,s=i.bounds.getPerimeter(),o=i.bounds.combine(e).getPerimeter(),r=2*o,a=2*(o-s);let l=0;const h=e.combine(t.bounds);let c,d;t.isLeaf()?l=h.getPerimeter()+a:(d=t.bounds.getPerimeter(),c=h.getPerimeter(),l=c-d+a);let u=0;const p=e.combine(n.bounds);if(n.isLeaf()?u=p.getPerimeter()+a:(d=n.bounds.getPerimeter(),c=p.getPerimeter(),u=c-d+a),r<l&&r<u)break;i=l<u?t:n}const n=i.parent,s=new gi(n);s.bounds=e.combine(i.bounds),s.height=i.height+1,null!==n?(n.left===i?n.left=s:n.right=s,s.left=i,s.right=t,i.parent=s,t.parent=s):(s.left=i,s.right=t,i.parent=s,t.parent=s,this.root=s);let o=t.parent;for(;o;){if(o=this._balance(o),!o.left)throw new Error("Parent of current leaf cannot have a null left child"+o);if(!o.right)throw new Error("Parent of current leaf cannot have a null right child"+o);o.height=1+Math.max(o.left.height,o.right.height),o.bounds=o.left.bounds.combine(o.right.bounds),o=o.parent}}_remove(t){if(t===this.root)return void(this.root=null);const e=t.parent,i=e.parent;let n;if(n=e.left===t?e.right:e.left,i){i.left===e?i.left=n:i.right=n,n.parent=i;let t=i;for(;t;)t=this._balance(t),t.bounds=t.left.bounds.combine(t.right.bounds),t.height=1+Math.max(t.left.height,t.right.height),t=t.parent}else this.root=n,n.parent=null}trackCollider(t){const e=new gi;e.data=t,e.bounds=t.bounds,e.bounds.left-=2,e.bounds.top-=2,e.bounds.right+=2,e.bounds.bottom+=2,this.nodes[t.id.value]=e,this._insert(e)}updateCollider(t){var e;const i=this.nodes[t.id.value];if(!i)return!1;const n=t.bounds;if(!this.worldBounds.contains(n))return tt.getInstance().warn("Collider with id "+t.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(t),!1;if(i.bounds.contains(n))return!1;if(this._remove(i),n.left-=ii.boundsPadding,n.top-=ii.boundsPadding,n.right+=ii.boundsPadding,n.bottom+=ii.boundsPadding,t.owner){const i=null===(e=t.owner)||void 0===e?void 0:e.get(Ri);if(i){const t=32*i.vel.x/1e3*ii.dynamicTreeVelocityMultiplier,e=32*i.vel.y/1e3*ii.dynamicTreeVelocityMultiplier;t<0?n.left+=t:n.right+=t,e<0?n.top+=e:n.bottom+=e}}return i.bounds=n,this._insert(i),!0}untrackCollider(t){const e=this.nodes[t.id.value];e&&(this._remove(e),this.nodes[t.id.value]=null,delete this.nodes[t.id.value])}_balance(t){if(null===t)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;const e=t.left,i=t.right,n=t,s=e,o=i,r=e.left,a=e.right,l=i.left,h=i.right,c=o.height-s.height;if(c>1)return o.left=n,o.parent=n.parent,n.parent=o,o.parent?o.parent.left===n?o.parent.left=o:o.parent.right=o:this.root=o,l.height>h.height?(o.right=l,n.right=h,h.parent=n,n.bounds=s.bounds.combine(h.bounds),o.bounds=n.bounds.combine(l.bounds),n.height=1+Math.max(s.height,h.height),o.height=1+Math.max(n.height,l.height)):(o.right=h,n.right=l,l.parent=n,n.bounds=s.bounds.combine(l.bounds),o.bounds=n.bounds.combine(h.bounds),n.height=1+Math.max(s.height,l.height),o.height=1+Math.max(n.height,h.height)),o;if(c<-1){if(s.left=n,s.parent=n.parent,n.parent=s,s.parent)if(s.parent.left===n)s.parent.left=s;else{if(s.parent.right!==n)throw"Error rotating Dynamic Tree";s.parent.right=s}else this.root=s;return r.height>a.height?(s.right=r,n.left=a,a.parent=n,n.bounds=o.bounds.combine(a.bounds),s.bounds=n.bounds.combine(r.bounds),n.height=1+Math.max(o.height,a.height),s.height=1+Math.max(n.height,r.height)):(s.right=a,n.left=r,r.parent=n,n.bounds=o.bounds.combine(r.bounds),s.bounds=n.bounds.combine(a.bounds),n.height=1+Math.max(o.height,r.height),s.height=1+Math.max(n.height,a.height)),s}return t}getHeight(){return null===this.root?0:this.root.height}query(t,e){const i=t.bounds,n=s=>{if(s&&s.bounds.overlaps(i)){if(!s.isLeaf()||s.data===t)return n(s.left)||n(s.right);if(e.call(t,s.data))return!0}return!1};n(this.root)}rayCastQuery(t,e=1/0,i){const n=s=>{if(s&&s.bounds.rayCast(t,e)){if(!s.isLeaf())return n(s.left)||n(s.right);if(i.call(t,s.data))return!0}return!1};n(this.root)}getNodes(){const t=e=>e?[e].concat(t(e.left),t(e.right)):[];return t(this.root)}debug(t){const e=i=>{i&&(i.isLeaf()?i.bounds.draw(t,wt.Green):i.bounds.draw(t,wt.White),i.left&&e(i.left),i.right&&e(i.right))};e(this.root)}}class mi{constructor(t,e){this.pos=t,this.dir=e.normalize()}intersect(t){const e=t.begin.sub(this.pos);if(0===this.dir.cross(t.getSlope())&&0!==e.cross(this.dir))return-1;const i=this.dir.cross(t.getSlope());if(0===i)return-1;const n=e.cross(t.getSlope())/i;if(n>=0){const s=e.cross(this.dir)/i/t.getLength();if(s>=0&&s<=1)return n}return-1}intersectPoint(t){const e=this.intersect(t);return e<0?null:this.getPoint(e)}getPoint(t){return this.pos.add(this.dir.scale(t))}}class vi{constructor(){this._dynamicCollisionTree=new fi,this._pairs=new Set,this._collisionPairCache=[],this._colliders=[]}getColliders(){return this._colliders}rayCast(t,e){var i,n,s;const o=[],r=null!==(i=null==e?void 0:e.maxDistance)&&void 0!==i?i:1/0,a=null!==(n=null==e?void 0:e.collisionGroup)&&void 0!==n?n:di.All,l=null!==(s=null==e?void 0:e.searchAllColliders)&&void 0!==s&&s;return this._dynamicCollisionTree.rayCastQuery(t,r,(e=>{var i;const n=e.owner.get(Ri);if(a.mask!==di.All.mask&&(null===(i=null==n?void 0:n.group)||void 0===i?void 0:i.mask)!==a.mask)return!1;const s=e.rayCast(t,r);return!(!s||(o.push({distance:s.sub(t.pos).distance(),point:s,collider:e,body:n}),l))})),o}track(t){if(t)if(t instanceof yi){const e=t.getColliders();for(const i of e)i.owner=t.owner,this._colliders.push(i),this._dynamicCollisionTree.trackCollider(i)}else this._colliders.push(t),this._dynamicCollisionTree.trackCollider(t);else tt.getInstance().warn("Cannot track null collider")}untrack(t){if(t)if(t instanceof yi){const e=t.getColliders();for(const t of e){const e=this._colliders.indexOf(t);-1!==e&&this._colliders.splice(e,1),this._dynamicCollisionTree.untrackCollider(t)}}else{const e=this._colliders.indexOf(t);-1!==e&&this._colliders.splice(e,1),this._dynamicCollisionTree.untrackCollider(t)}else tt.getInstance().warn("Cannot untrack a null collider")}_pairExists(t,e){const i=ui.calculatePairHash(t.id,e.id);return this._pairs.has(i)}broadphase(t,e,i){const n=e/1e3,s=t.filter((t=>{var e,i;const n=null===(e=t.owner)||void 0===e?void 0:e.get(Ri);return(null===(i=t.owner)||void 0===i?void 0:i.active)&&n.collisionType!==Ge.PreventCollision}));let o;this._collisionPairCache=[],this._pairs.clear();for(let t=0,e=s.length;t<e;t++)o=s[t],this._dynamicCollisionTree.query(o,(t=>{if(!this._pairExists(o,t)&&ui.canCollide(o,t)){const e=new ui(o,t);this._pairs.add(e.id),this._collisionPairCache.push(e)}return!1}));if(i&&(i.physics.pairs=this._collisionPairCache.length),ii.checkForFastBodies)for(const t of s){const e=t.owner.get(Ri);if(e.collisionType!==Ge.Active)continue;const s=e.vel.size*n+.5*e.acc.size*n*n,o=Math.min(t.bounds.height,t.bounds.width);if(ii.disableMinimumSpeedForFastBody||s>o/2){i&&i.physics.fastBodies++;const n=e.globalPos.sub(e.oldPos),o=t.center,r=t.getFurthestPoint(e.vel),a=r.sub(n),l=new mi(a,e.vel);let h;l.pos=l.pos.add(l.dir.scale(-2*ii.surfaceEpsilon));let c=new _t(1/0,1/0);if(this._dynamicCollisionTree.rayCastQuery(l,s+2*ii.surfaceEpsilon,(e=>{if(!this._pairExists(t,e)&&ui.canCollide(t,e)){const t=e.rayCast(l,s+10*ii.surfaceEpsilon);if(t){const i=t.sub(a);i.size<c.size&&(c=i,h=e)}}return!1})),h&&_t.isValid(c)){const n=new ui(t,h);this._pairs.has(n.id)||(this._pairs.add(n.id),this._collisionPairCache.push(n));const s=o.sub(r);e.globalPos=a.add(s).add(c).add(l.dir.scale(10*ii.surfaceEpsilon)),t.update(e.transform.get()),i&&i.physics.fastBodyCollisions++}}}return this._collisionPairCache}narrowphase(t,e){let i=[];for(let n=0;n<t.length;n++){const s=t[n].collide();if(i=i.concat(s),e&&s.length>0)for(const t of s)e.physics.contacts.set(t.id,t)}return e&&(e.physics.collisions+=i.length),i}update(t){let e=0;const i=t.length;for(let n=0;n<i;n++)this._dynamicCollisionTree.updateCollider(t[n])&&e++;return e}debug(t){this._dynamicCollisionTree.debug(t)}}class _i{constructor(){this.id=f("collider",_i._ID++),this.__compositeColliderId=null,this.events=new m}touching(t){return!!this.collide(t)}}_i._ID=0;class yi extends _i{constructor(t){super(),this._collisionProcessor=new vi,this._dynamicAABBTree=new fi,this._colliders=[];for(const e of t)this.addCollider(e)}clearColliders(){this._colliders=[]}addCollider(t){t.events.pipe(this.events),t.__compositeColliderId=this.id,this._colliders.push(t),this._collisionProcessor.track(t),this._dynamicAABBTree.trackCollider(t)}removeCollider(t){t.events.pipe(this.events),t.__compositeColliderId=null,kt(t,this._colliders),this._collisionProcessor.untrack(t),this._dynamicAABBTree.untrackCollider(t)}getColliders(){return this._colliders}get worldPos(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:_t.Zero}get center(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:_t.Zero}get bounds(){var t,e;const i=this.getColliders();return i.reduce(((t,e)=>t.combine(e.bounds)),null!==(e=null===(t=i[0])||void 0===t?void 0:t.bounds)&&void 0!==e?e:(new At).translate(this.worldPos))}get localBounds(){var t,e;const i=this.getColliders();return i.reduce(((t,e)=>t.combine(e.localBounds)),null!==(e=null===(t=i[0])||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new At)}get axes(){const t=this.getColliders();let e=[];for(const i of t)e=e.concat(i.axes);return e}getFurthestPoint(t){const e=this.getColliders(),i=[];for(const n of e)i.push(n.getFurthestPoint(t));let n=i[0],s=-Number.MAX_VALUE;for(const e of i){const i=e.dot(t);i>s&&(n=e,s=i)}return n}getInertia(t){const e=this.getColliders();let i=0;for(const n of e)i+=n.getInertia(t);return i}collide(t){let e=[t];t instanceof yi&&(e=t.getColliders());const i=[];for(const t of e)this._dynamicAABBTree.query(t,(e=>(i.push(new ui(t,e)),!1)));let n=[];for(const t of i)n=n.concat(t.collide());return n}getClosestLineBetween(t){const e=this.getColliders(),i=[];if(t instanceof yi){const n=t.getColliders();for(const t of e)for(const e of n){const n=t.getClosestLineBetween(e);n&&i.push(n)}}else for(const n of e){const e=t.getClosestLineBetween(n);e&&i.push(e)}if(i.length){let t=i[0].getLength(),e=i[0];for(const n of i){const i=n.getLength();i<t&&(t=i,e=n)}return e}return null}contains(t){const e=this.getColliders();for(const i of e)if(i.contains(t))return!0;return!1}rayCast(t,e){const i=this.getColliders(),n=[];for(const s of i){const i=s.rayCast(t,e);i&&n.push(i)}if(n.length){let e=n[0],i=e.dot(t.dir);for(const s of n){const n=t.dir.dot(s);n<i&&(e=s,i=n)}return e}return null}project(t){const e=this.getColliders(),i=[];for(const n of e){const e=n.project(t);e&&i.push(e)}if(i.length){const t=new pi(i[0].min,i[0].max);for(const e of i)t.min=Math.min(e.min,t.min),t.max=Math.max(e.max,t.max);return t}return null}update(t){if(t){const e=this.getColliders();for(const i of e)i.owner=this.owner,i.update(t)}}debug(t,e){const i=this.getColliders();for(const n of i)n.debug(t,e)}clone(){return new yi(this._colliders.map((t=>t.clone())))}}class wi{constructor(t,e){this.begin=t,this.end=e}get slope(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}get intercept(){return this.begin.y-this.slope*this.begin.x}normal(){return this._normal?this._normal:this._normal=this.end.sub(this.begin).normal()}dir(){return this._dir?this._dir:this._dir=this.end.sub(this.begin)}getPoints(){return[this.begin,this.end]}getSlope(){if(this._slope)return this._slope;const t=this.begin,e=this.end,i=t.distance(e);return this._slope=e.sub(t).scale(1/i)}getEdge(){const t=this.begin;return this.end.sub(t)}getLength(){if(this._length)return this._length;const t=this.begin,e=this.end,i=t.distance(e);return this._length=i}get midpoint(){return this.begin.add(this.end).scale(.5)}flip(){return new wi(this.end,this.begin)}below(t){return(this.end.x-this.begin.x)*(t.y-this.begin.y)-(this.end.y-this.begin.y)*(t.x-this.begin.x)>=0}clip(t,e){let i=t;i=i.normalize();const n=i.dot(this.begin)-e,s=i.dot(this.end)-e,o=[];if(n<=0&&o.push(this.begin),s<=0&&o.push(this.end),n*s<0){const t=n/(n-s);o.push(this.begin.add(this.end.sub(this.begin).scale(t)))}return 2!==o.length?null:new wi(o[0],o[1])}distanceToPoint(t,e=!1){const i=t.x,n=t.y,s=this.getLength(),o=((this.end.y-this.begin.y)*i-(this.end.x-this.begin.x)*n+this.end.x*this.begin.y-this.end.y*this.begin.x)/s;return e?o:Math.abs(o)}findVectorToPoint(t){const e=this.begin.sub(t),i=this.getSlope();return e.sub(i.scale(e.dot(i)))}findPoint(t=null,e=null){const i=this.slope,n=this.intercept;if(null!==t)return new _t(t,i*t+n);if(null!==e)return new _t((e-n)/i,e);throw new Error("You must provide an X or a Y value")}hasPoint(){let t,e=0;if("number"==typeof arguments[0]&&"number"==typeof arguments[1])t=new _t(arguments[0],arguments[1]),e=arguments[2]||0;else{if(!(arguments[0]instanceof _t))throw"Could not determine the arguments for Vector.hasPoint";t=arguments[0],e=arguments[1]||0}const i=t.x-this.begin.x,n=t.y-this.begin.y,s=this.end.x-this.begin.x,o=this.end.y-this.begin.y,r=i*o-n*s;return!(Math.abs(r)>e)&&(Math.abs(s)>=Math.abs(o)?s>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:o>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y)}}function xi(t,e,i,n){const s=t.sub(i),o=e.dot(e),r=e.dot(n),a=n.dot(n),l=e.dot(s),h=n.dot(s),c=o*a-r*r;let d=c,u=c;if(0===c||c<=.01){const e=l/r;return new wi(t,i.add(n.scale(e)))}let p=r*h-a*l,g=o*h-r*l;return p<0?(p=0,g=h,u=a):p>d&&(p=d,g=h+r,u=a),g<0?(g=0,-l<0?p=0:-l>o?p=d:(p=-l,d=o)):g>u&&(g=u,-l+r<0?p=0:-l+r>o?p=d:(p=-l+r,d=o)),p=Math.abs(p)<.001?0:p/d,g=Math.abs(g)<.001?0:g/u,new wi(t.add(e.scale(p)),i.add(n.scale(g)))}const bi={PolygonPolygonClosestLine(t,e){const i=e.worldPos,n=i.sub(t.worldPos),s=n.negate(),o=new mi(t.worldPos,n),r=new mi(i,s),a=t.rayCast(o).add(o.dir.scale(.1)),l=e.rayCast(r).add(r.dir.scale(.1)),h=t.getClosestFace(a),c=e.getClosestFace(l);return xi(h.face.begin,h.face.getEdge(),c.face.begin,c.face.getEdge())},PolygonEdgeClosestLine(t,e){const i=e.worldPos.sub(t.worldPos),n=new mi(t.worldPos,i),s=t.rayCast(n).add(n.dir.scale(.1)),o=t.getClosestFace(s),r=o.face.begin,a=o.face.getEdge(),l=e.asLine();return xi(r,a,l.begin,l.getEdge())},PolygonCircleClosestLine(t,e){const i=e.worldPos,n=i.sub(t.worldPos),s=new mi(t.worldPos,n.normalize()),o=t.rayCast(s).add(s.dir.scale(.1)),r=t.getClosestFace(o),a=r.face.begin,l=r.face.getEdge();let h=(l.x*(i.x-a.x)+l.y*(i.y-a.y))/(l.x*l.x+l.y*l.y);h>1?h=1:h<0&&(h=0);const c=Math.sqrt(Math.pow(a.x+l.x*h-i.x,2)+Math.pow(a.y+l.y*h-i.y,2))-e.radius,d=(a.x+l.x*h-i.x)*e.radius/(e.radius+c),u=(a.y+l.y*h-i.y)*e.radius/(e.radius+c);return new wi(l.scale(h).add(a),new _t(i.x+d,i.y+u))},CircleCircleClosestLine(t,e){const i=e.worldPos.sub(t.worldPos),n=t.worldPos.sub(e.worldPos),s=new mi(t.worldPos,i),o=new mi(e.worldPos,n),r=t.rayCast(s),a=e.rayCast(o);return new wi(r,a)},CircleEdgeClosestLine(t,e){const i=t.worldPos,n=e.asLine(),s=n.begin,o=n.getEdge();let r=(o.x*(i.x-s.x)+o.y*(i.y-s.y))/(o.x*o.x+o.y*o.y);r>1?r=1:r<0&&(r=0);const a=Math.sqrt(Math.pow(s.x+o.x*r-i.x,2)+Math.pow(s.y+o.y*r-i.y,2))-t.radius,l=(s.x+o.x*r-i.x)*t.radius/(t.radius+a),h=(s.y+o.y*r-i.y)*t.radius/(t.radius+a);return new wi(o.scale(r).add(s),new _t(i.x+l,i.y+h))},EdgeEdgeClosestLine(t,e){const i=t.asLine(),n=i.begin,s=i.getEdge(),o=e.asLine();return xi(n,s,o.begin,o.getEdge())}};class Ci extends _i{get worldPos(){return this._globalMatrix.getPosition()}get radius(){var t;const e=this._transform,i=null!==(t=null==e?void 0:e.globalScale)&&void 0!==t?t:_t.One;return this._naturalRadius*Math.min(i.x,i.y)}set radius(t){var e;const i=this._transform,n=null!==(e=null==i?void 0:i.globalScale)&&void 0!==e?e:_t.One;this._naturalRadius=t/Math.min(n.x,n.y)}constructor(t){super(),this.offset=_t.Zero,this._globalMatrix=It.identity(),this.offset=t.offset||_t.Zero,this.radius=t.radius||0,this._globalMatrix.translate(this.offset.x,this.offset.y)}clone(){return new Ci({offset:this.offset.clone(),radius:this.radius})}get center(){return this._globalMatrix.getPosition()}contains(t){var e,i;return(null!==(i=null===(e=this._transform)||void 0===e?void 0:e.pos)&&void 0!==i?i:this.offset).distance(t)<=this.radius}rayCast(t,e=1/0){const i=this.center,n=t.dir,s=t.pos,o=Math.sqrt(Math.pow(n.dot(s.sub(i)),2)-Math.pow(s.sub(i).distance(),2)+Math.pow(this.radius,2));if(o<0)return null;{let r=0;if(0===o)return r=-n.dot(s.sub(i)),r>0&&r<e?t.getPoint(r):null;{const r=-n.dot(s.sub(i))+o,a=-n.dot(s.sub(i))-o,l=[];r>=0&&l.push(r),a>=0&&l.push(a);const h=Math.min(...l);return h<=e?t.getPoint(h):null}}}getClosestLineBetween(t){if(t instanceof Ci)return bi.CircleCircleClosestLine(this,t);if(t instanceof ki)return bi.PolygonCircleClosestLine(t,this).flip();if(t instanceof Ti)return bi.CircleEdgeClosestLine(this,t).flip();throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}collide(t){if(t instanceof Ci)return Ei.CollideCircleCircle(this,t);if(t instanceof ki)return Ei.CollideCirclePolygon(this,t);if(t instanceof Ti)return Ei.CollideCircleEdge(this,t);throw new Error("Circle could not collide with unknown CollisionShape "+typeof t)}getFurthestPoint(t){return this.center.add(t.normalize().scale(this.radius))}getFurthestLocalPoint(t){return t.normalize().scale(this.radius)}get bounds(){var t,e,i;const n=this._transform,s=null!==(t=null==n?void 0:n.globalScale)&&void 0!==t?t:_t.One,o=null!==(e=null==n?void 0:n.globalRotation)&&void 0!==e?e:0,r=null!==(i=null==n?void 0:n.globalPos)&&void 0!==i?i:_t.Zero;return new At(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius).rotate(o).scale(s).translate(r)}get localBounds(){return new At(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius)}get axes(){return[]}getInertia(t){return t*this.radius*this.radius/2}update(t){var e;this._transform=t,(null!==(e=t.matrix)&&void 0!==e?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const e=[],i=this.center.dot(t);return e.push(i),e.push(i+this.radius),e.push(i-this.radius),new pi(Math.min.apply(Math,e),Math.max.apply(Math,e))}debug(t,e){var i,n,s,o;const r=this._transform,a=null!==(i=null==r?void 0:r.globalScale)&&void 0!==i?i:_t.One,l=null!==(n=null==r?void 0:r.globalRotation)&&void 0!==n?n:0,h=null!==(s=null==r?void 0:r.globalPos)&&void 0!==s?s:_t.Zero;t.save(),t.translate(h.x,h.y),t.rotate(l),t.scale(a.x,a.y),t.drawCircle(null!==(o=this.offset)&&void 0!==o?o:_t.Zero,this._naturalRadius,wt.Transparent,e,2),t.restore()}}class Ai{constructor(t,e,i,n,s,o,r,a){var l,h;this._canceled=!1,this.colliderA=t,this.colliderB=e,this.mtv=i,this.normal=n,this.tangent=s,this.points=o,this.localPoints=r,this.info=a,this.id=ui.calculatePairHash(t.id,e.id),(t.__compositeColliderId||e.__compositeColliderId)&&(this.id+="|"+ui.calculatePairHash(null!==(l=t.__compositeColliderId)&&void 0!==l?l:t.id,null!==(h=e.__compositeColliderId)&&void 0!==h?h:e.id))}matchAwake(){const t=this.colliderA.owner.get(Ri),e=this.colliderB.owner.get(Ri);t&&e&&t.sleeping!==e.sleeping&&(t.sleeping&&t.collisionType!==Ge.Fixed&&e.sleepMotion>=ii.wakeThreshold&&t.setSleeping(!1),e.sleeping&&e.collisionType!==Ge.Fixed&&t.sleepMotion>=ii.wakeThreshold&&e.setSleeping(!1))}isCanceled(){return this._canceled}cancel(){this._canceled=!0}}class Si{static findPolygonPolygonSeparation(t,e){let i=-Number.MAX_VALUE,n=null,s=null,o=-1,r=null;const a=t.getSides(),l=t.getLocalSides();for(let t=0;t<a.length;t++){const l=a[t],h=l.normal(),c=e.getFurthestPoint(h.negate()),d=l.distanceToPoint(c,!0);d>i&&(i=d,n=l,s=h,o=t,r=c)}return{collider:t,separation:s?i:99,axis:s,side:n,localSide:l[o],sideId:o,point:r,localPoint:s?e.getFurthestLocalPoint(s.negate()):null}}static findCirclePolygonSeparation(t,e){const i=e.axes,n=e.center.sub(t.worldPos),s=e.getFurthestPoint(n.negate());i.push(s.sub(t.worldPos).normalize());let o=Number.MAX_VALUE,r=null,a=-1;for(let n=0;n<i.length;n++){const s=e.project(i[n]),l=t.project(i[n]),h=s.getOverlap(l);if(h<=0)return null;h<o&&(o=h,r=i[n],a=n)}return a<0?null:r.normalize().scale(o)}}const Ei={CollideCircleCircle(t,e){const i=t.worldPos,n=e.worldPos,s=t.radius+e.radius,o=i.distance(n);if(o>s)return[];const r=s-o,a=n.sub(i).normalize(),l=a.perpendicular(),h=a.scale(r),c=t.getFurthestPoint(a),d=t.getFurthestLocalPoint(a);return[new Ai(t,e,h,a,l,[c],[d],{collider:t,separation:r,axis:a,point:c})]},CollideCirclePolygon(t,e){var i,n;let s=Si.findCirclePolygonSeparation(t,e);if(!s)return[];const o=s.dot(e.center.sub(t.center));s=o<0?s.negate():s;const r=t.getFurthestPoint(s),a=(null!==(n=null===(i=t.owner)||void 0===i?void 0:i.get(hi))&&void 0!==n?n:new hi).applyInverse(r),l=s.normalize(),h={collider:t,separation:-s.size,axis:l,point:r,localPoint:a,side:e.findSide(l.negate()),localSide:e.findLocalSide(l.negate())};return[new Ai(t,e,s,l,l.perpendicular(),[r],[a],h)]},CollideCircleEdge(t,e){const i=t.center,n=e.asLine(),s=n.end.sub(n.begin),o=s.dot(n.end.sub(i)),r=s.dot(i.sub(n.begin)),a=e.asLine(),l=e.asLocalLine();if(r<=0){const s=n.begin.sub(i),o=s.dot(s);if(o>t.radius*t.radius)return[];const r=s.normalize(),h=t.radius-Math.sqrt(o),c={collider:t,separation:h,axis:r,point:a.begin,side:a,localSide:l};return[new Ai(t,e,r.scale(h),r,r.perpendicular(),[a.begin],[l.begin],c)]}if(o<=0){const s=n.end.sub(i),o=s.dot(s);if(o>t.radius*t.radius)return[];const r=s.normalize(),h=t.radius-Math.sqrt(o),c={collider:t,separation:h,axis:r,point:a.end,side:a,localSide:l};return[new Ai(t,e,r.scale(h),r,r.perpendicular(),[a.end],[l.end],c)]}const h=s.dot(s),c=n.begin.scale(o).add(n.end.scale(r)).scale(1/h),d=i.sub(c),u=d.dot(d);if(u>t.radius*t.radius)return[];let p=s.perpendicular();p.dot(i.sub(n.begin))<0&&(p.x=-p.x,p.y=-p.y),p=p.normalize();const g=t.radius-Math.sqrt(u),f=p.scale(g),m={collider:t,separation:g,axis:p,point:c,side:a,localSide:l};return[new Ai(t,e,f,p.negate(),p.negate().perpendicular(),[c],[c.sub(e.worldPos)],m)]},CollideEdgeEdge:()=>[],CollidePolygonEdge(t,e){var i;const n=t.center,s=e.center.sub(n).normalize(),o=new ki({points:[e.begin,e.end,e.end.add(s.scale(100)),e.begin.add(s.scale(100))],offset:e.offset});o.owner=e.owner,(null===(i=e.owner)||void 0===i?void 0:i.get(hi))&&o.update(e.owner.get(hi).get());const r=this.CollidePolygonPolygon(t,o);return r.length&&(r[0].colliderB=e,r[0].id=ui.calculatePairHash(t.id,e.id)),r},CollidePolygonPolygon(t,e){var i,n,s,o;const r=Si.findPolygonPolygonSeparation(t,e);if(r.separation>0)return[];const a=Si.findPolygonPolygonSeparation(e,t);if(a.separation>0)return[];const l=r.separation>a.separation?r:a,h=(l.collider===t?e:t).findSide(l.axis.negate()),c=l.side,d=c.dir().normalize(),u=h.clip(d.negate(),-d.dot(c.begin));let p=null;if(u&&(p=u.clip(d,d.dot(c.end))),p){const r=p.getPoints().filter((t=>c.below(t)));let a=l.axis,h=a.perpendicular();e.center.sub(t.center).dot(a)<0&&(a=a.negate(),h=a.perpendicular());let d=[];if(l.collider===t){const t=null!==(n=null===(i=e.owner)||void 0===i?void 0:i.get(hi))&&void 0!==n?n:new hi;d=r.map((e=>t.applyInverse(e)))}else{const e=null!==(o=null===(s=t.owner)||void 0===s?void 0:s.get(hi))&&void 0!==o?o:new hi;d=r.map((t=>e.applyInverse(t)))}return[new Ai(t,e,a.scale(-l.separation),a,h,r,d,l)]}return[]},FindContactSeparation(t,e){var i,n,s,o;const r=t.colliderA,a=null!==(n=null===(i=t.colliderA.owner)||void 0===i?void 0:i.get(hi))&&void 0!==n?n:new hi,l=t.colliderB,h=null!==(o=null===(s=t.colliderB.owner)||void 0===s?void 0:s.get(hi))&&void 0!==o?o:new hi;if(r instanceof Ci&&l instanceof Ci)return-(r.radius+l.radius-a.pos.distance(h.pos));if(r instanceof ki&&l instanceof ki&&t.info.localSide){let i,n;return t.info.collider===r?(i=new wi(a.apply(t.info.localSide.begin),a.apply(t.info.localSide.end)),n=h.apply(e)):(i=new wi(h.apply(t.info.localSide.begin),h.apply(t.info.localSide.end)),n=a.apply(e)),i.distanceToPoint(n,!0)}if(r instanceof ki&&l instanceof Ci||l instanceof ki&&r instanceof Ci){const i=a.apply(e);if(t.info.side)return t.info.side.distanceToPoint(i,!0)}if(r instanceof Ti&&l instanceof ki||l instanceof Ti&&r instanceof ki){let i;if(i=t.info.collider===r?h.apply(e):a.apply(e),t.info.side)return t.info.side.distanceToPoint(i,!0)}if(r instanceof Ci&&l instanceof Ti||l instanceof Ci&&r instanceof Ti){const i=h.apply(e);let n;r instanceof Ci&&(n=r.getFurthestPoint(t.normal));const s=i.distance(n);if(t.info.side)return s>0?-s:0}return 0}};class Ti extends _i{constructor(t){var e;super(),this._globalMatrix=It.identity(),this.begin=t.begin||_t.Zero,this.end=t.end||_t.Zero,this.offset=null!==(e=t.offset)&&void 0!==e?e:_t.Zero}clone(){return new Ti({begin:this.begin.clone(),end:this.end.clone()})}get worldPos(){var t;const e=this._transform;return null!==(t=null==e?void 0:e.globalPos.add(this.offset))&&void 0!==t?t:this.offset}get center(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.average(e)}_getTransformedBegin(){return this._globalMatrix.multiply(this.begin)}_getTransformedEnd(){return this._globalMatrix.multiply(this.end)}getSlope(){const t=this._getTransformedBegin(),e=this._getTransformedEnd(),i=t.distance(e);return e.sub(t).scale(1/i)}getLength(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.distance(e)}contains(){return!1}rayCast(t,e=1/0){const i=this._getTransformedBegin().sub(t.pos);if(0===t.dir.cross(this.getSlope())&&0!==i.cross(t.dir))return null;const n=t.dir.cross(this.getSlope());if(0===n)return null;const s=i.cross(this.getSlope())/n;if(s>=0&&s<=e){const e=i.cross(t.dir)/n/this.getLength();if(e>=0&&e<=1)return t.getPoint(s)}return null}getClosestLineBetween(t){if(t instanceof Ci)return bi.CircleEdgeClosestLine(t,this);if(t instanceof ki)return bi.PolygonEdgeClosestLine(t,this).flip();if(t instanceof Ti)return bi.EdgeEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}collide(t){if(t instanceof Ci)return Ei.CollideCircleEdge(t,this);if(t instanceof ki)return Ei.CollidePolygonEdge(t,this);if(t instanceof Ti)return Ei.CollideEdgeEdge();throw new Error("Edge could not collide with unknown CollisionShape "+typeof t)}getFurthestPoint(t){const e=this._getTransformedBegin(),i=this._getTransformedEnd();return t.dot(e)>0?e:i}_boundsFromBeginEnd(t,e,i=10){return new At(Math.min(t.x,e.x)-i,Math.min(t.y,e.y)-i,Math.max(t.x,e.x)+i,Math.max(t.y,e.y)+i)}get bounds(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return this._boundsFromBeginEnd(t,e)}get localBounds(){return this._boundsFromBeginEnd(this.begin,this.end)}asLine(){return new wi(this._getTransformedBegin(),this._getTransformedEnd())}asLocalLine(){return new wi(this.begin,this.end)}get axes(){const t=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),e=[];return e.push(t),e.push(t.negate()),e.push(t.normal()),e.push(t.normal().negate()),e}getInertia(t){const e=this.end.sub(this.begin).distance()/2;return t*e*e}update(t){var e;this._transform=t,(null!==(e=t.matrix)&&void 0!==e?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const e=[],i=[this._getTransformedBegin(),this._getTransformedEnd()],n=i.length;for(let s=0;s<n;s++)e.push(i[s].dot(t));return new pi(Math.min.apply(Math,e),Math.max.apply(Math,e))}debug(t,e){const i=this._getTransformedBegin(),n=this._getTransformedEnd();t.drawLine(i,n,e,2),t.drawCircle(i,2,e),t.drawCircle(n,2,e)}}class ki extends _i{set points(t){this._localBoundsDirty=!0,this._localSidesDirty=!0,this._sidesDirty=!0,this._points=t}get points(){return this._points}constructor(t){var e,i;super(),this._logger=tt.getInstance(),this._transformedPoints=[],this._sides=[],this._localSides=[],this._globalMatrix=It.identity(),this._transformedPointsDirty=!0,this._sidesDirty=!0,this._localSidesDirty=!0,this._localBoundsDirty=!0,this.offset=null!==(e=t.offset)&&void 0!==e?e:_t.Zero,this._globalMatrix.translate(this.offset.x,this.offset.y),this.points=null!==(i=t.points)&&void 0!==i?i:[],this._isCounterClockwiseWinding(this.points)||this.points.reverse(),this.isConvex()||this._logger.warn("Excalibur only supports convex polygon colliders and will not behave properly.Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles"),this._calculateTransformation()}_isCounterClockwiseWinding(t){let e=0;for(let i=0;i<t.length;i++)e+=(t[(i+1)%t.length].x-t[i].x)*(t[(i+1)%t.length].y+t[i].y);return e<0}isConvex(){if(this.points.length<3)return!1;let t=this.points[this.points.length-2],e=this.points[this.points.length-1],i=Math.atan2(e.y-t.y,e.x-t.x),n=0,s=0,o=0;for(const[r,a]of this.points.entries()){if(t=e,n=i,e=a,i=Math.atan2(e.y-t.y,e.x-t.x),t.equals(e))return!1;let l=i-n;if(l<=-Math.PI?l+=2*Math.PI:l>Math.PI&&(l-=2*Math.PI),0===r){if(0===l)return!1;s=l>0?1:-1}else if(s*l<=0)return!1;o+=l}return 1===Math.abs(Math.round(o/(2*Math.PI)))}tessellate(){const t=[];for(let e=1;e<this.points.length-2;e++)t.push([this.points[0],this.points[e+1],this.points[e+2]]);return t.push([this.points[0],this.points[1],this.points[2]]),new yi(t.map((t=>Mi.Polygon(t))))}triangulate(){if(this.points.length<3)throw Error("Invalid polygon");function t(t,e){return t>=e.length?e[t%e.length]:t<0?e[t%e.length+e.length]:e[t]}function e(t,e,i,n){const s=i.sub(e),o=n.sub(i),r=e.sub(n),a=t.sub(e),l=t.sub(i),h=t.sub(n),c=s.cross(a),d=o.cross(l),u=r.cross(h);return!(c>0||d>0||u>0)}const i=[],n=[...this.points],s=ft(0,this.points.length-1);for(;s.length>3;)for(let o=0;o<s.length;o++){const r=s[o],a=t(o-1,s),l=t(o+1,s),h=n[r],c=n[a],d=n[l],u=c.sub(h);if(!(d.sub(h).cross(u)>0))continue;let p=!0;for(let t=0;t<s.length;t++){const i=s[t];if(i!==r&&i!==a&&i!==l&&e(n[i],c,h,d)){p=!1;break}}if(p){i.push([c,h,d]),s.splice(o,1);break}}return i.push([n[s[0]],n[s[1]],n[s[2]]]),new yi(i.map((t=>Mi.Polygon(t))))}clone(){return new ki({offset:this.offset.clone(),points:this.points.map((t=>t.clone()))})}get worldPos(){return this._transform?this._transform.pos.add(this.offset):this.offset}get center(){return this.bounds.center}_calculateTransformation(){const t=this.points,e=t.length;this._transformedPoints.length=0;for(let i=0;i<e;i++)this._transformedPoints[i]=this._globalMatrix.multiply(t[i].clone())}getTransformedPoints(){return this._transformedPointsDirty&&(this._calculateTransformation(),this._transformedPointsDirty=!1),this._transformedPoints}getSides(){if(this._sidesDirty){const t=[],e=this.getTransformedPoints(),i=e.length;for(let n=0;n<i;n++)t.push(new wi(e[n],e[(n+1)%i]));this._sides=t,this._sidesDirty=!1}return this._sides}getLocalSides(){if(this._localSidesDirty){const t=[],e=this.points,i=e.length;for(let n=0;n<i;n++)t.push(new wi(e[n],e[(n+1)%i]));this._localSides=t,this._localSidesDirty=!1}return this._localSides}findSide(t){const e=this.getSides();let i=e[0],n=-Number.MAX_VALUE;for(let s=0;s<e.length;s++){const o=e[s],r=o.normal().dot(t);r>n&&(i=o,n=r)}return i}findLocalSide(t){const e=this.getLocalSides();let i=e[0],n=-Number.MAX_VALUE;for(let s=0;s<e.length;s++){const o=e[s],r=o.normal().dot(t);r>n&&(i=o,n=r)}return i}get axes(){const t=[],e=this.getSides();for(let i=0;i<e.length;i++)t.push(e[i].normal());return t}update(t){var e;t&&(this._transform=t,this._transformedPointsDirty=!0,this._sidesDirty=!0,(null!==(e=t.matrix)&&void 0!==e?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y))}contains(t){const e=new mi(t,new _t(1,0));return this.getSides().reduce((function(t,i){return e.intersect(i)>=0?t+1:t}),0)%2!=0}getClosestLineBetween(t){if(t instanceof Ci)return bi.PolygonCircleClosestLine(this,t);if(t instanceof ki)return bi.PolygonPolygonClosestLine(this,t);if(t instanceof Ti)return bi.PolygonEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}collide(t){if(t instanceof Ci)return Ei.CollideCirclePolygon(t,this);if(t instanceof ki)return Ei.CollidePolygonPolygon(this,t);if(t instanceof Ti)return Ei.CollidePolygonEdge(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}getFurthestPoint(t){const e=this.getTransformedPoints();let i=null,n=-Number.MAX_VALUE;for(let s=0;s<e.length;s++){const o=t.dot(e[s]);o>n&&(n=o,i=e[s])}return i}getFurthestLocalPoint(t){const e=this.points;let i=e[0],n=-Number.MAX_VALUE;for(let s=0;s<e.length;s++){const o=t.dot(e[s]);o>n&&(n=o,i=e[s])}return i}getClosestFace(t){const e=this.getSides();let i=Number.POSITIVE_INFINITY,n=-1,s=-1;for(let o=0;o<e.length;o++){const r=e[o].distanceToPoint(t);r<i&&(i=r,n=o,s=r)}return-1!==n?{distance:e[n].normal().scale(s),face:e[n]}:null}get bounds(){return this.localBounds.transform(this._globalMatrix)}get localBounds(){return this._localBoundsDirty&&(this._localBounds=At.fromPoints(this.points),this._localBoundsDirty=!1),this._localBounds}getInertia(t){if(this._cachedMass===t&&this._cachedInertia)return this._cachedInertia;let e=0,i=0;const n=this.points;for(let t=0;t<n.length;t++){const s=(t+1)%n.length,o=n[s].cross(n[t]);e+=o*(n[t].dot(n[t])+n[t].dot(n[s])+n[s].dot(n[s])),i+=o}return this._cachedMass=t,this._cachedInertia=t/6*(e/i)}rayCast(t,e=1/0){const i=this.getSides(),n=i.length;let s=Number.MAX_VALUE,o=-1;for(let r=0;r<n;r++){const n=t.intersect(i[r]);n>=0&&n<s&&n<=e&&(s=n,o=r)}return o>=0?t.getPoint(s):null}project(t){const e=this.getTransformedPoints(),i=e.length;let n=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(let o=0;o<i;o++){const i=e[o].dot(t);n=Math.min(n,i),s=Math.max(s,i)}return new pi(n,s)}debug(t,e){const i=this.getTransformedPoints()[0],n=[i,...this.getTransformedPoints(),i];for(let i=0;i<n.length-1;i++)t.drawLine(n[i],n[i+1],e,2),t.drawCircle(n[i],2,e),t.drawCircle(n[i+1],2,e)}}class Mi{static Box(t,e,i=_t.Half,n=_t.Zero){return new ki({points:new At(-t*i.x,-e*i.y,t-t*i.x,e-e*i.y).getPoints(),offset:n})}static Polygon(t,e=_t.Zero){return new ki({points:t,offset:e})}static Circle(t,e=_t.Zero){return new Ci({radius:t,offset:e})}static Edge(t,e){return new Ti({begin:t,end:e})}static Capsule(t,e,i=_t.Zero){const n=tt.getInstance();return t===e&&n.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider"),new yi(e>=t?[Mi.Circle(t/2,yt(0,-e/2+t/2).add(i)),Mi.Box(t,e-t,_t.Half,i),Mi.Circle(t/2,yt(0,e/2-t/2).add(i))]:[Mi.Circle(e/2,yt(-t/2+e/2,0).add(i)),Mi.Box(t-e,e,_t.Half,i),Mi.Circle(e/2,yt(t/2-e/2,0).add(i))])}}class $i extends ri{constructor(t){super(),this.type="ex.collider",this.events=new m,this.$colliderAdded=new li,this.$colliderRemoved=new li,this.set(t)}get(){return this._collider}set(t){return this.clear(),t&&(this._collider=t,this._collider.owner=this.owner,t.events.pipe(this.events),this.$colliderAdded.notifyAll(t),this.update()),t}clear(){this._collider&&(this._collider.events.unpipe(this.events),this.$colliderRemoved.notifyAll(this._collider),this._collider.owner=null,this._collider=null)}clone(){return new $i(this._collider.clone())}get bounds(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.bounds)&&void 0!==e?e:new At}get localBounds(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new At}update(){var t;const e=null===(t=this.owner)||void 0===t?void 0:t.get(hi);this._collider&&(this._collider.owner=this.owner,e&&this._collider.update(e.get()))}collide(t){let e=this._collider,i=t._collider;if(!e||!i)return[];let n=!1;if(i instanceof yi&&(e=i,i=this._collider,n=!0),this._collider){const s=e.collide(i);return s?(n&&s.forEach((e=>{e.mtv=e.mtv.negate(),e.normal=e.normal.negate(),e.tangent=e.normal.perpendicular(),e.colliderA=this._collider,e.colliderB=t._collider})),s):[]}return[]}onAdd(t){this._collider&&this.update(),this.events.on("precollision",(e=>{const i=e;t.events.emit("precollision",new F(i.target.owner,i.other.owner,i.side,i.intersection))})),this.events.on("postcollision",(e=>{const i=e;t.events.emit("postcollision",new O(i.target.owner,i.other.owner,i.side,i.intersection))})),this.events.on("collisionstart",(e=>{const i=e;t.events.emit("collisionstart",new U(i.target.owner,i.other.owner,i.contact))})),this.events.on("collisionend",(e=>{const i=e;t.events.emit("collisionend",new j(i.target.owner,i.other.owner))}))}onRemove(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}useBoxCollider(t,e,i=_t.Half,n=_t.Zero){const s=Mi.Box(t,e,i,n);return this.set(s)}usePolygonCollider(t,e=_t.Zero){const i=Mi.Polygon(t,e);return this.set(i)}useCircleCollider(t,e=_t.Zero){const i=Mi.Circle(t,e);return this.set(i)}useEdgeCollider(t,e){const i=Mi.Edge(t,e);return this.set(i)}useCompositeCollider(t){return this.set(new yi(t))}}var Li;!function(t){t.Rotation="rotation",t.X="x",t.Y="y"}(Li||(Li={}));class Ri extends ri{constructor(t){var e,i,n;super(),this.type="ex.body",this.dependencies=[hi,ci],this.id=f("body",Ri._ID++),this.events=new m,this._oldTransform=new oi,this.__oldTransformCaptured=!1,this.enableFixedUpdateInterpolate=!0,this.collisionType=Ge.PreventCollision,this.group=di.All,this._mass=ii.defaultMass,this.sleepMotion=5*ii.sleepEpsilon,this.canSleep=ii.bodiesCanSleepByDefault,this._sleeping=!1,this.bounciness=.2,this.friction=.99,this.useGravity=!0,this.limitDegreeOfFreedom=[],this.oldVel=new _t(0,0),this.oldAcc=_t.Zero,t&&(this.collisionType=null!==(e=t.type)&&void 0!==e?e:this.collisionType,this.group=null!==(i=t.group)&&void 0!==i?i:this.group,this.useGravity=null!==(n=t.useGravity)&&void 0!==n?n:this.useGravity)}get matrix(){return this.transform.get().matrix}get mass(){return this._mass}set mass(t){this._mass=t,this._cachedInertia=void 0,this._cachedInverseInertia=void 0}get inverseMass(){return this.collisionType===Ge.Fixed?0:1/this.mass}get sleeping(){return this._sleeping}setSleeping(t){this._sleeping=t,t?(this.vel=_t.Zero,this.acc=_t.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=5*ii.sleepEpsilon}updateMotion(){this._sleeping&&this.setSleeping(!0);const t=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),e=ii.sleepBias;this.sleepMotion=e*this.sleepMotion+(1-e)*t,this.sleepMotion=dt(this.sleepMotion,0,10*ii.sleepEpsilon),this.canSleep&&this.sleepMotion<ii.sleepEpsilon&&this.setSleeping(!0)}get inertia(){if(this._cachedInertia)return this._cachedInertia;const t=this.owner.get($i);if(t){t.$colliderAdded.subscribe((()=>{this._cachedInertia=null})),t.$colliderRemoved.subscribe((()=>{this._cachedInertia=null}));const e=t.get();if(e)return this._cachedInertia=e.getInertia(this.mass)}return 0}get inverseInertia(){return this._cachedInverseInertia?this._cachedInverseInertia:this._cachedInverseInertia=this.collisionType===Ge.Fixed?0:1/this.inertia}get active(){var t;return!!(null===(t=this.owner)||void 0===t?void 0:t.active)}get center(){return this.globalPos}get transform(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(hi)}get motion(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(ci)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t}get globalPos(){return this.transform.globalPos}set globalPos(t){this.transform.globalPos=t}get oldPos(){return this._oldTransform.pos}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t}get torque(){return this.motion.torque}set torque(t){this.motion.torque=t}get oldRotation(){return this._oldTransform.rotation}get rotation(){return this.transform.globalRotation}set rotation(t){this.transform.globalRotation=t}get scale(){return this.transform.globalScale}set scale(t){this.transform.globalScale=t}get oldScale(){return this._oldTransform.scale}get scaleFactor(){return this.motion.scaleFactor}set scaleFactor(t){this.motion.scaleFactor=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}applyImpulse(t,e){if(this.collisionType!==Ge.Active)return;const i=e.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(Li.X)&&(i.x=0),this.limitDegreeOfFreedom.includes(Li.Y)&&(i.y=0),this.vel.addEqual(i),!this.limitDegreeOfFreedom.includes(Li.Rotation)){const i=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*i.cross(e)}}applyLinearImpulse(t){if(this.collisionType!==Ge.Active)return;const e=t.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(Li.X)&&(e.x=0),this.limitDegreeOfFreedom.includes(Li.Y)&&(e.y=0),this.vel=this.vel.add(e)}applyAngularImpulse(t,e){if(this.collisionType===Ge.Active&&!this.limitDegreeOfFreedom.includes(Li.Rotation)){const i=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*i.cross(e)}}captureOldTransform(){this.__oldTransformCaptured=!0,this.transform.get().clone(this._oldTransform),this.oldVel.setTo(this.vel.x,this.vel.y),this.oldAcc.setTo(this.acc.x,this.acc.y)}clone(){return super.clone()}}Ri._ID=0;class Ii{constructor(t){this.data=t,this.type="Component Added"}}function Di(t){return!!t&&"Component Added"===t.type}class Pi{constructor(t){this.data=t,this.type="Component Removed"}}function Bi(t){return!!t&&"Component Removed"===t.type}const Fi={Initialize:"initialize",PreUpdate:"preupdate",PostUpdate:"postupdate"};class Oi{constructor(t,e){if(this.events=new m,this.id=Oi._ID++,this.scene=null,this._name="anonymous",this.active=!0,this._componentsToRemove=[],this._componentTypeToInstance=new Map,this._componentStringToInstance=new Map,this._tagsMemo=[],this._typesMemo=[],this.componentAdded$=new li,this.componentRemoved$=new li,this._parent=null,this.childrenAdded$=new li,this.childrenRemoved$=new li,this._children=[],this._isInitialized=!1,this._setName(e),t)for(const e of t)this.addComponent(e)}_setName(t){t&&(this._name=t)}get name(){return this._name}kill(){this.active&&(this.active=!1,this.unparent())}isKilled(){return!this.active}get tags(){return this._tagsMemo}hasTag(t){return this.tags.includes(t)}addTag(t){return this.addComponent(new ai(t))}removeTag(t,e=!1){return this.removeComponent(t,e)}get types(){return this._typesMemo}_rebuildMemos(){this._tagsMemo=Array.from(this._componentStringToInstance.values()).filter((t=>t instanceof ai)).map((t=>t.type)),this._typesMemo=Array.from(this._componentStringToInstance.keys())}getComponents(){return Array.from(this._componentStringToInstance.values())}_notifyAddComponent(t){this._rebuildMemos();const e=new Ii({component:t,entity:this});this.componentAdded$.notifyAll(e)}_notifyRemoveComponent(t){const e=new Pi({component:t,entity:this});this.componentRemoved$.notifyAll(e),this._rebuildMemos()}get parent(){return this._parent}get children(){return this._children}unparent(){this._parent&&(this._parent.removeChild(this),this._parent=null)}addChild(t){if(null!==t.parent)throw new Error("Entity already has a parent, cannot add without unparenting");if(this.getAncestors().includes(t))throw new Error("Cycle detected, cannot add entity");return this._children.push(t),t._parent=this,this.childrenAdded$.notifyAll(t),this}removeChild(t){return t.parent===this&&(kt(t,this._children),t._parent=null,this.childrenRemoved$.notifyAll(t)),this}removeAllChildren(){for(let t=this.children.length-1;t>=0;t--)this.removeChild(this.children[t]);return this}getAncestors(){const t=[this];let e=this.parent;for(;e;)t.push(e),e=e.parent;return t.reverse()}getDescendants(){let t=[this],e=[this];for(;e.length>0;){const i=e.pop();e=e.concat(i.children),t=t.concat(i.children)}return t}clone(){const t=new Oi;for(const e of this.types)t.addComponent(this.get(e).clone());for(const e of this.children)t.addChild(e.clone());return t}addTemplate(t,e=!1){for(const i of t.getComponents())this.addComponent(i.clone(),e);for(const e of t.children)this.addChild(e.clone().addTemplate(e));return this}addComponent(t,e=!1){if(this.has(t.type)){if(!e)return this;this.removeComponent(t,!0)}if(t.dependencies&&t.dependencies.length)for(const e of t.dependencies)this.addComponent(new e);t.owner=this;const i=t.constructor;return this._componentTypeToInstance.set(i,t),this._componentStringToInstance.set(t.type,t),t.onAdd&&t.onAdd(this),this._notifyAddComponent(t),this}removeComponent(t,e=!1){return e?"string"==typeof t?this._removeComponentByType(t):t instanceof ri&&this._removeComponentByType(t.type):this._componentsToRemove.push(t),this}clearComponents(){const t=this.getComponents();for(const e of t)this.removeComponent(e)}_removeComponentByType(t){if(this.has(t)){const e=this.get(t);e.owner=null,e.onRemove&&e.onRemove(this);const i=e.constructor;this._componentTypeToInstance.delete(i),this._componentStringToInstance.delete(e.type),this._notifyRemoveComponent(e)}}processComponentRemoval(){for(const t of this._componentsToRemove){const e="string"==typeof t?t:t.type;this._removeComponentByType(e)}this._componentsToRemove.length=0}has(t){return"string"==typeof t?this._componentStringToInstance.has(t):this._componentTypeToInstance.has(t)}get(t){return"string"==typeof t?this._componentStringToInstance.get(t):this._componentTypeToInstance.get(t)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.onInitialize(t),this.events.emit("initialize",new V(t,this)),this._isInitialized=!0)}_preupdate(t,e){this.events.emit("preupdate",new T(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.events.emit("postupdate",new k(t,e,this)),this.onPostUpdate(t,e)}onInitialize(t){}onPreUpdate(t,e){}onPostUpdate(t,e){}update(t,e){this._initialize(t),this._preupdate(t,e);for(const i of this.children)i.update(t,e);this._postupdate(t,e)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}}function Ni(t){return!!t.tick}Oi._ID=0;class zi{constructor(t,e){this._options=t,this._graphics=e,this.graphics=[]}get name(){return this._options.name}hide(t){if(t){let e=null;e=t instanceof zt?t:this._graphics.getGraphic(t),this.graphics=this.graphics.filter((t=>t.graphic!==e)),this._graphics.recalculateBounds()}else this.graphics.length=0}show(t,e){let i;return e={...e},t instanceof zt?i=this._graphics.copyGraphics?t.clone():t:(i=this._graphics.getGraphic(t),i||tt.getInstance().error(`No such graphic added to component named ${t}. These named graphics are available: `,this._graphics.getNames())),i?(this.graphics.push({graphic:i,options:e}),this._graphics.recalculateBounds(),i):null}use(t,e){return e={...e},this.hide(),this.show(t,e)}get order(){return this._options.order}set order(t){this._options.order=t}get offset(){var t;return null!==(t=this._options.offset)&&void 0!==t?t:_t.Zero}set offset(t){this._options.offset=t}get currentKeys(){var t;return null!==(t=this.name)&&void 0!==t?t:"anonymous"}clone(t){const e=new zi({...this._options},t);return e.graphics=[...this.graphics.map((t=>({graphic:t.graphic.clone(),options:{...t.options}})))],e}}class Wi{constructor(t){this._component=t,this._layers=[],this._layerMap={},this.default=new zi({name:"default",order:0},t),this._maybeAddLayer(this.default)}create(t){const e=new zi(t,this._component);return this._maybeAddLayer(e)}get(t){return t?this._getLayer(t):this._layers}currentKeys(){const t=[];for(const e of this._layers)t.push(e.currentKeys);return t}has(t){return t in this._layerMap}_maybeAddLayer(t){return this._layerMap[t.name]?this._layerMap[t.name]:(this._layerMap[t.name]=t,this._layers.push(t),this._layers.sort(((t,e)=>t.order-e.order)),t)}_getLayer(t){return this._layerMap[t]}clone(t){const e=new Wi(t);return e._layerMap={},e._layers=[],e.default=this.default.clone(t),e._maybeAddLayer(e.default),this._layers.filter((t=>"default"!==t.name)).map((e=>e.clone(t))).forEach((t=>e._maybeAddLayer(t))),e}}class Hi extends ri{getGraphic(t){return this._graphics[t]}getNames(){return Object.keys(this._graphics)}constructor(t){super(),this.type="ex.graphics",this._graphics={},this.visible=!0,this.opacity=1,this.offset=_t.Zero,this.anchor=_t.Half,this.flipHorizontal=!1,this.flipVertical=!1,this.copyGraphics=!1,this._localBounds=null,t={visible:this.visible,...t};const{current:e,anchor:i,opacity:n,visible:s,graphics:o,offset:r,copyGraphics:a,onPreDraw:l,onPostDraw:h}=t;this._graphics=o||{},this.offset=null!=r?r:this.offset,this.opacity=null!=n?n:this.opacity,this.anchor=null!=i?i:this.anchor,this.copyGraphics=null!=a?a:this.copyGraphics,this.onPreDraw=null!=l?l:this.onPreDraw,this.onPostDraw=null!=h?h:this.onPostDraw,this.visible=!!s,this.layers=new Wi(this),e&&this._graphics[e]&&this.show(this._graphics[e])}get current(){return this.layers.default.graphics}get graphics(){return this._graphics}add(t,e){let i="default",n=null;return"string"==typeof t?(i=t,n=e):n=t,this._graphics[i]=this.copyGraphics?n.clone():n,"default"===i&&this.show("default"),n}show(t,e){const i=this.layers.default.show(t,e);return this.recalculateBounds(),i}use(t,e){const i=this.layers.default.use(t,e);return this.recalculateBounds(),i}hide(t){this.layers.default.hide(t)}set localBounds(t){this._localBounds=t}recalculateBounds(){let t=new At;for(const e of this.layers.get())for(const{graphic:i,options:n}of e.graphics){let s=this.anchor,o=this.offset;(null==n?void 0:n.anchor)&&(s=n.anchor),(null==n?void 0:n.offset)&&(o=n.offset);const r=i.localBounds,a=-r.width*s.x+o.x,l=-r.height*s.y+o.y;t=null==i?void 0:i.localBounds.translate(yt(a+e.offset.x,l+e.offset.y)).combine(t)}this._localBounds=t}get localBounds(){return this._localBounds&&!this._localBounds.hasZeroDimensions()||this.recalculateBounds(),this._localBounds}update(t,e=0){for(const i of this.layers.get())for(const{graphic:n}of i.graphics)Ni(n)&&(null==n||n.tick(t,e))}clone(){const t=new Hi;return t._graphics={...this._graphics},t.offset=this.offset.clone(),t.opacity=this.opacity,t.anchor=this.anchor.clone(),t.copyGraphics=this.copyGraphics,t.onPreDraw=this.onPreDraw,t.onPostDraw=this.onPostDraw,t.visible=this.visible,t.layers=this.layers.clone(t),t}}class Ui extends Le{constructor(t){super(t),this.width=t.width,this.height=t.height,this.rasterize()}clone(){return new Ui({width:this.width,height:this.height,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}class ji extends Le{get radius(){return this._radius}set radius(t){this._radius=t,this.width=2*this._radius,this.height=2*this._radius,this.flagDirty()}constructor(t){var e,i,n;super(t),this._radius=0;const s=null!==(e=t.lineWidth)&&void 0!==e?e:t.strokeColor?1:0;this.padding=null!==(i=t.padding)&&void 0!==i?i:2+s/2,this.radius=t.radius,this.filtering=null!==(n=t.filtering)&&void 0!==n?n:Ht.Blended,this.rasterize()}clone(){return new ji({radius:this.radius,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.color&&t.fill(),this.strokeColor&&t.stroke())}}class Vi extends ri{constructor(){super(...arguments),this.type="ex.pointer",this.useColliderShape=!0,this.useGraphicsBounds=!1}}class Gi{static CreateReversibleEasingFunction(t){return(e,i,n,s)=>n<i?i-(t(e,n,i,s)-n):t(e,i,n,s)}static CreateVectorEasingFunction(t){return(e,i,n,s)=>new _t(t(e,i.x,n.x,s),t(e,i.y,n.y,s))}}Gi.Linear=Gi.CreateReversibleEasingFunction(((t,e,i,n)=>(i-=e)*t/n+e)),Gi.EaseInQuad=Gi.CreateReversibleEasingFunction(((t,e,i,n)=>(i-=e)*(t/=n)*t+e)),Gi.EaseOutQuad=Gi.CreateReversibleEasingFunction(((t,e,i,n)=>-(i-=e)*(t/=n)*(t-2)+e)),Gi.EaseInOutQuad=Gi.CreateReversibleEasingFunction(((t,e,i,n)=>(i-=e,(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e))),Gi.EaseInCubic=Gi.CreateReversibleEasingFunction(((t,e,i,n)=>(i-=e)*(t/=n)*t*t+e)),Gi.EaseOutCubic=Gi.CreateReversibleEasingFunction(((t,e,i,n)=>(t/=n,(i-=e)*(--t*t*t+1)+e))),Gi.EaseInOutCubic=Gi.CreateReversibleEasingFunction(((t,e,i,n)=>(i-=e,(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e)));class Ki{constructor(t){this._actions=[],this._completedActions=[],this._entity=t}add(t){this._actions.push(t)}remove(t){const e=this._actions.indexOf(t);this._actions.splice(e,1)}clearActions(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}getActions(){return this._actions.concat(this._completedActions)}hasNext(){return this._actions.length>0}isComplete(){return 0===this._actions.length}reset(){this._actions=this.getActions();const t=this._actions.length;for(let e=0;e<t;e++)this._actions[e].reset();this._completedActions=[]}update(t){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(t),this._currentAction.isComplete(this._entity)&&this._completedActions.push(this._actions.shift()))}}class Yi{constructor(t,e,i){this._stopped=!1,this._repeatBuilder=e,this._repeatContext=new _n(t),this._actionQueue=this._repeatContext.getQueue(),this._repeat=i,this._originalRepeat=i,this._repeatBuilder(this._repeatContext),this._repeat--}update(t){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(t)}isComplete(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._repeat=this._originalRepeat}}class qi{constructor(t,e){this._stopped=!1,this._repeatBuilder=e,this._repeatContext=new _n(t),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}update(t){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(t))}isComplete(){return this._stopped}stop(){this._stopped=!0,this._actionQueue.clearActions()}reset(){}}class Xi{constructor(t,e,i,n){if(this._started=!1,this._stopped=!1,this._entity=t,this._tx=t.get(hi),this._motion=t.get(ci),this._speed=n,this._offset=new _t(e,i),n<=0)throw tt.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+n),new Error("Speed must be greater than 0 pixels per second")}update(t){this._started||(this._started=!0,this._start=new _t(this._tx.pos.x,this._tx.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._entity)?(this._tx.pos=yt(this._end.x,this._end.y),this._motion.vel=yt(0,0)):this._motion.vel=this._dir.scale(this._speed)}isComplete(t){const e=t.get(hi);return this._stopped||e.pos.distance(this._start)>=this._distance}stop(){this._motion.vel=yt(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class Zi{constructor(t,e,i,n){this.entity=t,this._started=!1,this._stopped=!1,this._tx=t.get(hi),this._motion=t.get(ci),this._end=new _t(e,i),this._speed=n}update(t){this._started||(this._started=!0,this._start=new _t(this._tx.pos.x,this._tx.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());const e=this._dir.scale(this._speed);this._motion.vel=yt(e.x,e.y),this.isComplete(this.entity)&&(this._tx.pos=yt(this._end.x,this._end.y),this._motion.vel=yt(0,0))}isComplete(t){const e=t.get(hi);return this._stopped||new _t(e.pos.x,e.pos.y).distance(this._start)>=this._distance}stop(){this._motion.vel=yt(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}var Qi,Ji,tn,en,nn,sn;!function(t){t[t.ShortestPath=0]="ShortestPath",t[t.LongestPath=1]="LongestPath",t[t.Clockwise=2]="Clockwise",t[t.CounterClockwise=3]="CounterClockwise"}(Qi||(Qi={}));class on{constructor(t,e,i,n){this._started=!1,this._stopped=!1,this._tx=t.get(hi),this._motion=t.get(ci),this._end=e,this._speed=i,this._rotationType=n||Qi.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation;const t=Math.abs(this._end-this._start),e=lt-t;switch(t>e?(this._shortDistance=e,this._longDistance=t):(this._shortDistance=t,this._longDistance=e),this._shortestPathIsPositive=(this._start-this._end+lt)%lt>=Math.PI,this._rotationType){case Qi.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case Qi.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case Qi.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case Qi.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class rn{constructor(t,e,i,n){this._started=!1,this._stopped=!1,this._tx=t.get(hi),this._motion=t.get(ci),this._speed=i,this._offset=e,this._rotationType=n||Qi.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation,this._end=this._start+this._offset;const t=Math.abs(this._end-this._start),e=lt-t;switch(t>e?(this._shortDistance=e,this._longDistance=t):(this._shortDistance=t,this._longDistance=e),this._shortestPathIsPositive=(this._start-this._end+lt)%lt>=Math.PI,this._rotationType){case Qi.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case Qi.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case Qi.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case Qi.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._start=void 0,this._currentNonCannonAngle=void 0,this._distance=void 0}}class an{constructor(t,e,i,n,s){this._started=!1,this._stopped=!1,this._tx=t.get(hi),this._motion=t.get(ci),this._endX=e,this._endY=i,this._speedX=n,this._speedY=s}update(t){if(this._started||(this._started=!0,this._startX=this._tx.scale.x,this._startY=this._tx.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._tx.scale.x-this._startX)>=this._distanceX)this._motion.scaleFactor.x=0;else{const t=this._endY<this._startY?-1:1;this._motion.scaleFactor.x=this._speedX*t}if(Math.abs(this._tx.scale.y-this._startY)>=this._distanceY)this._motion.scaleFactor.y=0;else{const t=this._endY<this._startY?-1:1;this._motion.scaleFactor.y=this._speedY*t}this.isComplete()&&(this._tx.scale=yt(this._endX,this._endY),this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startX)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startY)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class ln{constructor(t,e,i,n){this._started=!1,this._stopped=!1,this._tx=t.get(hi),this._motion=t.get(ci),this._offset=new _t(e,i),this._speedX=this._speedY=n}update(t){this._started||(this._started=!0,this._startScale=this._tx.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._motion.scaleFactor.x=this._speedX*this._directionX,this._motion.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(this._tx.scale=this._endScale,this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startScale.x)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startScale.y)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class hn{constructor(t){this._method=null,this._hasBeenCalled=!1,this._method=t}update(t){this._method(),this._hasBeenCalled=!0}isComplete(){return this._hasBeenCalled}reset(){this._hasBeenCalled=!1}stop(){this._hasBeenCalled=!0}}class cn{constructor(t,e,i,n,s){this.easingFcn=s,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new _t(0,0),this._lerpEnd=new _t(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(hi),this._motion=t.get(ci),this._lerpDuration=n,this._lerpEnd=new _t(e,i)}_initialize(){this._lerpStart=new _t(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let e=this._tx.pos.x,i=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(e=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),i=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=yt((e-this._tx.pos.x)/(t/1e3),(i-this._tx.pos.y)/(t/1e3))):(this._tx.pos=yt(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=_t.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=yt(0,0),this._stopped=!0}}class dn{constructor(t,e,i,n,s){this.easingFcn=s,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new _t(0,0),this._lerpEnd=new _t(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(hi),this._motion=t.get(ci),this._lerpDuration=n,this._offset=new _t(e,i)}_initialize(){this._lerpStart=new _t(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0,this._lerpEnd=this._lerpStart.add(this._offset)}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let e=this._tx.pos.x,i=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(e=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),i=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=yt((e-this._tx.pos.x)/(t/1e3),(i-this._tx.pos.y)/(t/1e3))):(this._tx.pos=yt(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=_t.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=yt(0,0),this._stopped=!0}}class un{constructor(t,e,i,n=1){this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._graphics=t.get(Hi),this._timeVisible=e,this._timeNotVisible=i,this._duration=(e+i)*n}update(t){this._started||(this._started=!0,this._elapsedTime=0,this._totalTime=0),this._graphics&&(this._elapsedTime+=t,this._totalTime+=t,this._graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._graphics.visible=!1,this._elapsedTime=0),!this._graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._graphics.visible=!0))}isComplete(){return this._stopped||this._totalTime>=this._duration}stop(){this._graphics&&(this._graphics.visible=!0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._elapsedTime=0,this._totalTime=0}}class pn{constructor(t,e,i){this._multiplier=1,this._started=!1,this._stopped=!1,this._graphics=t.get(Hi),this._endOpacity=e,this._speed=this._ogspeed=i}update(t){this._graphics&&(this._started||(this._started=!0,this._speed=this._ogspeed,this._endOpacity<this._graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._graphics.opacity+=this._multiplier*(Math.abs(this._graphics.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._graphics.opacity=this._endOpacity),tt.getInstance().debug("[Action fade] Actor opacity:",this._graphics.opacity))}isComplete(){return this._stopped||Math.abs(this._graphics.opacity-this._endOpacity)<.05}stop(){this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class gn{constructor(t){this._elapsedTime=0,this._started=!1,this._stopped=!1,this._delay=t}update(t){this._started||(this._started=!0),this._elapsedTime+=t}isComplete(){return this._stopped||this._elapsedTime>=this._delay}stop(){this._stopped=!0}reset(){this._elapsedTime=0,this._started=!1,this._stopped=!1}}class fn{constructor(t){this._stopped=!1,this._entity=t}update(t){this._entity.get(yn).clearActions(),this._entity.kill(),this._stopped=!0}isComplete(){return this._stopped}stop(){}reset(){}}class mn{constructor(t,e,i){this._started=!1,this._stopped=!1,this._tx=t.get(hi),this._motion=t.get(ci),this._followTx=e.get(hi),this._followMotion=e.get(ci),this._current=new _t(this._tx.pos.x,this._tx.pos.y),this._end=new _t(this._followTx.pos.x,this._followTx.pos.y),this._maximumDistance=void 0!==i?i:this._current.distance(this._end),this._speed=0}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const e=Math.sqrt(Math.pow(this._followMotion.vel.x,2)+Math.pow(this._followMotion.vel.y,2));if(0!==e&&(this._speed=e),this._current=yt(this._tx.pos.x,this._tx.pos.y),this._end=yt(this._followTx.pos.x,this._followTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){const t=this._dir.scale(this._speed);this._motion.vel=yt(t.x,t.y)}else this._motion.vel=yt(0,0);this.isComplete()&&(this._tx.pos=yt(this._end.x,this._end.y),this._motion.vel=yt(0,0))}stop(){this._motion.vel=yt(0,0),this._stopped=!0}isComplete(){return this._stopped}reset(){this._started=!1,this._stopped=!1}}class vn{constructor(t,e,i){this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._tx=t.get(hi),this._motion=t.get(ci),this._meetTx=e.get(hi),this._meetMotion=e.get(ci),this._current=new _t(this._tx.pos.x,this._tx.pos.y),this._end=new _t(this._meetTx.pos.x,this._meetTx.pos.y),this._speed=i||0,void 0!==i&&(this._speedWasSpecified=!0)}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const e=Math.sqrt(Math.pow(this._meetMotion.vel.x,2)+Math.pow(this._meetMotion.vel.y,2));0===e||this._speedWasSpecified||(this._speed=e),this._current=yt(this._tx.pos.x,this._tx.pos.y),this._end=yt(this._meetTx.pos.x,this._meetTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();const i=this._dir.scale(this._speed);this._motion.vel=yt(i.x,i.y),this.isComplete()&&(this._tx.pos=yt(this._end.x,this._end.y),this._motion.vel=yt(0,0))}isComplete(){return this._stopped||this._distanceBetween<=1}stop(){this._motion.vel=yt(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._distanceBetween=void 0}}class _n{constructor(t){this._entity=t,this._queue=new Ki(t)}getQueue(){return this._queue}update(t){this._queue.update(t)}clearActions(){this._queue.clearActions()}runAction(t){return t.reset(),this._queue.add(t),this}easeTo(...t){var e,i;let n=0,s=0,o=0,r=Gi.Linear;return t[0]instanceof _t?(n=t[0].x,s=t[0].y,o=t[1],r=null!==(e=t[2])&&void 0!==e?e:r):(n=t[0],s=t[1],o=t[2],r=null!==(i=t[3])&&void 0!==i?i:r),this._queue.add(new cn(this._entity,n,s,o,r)),this}easeBy(...t){var e,i;let n=0,s=0,o=0,r=Gi.Linear;return t[0]instanceof _t?(n=t[0].x,s=t[0].y,o=t[1],r=null!==(e=t[2])&&void 0!==e?e:r):(n=t[0],s=t[1],o=t[2],r=null!==(i=t[3])&&void 0!==i?i:r),this._queue.add(new dn(this._entity,n,s,o,r)),this}moveTo(t,e,i){let n=0,s=0,o=0;return t instanceof _t?(n=t.x,s=t.y,o=e):(n=t,s=e,o=i),this._queue.add(new Zi(this._entity,n,s,o)),this}moveBy(t,e,i){let n=0,s=0,o=0;return t instanceof _t?(n=t.x,s=t.y,o=e):(n=t,s=e,o=i),this._queue.add(new Xi(this._entity,n,s,o)),this}rotateTo(t,e,i){return this._queue.add(new on(this._entity,t,e,i)),this}rotateBy(t,e,i){return this._queue.add(new rn(this._entity,t,e,i)),this}scaleTo(t,e,i,n){let s=1,o=1,r=0,a=0;return t instanceof _t&&e instanceof _t&&(s=t.x,o=t.y,r=e.x,a=e.y),"number"==typeof t&&"number"==typeof e&&(s=t,o=e,r=i,a=n),this._queue.add(new an(this._entity,s,o,r,a)),this}scaleBy(t,e,i){let n=1,s=1;return t instanceof _t&&(n=t.x,s=t.y,i=e),"number"==typeof t&&"number"==typeof e&&(n=t,s=e),this._queue.add(new ln(this._entity,n,s,i)),this}blink(t,e,i=1){return this._queue.add(new un(this._entity,t,e,i)),this}fade(t,e){return this._queue.add(new pn(this._entity,t,e)),this}delay(t){return this._queue.add(new gn(t)),this}die(){return this._queue.add(new fn(this._entity)),this}callMethod(t){return this._queue.add(new hn(t)),this}repeat(t,e){return e?(this._queue.add(new Yi(this._entity,t,e)),this):(this.repeatForever(t),this)}repeatForever(t){return this._queue.add(new qi(this._entity,t)),this}follow(t,e){return void 0===e?this._queue.add(new mn(this._entity,t)):this._queue.add(new mn(this._entity,t,e)),this}meet(t,e){return void 0===e?this._queue.add(new vn(this._entity,t)):this._queue.add(new vn(this._entity,t,e)),this}toPromise(){return new Promise((t=>{this._queue.add(new hn((()=>{t()})))}))}}class yn extends ri{constructor(){super(...arguments),this.type="ex.actions",this.dependencies=[hi,ci]}onAdd(t){this._ctx=new _n(t)}onRemove(){this._ctx=null}getQueue(){var t;return null===(t=this._ctx)||void 0===t?void 0:t.getQueue()}runAction(t){var e;return null===(e=this._ctx)||void 0===e?void 0:e.runAction(t)}update(t){var e;return null===(e=this._ctx)||void 0===e?void 0:e.update(t)}clearActions(){var t;null===(t=this._ctx)||void 0===t||t.clearActions()}easeTo(...t){return this._ctx.easeTo.apply(this._ctx,t)}easeBy(...t){return this._ctx.easeBy.apply(this._ctx,t)}moveTo(t,e,i){return this._ctx.moveTo.apply(this._ctx,[t,e,i])}moveBy(t,e,i){return this._ctx.moveBy.apply(this._ctx,[t,e,i])}rotateTo(t,e,i){return this._ctx.rotateTo(t,e,i)}rotateBy(t,e,i){return this._ctx.rotateBy(t,e,i)}scaleTo(t,e,i,n){return this._ctx.scaleTo.apply(this._ctx,[t,e,i,n])}scaleBy(t,e,i){return this._ctx.scaleBy.apply(this._ctx,[t,e,i])}blink(t,e,i){return this._ctx.blink(t,e,i)}fade(t,e){return this._ctx.fade(t,e)}delay(t){return this._ctx.delay(t)}die(){return this._ctx.die()}callMethod(t){return this._ctx.callMethod(t)}repeat(t,e){return this._ctx.repeat(t,e)}repeatForever(t){return this._ctx.repeatForever(t)}follow(t,e){return this._ctx.follow(t,e)}meet(t,e){return this._ctx.meet(t,e)}toPromise(){return this._ctx.toPromise()}}!function(t){t.Em="em",t.Rem="rem",t.Px="px",t.Pt="pt",t.Percent="%"}(Ji||(Ji={})),function(t){t.Left="left",t.Right="right",t.Center="center",t.Start="start",t.End="end"}(tn||(tn={})),function(t){t.Top="top",t.Hanging="hanging",t.Middle="middle",t.Alphabetic="alphabetic",t.Ideographic="ideographic",t.Bottom="bottom"}(en||(en={})),function(t){t.Normal="normal",t.Italic="italic",t.Oblique="oblique"}(nn||(nn={})),function(t){t.LeftToRight="ltr",t.RightToLeft="rtl"}(sn||(sn={}));class wn{constructor(t,e,i,n){this.font=t,this.text=e,this.color=i,this.maxWidth=n,this._textFragments=[],this.disposed=!1,this._dirty=!0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.dimensions=this.measureText(e),this._setDimension(this.dimensions,this.ctx),this._lastHashCode=this.getHashCode()}measureText(t,e){if(this.disposed)throw Error("Accessing disposed text instance! "+this.text);let i=null;i=null!=e?this._getLinesFromText(t,e):t.split("\n");const n=i.reduce(((t,e)=>t.length>e.length?t:e));this._applyFont(this.ctx);const s=this.ctx.measureText(n);let o=Math.abs(s.actualBoundingBoxAscent)+Math.abs(s.actualBoundingBoxDescent);const r=o*i.length;o=r;const a=r-Math.abs(s.actualBoundingBoxAscent);return new At({left:0-Math.abs(s.actualBoundingBoxLeft)-this.font.padding,top:0-Math.abs(s.actualBoundingBoxAscent)-this.font.padding,bottom:0+a+this.font.padding,right:0+Math.abs(s.actualBoundingBoxRight)+this.font.padding})}_setDimension(t,e){e.canvas.width=2*(t.width+2*this.font.padding)*this.font.quality,e.canvas.height=2*(t.height+2*this.font.padding)*this.font.quality}static getHashCode(t,e,i){var n;return e+"__hashcode__"+t.fontString+t.showDebug+t.textAlign+t.baseAlign+t.direction+JSON.stringify(t.shadow)+(t.padding.toString()+t.smoothing.toString()+t.lineWidth.toString()+t.lineDash.toString()+(null===(n=t.strokeColor)||void 0===n?void 0:n.toString())+(i?i.toString():t.color.toString()))}getHashCode(t=!0){return wn.getHashCode(this.font,this.text,t?this.color:void 0)}_applyRasterProperties(t){var e,i;t.translate(this.font.padding,this.font.padding),t.imageSmoothingEnabled=this.font.smoothing,t.lineWidth=this.font.lineWidth,t.setLineDash(null!==(e=this.font.lineDash)&&void 0!==e?e:t.getLineDash()),t.strokeStyle=null===(i=this.font.strokeColor)||void 0===i?void 0:i.toString(),t.fillStyle=this.color.toString()}_applyFont(t){t.resetTransform(),t.translate(this.font.padding+t.canvas.width/2,this.font.padding+t.canvas.height/2),t.scale(this.font.quality,this.font.quality),t.textAlign=this.font.textAlign,t.textBaseline=this.font.baseAlign,t.font=this.font.fontString,t.direction=this.font.direction,this.font.shadow&&(t.shadowColor=this.font.shadow.color.toString(),t.shadowBlur=this.font.shadow.blur,t.shadowOffsetX=this.font.shadow.offset.x,t.shadowOffsetY=this.font.shadow.offset.y)}_drawText(t,e,i){this._applyRasterProperties(t),this._applyFont(t);for(let n=0;n<e.length;n++){const s=e[n];this.color&&t.fillText(s,0,n*i),this.font.strokeColor&&t.strokeText(s,0,n*i)}this.font.showDebug&&(Se(t,wt.Green,-t.canvas.width/2,0,t.canvas.width/2,0,2),Se(t,wt.Red,0,-t.canvas.height/2,0,t.canvas.height/2,2))}_splitTextBitmap(t){const e=[];let i=0,n=0;const s=Math.min(4096,t.canvas.width),o=Math.min(4096,t.canvas.height);for(;i<t.canvas.width;){for(;n<t.canvas.height;){const r=document.createElement("canvas");r.width=s,r.height=o,r.getContext("2d").drawImage(t.canvas,i,n,s,o,0,0,s,o),e.push({x:i,y:n,canvas:r}),n+=o}i+=s,n=0}return e}flagDirty(){this._dirty=!0}render(t,e,i,n){if(this.disposed)throw Error("Accessing disposed text instance! "+this.text);this._ex=t;const s=this.getHashCode();if(this._lastHashCode!==s&&(this._dirty=!0),this._dirty){this.dimensions=this.measureText(this.text,n),this._setDimension(this.dimensions,this.ctx);const e=this._getLinesFromText(this.text,n),i=this.dimensions.height/e.length;if(this._drawText(this.ctx,e,i),t instanceof me)for(const e of this._textFragments)t.textureLoader.delete(e.canvas);if(this._textFragments=this._splitTextBitmap(this.ctx),t instanceof me)for(const e of this._textFragments)t.textureLoader.load(e.canvas,this.font.filtering,!0);this._lastHashCode=s,this._dirty=!1}for(const n of this._textFragments)t.drawImage(n.canvas,0,0,n.canvas.width,n.canvas.height,n.x/this.font.quality+e-this.ctx.canvas.width/this.font.quality/2,n.y/this.font.quality+i-this.ctx.canvas.height/this.font.quality/2,n.canvas.width/this.font.quality,n.canvas.height/this.font.quality)}dispose(){if(this.disposed=!0,this.dimensions=void 0,this.canvas=void 0,this.ctx=void 0,this._ex instanceof me)for(const t of this._textFragments)this._ex.textureLoader.delete(t.canvas);this._textFragments.length=0}_getLinesFromText(t,e){if(this._chachedText===t&&this._cachedRenderWidth===e)return this._chachedLines;const i=t.split("\n");if(null==e)return i;for(let t=0;t<i.length;t++){let n=i[t],s="";if(this.measureText(n).width>e){for(;this.measureText(n).width>e;)s=n[n.length-1]+s,n=n.slice(0,-1);i[t]=n,i[t+1]=s}}return this._chachedText=t,this._chachedLines=i,this._cachedRenderWidth=e,i}}class xn{static measureText(t,e,i){const n=wn.getHashCode(e,t);if(xn._MEASURE_CACHE.has(n))return xn._MEASURE_CACHE.get(n);xn._LOGGER.debug("Font text measurement cache miss");const s=e.measureTextWithoutCache(t,i);return xn._MEASURE_CACHE.set(n,s),s}static getTextInstance(t,e,i){const n=wn.getHashCode(e,t,i);let s=xn._TEXT_CACHE.get(n);return s||(s=new wn(e,t,i),xn._TEXT_CACHE.set(n,s),xn._LOGGER.debug("Font text instance cache miss")),xn._TEXT_USAGE.set(s,performance.now()),s}static checkAndClearCache(){const t=[],e=new Set;for(const[i,n]of xn._TEXT_USAGE.entries())if(n+100<performance.now())xn._LOGGER.debug(`Text cache entry timed out ${i.text}`),t.push(i),i.dispose();else{const t=i.getHashCode(!1);e.add(t)}t.forEach((t=>{xn._TEXT_USAGE.delete(t)})),this._TEXT_CACHE.clear();for(const[t]of this._TEXT_USAGE.entries())this._TEXT_CACHE.set(t.getHashCode(),t);const i=new Map;for(const t of e)xn._MEASURE_CACHE.has(t)&&i.set(t,xn._MEASURE_CACHE.get(t));this._MEASURE_CACHE.clear(),this._MEASURE_CACHE=i}static get cacheSize(){return xn._TEXT_USAGE.size}static clearCache(){for(const[t]of xn._TEXT_USAGE.entries())t.dispose();xn._TEXT_USAGE.clear(),xn._TEXT_CACHE.clear(),xn._MEASURE_CACHE.clear()}}xn._LOGGER=tt.getInstance(),xn._TEXT_USAGE=new Map,xn._TEXT_CACHE=new Map,xn._MEASURE_CACHE=new Map;class bn extends zt{constructor(t={}){var e,i,n,s,o,r,a,l,h,c,d,u,p,g,f,m,v,_,y;super(t),this.filtering=Ht.Blended,this.quality=2,this.padding=2,this.smoothing=!1,this.lineWidth=1,this.lineDash=[],this.color=wt.Black,this.family="sans-serif",this.style=nn.Normal,this.bold=!1,this.unit=Ji.Px,this.textAlign=tn.Left,this.baseAlign=en.Alphabetic,this.direction=sn.LeftToRight,this.size=10,this.shadow=null,this._textBounds=new At,this._textMeasurement=new wn(this,"",wt.Black),this.smoothing=null!==(e=null==t?void 0:t.smoothing)&&void 0!==e?e:this.smoothing,this.padding=null!==(i=null==t?void 0:t.padding)&&void 0!==i?i:this.padding,this.color=null!==(n=null==t?void 0:t.color)&&void 0!==n?n:this.color,this.strokeColor=null!==(s=null==t?void 0:t.strokeColor)&&void 0!==s?s:this.strokeColor,this.lineDash=null!==(o=null==t?void 0:t.lineDash)&&void 0!==o?o:this.lineDash,this.lineWidth=null!==(r=null==t?void 0:t.lineWidth)&&void 0!==r?r:this.lineWidth,this.filtering=null!==(a=null==t?void 0:t.filtering)&&void 0!==a?a:this.filtering,this.family=null!==(l=null==t?void 0:t.family)&&void 0!==l?l:this.family,this.style=null!==(h=null==t?void 0:t.style)&&void 0!==h?h:this.style,this.bold=null!==(c=null==t?void 0:t.bold)&&void 0!==c?c:this.bold,this.size=null!==(d=null==t?void 0:t.size)&&void 0!==d?d:this.size,this.unit=null!==(u=null==t?void 0:t.unit)&&void 0!==u?u:this.unit,this.textAlign=null!==(p=null==t?void 0:t.textAlign)&&void 0!==p?p:this.textAlign,this.baseAlign=null!==(g=null==t?void 0:t.baseAlign)&&void 0!==g?g:this.baseAlign,this.direction=null!==(f=null==t?void 0:t.direction)&&void 0!==f?f:this.direction,this.quality=null!==(m=null==t?void 0:t.quality)&&void 0!==m?m:this.quality,(null==t?void 0:t.shadow)&&(this.shadow={},this.shadow.blur=null!==(v=t.shadow.blur)&&void 0!==v?v:this.shadow.blur,this.shadow.offset=null!==(_=t.shadow.offset)&&void 0!==_?_:this.shadow.offset,this.shadow.color=null!==(y=t.shadow.color)&&void 0!==y?y:this.shadow.color)}clone(){return new bn({...this.cloneGraphicOptions(),size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null})}get fontString(){return`${this.style} ${this.bold?"bold":""} ${this.size}${this.unit} ${this.family}`}get localBounds(){return this._textBounds}_drawImage(t,e,i){}_rotate(t){var e;const i=null!==(e=this.origin)&&void 0!==e?e:this._textBounds.center;t.translate(i.x,i.y),t.rotate(this.rotation),t.translate(-i.x,-i.y)}_flip(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}measureTextWithoutCache(t,e){return this._textMeasurement.measureText(t,e)}measureText(t,e){return xn.measureText(t,this,e)}_postDraw(t){t.restore()}render(t,e,i,n,s,o){const r=xn.getTextInstance(e,this,i);this._textBounds=r.dimensions,this._preDraw(t,n,s),r.render(t,n,s,o),this._postDraw(t)}}class Cn extends zt{constructor(t){var e,i;super(t),this._text="",this._textWidth=0,this._textHeight=0,this.font=null!==(e=t.font)&&void 0!==e?e:new bn,this.color=null!==(i=t.color)&&void 0!==i?i:this.color,this.text=t.text,this.maxWidth=t.maxWidth}clone(){var t,e;return new Cn({text:this.text.slice(),color:null!==(e=null===(t=this.color)||void 0===t?void 0:t.clone())&&void 0!==e?e:wt.Black,font:this.font.clone(),maxWidth:this.maxWidth})}get text(){return this._text}set text(t){this._text=t,this._calculateDimension()}get font(){return this._font}set font(t){this._font=t}get width(){return 0===this._textWidth&&this._calculateDimension(),this._textWidth*this.scale.x}get height(){return 0===this._textHeight&&this._calculateDimension(),this._textHeight*this.scale.y}_calculateDimension(){const{width:t,height:e}=this.font.measureText(this._text,this.maxWidth);this._textWidth=t,this._textHeight=e}get localBounds(){return this.font.measureText(this._text,this.maxWidth).scale(this.scale)}_rotate(t){}_flip(t){}_preDraw(t,e,i){(this.isStale()||this.font.isStale())&&(this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity),this.font.tint=this.tint,super._preDraw(t,e,i)}_drawImage(t,e,i){var n;let s=wt.Black;this.font instanceof bn&&(s=null!==(n=this.color)&&void 0!==n?n:this.font.color);const{width:o,height:r}=this.font.measureText(this._text,this.maxWidth);this._textWidth=o,this._textHeight=r,this.font.render(t,this._text,s,e,i,this.maxWidth),this.font.showDebug&&(t.debug.drawRect(e-o,i-r,2*o,2*r),null!=this.maxWidth&&t.debug.drawRect(e,i,this.maxWidth,this.height,{color:wt.Yellow}))}}class An extends Oi{get body(){return this.get(Ri)}get transform(){return this.get(hi)}get motion(){return this.get(ci)}get graphics(){return this.get(Hi)}get collider(){return this.get($i)}get pointer(){return this.get(Vi)}get actions(){return this.get(yn)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t.clone()}get oldPos(){return this.body.oldPos}set oldPos(t){this.body.oldPos.setTo(t.x,t.y)}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t.clone()}get oldVel(){return this.body.oldVel}set oldVel(t){this.body.oldVel.setTo(t.x,t.y)}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t.clone()}set oldAcc(t){this.body.oldAcc.setTo(t.x,t.y)}get oldAcc(){return this.body.oldAcc}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}get scale(){return this.get(hi).scale}set scale(t){this.get(hi).scale=t}get anchor(){return this._anchor}set anchor(t){this._anchor=Ot(t,(t=>this._handleAnchorChange(t))),this._handleAnchorChange(t)}_handleAnchorChange(t){this.graphics&&(this.graphics.anchor=t)}get isOffScreen(){return this.hasTag("ex.offscreen")}get draggable(){return this._draggable}set draggable(t){t&&(t&&!this._draggable?(this.events.on("pointerdragstart",this._pointerDragStartHandler),this.events.on("pointerdragend",this._pointerDragEndHandler),this.events.on("pointerdragmove",this._pointerDragMoveHandler),this.events.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.events.off("pointerdragstart",this._pointerDragStartHandler),this.events.off("pointerdragend",this._pointerDragEndHandler),this.events.off("pointerdragmove",this._pointerDragMoveHandler),this.events.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}get color(){return this._color}set color(t){var e;this._color=t.clone();const i=null===(e=this.graphics.layers.default.graphics[0])||void 0===e?void 0:e.graphic;(i instanceof Le||i instanceof Cn)&&(i.color=this._color)}constructor(t){super(),this.events=new m,this._anchor=Ot(_t.Half,(t=>this._handleAnchorChange(t))),this.logger=tt.getInstance(),this._draggable=!1,this._dragging=!1,this._pointerDragStartHandler=()=>{this._dragging=!0},this._pointerDragEndHandler=()=>{this._dragging=!1},this._pointerDragMoveHandler=t=>{this._dragging&&(this.pos=t.worldPos)},this._pointerDragLeaveHandler=t=>{this._dragging&&(this.pos=t.worldPos)};const{name:e,x:i,y:n,pos:s,coordPlane:o,scale:r,width:a,height:l,radius:h,collider:c,vel:d,acc:u,rotation:p,angularVelocity:g,z:f,color:v,visible:_,anchor:y,collisionType:w,collisionGroup:x}={...t};this._setName(e),this.anchor=null!=y?y:An.defaults.anchor.clone();const b=new hi;this.addComponent(b),this.pos=null!=s?s:yt(null!=i?i:0,null!=n?n:0),this.rotation=null!=p?p:0,this.scale=null!=r?r:yt(1,1),this.z=null!=f?f:0,b.coordPlane=null!=o?o:ei.World,this.addComponent(new Vi),this.addComponent(new Hi({anchor:this.anchor})),this.addComponent(new ci),this.vel=null!=d?d:_t.Zero,this.acc=null!=u?u:_t.Zero,this.angularVelocity=null!=g?g:0,this.addComponent(new yn),this.addComponent(new Ri),this.body.collisionType=null!=w?w:Ge.Passive,x&&(this.body.group=x),c?this.addComponent(new $i(c)):h?this.addComponent(new $i(Mi.Circle(h))):a>0&&l>0?this.addComponent(new $i(Mi.Box(a,l,this.anchor))):this.addComponent(new $i),this.graphics.visible=null==_||_,v&&(this.color=v,a&&l?this.graphics.add(new Ui({color:v,width:a,height:l})):h&&this.graphics.add(new ji({color:v,radius:h})))}clone(){const t=new An({color:this.color.clone(),anchor:this.anchor.clone()});t.clearComponents(),t.processComponentRemoval();const e=this.getComponents();for(const i of e)t.addComponent(i.clone(),!0);return t}onInitialize(t){}_initialize(t){super._initialize(t);for(const e of this.children)e._initialize(t)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}_prekill(t){this.events.emit("prekill",new y(this)),this.onPreKill(t)}onPreKill(t){}_postkill(t){this.events.emit("postkill",new w(this)),this.onPostKill(t)}onPostKill(t){}kill(){this.scene?(this._prekill(this.scene),this.events.emit("kill",new _(this)),super.kill(),this._postkill(this.scene)):this.logger.warn(`Cannot kill actor named "${this.name}", it was never added to the Scene`)}unkill(){this.active=!0}isKilled(){return!this.active}get z(){return this.get(hi).z}set z(t){this.get(hi).z=t}get center(){const t=this.getGlobalPos();return new _t(t.x+this.width/2-this.anchor.x*this.width,t.y+this.height/2-this.anchor.y*this.height)}get localCenter(){return new _t(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}get width(){return this.collider.localBounds.width*this.getGlobalScale().x}get height(){return this.collider.localBounds.height*this.getGlobalScale().y}getGlobalRotation(){return this.get(hi).globalRotation}getGlobalPos(){return this.get(hi).globalPos}getGlobalScale(){return this.get(hi).globalScale}contains(t,e,i=!1){const n=yt(t,e),s=this.get($i);s.update();const o=s.get();if(!o)return!1;const r=o.contains(n);return i?r||this.children.some((i=>i.contains(t,e,!0))):r}within(t,e){const i=this.get($i),n=t.get($i),s=i.get(),o=n.get();return!(!s||!o)&&s.getClosestLineBetween(o).getLength()<=e}update(t,e){this._initialize(t),this._preupdate(t,e),this._postupdate(t,e)}onPreUpdate(t,e){}onPostUpdate(t,e){}_preupdate(t,e){this.events.emit("preupdate",new T(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.events.emit("postupdate",new k(t,e,this)),this.onPostUpdate(t,e)}}function Sn(t){return t instanceof En}An.defaults={anchor:_t.Half};class En extends An{constructor(t){var e,i;super({...t}),this.get(hi).coordPlane=ei.Screen,this.anchor=null!==(e=null==t?void 0:t.anchor)&&void 0!==e?e:yt(0,0),this.body.collisionType=null!==(i=null==t?void 0:t.collisionType)&&void 0!==i?i:Ge.PreventCollision,this.pointer.useGraphicsBounds=!0,this.pointer.useColliderShape=!1,!(null==t?void 0:t.collider)&&(null==t?void 0:t.width)>0&&(null==t?void 0:t.height)>0&&this.collider.useBoxCollider(this.width,this.height,this.anchor)}_initialize(t){this._engine=t,super._initialize(t)}contains(t,e,i=!0){if(i)return super.contains(t,e);const n=this._engine.worldToScreenCoordinates(new _t(t,e));return super.contains(n.x,n.y)}}class Tn{get complete(){return this._complete}constructor(t,e,i,n,s,o){if(this._logger=tt.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this.randomRange=[0,0],this._baseInterval=10,this._generateRandomInterval=()=>this._baseInterval+this.random.integer(this.randomRange[0],this.randomRange[1]),this._complete=!1,this.scene=null,"function"!=typeof t){const r=t;t=r.fcn,e=r.interval,i=r.repeats,n=r.numberOfRepeats,s=r.randomRange,o=r.random}if(n&&n>=0&&(this.maxNumberOfRepeats=n,!i))throw new Error("repeats must be set to true if numberOfRepeats is set");if(this.id=Tn._MAX_ID++,this._callbacks=[],this._baseInterval=this.interval=e,s){if(s[0]>s[1])throw new Error("min value must be lower than max value for range");this.random=null!=o?o:new at,this.randomRange=s,this.interval=this._generateRandomInterval(),this.on((()=>{this.interval=this._generateRandomInterval()}))}this.repeats=i||this.repeats,t&&this.on(t)}on(t){this._callbacks.push(t)}off(t){const e=this._callbacks.indexOf(t);this._callbacks.splice(e,1)}update(t){this._running&&(this._totalTimeAlive+=t,this._elapsedTime+=t,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach((t=>{t.call(this)})),this._numberOfTicks++,this.repeats||(this._complete=!0,this._running=!1),this._elapsedTime=0))}reset(t,e){if(t&&t>=0&&(this._baseInterval=this.interval=t),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=e,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}get timesRepeated(){return this._numberOfTicks}getTimeRunning(){return this._totalTimeAlive}get timeToNextAction(){return this.complete?0:this.interval-this._elapsedTime}get timeElapsedTowardNextAction(){return this._elapsedTime}get isRunning(){return this._running}pause(){return this._running=!1,this}resume(){return this._running=!0,this}start(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}stop(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}cancel(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}Tn._MAX_ID=0;class kn extends ri{constructor(t){super(),this.type="ex.parallax",this.parallaxFactor=yt(1,1),this.parallaxFactor=null!=t?t:this.parallaxFactor}}class Mn extends ri{constructor(t,e=!0){super(),this.draw=t,this.useTransform=e,this.type="ex.debuggraphics"}}const $n={PreUpdate:"preupdate",PostUpdate:"postupdate",PreDraw:"predraw",PostDraw:"postdraw"};class Ln extends Oi{flagCollidersDirty(){this._collidersDirty=!0}flagTilesDirty(){for(let t=0;t<this.tiles.length;t++)this.tiles[t]&&this.tiles[t].flagDirty()}get x(){var t;return null!==(t=this._transform.pos.x)&&void 0!==t?t:0}set x(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this.get(hi).pos=yt(t,this.y))}get y(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos.y)&&void 0!==e?e:0}set y(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this._transform.pos=yt(this.x,t))}get z(){var t;return null!==(t=this._transform.z)&&void 0!==t?t:0}set z(t){this._transform&&(this._transform.z=t)}get rotation(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.rotation)&&void 0!==e?e:0}set rotation(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.rotation)&&(this._transform.rotation=t)}get scale(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.scale)&&void 0!==e?e:_t.One}set scale(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.scale)&&(this._transform.scale=t)}get pos(){return this._transform.pos}set pos(t){this._transform.pos=t}get vel(){return this._motion.vel}set vel(t){this._motion.vel=t}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}constructor(t){var e,i;super(null,t.name),this.events=new m,this._token=0,this.logger=tt.getInstance(),this.tiles=[],this._rows=[],this._cols=[],this.renderFromTopOfGraphic=!1,this._collidersDirty=!0,this._originalOffsets=new WeakMap,this.addComponent(new hi),this.addComponent(new ci),this.addComponent(new Ri({type:Ge.Fixed})),this.addComponent(new Hi({onPostDraw:(t,e)=>this.draw(t,e)})),this.addComponent(new Mn((t=>this.debug(t)))),this.addComponent(new $i),this._graphics=this.get(Hi),this._transform=this.get(hi),this._motion=this.get(ci),this._collider=this.get($i),this._composite=this._collider.useCompositeCollider([]),this._transform.pos=null!==(e=t.pos)&&void 0!==e?e:_t.Zero,this._oldPos=this._transform.pos.clone(),this._oldScale=this._transform.scale.clone(),this.renderFromTopOfGraphic=null!==(i=t.renderFromTopOfGraphic)&&void 0!==i?i:this.renderFromTopOfGraphic,this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight,this.rows=t.rows,this.columns=t.columns,this.tiles=new Array(this.rows*this.columns),this._rows=new Array(this.rows),this._cols=new Array(this.columns);let n=[];for(let t=0;t<this.columns;t++){for(let e=0;e<this.rows;e++){const i=new Rn({x:t,y:e,map:this});i.map=this,this.tiles[t+e*this.columns]=i,n.push(i),this._rows[e]||(this._rows[e]=[]),this._rows[e].push(i)}this._cols[t]=n,n=[]}this._graphics.localBounds=new At({left:0,top:0,right:this.columns*this.tileWidth*this.scale.x,bottom:this.rows*this.tileHeight*this.scale.y})}_initialize(t){super._initialize(t),this._engine=t}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const e=t.offset;return this._originalOffsets.set(t,e),e}}_updateColliders(){this._collider.$colliderRemoved.notifyAll(this._composite),this._composite.clearColliders();const t=[];let e;this._composite=this._collider.useCompositeCollider([]);for(let i=0;i<this.columns;i++){for(let n=0;n<this.rows;n++){0===n&&(e=null);const s=this.tiles[i+n*this.columns];if(s.solid)if(s.getColliders().length>0){for(const t of s.getColliders()){const e=this._getOrSetColliderOriginalOffset(t);t.offset=yt(s.x*this.tileWidth*this.scale.x,s.y*this.tileHeight*this.scale.y).add(e),t.owner=this,this._composite.addCollider(t)}e&&t.push(e),e=null}else e=e?e.combine(s.bounds):s.bounds;else e&&t.push(e),e=null}if(e){const i=t[t.length-1];i&&i.top===e.top&&i.bottom===e.bottom?t[t.length-1]=i.combine(e):t.push(e)}}for(const e of t){const t=Mi.Box(e.width,e.height,_t.Zero,yt(e.left-this.pos.x,e.top-this.pos.y));t.owner=this,this._composite.addCollider(t)}this._collider.update(),this._collider.$colliderAdded.notifyAll(this._composite)}getTileByIndex(t){return this.tiles[t]}getTile(t,e){return t<0||e<0||t>=this.columns||e>=this.rows?null:this.tiles[t+e*this.columns]}getTileByPoint(t){const e=Math.floor((t.x-this.pos.x)/(this.tileWidth*this.scale.x)),i=Math.floor((t.y-this.pos.y)/(this.tileHeight*this.scale.y)),n=this.getTile(e,i);return e>=0&&i>=0&&e<this.columns&&i<this.rows&&n?n:null}getRows(){return this._rows}getColumns(){return this._cols}update(t,e){this.onPreUpdate(t,e),this.emit("preupdate",new T(t,e,this)),this._oldPos.equals(this.pos)&&this._oldScale.equals(this.scale)||(this.flagCollidersDirty(),this.flagTilesDirty()),this._collidersDirty&&(this._collidersDirty=!1,this._updateColliders()),this._token++,this.pos.clone(this._oldPos),this.scale.clone(this._oldScale),this._transform.pos=this.pos,this.onPostUpdate(t,e),this.emit("postupdate",new k(t,e,this))}draw(t,e){this.emit("predraw",new C(t,e,this));let i=this._engine.screen.getWorldBounds(),n=0;const s=this.columns;let o=0;const r=this.rows;let a,l,h;const c=this.get(kn);if(c){let t=this.pos;const e=_t.One.sub(c.parallaxFactor),n=this._engine.currentScene.camera.pos.scale(e);t=t.sub(n),i=i.translate(t)}let d;for(;n<s;n++){for(;o<r;o++)if(d=this.getTile(n,o),i.overlaps(d.bounds))for(a=this.getTile(n,o).getGraphics(),l=0,h=a.length;l<h;l++){const i=a[l];if(i){Ni(i)&&(null==i||i.tick(e,this._token));const s=this.renderFromTopOfGraphic?0:i.height-this.tileHeight;i.draw(t,n*this.tileWidth,o*this.tileHeight-s)}}o=0}this.emit("postdraw",new A(t,e,this))}debug(t){const e=this.tileWidth*this.columns,i=this.tileHeight*this.rows,n=_t.Zero;for(let i=0;i<this.rows+1;i++){const s=yt(0,i*this.tileHeight);t.drawLine(n.add(s),n.add(yt(e,s.y)),wt.Red,2)}for(let e=0;e<this.columns+1;e++){const s=yt(e*this.tileWidth,0);t.drawLine(n.add(s),n.add(yt(s.x,i)),wt.Red,2)}const s=this._composite.getColliders();for(const e of s){const i=wt.Gray;i.a=.5;const n=e.localBounds,s=e.worldPos.sub(this.pos);t.drawRectangle(s,n.width,n.height,i)}}}class Rn extends Oi{get pos(){return this._posDirty&&(this._recalculate(),this._posDirty=!1),this._pos}get width(){return this._width}get height(){return this._height}get solid(){return this._solid}set solid(t){var e;null===(e=this.map)||void 0===e||e.flagCollidersDirty(),this._solid=t}getGraphics(){return this._graphics}addGraphic(t){this._graphics.push(t)}removeGraphic(t){kt(t,this._graphics)}clearGraphics(){this._graphics.length=0}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const e=this._colliders.indexOf(t);e>-1&&this._colliders.splice(e,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}constructor(t){var e,i;super(),this._posDirty=!1,this._solid=!1,this._graphics=[],this._colliders=[],this.data=new Map,this.x=t.x,this.y=t.y,this.map=t.map,this._width=t.map.tileWidth*this.map.scale.x,this._height=t.map.tileHeight*this.map.scale.y,this.solid=null!==(e=t.solid)&&void 0!==e?e:this.solid,this._graphics=null!==(i=t.graphics)&&void 0!==i?i:[],this._recalculate()}flagDirty(){return this._posDirty=!0}_recalculate(){this._width=this.map.tileWidth*this.map.scale.x,this._height=this.map.tileHeight*this.map.scale.y,this._pos=this.map.pos.add(yt(this.x*this._width,this.y*this._height)),this._bounds=new At(this._pos.x,this._pos.y,this._pos.x+this._width,this._pos.y+this._height),this._posDirty=!1}get bounds(){return this._posDirty&&this._recalculate(),this._bounds}get center(){return this._posDirty&&this._recalculate(),new _t(this._pos.x+this._width/2,this._pos.y+this._height/2)}}class In{constructor(t){this.camera=t}lockToActor(t){this.camera.addStrategy(new Pn(t))}lockToActorAxis(t,e){this.camera.addStrategy(new Bn(t,e))}elasticToActor(t,e,i){this.camera.addStrategy(new Fn(t,e,i))}radiusAroundActor(t,e){this.camera.addStrategy(new On(t,e))}limitCameraBounds(t){this.camera.addStrategy(new Nn(t))}}var Dn;!function(t){t[t.X=0]="X",t[t.Y=1]="Y"}(Dn||(Dn={}));class Pn{constructor(t){this.target=t,this.action=(t,e,i,n)=>t.center}}class Bn{constructor(t,e){this.target=t,this.axis=e,this.action=(t,e,i,n)=>{const s=t.center,o=e.getFocus();return this.axis===Dn.X?new _t(s.x,o.y):new _t(o.x,s.y)}}}class Fn{constructor(t,e,i){this.target=t,this.cameraElasticity=e,this.cameraFriction=i,this.action=(t,e,i,n)=>{const s=t.center;let o=e.getFocus(),r=e.vel.clone();const a=s.sub(o).scale(this.cameraElasticity);r=r.add(a);const l=r.scale(-1).scale(this.cameraFriction);return r=r.add(l),o=o.add(r),o}}}class On{constructor(t,e){this.target=t,this.radius=e,this.action=(t,e,i,n)=>{const s=t.center,o=e.getFocus(),r=s.sub(o),a=r.size;if(a>=this.radius){const t=a-this.radius;return o.add(r.normalize().scale(t))}return o}}}class Nn{constructor(t){this.target=t,this.boundSizeChecked=!1,this.action=(t,e,i,n)=>{const s=e.getFocus();this.boundSizeChecked||((t.bottom-t.top<i.drawHeight||t.right-t.left<i.drawWidth)&&tt.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),this.boundSizeChecked=!0);let o=s.x,r=s.y;return s.x<t.left+i.halfDrawWidth?o=t.left+i.halfDrawWidth:s.x>t.right-i.halfDrawWidth&&(o=t.right-i.halfDrawWidth),s.y<t.top+i.halfDrawHeight?r=t.top+i.halfDrawHeight:s.y>t.bottom-i.halfDrawHeight&&(r=t.bottom-i.halfDrawHeight),yt(o,r)}}}const zn={Initialize:"initialize",PreUpdate:"preupdate",PostUpdate:"postupdate"};class Wn{constructor(){this.events=new m,this.transform=It.identity(),this.inverse=It.identity(),this._cameraStrategies=[],this.strategy=new In(this),this._z=1,this.dz=0,this.az=0,this.rotation=0,this._angularVelocity=0,this._posChanged=!1,this._pos=Nt(_t.Zero,(()=>this._posChanged=!0)),this.vel=_t.Zero,this.acc=_t.Zero,this._cameraMoving=!1,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=null,this._lerpEnd=null,this._isShaking=!1,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._elapsedShakeTime=0,this._xShake=0,this._yShake=0,this._isZooming=!1,this._zoomStart=1,this._zoomEnd=1,this._currentZoomTime=0,this._zoomDuration=0,this._zoomEasing=Gi.EaseInOutCubic,this._easing=Gi.EaseInOutCubic,this._halfWidth=0,this._halfHeight=0,this._viewport=null,this._isInitialized=!1}get zoom(){return this._z}set zoom(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}get angularVelocity(){return this._angularVelocity}set angularVelocity(t){this._angularVelocity=t}get pos(){return this._pos}set pos(t){this._pos=Nt(t,(()=>this._posChanged=!0)),this._posChanged=!0}get x(){return this.pos.x}set x(t){this._follow||this._cameraMoving||(this.pos=yt(t,this.pos.y))}get y(){return this.pos.y}set y(t){this._follow||this._cameraMoving||(this.pos=yt(this.pos.x,t))}get dx(){return this.vel.x}set dx(t){this.vel=yt(t,this.vel.y)}get dy(){return this.vel.y}set dy(t){this.vel=yt(this.vel.x,t)}get ax(){return this.acc.x}set ax(t){this.acc=yt(t,this.acc.y)}get ay(){return this.acc.y}set ay(t){this.acc=yt(this.acc.x,t)}getFocus(){return this.pos}move(t,e,i=Gi.EaseInOutCubic){if("function"!=typeof i)throw"Please specify an EasingFunction";return this._follow?Promise.reject(t):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(t),this._lerpPromise=new Promise((t=>{this._lerpResolve=t})),this._lerpStart=this.getFocus().clone(),this._lerpDuration=e,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=i,this._lerpPromise)}shake(t,e,i){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=e,this._shakeDuration=i}zoomOverTime(t,e=0,i=Gi.EaseInOutCubic){return this._zoomPromise=new Promise((t=>{this._zoomResolve=t})),e?(this._isZooming=!0,this._zoomEasing=i,this._currentZoomTime=0,this._zoomDuration=e,this._zoomStart=this.zoom,this._zoomEnd=t,this._zoomPromise):(this._isZooming=!1,this.zoom=t,Promise.resolve(!0))}get viewport(){return this._viewport?this._viewport:new At(0,0,0,0)}addStrategy(t){this._cameraStrategies.push(t)}removeStrategy(t){kt(t,this._cameraStrategies)}clearAllStrategies(){this._cameraStrategies.length=0}_preupdate(t,e){this.events.emit("preupdate",new T(t,e,this)),this.onPreUpdate(t,e)}onPreUpdate(t,e){}_postupdate(t,e){this.events.emit("postupdate",new k(t,e,this)),this.onPostUpdate(t,e)}onPostUpdate(t,e){}get isInitialized(){return this._isInitialized}_initialize(t){if(!this.isInitialized){this._engine=t,this._screen=t.screen;const e=this._screen.contentArea;let i=yt(e.width/2,e.height/2);if(!this._engine.loadingComplete){const t=this._screen.peekResolution();t&&(i=yt(t.width/2,t.height/2))}this._halfWidth=i.x,this._halfHeight=i.y,this._posChanged||(this.pos=i),this.updateTransform(),this.runStrategies(t,t.clock.elapsed()),this.updateViewport(),this.updateTransform(),this.onInitialize(t),this.events.emit("initialize",new V(t,this)),this._isInitialized=!0}}onInitialize(t){}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}runStrategies(t,e){for(const i of this._cameraStrategies)this.pos=i.action.call(i,i.target,this,t,e)}updateViewport(){this._viewport=new At(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight)}update(t,e){if(this._initialize(t),this._preupdate(t,e),this.pos=this.pos.add(this.vel.scale(e/1e3)),this.zoom+=this.dz*e/1e3,this.vel=this.vel.add(this.acc.scale(e/1e3)),this.dz+=this.az*e/1e3,this.rotation+=this.angularVelocity*e/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){const t=(0,this._zoomEasing)(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=t,this._currentZoomTime+=e}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){const t=Gi.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=t,this._currentLerpTime+=e}else{this.pos=this._lerpEnd;const t=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(t)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=e,this._xShake=1+(Math.random()*this._shakeMagnitudeX|0),this._yShake=1+(Math.random()*this._shakeMagnitudeY|0)),this.runStrategies(t,e),this.updateViewport(),this.updateTransform(),this._postupdate(t,e)}draw(t){t.multiply(this.transform)}updateTransform(){const t=this._screen.resolution.width/this.zoom,e=this._screen.resolution.height/this.zoom,i=yt(-this.x+t/2+this._xShake,-this.y+e/2+this._yShake);this.transform.reset(),this.transform.scale(this.zoom,this.zoom),this.transform.translate(t/2,e/2),this.transform.rotate(this.rotation),this.transform.translate(-t/2,-e/2),this.transform.translate(i.x,i.y),this.transform.inverse(this.inverse)}_isDoneShaking(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}const Hn={ExitTrigger:"exittrigger",EnterTrigger:"entertrigger"},Un={pos:_t.Zero,width:10,height:10,visible:!1,action:()=>{},filter:()=>!0,repeat:-1};class jn extends An{constructor(t){super({x:t.pos.x,y:t.pos.y,width:t.width,height:t.height}),this.events=new m,this.action=()=>{},this.filter=()=>!0,this.repeat=-1,t={...Un,...t},this.filter=t.filter||this.filter,this.repeat=t.repeat||this.repeat,this.action=t.action||this.action,t.target&&(this.target=t.target),this.graphics.visible=t.visible,this.body.collisionType=Ge.Passive,this.events.on("collisionstart",(t=>{this.filter(t.other)&&(this.emit("enter",new X(this,t.other)),this._dispatchAction(),0===this.repeat&&this.kill())})),this.events.on("collisionend",(t=>{this.filter(t.other)&&this.emit("exit",new Z(this,t.other))}))}set target(t){this._target=t,this.filter=e=>e===t}get target(){return this._target}_initialize(t){super._initialize(t)}_dispatchAction(){0!==this.repeat&&(this.action.call(this),this.repeat--)}}var Vn;!function(t){t.Update="update",t.Draw="draw"}(Vn||(Vn={}));class Gn{constructor(){this.priority=0}notify(t){}}class Kn{constructor(t){this.data=t,this.type="Entity Added"}}function Yn(t){return!!t&&"Entity Added"===t.type}class qn{constructor(t){this.data=t,this.type="Entity Removed"}}function Xn(t){return!!t&&"Entity Removed"===t.type}class Zn{constructor(t){this._world=t,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}updateEntities(t,e){for(const i of this.entities)i.update(t.engine,e),i.active||this.removeEntity(i)}findEntitiesForRemoval(){for(const t of this.entities)t.active||this.removeEntity(t)}notify(t){Di(t)&&this._world.queryManager.addEntity(t.data.entity),Bi(t)&&this._world.queryManager.removeComponent(t.data.entity,t.data.component)}addEntity(t){t.active=!0,t.scene=this._world.context,t&&!this._entityIndex[t.id]&&(this._entityIndex[t.id]=t,this.entities.push(t),this._world.queryManager.addEntity(t),t.componentAdded$.register(this),t.componentRemoved$.register(this),t.children.forEach((e=>{e.scene=t.scene,this.addEntity(e)})),t.childrenAdded$.register({notify:t=>{this.addEntity(t)}}),t.childrenRemoved$.register({notify:t=>{this.removeEntity(t,!1)}}))}removeEntity(t,e=!0){var i;let n=0;n=t instanceof Oi?t.id:t;const s=this._entityIndex[n];s&&s.active&&(s.active=!1),s&&e?this._entitiesToRemove.push(s):(delete this._entityIndex[n],s&&(s.scene=null,kt(s,this.entities),this._world.queryManager.removeEntity(s),s.componentAdded$.unregister(this),s.componentRemoved$.unregister(this),s.children.forEach((t=>{t.scene=null,this.removeEntity(t,e)})),s.childrenAdded$.clear(),s.childrenRemoved$.clear(),(null===(i=this._world.context)||void 0===i?void 0:i.engine)&&this._world.context.engine.stats.currFrame.actors.killed++))}processEntityRemovals(){for(const t of this._entitiesToRemove)t.active||this.removeEntity(t,!1);this._entitiesToRemove.length=0}processComponentRemovals(){for(const t of this.entities)t.processComponentRemoval()}getById(t){return this._entityIndex[t]}getByName(t){return this.entities.filter((e=>e.name===t))}clear(){for(const t of this.entities)this.removeEntity(t)}}const Qn=t=>[...t].sort(((t,e)=>t.localeCompare(e))).join("+");class Jn extends li{get key(){return this._key?this._key:this._key=Qn(this.types)}constructor(t){super(),this._entities=[],t[0]instanceof Function?this.types=t.map((t=>(new t).type)):this.types=t}getEntities(t){return t&&this._entities.sort(t),this._entities}addEntity(t){!Mt(this._entities,t)&&this.matches(t)&&(this._entities.push(t),this.notifyAll(new Kn(t)))}removeEntity(t){kt(t,this._entities)&&this.notifyAll(new qn(t))}clear(){this._entities.length=0;for(const t of this.observers)this.unregister(t)}matches(t){let e=[];e=t instanceof Oi?t.types:t;let i=!0;for(const t of this.types)if(i=i&&e.indexOf(t)>-1,!i)return!1;return i}contain(t){return this.types.indexOf(t)>-1}}class ts{constructor(t){this._world=t,this._queries={}}_addQuery(t){this._queries[Qn(t.types)]=t;for(const e of this._world.entityManager.entities)t.addEntity(e)}maybeRemoveQuery(t){0===t.observers.length&&(t.clear(),delete this._queries[Qn(t.types)])}addEntity(t){for(const e in this._queries)this._queries[e]&&this._queries[e].addEntity(t)}removeComponent(t,e){for(const i in this._queries)this._queries[i].contain(e.type)&&this._queries[i].removeEntity(t)}removeEntity(t){for(const e in this._queries)this._queries[e].removeEntity(t)}createQuery(t){const e=this.getQuery(t);if(e)return e;const i=new Jn(t);return this._addQuery(i),i}getQuery(t){const e=Qn(t);return this._queries[e]?this._queries[e]:null}}class es{constructor(t){this._world=t,this.systems=[],this.initialized=!1}get(t){return this.systems.find((e=>e instanceof t))}addSystem(t){if(!t.types||0===t.types.length)throw new Error("Attempted to add a System without any types");const e=this._world.queryManager.createQuery(t.types);this.systems.push(t),this.systems.sort(((t,e)=>t.priority-e.priority)),e.register(t),this.initialized&&t.initialize&&t.initialize(this._world.context)}removeSystem(t){kt(t,this.systems);const e=this._world.queryManager.getQuery(t.types);e&&(e.unregister(t),this._world.queryManager.maybeRemoveQuery(e))}initialize(){if(!this.initialized){this.initialized=!0;for(const t of this.systems)t.initialize&&t.initialize(this._world.context)}}updateSystems(t,e,i){const n=this.systems.filter((e=>e.systemType===t));for(const t of n)t.preupdate&&t.preupdate(e,i);for(const t of n){const n=this._world.queryManager.getQuery(t.types).getEntities(t.sort);if(e instanceof Ms)for(const t of n)t._initialize(null==e?void 0:e.engine);t.update(n,i)}for(const t of n)t.postupdate&&t.postupdate(e,i)}clear(){for(const t of this.systems)this.removeSystem(t)}}class is{constructor(t){this.context=t,this.queryManager=new ts(this),this.entityManager=new Zn(this),this.systemManager=new es(this)}update(t,e){t===Vn.Update&&this.entityManager.updateEntities(this.context,e),this.systemManager.updateSystems(t,this.context,e),this.entityManager.findEntitiesForRemoval(),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}add(t){t instanceof Oi&&this.entityManager.addEntity(t),t instanceof Gn&&this.systemManager.addSystem(t)}remove(t,e=!0){t instanceof Oi&&this.entityManager.removeEntity(t,e),t instanceof Gn&&this.systemManager.removeSystem(t)}clearEntities(){this.entityManager.clear()}clearSystems(){this.systemManager.clear()}}class ns{static integrate(t,e,i,n){const s=n/1e3;e.vel.addEqual(i.scale(s,ns._ACC)),t.pos.add(e.vel.scale(s,ns._VEL),ns._POS).addEqual(i.scale(.5*s*s,ns._VEL_ACC)),e.angularVelocity+=e.torque*(1/e.inertia)*s;const o=t.rotation+e.angularVelocity*s;t.scale.add(e.scaleFactor.scale(s,this._SCALE_FACTOR),ns._SCALE),t.get().setTransform(ns._POS,o,ns._SCALE)}}ns._POS=new _t(0,0),ns._SCALE=new _t(1,1),ns._ACC=new _t(0,0),ns._VEL=new _t(0,0),ns._VEL_ACC=new _t(0,0),ns._SCALE_FACTOR=new _t(0,0);class ss extends Gn{constructor(){super(...arguments),this.types=["ex.transform","ex.motion"],this.systemType=Vn.Update,this.priority=-1}update(t,e){let i,n;for(let s=0;s<t.length;s++){i=t[s].get(hi),n=t[s].get(ci);const o=t[s].get(Ri);if(null==o?void 0:o.sleeping)continue;const r=n.acc.clone();(null==o?void 0:o.collisionType)===Ge.Active&&(null==o?void 0:o.useGravity)&&r.addEqual(ii.gravity),null==o||o.captureOldTransform(),ns.integrate(i,n,r,e)}}}class os{constructor(){this.directionMap=new Map,this.distanceMap=new Map}solve(t){this.preSolve(t),(t=t.filter((t=>!t.isCanceled()))).sort(((t,e)=>this.distanceMap.get(t.id)-this.distanceMap.get(e.id)));for(const e of t)this.solvePosition(e),this.solveVelocity(e);return this.postSolve(t),t}preSolve(t){const e=1e-4;for(const i of t){if(Math.abs(i.mtv.x)<e&&Math.abs(i.mtv.y)<e){i.cancel();continue}const t=bt.fromDirection(i.mtv),n=i.mtv.negate(),s=i.colliderA.worldPos.squareDistance(i.colliderB.worldPos);this.distanceMap.set(i.id,s),i.colliderA.events.emit("precollision",new F(i.colliderA,i.colliderB,t,n)),i.colliderB.events.emit("precollision",new F(i.colliderB,i.colliderA,bt.getOpposite(t),n.negate()))}}postSolve(t){var e,i;for(const n of t){if(n.isCanceled())continue;const t=n.colliderA,s=n.colliderB,o=null===(e=t.owner)||void 0===e?void 0:e.get(Ri),r=null===(i=s.owner)||void 0===i?void 0:i.get(Ri);if(o&&r&&(o.collisionType===Ge.Passive||r.collisionType===Ge.Passive))continue;const a=bt.fromDirection(n.mtv),l=n.mtv.negate();n.colliderA.events.emit("postcollision",new O(n.colliderA,n.colliderB,a,l)),n.colliderB.events.emit("postcollision",new O(n.colliderB,n.colliderA,bt.getOpposite(a),l.negate()))}}solvePosition(t){var e,i;const n=1e-4;if(!t.colliderA.bounds.overlaps(t.colliderB.bounds,n))return void t.cancel();if(Math.abs(t.mtv.x)<n&&Math.abs(t.mtv.y)<n)return void t.cancel();let s=t.mtv;const o=t.colliderA,r=t.colliderB,a=null===(e=o.owner)||void 0===e?void 0:e.get(Ri),l=null===(i=r.owner)||void 0===i?void 0:i.get(Ri);if(a&&l){if(a.collisionType===Ge.Passive||l.collisionType===Ge.Passive)return;a.collisionType===Ge.Active&&l.collisionType===Ge.Active&&(s=s.scale(.5)),a.collisionType===Ge.Active&&(a.globalPos.x-=s.x,a.globalPos.y-=s.y,o.update(a.transform.get())),l.collisionType===Ge.Active&&(l.globalPos.x+=s.x,l.globalPos.y+=s.y,r.update(l.transform.get()))}}solveVelocity(t){var e,i;if(t.isCanceled())return;const n=t.colliderA,s=t.colliderB,o=null===(e=n.owner)||void 0===e?void 0:e.get(Ri),r=null===(i=s.owner)||void 0===i?void 0:i.get(Ri);if(o&&r){if(o.collisionType===Ge.Passive||r.collisionType===Ge.Passive)return;const e=t.normal,i=e.negate();if(o.collisionType===Ge.Active&&o.vel.normalize().dot(i)<0){const t=e.scale(e.dot(o.vel.negate()));o.vel=o.vel.add(t)}if(r.collisionType===Ge.Active&&r.vel.normalize().dot(e)<0){const t=i.scale(i.dot(r.vel.negate()));r.vel=r.vel.add(t)}}}}class rs{constructor(t,e,i){this.point=t,this.local=e,this.contact=i,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new _t(0,0),this.bToContact=new _t(0,0),this.originalVelocityAndRestitution=0,this.update()}update(){var t,e;const i=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(Ri),n=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(Ri);if(i&&n){const t=this.contact.normal,e=this.contact.tangent;this.aToContact=this.point.sub(i.globalPos),this.bToContact=this.point.sub(n.globalPos);const s=this.aToContact.cross(t),o=this.bToContact.cross(t);this.normalMass=i.inverseMass+n.inverseMass+i.inverseInertia*s*s+n.inverseInertia*o*o;const r=this.aToContact.cross(e),a=this.bToContact.cross(e);this.tangentMass=i.inverseMass+n.inverseMass+i.inverseInertia*r*r+n.inverseInertia*a*a}return this}getRelativeVelocity(){var t,e;const i=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(Ri),n=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(Ri);if(i&&n){const t=i.vel.add(_t.cross(i.angularVelocity,this.aToContact));return n.vel.add(_t.cross(n.angularVelocity,this.bToContact)).sub(t)}return _t.Zero}}class as{constructor(){this.lastFrameContacts=new Map,this.idToContactConstraint=new Map}getContactConstraints(t){var e;return null!==(e=this.idToContactConstraint.get(t))&&void 0!==e?e:[]}solve(t){return this.preSolve(t),t=t.filter((t=>!t.isCanceled())),this.solveVelocity(t),this.solvePosition(t),this.postSolve(t),t}preSolve(t){var e,i,n;const s=1e-4;for(const e of t){if(Math.abs(e.mtv.x)<s&&Math.abs(e.mtv.y)<s){e.cancel();continue}const t=bt.fromDirection(e.mtv);e.colliderA.events.emit("precollision",new F(e.colliderA,e.colliderB,t,e.mtv)),e.colliderA.events.emit("beforecollisionresolve",new W(e.colliderA,e.colliderB,t,e.mtv,e)),e.colliderB.events.emit("precollision",new F(e.colliderB,e.colliderA,bt.getOpposite(t),e.mtv.negate())),e.colliderB.events.emit("beforecollisionresolve",new W(e.colliderB,e.colliderA,bt.getOpposite(t),e.mtv.negate(),e)),e.matchAwake()}const o=Array.from(this.idToContactConstraint.keys());for(const s of t){const t=o.indexOf(s.id);t>-1&&o.splice(t,1);const r=null!==(e=this.idToContactConstraint.get(s.id))&&void 0!==e?e:[];let a=0;const l=s.colliderA.owner.get(Ri),h=s.colliderB.owner.get(Ri);if(l&&h)for(const t of s.points){const e=s.normal,o=s.tangent,c=t.sub(l.globalPos),d=t.sub(h.globalPos),u=c.cross(e),p=d.cross(e),g=l.inverseMass+h.inverseMass+l.inverseInertia*u*u+h.inverseInertia*p*p,f=c.cross(o),m=d.cross(o),v=l.inverseMass+h.inverseMass+l.inverseInertia*f*f+h.inverseInertia*m*m;r[a]&&(null===(n=null===(i=r[a])||void 0===i?void 0:i.point)||void 0===n?void 0:n.squareDistance(t))<4?(r[a].point=t,r[a].local=s.localPoints[a]):r[a]=new rs(t,s.localPoints[a],s),r[a].aToContact=c,r[a].bToContact=d,r[a].normalMass=1/g,r[a].tangentMass=1/v;const _=l.bounciness>h.bounciness?l.bounciness:h.bounciness,y=s.normal.dot(r[a].getRelativeVelocity());r[a].originalVelocityAndRestitution=0,y<-.1&&(r[a].originalVelocityAndRestitution=-_*y),a++}this.idToContactConstraint.set(s.id,r)}for(const t of o)this.idToContactConstraint.delete(t);if(ii.warmStart)this.warmStart(t);else for(const e of t){const t=this.getContactConstraints(e.id);for(const e of t)e.normalImpulse=0,e.tangentImpulse=0}}postSolve(t){for(const e of t){const t=e.colliderA.owner.get(Ri),i=e.colliderB.owner.get(Ri);if(t&&i){if(t.collisionType===Ge.Passive||i.collisionType===Ge.Passive)continue;t.updateMotion(),i.updateMotion()}const n=bt.fromDirection(e.mtv);e.colliderA.events.emit("postcollision",new O(e.colliderA,e.colliderB,n,e.mtv)),e.colliderA.events.emit("aftercollisionresolve",new H(e.colliderA,e.colliderB,n,e.mtv,e)),e.colliderB.events.emit("postcollision",new O(e.colliderB,e.colliderA,bt.getOpposite(n),e.mtv.negate())),e.colliderB.events.emit("aftercollisionresolve",new H(e.colliderB,e.colliderA,bt.getOpposite(n),e.mtv.negate(),e))}this.lastFrameContacts.clear();for(const e of t)this.lastFrameContacts.set(e.id,e)}warmStart(t){var e,i,n;for(const s of t){const t=null===(e=s.colliderA.owner)||void 0===e?void 0:e.get(Ri),o=null===(i=s.colliderB.owner)||void 0===i?void 0:i.get(Ri);if(t&&o){const e=null!==(n=this.idToContactConstraint.get(s.id))&&void 0!==n?n:[];for(const i of e)if(ii.warmStart){const e=s.normal.scale(i.normalImpulse),n=s.tangent.scale(i.tangentImpulse),r=e.add(n);t.applyImpulse(i.point,r.negate()),o.applyImpulse(i.point,r)}else i.normalImpulse=0,i.tangentImpulse=0}}}solvePosition(t){var e,i,n;for(let s=0;s<ii.positionIterations;s++)for(const s of t){const t=null===(e=s.colliderA.owner)||void 0===e?void 0:e.get(Ri),o=null===(i=s.colliderB.owner)||void 0===i?void 0:i.get(Ri);if(t&&o){if(t.collisionType===Ge.Passive||o.collisionType===Ge.Passive)continue;const e=null!==(n=this.idToContactConstraint.get(s.id))&&void 0!==n?n:[];for(const i of e){const e=s.normal,n=Ei.FindContactSeparation(s,i.local),r=-5,a=dt(ii.steeringFactor*(n+ii.slop),r,0),l=e.scale(-a*i.normalMass);if(t.collisionType===Ge.Active){const e=l.negate().scale(t.inverseMass);t.limitDegreeOfFreedom.includes(Li.X)&&(e.x=0),t.limitDegreeOfFreedom.includes(Li.Y)&&(e.y=0),t.globalPos=t.globalPos.add(e),t.limitDegreeOfFreedom.includes(Li.Rotation)||(t.rotation-=i.aToContact.cross(l)*t.inverseInertia)}if(o.collisionType===Ge.Active){const t=l.scale(o.inverseMass);o.limitDegreeOfFreedom.includes(Li.X)&&(t.x=0),o.limitDegreeOfFreedom.includes(Li.Y)&&(t.y=0),o.globalPos=o.globalPos.add(t),o.limitDegreeOfFreedom.includes(Li.Rotation)||(o.rotation+=i.bToContact.cross(l)*o.inverseInertia)}}}}}solveVelocity(t){var e,i,n;for(let s=0;s<ii.velocityIterations;s++)for(const s of t){const t=null===(e=s.colliderA.owner)||void 0===e?void 0:e.get(Ri),o=null===(i=s.colliderB.owner)||void 0===i?void 0:i.get(Ri);if(t&&o){if(t.collisionType===Ge.Passive||o.collisionType===Ge.Passive)continue;const e=Math.min(t.friction,o.friction),i=null!==(n=this.idToContactConstraint.get(s.id))&&void 0!==n?n:[];for(const n of i){let i=-n.getRelativeVelocity().dot(s.tangent)*n.tangentMass;const r=e*n.normalImpulse,a=dt(n.tangentImpulse+i,-r,r);i=a-n.tangentImpulse,n.tangentImpulse=a;const l=s.tangent.scale(i);t.applyImpulse(n.point,l.negate()),o.applyImpulse(n.point,l)}for(const e of i){const i=e.getRelativeVelocity().dot(s.normal);let n=-e.normalMass*(i-e.originalVelocityAndRestitution);const r=Math.max(e.normalImpulse+n,0);n=r-e.normalImpulse,e.normalImpulse=r;const a=s.normal.scale(n);t.applyImpulse(e.point,a.negate()),o.applyImpulse(e.point,a)}}}}}class ls extends Gn{constructor(t){super(),this.types=["ex.transform","ex.motion","ex.collider"],this.systemType=Vn.Update,this.priority=-1,this._realisticSolver=new as,this._arcadeSolver=new os,this._lastFrameContacts=new Map,this._currentFrameContacts=new Map,this._processor=t.collisionProcessor,this._trackCollider=t=>this._processor.track(t),this._untrackCollider=t=>this._processor.untrack(t)}notify(t){if(Yn(t)){const e=t.data.get($i);e.$colliderAdded.subscribe(this._trackCollider),e.$colliderRemoved.subscribe(this._untrackCollider);const i=e.get();i&&this._processor.track(i)}else{const e=t.data.get($i),i=e.get();e&&i&&this._processor.untrack(i)}}initialize(t){this._engine=t.engine}update(t,e){var i,n,s,o;if(!ii.enabled)return;let r=[];for(const e of t){const t=e.get($i),n=null==t?void 0:t.get();if(t&&(null===(i=t.owner)||void 0===i?void 0:i.active)&&n)if(t.update(),n instanceof yi){const t=n.getColliders();r=r.concat(t)}else r.push(n)}this._processor.update(r);const a=this._processor.broadphase(r,e);this._currentFrameContacts.clear();let l=this._processor.narrowphase(a,null===(o=null===(s=null===(n=this._engine)||void 0===n?void 0:n.debug)||void 0===s?void 0:s.stats)||void 0===o?void 0:o.currFrame);l=this.getSolver().solve(l);for(const t of l){const e=t.id.indexOf("|");if(e>0){const i=t.id.substring(e+1);this._currentFrameContacts.set(i,t)}else this._currentFrameContacts.set(t.id,t)}this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts)}getSolver(){return ii.collisionResolutionStrategy===Qe.Realistic?this._realisticSolver:this._arcadeSolver}debug(t){this._processor.debug(t)}runContactStartEnd(){for(const[t,e]of this._currentFrameContacts)if(!this._lastFrameContacts.has(t)){const t=e.colliderA,i=e.colliderB;t.events.emit("collisionstart",new U(t,i,e)),t.events.emit("contactstart",new N(t,i,e)),i.events.emit("collisionstart",new U(i,t,e)),i.events.emit("contactstart",new N(i,t,e))}for(const[t,e]of this._lastFrameContacts)if(!this._currentFrameContacts.has(t)){const t=e.colliderA,i=e.colliderB;t.events.emit("collisionend",new j(t,i)),t.events.emit("contactend",new z(t,i)),i.events.emit("collisionend",new j(i,t)),i.events.emit("contactend",new z(i,t))}}}var hs,cs;!function(t){t.Forward="forward",t.Backward="backward"}(hs||(hs={})),function(t){t.End="end",t.Loop="loop",t.PingPong="pingpong",t.Freeze="freeze"}(cs||(cs={}));const ds={Frame:"frame",Loop:"loop",Ended:"ended"};class us extends zt{constructor(t){var e,i;super(t),this.events=new m,this.frames=[],this.strategy=cs.Loop,this.frameDuration=100,this.timeScale=1,this._idempotencyToken=-1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=0,this._pingPongDirection=1,this._done=!1,this._playing=!0,this._reversed=!1,this.frames=t.frames,this.strategy=null!==(e=t.strategy)&&void 0!==e?e:this.strategy,this.frameDuration=t.totalDuration?t.totalDuration/this.frames.length:null!==(i=t.frameDuration)&&void 0!==i?i:this.frameDuration,t.reverse&&this.reverse(),this.goToFrame(0)}clone(){return new us({frames:this.frames.map((t=>({...t}))),frameDuration:this.frameDuration,reverse:this._reversed,strategy:this.strategy,...this.cloneGraphicOptions()})}get width(){const t=this.currentFrame;return t?Math.abs(t.graphic.width*this.scale.x):0}get height(){const t=this.currentFrame;return t?Math.abs(t.graphic.height*this.scale.y):0}static fromSpriteSheet(t,e,i,n=cs.Loop){const s=t.sprites.length-1,o=e.filter((t=>t<0||t>s));return o.length&&us._LOGGER.warn(`Indices into SpriteSheet were provided that don't exist: ${o.join(",")} no frame will be shown`),new us({frames:t.sprites.filter(((t,i)=>e.indexOf(i)>-1)).map((t=>({graphic:t,duration:i}))),strategy:n})}static fromSpriteSheetCoordinates(t){const{spriteSheet:e,frameCoordinates:i,durationPerFrameMs:n,strategy:s,reverse:o}=t,r=null!=n?n:100,a=[];for(const t of i){const{x:i,y:n,duration:s}=t,o=e.getSprite(i,n);o?a.push({graphic:o,duration:null!=s?s:r}):us._LOGGER.warn(`Skipping frame! SpriteSheet does not have coordinate (${i}, ${n}), please check your SpriteSheet to confirm that sprite exists`)}return new us({frames:a,strategy:s,reverse:o})}get currentFrame(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}get currentFrameIndex(){return this._currentFrame}get isPlaying(){return this._playing}reverse(){this.frames=this.frames.slice().reverse(),this._reversed=!this._reversed}get direction(){return this._reversed&&1===this._pingPongDirection?hs.Backward:hs.Forward}play(){this._playing=!0}pause(){this._playing=!1,this._firstTick=!0}reset(){this._done=!1,this._firstTick=!0,this._currentFrame=0}get canFinish(){switch(this.strategy){case cs.End:case cs.Freeze:return!0;default:return!1}}get done(){return this._done}goToFrame(t){this._currentFrame=t,this._timeLeftInFrame=this.frameDuration;const e=this.frames[this._currentFrame];e&&!this._done&&(this._timeLeftInFrame=(null==e?void 0:e.duration)||this.frameDuration,this.events.emit("frame",{...e,frameIndex:this.currentFrameIndex}))}_nextFrame(){const t=this._currentFrame;if(this._done)return t;let e=-1;switch(this.strategy){case cs.Loop:e=(t+1)%this.frames.length,0===e&&this.events.emit("loop",this);break;case cs.End:e=t+1,e>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break;case cs.Freeze:e=dt(t+1,0,this.frames.length-1),e>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break;case cs.PingPong:t+this._pingPongDirection>=this.frames.length&&(this._pingPongDirection=-1,this.events.emit("loop",this)),t+this._pingPongDirection<0&&(this._pingPongDirection=1,this.events.emit("loop",this)),e=t+this._pingPongDirection%this.frames.length}return e}tick(t,e=0){this._idempotencyToken!==e&&(this._idempotencyToken=e,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",{...this.currentFrame,frameIndex:this.currentFrameIndex})),this._timeLeftInFrame-=t*this.timeScale,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame())))}_drawImage(t,e,i){this.currentFrame&&this.currentFrame.graphic.draw(t,e,i)}}us._LOGGER=tt.getInstance();class ps extends zt{constructor(t){super(t),this.members=[],this.members=t.members,this._updateDimensions()}clone(){return new ps({members:[...this.members],...this.cloneGraphicOptions()})}_updateDimensions(){let t=new At;for(const{graphic:e,pos:i}of this.members)t=e.localBounds.translate(i).combine(t);return this.width=t.width,this.height=t.height,t}get localBounds(){let t=new At;for(const{graphic:e,pos:i}of this.members)t=e.localBounds.translate(i).combine(t);return t}_isAnimationOrGroup(t){return t instanceof us||t instanceof ps}tick(t,e){for(const i of this.members){const n=i.graphic;this._isAnimationOrGroup(n)&&n.tick(t,e)}}reset(){for(const t of this.members){const e=t.graphic;this._isAnimationOrGroup(e)&&e.reset()}}_preDraw(t,e,i){this._updateDimensions(),super._preDraw(t,e,i)}_drawImage(t,e,i){for(const n of this.members)t.save(),t.translate(e,i),n.graphic.draw(t,n.pos.x,n.pos.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}function gs(t){return class extends t{assign(t){for(const e in t)"function"!=typeof this[e]&&(this[e]=t[e])}constructor(...t){super(...t),1!==t.filter((function(t){return void 0!==t})).length||!t[0]||"object"!=typeof t[0]||t[0]instanceof Array||this.assign(t[0])}}}var fs,ms;!function(t){t[t.Circle=0]="Circle",t[t.Rectangle=1]="Rectangle"}(fs||(fs={}));class vs extends Oi{constructor(t,e,i,n,s,o,r,a,l,h){super(),this.position=new _t(0,0),this.velocity=new _t(0,0),this.acceleration=new _t(0,0),this.particleRotationalVelocity=0,this.currentRotation=0,this.focus=null,this.focusAccel=0,this.opacity=1,this.beginColor=wt.White,this.endColor=wt.White,this.life=300,this.fadeFlag=!1,this._rRate=1,this._gRate=1,this._bRate=1,this._aRate=0,this._currentColor=wt.White,this.emitter=null,this.particleSize=5,this.particleSprite=null,this.sizeRate=0,this.elapsedMultiplier=0,this.visible=!0,this.isOffscreen=!1;let c=t;if(c&&!(t instanceof ys)){const d=t;c=d.emitter,e=d.life,i=d.opacity,s=d.endColor,n=d.beginColor,o=d.position,r=d.velocity,a=d.acceleration,l=d.startSize,h=d.endSize}if(this.emitter=c,this.life=e||this.life,this.opacity=i||this.opacity,this.endColor=s||this.endColor.clone(),this.beginColor=n||this.beginColor.clone(),this._currentColor=this.beginColor.clone(),this.emitter.particleTransform===ms.Global){const t=this.emitter.transform.globalPos;this.position=(o||this.position).add(t),this.velocity=(r||this.velocity).rotate(this.emitter.transform.globalRotation)}else this.velocity=r||this.velocity,this.position=o||this.position;this.acceleration=a||this.acceleration,this._rRate=(this.endColor.r-this.beginColor.r)/this.life,this._gRate=(this.endColor.g-this.beginColor.g)/this.life,this._bRate=(this.endColor.b-this.beginColor.b)/this.life,this._aRate=this.opacity/this.life,this.startSize=l||0,this.endSize=h||0,this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize),this.addComponent(this.transform=new hi),this.addComponent(this.graphics=new Hi),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=yt(1,1),this.particleSprite?(this.graphics.opacity=this.opacity,this.graphics.use(this.particleSprite)):(this.graphics.localBounds=At.fromDimension(this.particleSize,this.particleSize,_t.Half),this.graphics.onPostDraw=t=>{t.save(),this.graphics.opacity=this.opacity;const e=this._currentColor.clone();e.a=1,t.debug.drawPoint(yt(0,0),{color:e,size:this.particleSize}),t.restore()})}kill(){this.emitter.removeParticle(this)}update(t,e){if(this.life=this.life-e,this.elapsedMultiplier=this.elapsedMultiplier+e,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=dt(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=dt(this.sizeRate*e+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=dt(this._currentColor.r+this._rRate*e,0,255),this._currentColor.g=dt(this._currentColor.g+this._gRate*e,0,255),this._currentColor.b=dt(this._currentColor.b+this._bRate*e,0,255),this._currentColor.a=dt(this.opacity,1e-4,1),this.focus){const t=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(e/1e3);this.velocity=this.velocity.add(t)}else this.velocity=this.velocity.add(this.acceleration.scale(e/1e3));this.position=this.position.add(this.velocity.scale(e/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*e/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=yt(1,1),this.graphics.opacity=this.opacity}}class _s extends(gs(vs)){constructor(t,e,i,n,s,o,r,a,l,h){super(t,e,i,n,s,o,r,a,l,h)}}!function(t){t.Global="global",t.Local="local"}(ms||(ms={}));class ys extends An{get opacity(){return super.graphics.opacity}set opacity(t){super.graphics.opacity=t}get particleSprite(){return this._sprite}set particleSprite(t){t&&(this._sprite=t)}constructor(t){var e,i;super({width:null!==(e=t.width)&&void 0!==e?e:0,height:null!==(i=t.height)&&void 0!==i?i:0}),this._particlesToEmit=0,this.numParticles=0,this.isEmitting=!0,this.particles=[],this.deadParticles=[],this.minVel=0,this.maxVel=0,this.acceleration=new _t(0,0),this.minAngle=0,this.maxAngle=0,this.emitRate=1,this.particleLife=2e3,this.fadeFlag=!1,this.focus=null,this.focusAccel=null,this.startSize=null,this.endSize=null,this.minSize=5,this.maxSize=5,this.beginColor=wt.White,this.endColor=wt.White,this._sprite=null,this.emitterType=fs.Rectangle,this.radius=0,this.particleRotationalVelocity=0,this.randomRotation=!1,this.particleTransform=ms.Global;const{x:n,y:s,pos:o,isEmitting:r,minVel:a,maxVel:l,acceleration:h,minAngle:c,maxAngle:d,emitRate:u,particleLife:p,opacity:g,fadeFlag:f,focus:m,focusAccel:v,startSize:_,endSize:y,minSize:w,maxSize:x,beginColor:b,endColor:C,particleSprite:A,emitterType:S,radius:E,particleRotationalVelocity:T,particleTransform:k,randomRotation:M,random:$}={...t};this.pos=null!=o?o:yt(null!=n?n:0,null!=s?s:0),this.isEmitting=null!=r?r:this.isEmitting,this.minVel=null!=a?a:this.minVel,this.maxVel=null!=l?l:this.maxVel,this.acceleration=null!=h?h:this.acceleration,this.minAngle=null!=c?c:this.minAngle,this.maxAngle=null!=d?d:this.maxAngle,this.emitRate=null!=u?u:this.emitRate,this.particleLife=null!=p?p:this.particleLife,this.opacity=null!=g?g:this.opacity,this.fadeFlag=null!=f?f:this.fadeFlag,this.focus=null!=m?m:this.focus,this.focusAccel=null!=v?v:this.focusAccel,this.startSize=null!=_?_:this.startSize,this.endSize=null!=y?y:this.endSize,this.minSize=null!=w?w:this.minSize,this.maxSize=null!=x?x:this.maxSize,this.beginColor=null!=b?b:this.beginColor,this.endColor=null!=C?C:this.endColor,this.particleSprite=null!=A?A:this.particleSprite,this.emitterType=null!=S?S:this.emitterType,this.radius=null!=E?E:this.radius,this.particleRotationalVelocity=null!=T?T:this.particleRotationalVelocity,this.randomRotation=null!=M?M:this.randomRotation,this.particleTransform=null!=k?k:this.particleTransform,this.body.collisionType=Ge.PreventCollision,this.random=null!=$?$:new at}removeParticle(t){this.deadParticles.push(t)}emitParticles(t){var e;for(let i=0;i<t;i++){const t=this._createParticle();this.particles.push(t),(null===(e=null==this?void 0:this.scene)||void 0===e?void 0:e.world)&&(this.particleTransform===ms.Global?this.scene.world.add(t):this.addChild(t))}}clearParticles(){this.particles.length=0}_createParticle(){let t=0,e=0;const i=mt(this.minAngle,this.maxAngle,this.random),n=mt(this.minVel,this.maxVel,this.random),s=this.startSize||mt(this.minSize,this.maxSize,this.random),o=n*Math.cos(i),r=n*Math.sin(i);if(this.emitterType===fs.Rectangle)t=mt(0,this.width,this.random),e=mt(0,this.height,this.random);else if(this.emitterType===fs.Circle){const n=mt(0,this.radius,this.random);t=n*Math.cos(i),e=n*Math.sin(i)}const a=new _s(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new _t(t,e),new _t(o,r),this.acceleration,this.startSize,this.endSize);return a.fadeFlag=this.fadeFlag,a.particleSize=s,this.particleSprite&&(a.particleSprite=this.particleSprite,a.graphics.opacity=this.opacity,a.graphics.use(this._sprite)),a.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(a.currentRotation=mt(0,2*Math.PI,this.random)),this.focus&&(a.focus=this.focus.add(new _t(this.pos.x,this.pos.y)),a.focusAccel=this.focusAccel),a}update(t,e){var i;super.update(t,e),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(e/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(let t=0;t<this.deadParticles.length;t++)kt(this.deadParticles[t],this.particles),(null===(i=null==this?void 0:this.scene)||void 0===i?void 0:i.world)&&this.scene.world.remove(this.deadParticles[t],!1);this.deadParticles.length=0}}class ws extends Gn{constructor(){super(...arguments),this.types=["ex.transform","ex.graphics"],this.systemType=Vn.Draw,this.priority=0,this._token=0,this._sortedTransforms=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0}}get sortedTransforms(){return this._sortedTransforms}initialize(t){this._camera=t.camera,this._engine=t.engine}preupdate(){this._graphicsContext=this._engine.graphicsContext,this._zHasChanged&&(this._sortedTransforms.sort(((t,e)=>t.z-e.z)),this._zHasChanged=!1)}notify(t){if(Yn(t)){const e=t.data.get(hi);this._sortedTransforms.push(e),e.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}else{const e=t.data.get(hi);e.zIndexChanged$.unsubscribe(this._zIndexUpdate);const i=this._sortedTransforms.indexOf(e);i>-1&&this._sortedTransforms.splice(i,1)}}update(t,e){let i;this._token++,xn.checkAndClearCache(),this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext);for(const t of this._sortedTransforms){const n=t.owner;if(n.hasTag("ex.offscreen"))continue;if(i=n.get(Hi),!i.visible)continue;t.coordPlane===ei.Screen&&this._graphicsContext.restore(),this._graphicsContext.save(),t.coordPlane===ei.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),i.update(e,this._token);const s=n.get(kn);if(s){const t=_t.One.sub(s.parallaxFactor),e=this._camera.pos.scale(t);this._graphicsContext.translate(e.x,e.y)}this._applyTransform(n),i.material&&(this._graphicsContext.material=i.material),i.onPreDraw&&i.onPreDraw(this._graphicsContext,e);const o=n instanceof _s?n.opacity:1;this._graphicsContext.opacity*=i.opacity*o,this._drawGraphicsComponent(i),i.onPostDraw&&i.onPostDraw(this._graphicsContext,e),this._graphicsContext.restore(),t.coordPlane===ei.Screen&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}this._graphicsContext.restore()}_drawGraphicsComponent(t){var e,i;if(t.visible){const n=t.flipHorizontal,s=t.flipVertical;for(const o of t.layers.get())for(const{graphic:r,options:a}of o.graphics){let l=t.anchor,h=t.offset;(null==a?void 0:a.anchor)&&(l=a.anchor),(null==a?void 0:a.offset)&&(h=a.offset);const c=-r.width*l.x+h.x,d=-r.height*l.y+h.y,u=r.flipHorizontal,p=r.flipVertical;if((n||s)&&(r.flipHorizontal=n?!u:u,r.flipVertical=s?!p:p),null==r||r.draw(this._graphicsContext,c+o.offset.x,d+o.offset.y),(n||s)&&(r.flipHorizontal=u,r.flipVertical=p),(null===(e=this._engine)||void 0===e?void 0:e.isDebug)&&this._engine.debug.graphics.showBounds){const t=yt(c+o.offset.x,d+o.offset.y);if(r instanceof ps)for(const e of r.members)null===(i=e.graphic)||void 0===i||i.localBounds.translate(t.add(e.pos)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor);else null==r||r.localBounds.translate(t).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}}_applyTransform(t){const e=t.getAncestors();for(const t of e){const e=null==t?void 0:t.get(hi),i=null==t?void 0:t.get(Ri);let n=e.pos,s=e.scale,o=e.rotation;if(i&&this._engine.fixedUpdateFps&&i.__oldTransformCaptured&&i.enableFixedUpdateInterpolate){const t=this._engine.currentFrameLagMs/(1e3/this._engine.fixedUpdateFps);n=e.pos.scale(t).add(i.oldPos.scale(1-t)),s=e.scale.scale(t).add(i.oldScale.scale(1-t));const r=(1-t)*Math.cos(i.oldRotation)+t*Math.cos(e.rotation),a=(1-t)*Math.sin(i.oldRotation)+t*Math.sin(e.rotation);o=Math.atan2(a,r)}e&&(this._graphicsContext.z=e.z,this._graphicsContext.translate(n.x,n.y),this._graphicsContext.scale(s.x,s.y),this._graphicsContext.rotate(o))}}}class xs extends Gn{constructor(){super(...arguments),this.types=["ex.transform"],this.systemType=Vn.Draw,this.priority=999}initialize(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine,this._collisionSystem=t.world.systemManager.get(ls)}update(t,e){var i;if(!this._engine.isDebug)return;const n=this._engine.debug.filter;let s,o;const r=this._engine.debug.entity;let a;const l=this._engine.debug.transform;let h;const c=this._engine.debug.motion;let d;const u=this._engine.debug.collider,p=this._engine.debug.physics;let g;const f=this._engine.debug.graphics;let m,v;const _=this._engine.debug.body,y=this._engine.debug.camera;for(const e of t){if(e.hasTag("offscreen"))continue;if(e instanceof _s)continue;if(n.useFilter){if(0!==n.ids.length&&!n.ids.includes(e.id))continue;if(""!==n.nameQuery&&!e.name.includes(n.nameQuery))continue}let t=_t.Zero;const p=yt(0,16);if(s=e.id,o=e.name,a=e.get(hi),this._pushCameraTransform(a),this._graphicsContext.save(),this._applyTransform(e),a&&((l.showAll||l.showPosition)&&this._graphicsContext.debug.drawPoint(_t.Zero,{size:4,color:l.positionColor}),(l.showAll||l.showPositionLabel)&&(this._graphicsContext.debug.drawText(`pos${a.pos.toString(2)}`,t),t=t.add(p)),(l.showAll||l.showZIndex)&&(this._graphicsContext.debug.drawText(`z(${a.z.toFixed(1)})`,t),t=t.add(p)),(r.showAll||r.showId)&&(this._graphicsContext.debug.drawText(`id(${s}) ${e.parent?"child of id("+(null===(i=e.parent)||void 0===i?void 0:i.id)+")":""}`,t),t=t.add(p)),(r.showAll||r.showName)&&(this._graphicsContext.debug.drawText(`name(${o})`,t),t=t.add(p)),(l.showAll||l.showRotation)&&(this._graphicsContext.drawLine(_t.Zero,_t.fromAngle(a.rotation).scale(50).add(_t.Zero),l.rotationColor,2),this._graphicsContext.debug.drawText(`rot deg(${pt(a.rotation).toFixed(2)})`,t),t=t.add(p)),(l.showAll||l.showScale)&&this._graphicsContext.drawLine(_t.Zero,a.scale.add(_t.Zero),l.scaleColor,2)),g=e.get(Hi),g&&(f.showAll||f.showBounds)&&g.localBounds.draw(this._graphicsContext,f.boundsColor),m=e.get(Mn),m&&(m.useTransform||this._graphicsContext.restore(),m.draw(this._graphicsContext),m.useTransform||(this._graphicsContext.save(),this._applyTransform(e))),v=e.get(Ri),v&&((_.showAll||_.showCollisionGroup)&&(this._graphicsContext.debug.drawText(`collision group(${v.group.name})`,t),t=t.add(p)),(_.showAll||_.showCollisionType)&&(this._graphicsContext.debug.drawText(`collision type(${v.collisionType})`,t),t=t.add(p)),(_.showAll||_.showMass)&&(this._graphicsContext.debug.drawText(`mass(${v.mass})`,t),t=t.add(p)),(_.showAll||_.showMotion)&&(this._graphicsContext.debug.drawText(`motion(${v.sleepMotion})`,t),t=t.add(p)),(_.showAll||_.showSleeping)&&(this._graphicsContext.debug.drawText(`sleeping(${v.canSleep?v.sleeping:"cant sleep"})`,t),t=t.add(p))),this._graphicsContext.restore(),h=e.get(ci),h&&((c.showAll||c.showVelocity)&&(this._graphicsContext.debug.drawText(`vel${h.vel.toString(2)}`,t.add(a.globalPos)),this._graphicsContext.drawLine(a.globalPos,a.globalPos.add(h.vel),c.velocityColor,2),t=t.add(p)),(c.showAll||c.showAcceleration)&&this._graphicsContext.drawLine(a.globalPos,a.globalPos.add(h.acc),c.accelerationColor,2)),d=e.get($i),d){const t=d.get();if((u.showAll||u.showGeometry)&&t&&t.debug(this._graphicsContext,u.geometryColor),u.showAll||u.showBounds)if(t instanceof yi){const e=t.getColliders();for(const t of e){const e=t.bounds,i=yt(e.left,e.top);this._graphicsContext.debug.drawRect(i.x,i.y,e.width,e.height,{color:u.boundsColor}),(u.showAll||u.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${t.owner.id})`,i)}d.bounds.draw(this._graphicsContext,u.boundsColor)}else if(t){const t=d.bounds,e=yt(t.left,t.top);this._graphicsContext.debug.drawRect(e.x,e.y,t.width,t.height,{color:u.boundsColor}),(u.showAll||u.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${d.owner.id})`,e)}}this._popCameraTransform(a)}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(p.showAll||p.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),p.showAll||p.showCollisionContacts||p.showCollisionNormals)for(const[t,e]of this._engine.debug.stats.currFrame.physics.contacts){if(p.showAll||p.showCollisionContacts)for(const t of e.points)this._graphicsContext.debug.drawPoint(t,{size:5,color:p.collisionContactColor});if(p.showAll||p.showCollisionNormals)for(const t of e.points)this._graphicsContext.debug.drawLine(t,e.normal.scale(30).add(t),{color:p.collisionNormalColor})}this._graphicsContext.restore(),y&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(y.showAll||y.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,y.focusColor),(y.showAll||y.showZoom)&&this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`,this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}_applyTransform(t){const e=t.getAncestors();for(const t of e){const e=null==t?void 0:t.get(hi);e&&(this._graphicsContext.translate(e.pos.x,e.pos.y),this._graphicsContext.scale(e.scale.x,e.scale.y),this._graphicsContext.rotate(e.rotation))}}_pushCameraTransform(t){t.coordPlane===ei.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}_popCameraTransform(t){t.coordPlane===ei.World&&this._graphicsContext.restore()}}class bs extends Gn{constructor(){super(...arguments),this.types=["ex.transform","ex.pointer"],this.systemType=Vn.Update,this.priority=-1,this.overrideUseColliderShape=!1,this.overrideUseGraphicsBounds=!1,this.lastFrameEntityToPointers=new Map,this.currentFrameEntityToPointers=new Map,this._sortedTransforms=[],this._sortedEntities=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0}}initialize(t){this._engine=t.engine}preupdate(){this._receiver=this._engine.input.pointers,this._zHasChanged&&(this._sortedTransforms.sort(((t,e)=>e.z-t.z)),this._sortedEntities=this._sortedTransforms.map((t=>t.owner)),this._zHasChanged=!1)}notify(t){if(Yn(t)){const e=t.data.get(hi);this._sortedTransforms.push(e),this._sortedEntities.push(e.owner),e.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}else{const e=t.data.get(hi);e.zIndexChanged$.unsubscribe(this._zIndexUpdate);const i=this._sortedTransforms.indexOf(e);i>-1&&(this._sortedTransforms.splice(i,1),this._sortedEntities.splice(i,1))}}entityCurrentlyUnderPointer(t,e){return this.currentFrameEntityToPointers.has(t.id)&&this.currentFrameEntityToPointers.get(t.id).includes(e)}entityWasUnderPointer(t,e){return this.lastFrameEntityToPointers.has(t.id)&&this.lastFrameEntityToPointers.get(t.id).includes(e)}entered(t,e){return this.entityCurrentlyUnderPointer(t,e)&&!this.lastFrameEntityToPointers.has(t.id)}left(t,e){return!this.currentFrameEntityToPointers.has(t.id)&&this.entityWasUnderPointer(t,e)}addPointerToEntity(t,e){if(!this.currentFrameEntityToPointers.has(t.id))return void this.currentFrameEntityToPointers.set(t.id,[e]);const i=this.currentFrameEntityToPointers.get(t.id);this.currentFrameEntityToPointers.set(t.id,i.concat(e))}update(t){this._processPointerToEntity(this._sortedEntities),this._dispatchEvents(this._sortedEntities),this._receiver.update(),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear(),this._receiver.clear()}_processPointerToEntity(t){var e;let i,n,s,o;for(const r of t){if(i=r.get(hi),o=null!==(e=r.get(Vi))&&void 0!==e?e:new Vi,n=r.get($i),n&&(o.useColliderShape||this.overrideUseColliderShape)){n.update();const t=n.get();if(t)for(const[e,n]of this._receiver.currentFramePointerCoords.entries())t.contains(i.coordPlane===ei.World?n.worldPos:n.screenPos)&&this.addPointerToEntity(r,e)}if(s=r.get(Hi),s&&(o.useGraphicsBounds||this.overrideUseGraphicsBounds)){const t=s.localBounds.transform(i.get().matrix);for(const[e,n]of this._receiver.currentFramePointerCoords.entries())t.contains(i.coordPlane===ei.World?n.worldPos:n.screenPos)&&this.addPointerToEntity(r,e)}}}_processDownAndEmit(t){const e=new Map;for(const i of this._receiver.currentFrameDown)i.active&&t.active&&this.entityCurrentlyUnderPointer(t,i.pointerId)&&(t.events.emit("pointerdown",i),this._receiver.isDragStart(i.pointerId)&&t.events.emit("pointerdragstart",i)),e.set(i.pointerId,i);return e}_processUpAndEmit(t){const e=new Map;for(const i of this._receiver.currentFrameUp)i.active&&t.active&&this.entityCurrentlyUnderPointer(t,i.pointerId)&&(t.events.emit("pointerup",i),this._receiver.isDragEnd(i.pointerId)&&t.events.emit("pointerdragend",i)),e.set(i.pointerId,i);return e}_processMoveAndEmit(t){const e=new Map;for(const i of this._receiver.currentFrameMove)i.active&&t.active&&this.entityCurrentlyUnderPointer(t,i.pointerId)&&(t.events.emit("pointermove",i),this._receiver.isDragging(i.pointerId)&&t.events.emit("pointerdragmove",i)),e.set(i.pointerId,i);return e}_processEnterLeaveAndEmit(t,e){for(const i of e){if(i.active&&t.active&&this.entered(t,i.pointerId)){t.events.emit("pointerenter",i),this._receiver.isDragging(i.pointerId)&&t.events.emit("pointerdragenter",i);break}if(i.active&&t.active&&(this.left(t,i.pointerId)||this.entityCurrentlyUnderPointer(t,i.pointerId)&&"up"===i.type)){t.events.emit("pointerleave",i),this._receiver.isDragging(i.pointerId)&&t.events.emit("pointerdragleave",i);break}}}_processCancelAndEmit(t){for(const e of this._receiver.currentFrameCancel)e.active&&t.active&&this.entityCurrentlyUnderPointer(t,e.pointerId)&&t.events.emit("pointercancel",e)}_processWheelAndEmit(t){for(const e of this._receiver.currentFrameWheel)e.active&&t.active&&this.entityCurrentlyUnderPointer(t,0)&&t.events.emit("pointerwheel",e)}_dispatchEvents(t){const e=new Set(this.lastFrameEntityToPointers.keys()),i=new Set(this.currentFrameEntityToPointers.keys()),n=t.filter((t=>e.has(t.id)||i.has(t.id)));let s,o,r;for(const t of n){r=this._processDownAndEmit(t),o=this._processUpAndEmit(t),s=this._processMoveAndEmit(t);const e=[...s.values(),...r.values(),...o.values()];this._processEnterLeaveAndEmit(t,e),this._processCancelAndEmit(t),this._processWheelAndEmit(t)}}}class Cs extends Gn{constructor(){super(...arguments),this.types=["ex.actions"],this.systemType=Vn.Update,this.priority=-1,this._actions=[]}notify(t){if(Yn(t)){const e=t.data.get(yn);this._actions.push(e)}else{const e=t.data.get(yn),i=this._actions.indexOf(e);i>-1&&this._actions.splice(i,1)}}update(t,e){for(const t of this._actions)t.update(e)}}class As extends ri{constructor(t){super(),this.type="ex.isometricentity",this.elevation=0,this.map=t}}class Ss extends Gn{constructor(){super(...arguments),this.types=["ex.transform","ex.isometricentity"],this.systemType=Vn.Update,this.priority=99}update(t,e){let i,n;for(const e of t){i=e.get(hi),n=e.get(As);const t=Math.max(n.map.columns*n.map.tileWidth,n.map.rows*n.map.tileHeight)*n.elevation+i.pos.y;i.z=t}}}class Es extends Gn{constructor(){super(...arguments),this.types=["ex.transform","ex.graphics"],this.systemType=Vn.Draw,this.priority=-1}initialize(t){this._camera=t.camera,this._screen=t.engine.screen}update(t){let e,i,n;this._worldBounds=this._screen.getWorldBounds();for(const s of t){let t;if(i=s.get(Hi),e=s.get(hi),n=s.get(kn),n){const e=_t.One.sub(n.parallaxFactor);t=this._camera.pos.scale(e)}const o=this._isOffscreen(e,i,t);o&&!s.hasTag("ex.offscreen")&&(s.events.emit("exitviewport",new Y(s)),s.addTag("ex.offscreen")),!o&&s.hasTag("ex.offscreen")&&(s.events.emit("enterviewport",new q(s)),s.removeTag("ex.offscreen"))}}_isOffscreen(t,e,i){if(t.coordPlane===ei.World){let n=e.localBounds;i&&(n=n.translate(i));const s=n.transform(t.get().matrix);return!this._worldBounds.overlaps(s)}return!1}}class Ts{constructor(){this.collisionProcessor=new vi}rayCast(t,e){return this.collisionProcessor.rayCast(t,e)}}const ks={Initialize:"initialize",Activate:"activate",Deactivate:"deactivate",PreUpdate:"preupdate",PostUpdate:"postupdate",PreDraw:"predraw",PostDraw:"postdraw",PreDebugDraw:"predebugdraw",PostDebugDraw:"postdebugdraw"};class Ms{get actors(){return this.world.entityManager.entities.filter((t=>t instanceof An))}get entities(){return this.world.entityManager.entities}get triggers(){return this.world.entityManager.entities.filter((t=>t instanceof jn))}get tileMaps(){return this.world.entityManager.entities.filter((t=>t instanceof Ln))}get timers(){return this._timers}constructor(){this._logger=tt.getInstance(),this.events=new m,this.camera=new Wn,this.world=new is(this),this.physics=new Ts,this._isInitialized=!1,this._timers=[],this._cancelQueue=[],this.world.add(new Cs),this.world.add(new ss),this.world.add(new ls(this.physics)),this.world.add(new bs),this.world.add(new Ss),this.world.add(new Es),this.world.add(new ws),this.world.add(new xs)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}onInitialize(t){}onActivate(t){}onDeactivate(t){}onPreUpdate(t,e){}onPostUpdate(t,e){}onPreDraw(t,e){}onPostDraw(t,e){}_initializeChildren(){for(const t of this.entities)t._initialize(this.engine)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.engine=t,this.camera._initialize(t),this.world.systemManager.initialize(),this.onInitialize.call(this,t),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,t),this.events.emit("initialize",new V(t,this)),this._isInitialized=!0)}_activate(t){this._logger.debug("Scene.onActivate",this),this.onActivate(t)}_deactivate(t){this._logger.debug("Scene.onDeactivate",this),this.onDeactivate(t)}_preupdate(t,e){this.emit("preupdate",new T(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.emit("postupdate",new k(t,e,this)),this.onPostUpdate(t,e)}_predraw(t,e){this.emit("predraw",new C(t,e,this)),this.onPreDraw(t,e)}_postdraw(t,e){this.emit("postdraw",new A(t,e,this)),this.onPostDraw(t,e)}update(t,e){let i,n;for(this._preupdate(t,e),i=0,n=this._cancelQueue.length;i<n;i++)this.removeTimer(this._cancelQueue[i]);this._cancelQueue.length=0;for(const t of this._timers)t.update(e);this.world.update(Vn.Update,e),this.camera&&this.camera.update(t,e),this._collectActorStats(t),this._postupdate(t,e)}draw(t,e){var i;this._predraw(t,e),this.world.update(Vn.Draw,e),(null===(i=this.engine)||void 0===i?void 0:i.isDebug)&&this.debugDraw(t),this._postdraw(t,e)}debugDraw(t){this.emit("predebugdraw",new S(t,this)),this.emit("postdebugdraw",new E(t,this))}contains(t){return this.actors.indexOf(t)>-1}add(t){this.emit("entityadded",{target:t}),this.world.add(t),t.scene=this,t instanceof Tn&&(Mt(this._timers,t)||this.addTimer(t))}transfer(t){let e;t instanceof Oi&&t.scene&&t.scene!==this&&(e=t.scene,t.scene.world.remove(t,!1)),t instanceof Tn&&t.scene&&(e=t.scene,t.scene.removeTimer(t)),null==e||e.emit("entityremoved",{target:t}),this.add(t)}remove(t){t instanceof Oi&&(this.emit("entityremoved",{target:t}),t.active&&t.kill(),this.world.remove(t)),t instanceof Tn&&this.removeTimer(t)}clear(t=!0){for(const e of this.entities)this.world.remove(e,t);for(const t of this.timers)this.removeTimer(t)}addTimer(t){return this._timers.push(t),t.scene=this,t}removeTimer(t){const e=this._timers.indexOf(t);return-1!==e&&this._timers.splice(e,1),t}cancelTimer(t){return this._cancelQueue.push(t),t}isTimerActive(t){return this._timers.indexOf(t)>-1&&!t.complete}isCurrentScene(){return!!this.engine&&this.engine.currentScene===this}_collectActorStats(t){const e=this.actors.filter((t=>t instanceof En));for(const i of e)t.stats.currFrame.actors.ui++;for(const e of this.actors){t.stats.currFrame.actors.alive++;for(const i of e.children)Sn(i)?t.stats.currFrame.actors.ui++:t.stats.currFrame.actors.alive++}}}var $s,Ls,Rs,Is,Ds;!function(t){t.Protanope="Protanope",t.Deuteranope="Deuteranope",t.Tritanope="Tritanope"}($s||($s={}));class Ps{constructor(t,e){this._shader=new Jt({gl:t,vertexSource:"#version 300 es\n      in vec2 a_position;\n      in vec2 a_texcoord;\n      out vec2 v_texcoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0.0, 1.0);\n        // Pass the texcoord to the fragment shader.\n        v_texcoord = a_texcoord;\n      }",fragmentSource:e}),this._shader.compile(),this._buffer=new te({gl:t,type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new ee({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}getShader(){return this._shader}getLayout(){return this._layout}}class Bs{constructor(t,e=!1){this._colorBlindnessMode=t,this._simulate=!1,this._simulate=e}initialize(t){this._shader=new Ps(t,"#version 300 es\r\nprecision mediump float;\r\n// our texture\r\nuniform sampler2D u_image;\r\n// the texCoords passed in from the vertex shader.\r\nin vec2 v_texcoord;\r\n\r\n// color blind type\r\nuniform int u_type;\r\n\r\n// simulation?\r\nuniform bool u_simulate;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  vec4 o =  texture(u_image, v_texcoord);\r\n  // RGB to LMS matrix conversion\r\n  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\r\n  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\r\n  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\r\n  // Simulate color blindness\r\n  float l;\r\n  float m;\r\n  float s;\r\n  //MODE CODE//\r\n  if (u_type == 0) {\r\n    // Protanope\r\n    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\r\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\r\n    s = 0.0 * L + 0.0 * M + 1.0 * S;;\r\n  } else if (u_type == 1) {\r\n    // Deuteranope\r\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\r\n    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\r\n    s = 0.0 * L + 0.0 * M + 1.0 * S;\r\n  } else if (u_type == 2) {\r\n    // Tritanope\r\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\r\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\r\n    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\r\n  }\r\n\r\n  // LMS to RGB matrix conversion\r\n  vec4 error; // simulate the colors\r\n  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\r\n  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\r\n  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\r\n  error.a = 1.0;\r\n  vec4 diff = o - error;\r\n  vec4 correction; // correct the colors\r\n  correction.r = 0.0;\r\n  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\r\n  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\r\n  correction = o + correction;\r\n  correction.a = o.a;\r\n  //SIMULATE//\r\n\r\n  // sim \r\n  if (u_simulate) {\r\n    fragColor = error.rgba;\r\n  } else {\r\n    fragColor = correction.rgba;\r\n  }\r\n}"),this.simulate=this._simulate,this.colorBlindnessMode=this._colorBlindnessMode}getShader(){return this._shader.getShader()}getLayout(){return this._shader.getLayout()}set colorBlindnessMode(t){if(this._colorBlindnessMode=t,this._shader){const t=this._shader.getShader();t.use(),this._colorBlindnessMode===$s.Protanope?t.setUniformInt("u_type",0):this._colorBlindnessMode===$s.Deuteranope?t.setUniformInt("u_type",1):this._colorBlindnessMode===$s.Tritanope&&t.setUniformInt("u_type",2)}}get colorBlindnessMode(){return this._colorBlindnessMode}set simulate(t){if(this._simulate=t,this._shader){const e=this._shader.getShader();e.use(),e.setUniformBoolean("u_simulate",t)}}get simulate(){return this._simulate}}class Fs{constructor(t){this._engine=t,this._colorBlindPostProcessor=new Bs($s.Protanope)}correct(t){this._engine.graphicsContext instanceof me&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!1,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}simulate(t){this._engine.graphicsContext instanceof me&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!0,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}clear(){this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor)}}class Os{constructor(t){this.stats={currFrame:new Ns,prevFrame:new Ns},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!0,showName:!1},this.transform={showAll:!1,showPosition:!1,showPositionLabel:!1,positionColor:wt.Yellow,showZIndex:!1,showScale:!1,scaleColor:wt.Green,showRotation:!1,rotationColor:wt.Blue},this.graphics={showAll:!1,showBounds:!0,boundsColor:wt.Yellow},this.collider={showAll:!1,showBounds:!0,boundsColor:wt.Blue,showOwner:!1,showGeometry:!0,geometryColor:wt.Green},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:wt.Cyan,showCollisionContacts:!0,collisionContactColor:wt.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:wt.Yellow,showAcceleration:!1,accelerationColor:wt.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:wt.Red,showZoom:!1},this._engine=t,this.colorBlindMode=new Fs(this._engine)}useTestClock(){const t=this._engine.clock,e=t.isRunning();t.stop();const i=t.toTestClock();return e&&i.start(),this._engine.clock=i,i}useStandardClock(){const t=this._engine.clock,e=t.isRunning();t.stop();const i=t.toStandardClock();return e&&i.start(),this._engine.clock=i,i}}class Ns{constructor(){this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new zs,this._graphicsStats={drawCalls:0,drawnImages:0}}reset(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}clone(){const t=new Ns;return t.reset(this),t}get id(){return this._id}set id(t){this._id=t}get delta(){return this._delta}set delta(t){this._delta=t}get fps(){return this._fps}set fps(t){this._fps=t}get actors(){return this._actorStats}get duration(){return this._durationStats}get physics(){return this._physicsStats}get graphics(){return this._graphicsStats}}class zs{constructor(){this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}reset(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.contacts=t.contacts,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}clone(){const t=new zs;return t.reset(this),t}get pairs(){return this._pairs}set pairs(t){this._pairs=t}get collisions(){return this._collisions}set collisions(t){this._collisions=t}get contacts(){return this._contacts}set contacts(t){this._contacts=t}get fastBodies(){return this._fastBodies}set fastBodies(t){this._fastBodies=t}get fastBodyCollisions(){return this._fastBodyCollisions}set fastBodyCollisions(t){this._fastBodyCollisions=t}get broadphase(){return this._broadphase}set broadphase(t){this._broadphase=t}get narrowphase(){return this._narrowphase}set narrowphase(t){this._narrowphase=t}}class Ws{on(t,e){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(e),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])}off(t,e){e||(e=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,e),this._nativeHandlers[t]=null}_decorate(t){return e=>{this._paused||t(e)}}pause(){this._paused=!0}resume(){this._paused=!1}clear(){for(const t in this._nativeHandlers)this.off(t)}constructor(t){this.nativeComponent=t,this._paused=!1,this._nativeHandlers={}}}class Hs{constructor(t,e){this._windowGlobal=t,this._documentGlobal=e,this._windowComponent=new Ws(this._windowGlobal),this._documentComponent=new Ws(this._documentGlobal)}get window(){return this._windowComponent}get document(){return this._documentComponent}pause(){this.window.pause(),this.document.pause()}resume(){this.window.resume(),this.document.resume()}clear(){this.window.clear(),this.document.clear()}}class Us{static fromPagePosition(t,e,i){let n,s,o,r;3===arguments.length?(n=t,s=e,o=new _t(n,s),r=i):(o=t,n=o.x,s=o.y,r=e);const a=r.screen.pageToScreenCoordinates(o),l=r.screen.screenToWorldCoordinates(a);return new Us(l,o,a)}constructor(t,e,i){this.worldPos=t,this.pagePos=e,this.screenPos=i}}class js{cancel(){this.active=!1}get pagePos(){return this.coordinates.pagePos}get screenPos(){return this.coordinates.screenPos}get worldPos(){return this.coordinates.worldPos}constructor(t,e,i,n,s,o){this.type=t,this.pointerId=e,this.button=i,this.pointerType=n,this.coordinates=s,this.nativeEvent=o,this.active=!0}}class Vs{cancel(){this.active=!1}constructor(t,e,i,n,s,o,r,a,l,h,c,d){this.x=t,this.y=e,this.pageX=i,this.pageY=n,this.screenX=s,this.screenY=o,this.index=r,this.deltaX=a,this.deltaY=l,this.deltaZ=h,this.deltaMode=c,this.ev=d,this.active=!0}}class Gs{constructor(){this.events=new m,this.lastPagePos=_t.Zero,this.lastScreenPos=_t.Zero,this.lastWorldPos=_t.Zero,this._onPointerMove=t=>{this.lastPagePos=new _t(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new _t(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new _t(t.worldPos.x,t.worldPos.y)},this._onPointerDown=t=>{this.lastPagePos=new _t(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new _t(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new _t(t.worldPos.x,t.worldPos.y)},this.on("move",this._onPointerMove),this.on("down",this._onPointerDown)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}}!function(t){t.Pixel="Pixel",t.Line="Line",t.Page="Page"}(Ls||(Ls={})),function(t){t[t.NoButton=-1]="NoButton",t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Unknown=3]="Unknown"}(Rs||(Rs={})),function(t){t.Left="Left",t.Middle="Middle",t.Right="Right",t.Unknown="Unknown",t.NoButton="NoButton"}(Is||(Is={})),function(t){t.Touch="Touch",t.Mouse="Mouse",t.Pen="Pen",t.Unknown="Unknown"}(Ds||(Ds={}));class Ks{constructor(t,e){this.target=t,this.engine=e,this.events=new m,this.primary=new Gs,this._activeNativePointerIdsToNormalized=new Map,this.lastFramePointerCoords=new Map,this.currentFramePointerCoords=new Map,this.currentFramePointerDown=new Map,this.lastFramePointerDown=new Map,this.currentFrameDown=[],this.currentFrameUp=[],this.currentFrameMove=[],this.currentFrameCancel=[],this.currentFrameWheel=[],this._pointers=[this.primary],this._boundHandle=this._handle.bind(this),this._boundWheel=this._handleWheel.bind(this)}recreate(t,e){const i=new Ks(t,e);return i.primary=this.primary,i._pointers=this._pointers,i}at(t){if(t>=this._pointers.length)for(let e=this._pointers.length-1,i=t;e<i;e++)this._pointers.push(new Gs);return this._pointers[t]}count(){return this._pointers.length}isDown(t){var e;return null!==(e=this.currentFramePointerDown.get(t))&&void 0!==e&&e}wasDown(t){var e;return null!==(e=this.lastFramePointerDown.get(t))&&void 0!==e&&e}isDragging(t){return this.isDown(t)}isDragStart(t){return this.isDown(t)&&!this.wasDown(t)}isDragEnd(t){return!this.isDown(t)&&this.wasDown(t)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}update(){this.lastFramePointerDown=new Map(this.currentFramePointerDown),this.lastFramePointerCoords=new Map(this.currentFramePointerCoords);for(const t of this.currentFrameDown)this.emit("down",t),this.at(t.pointerId).emit("down",t),this.primary.emit("pointerdown",t);for(const t of this.currentFrameUp)this.emit("up",t),this.at(t.pointerId).emit("up",t);for(const t of this.currentFrameMove)this.emit("move",t),this.at(t.pointerId).emit("move",t);for(const t of this.currentFrameCancel)this.emit("cancel",t),this.at(t.pointerId).emit("cancel",t);for(const t of this.currentFrameWheel)this.emit("wheel",t),this.primary.emit("pointerwheel",t)}clear(){for(const t of this.currentFrameUp){this.currentFramePointerCoords.delete(t.pointerId);const e=this._activeNativePointerIdsToNormalized.entries();for(const[i,n]of e)n===t.pointerId&&this._activeNativePointerIdsToNormalized.delete(i)}this.currentFrameDown.length=0,this.currentFrameUp.length=0,this.currentFrameMove.length=0,this.currentFrameCancel.length=0,this.currentFrameWheel.length=0}init(t){var e;this.target===this.engine.canvas?this.engine.canvas.style.touchAction="none":document.body.style.touchAction="none",window.PointerEvent?(this.target.addEventListener("pointerdown",this._boundHandle),this.target.addEventListener("pointerup",this._boundHandle),this.target.addEventListener("pointermove",this._boundHandle),this.target.addEventListener("pointercancel",this._boundHandle)):(this.target.addEventListener("touchstart",this._boundHandle),this.target.addEventListener("touchend",this._boundHandle),this.target.addEventListener("touchmove",this._boundHandle),this.target.addEventListener("touchcancel",this._boundHandle),this.target.addEventListener("mousedown",this._boundHandle),this.target.addEventListener("mouseup",this._boundHandle),this.target.addEventListener("mousemove",this._boundHandle));const i={passive:!(this.engine.pageScrollPreventionMode===io.All||this.engine.pageScrollPreventionMode===io.Canvas)};if("onwheel"in document.createElement("div")?this.target.addEventListener("wheel",this._boundWheel,i):void 0!==document.onmousewheel?this.target.addEventListener("mousewheel",this._boundWheel,i):this.target.addEventListener("MozMousePixelScroll",this._boundWheel,i),(null===(e=null==t?void 0:t.grabWindowFocus)||void 0===e||e)&&nt()){const t=()=>{window.focus()};window.PointerEvent?this.target.addEventListener("pointerdown",t):(this.target.addEventListener("touchstart",t),this.target.addEventListener("mousedown",t))}}detach(){window.PointerEvent?(this.target.removeEventListener("pointerdown",this._boundHandle),this.target.removeEventListener("pointerup",this._boundHandle),this.target.removeEventListener("pointermove",this._boundHandle),this.target.removeEventListener("pointercancel",this._boundHandle)):(this.target.removeEventListener("touchstart",this._boundHandle),this.target.removeEventListener("touchend",this._boundHandle),this.target.removeEventListener("touchmove",this._boundHandle),this.target.removeEventListener("touchcancel",this._boundHandle),this.target.removeEventListener("mousedown",this._boundHandle),this.target.removeEventListener("mouseup",this._boundHandle),this.target.removeEventListener("mousemove",this._boundHandle)),"onwheel"in document.createElement("div")?this.target.removeEventListener("wheel",this._boundWheel):void 0!==document.onmousewheel?this.target.addEventListener("mousewheel",this._boundWheel):this.target.addEventListener("MozMousePixelScroll",this._boundWheel)}_normalizePointerId(t){this._activeNativePointerIdsToNormalized.set(t,-1);const e=Array.from(this._activeNativePointerIdsToNormalized.keys()).sort(((t,e)=>t-e)).findIndex((e=>e===t));return this._activeNativePointerIdsToNormalized.set(t,e),e}_handle(t){t.preventDefault();const e=new Map;let i,n;if(s=t,globalThis.TouchEvent&&s instanceof globalThis.TouchEvent){i=Is.Unknown,n=Ds.Touch;for(let i=0;i<t.changedTouches.length;i++){const n=t.changedTouches[i],s=Us.fromPagePosition(n.pageX,n.pageY,this.engine),o=i+1,r=this._normalizePointerId(o);this.currentFramePointerCoords.set(r,s),e.set(r,s)}}else{i=this._nativeButtonToPointerButton(t.button),n=Ds.Mouse;const s=Us.fromPagePosition(t.pageX,t.pageY,this.engine);let o=1;(function(t){return globalThis.PointerEvent&&t instanceof globalThis.PointerEvent})(t)&&(o=t.pointerId,n=this._stringToPointerType(t.pointerType));const r=this._normalizePointerId(o);this.currentFramePointerCoords.set(r,s),e.set(r,s)}var s;for(const[s,o]of e.entries())switch(t.type){case"mousedown":case"pointerdown":case"touchstart":this.currentFrameDown.push(new js("down",s,i,n,o,t)),this.currentFramePointerDown.set(s,!0);break;case"mouseup":case"pointerup":case"touchend":this.currentFrameUp.push(new js("up",s,i,n,o,t)),this.currentFramePointerDown.set(s,!1);break;case"mousemove":case"pointermove":case"touchmove":this.currentFrameMove.push(new js("move",s,i,n,o,t));break;case"touchcancel":case"pointercancel":this.currentFrameCancel.push(new js("cancel",s,i,n,o,t))}}_handleWheel(t){(this.engine.pageScrollPreventionMode===io.All||this.engine.pageScrollPreventionMode===io.Canvas&&t.target===this.engine.canvas)&&t.preventDefault();const e=this.engine.screen.pageToScreenCoordinates(yt(t.pageX,t.pageY)),i=this.engine.screen.screenToWorldCoordinates(e),n=-1/40,s=t.deltaX||t.wheelDeltaX*n||0,o=t.deltaY||t.wheelDeltaY*n||t.wheelDelta*n||t.detail||0,r=t.deltaZ||0;let a=Ls.Pixel;t.deltaMode&&(1===t.deltaMode?a=Ls.Line:2===t.deltaMode&&(a=Ls.Page));const l=new Vs(i.x,i.y,t.pageX,t.pageY,e.x,e.y,0,s,o,r,a,t);this.currentFrameWheel.push(l)}triggerEvent(t,e){const i=this.engine.screen.worldToPageCoordinates(e);window.PointerEvent?this._handle(new window.PointerEvent("pointer"+t,{pointerId:0,clientX:i.x,clientY:i.y})):this._handle(new window.MouseEvent("mouse"+t,{clientX:i.x,clientY:i.y}));const n=this.engine.currentScene.world.systemManager.get(bs),s=this.engine.currentScene.world.queryManager.createQuery(n.types);n.preupdate(),n.update(s.getEntities())}_nativeButtonToPointerButton(t){switch(t){case Rs.NoButton:return Is.NoButton;case Rs.Left:return Is.Left;case Rs.Middle:return Is.Middle;case Rs.Right:return Is.Right;case Rs.Unknown:return Is.Unknown;default:return $t(t)}}_stringToPointerType(t){switch(t){case"touch":return Ds.Touch;case"mouse":return Ds.Mouse;case"pen":return Ds.Pen;default:return Ds.Unknown}}}class Ys{constructor(t){var e;this._samplePeriod=100,this._currentFrameTime=0,this._frames=0,this._previousSampleTime=0,this._beginFrameTime=0,this._fps=t.initialFps,this._samplePeriod=null!==(e=t.samplePeriod)&&void 0!==e?e:this._samplePeriod,this._currentFrameTime=1e3/t.initialFps,this._nowFn=t.nowFn,this._previousSampleTime=this._nowFn()}start(){this._beginFrameTime=this._nowFn()}end(){this._frames++;const t=this._nowFn();this._currentFrameTime=t-this._beginFrameTime,t>=this._previousSampleTime+this._samplePeriod&&(this._fps=1e3*this._frames/(t-this._previousSampleTime),this._previousSampleTime=t,this._frames=0)}get fps(){return this._fps}get instant(){return 1e3/this._currentFrameTime}}class qs{constructor(t){var e,i,n;this._onFatalException=()=>{},this._maxFps=1/0,this._lastTime=0,this._elapsed=1,this._scheduledCbs=[],this._totalElapsed=0,this._options=t,this.tick=t.tick,this._lastTime=null!==(e=this.now())&&void 0!==e?e:0,this._maxFps=null!==(i=t.maxFps)&&void 0!==i?i:this._maxFps,this._onFatalException=null!==(n=t.onFatalException)&&void 0!==n?n:this._onFatalException,this.fpsSampler=new Ys({initialFps:60,nowFn:()=>this.now()})}elapsed(){return this._elapsed}now(){return performance.now()}toTestClock(){return new Zs({...this._options,defaultUpdateMs:16.6})}toStandardClock(){return new Xs({...this._options})}setFatalExceptionHandler(t){this._onFatalException=t}schedule(t,e=0){const i=this._totalElapsed+e;this._scheduledCbs.push([t,i])}_runScheduledCbs(){for(let t=this._scheduledCbs.length-1;t>-1;t--)this._scheduledCbs[t][1]<=this._totalElapsed&&(this._scheduledCbs[t][0](),this._scheduledCbs.splice(t,1))}update(t){try{this.fpsSampler.start();const e=this.now();let i=e-this._lastTime||1;const n=1e3/this._maxFps;if(i>=n){let s=0;0!==n&&(s=i%n,i-=s),i>200&&(i=1),this._elapsed=t||i,this._totalElapsed+=this._elapsed,this._runScheduledCbs(),this.tick(t||i),this._lastTime=0!==n?e-s:e,this.fpsSampler.end()}}catch(t){this._onFatalException(t),this.stop()}}}class Xs extends qs{constructor(t){super(t),this._running=!1}isRunning(){return this._running}start(){if(this._running)return;this._running=!0;const t=()=>{if(this._running)try{this._requestId=window.requestAnimationFrame(t),this.update()}catch(t){throw window.cancelAnimationFrame(this._requestId),t}};t()}stop(){this._running=!1}}class Zs extends qs{constructor(t){super({...t}),this._logger=tt.getInstance(),this._running=!1,this._currentTime=0,this._updateMs=t.defaultUpdateMs}now(){var t;return null!==(t=this._currentTime)&&void 0!==t?t:0}isRunning(){return this._running}start(){this._running=!0}stop(){this._running=!1}step(t){const e=null!=t?t:this._updateMs;this._running?(this.update(e),this._currentTime+=e):this._logger.warn("The clock is not running, no step will be performed")}run(t,e){for(let i=0;i<t;i++)this.step(null!=e?e:this._updateMs)}}var Qs=o(7379);class Js{constructor(){this._toasterCss=Qs.Z.toString(),this._isInitialized=!1}_initialize(){this._isInitialized||(this._container=document.createElement("div"),this._container.id="ex-toast-container",document.body.appendChild(this._container),this._isInitialized=!0,this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._toasterCss,document.head.appendChild(this._styleBlock))}dispose(){this._container.parentElement.removeChild(this._container),this._styleBlock.parentElement.removeChild(this._styleBlock),this._isInitialized=!1}_createFragment(t){const e=document.createElement("span");return e.innerText=t,e}toast(t,e,i){this._initialize();const n=document.createElement("div");n.className="ex-toast-message";const s=t.split("[LINK]").map((t=>this._createFragment(t)));if(e){const t=document.createElement("a");t.href=e,t.innerText=i||e,s.splice(1,0,t)}const o=document.createElement("div");s.forEach((t=>{o.appendChild(t)})),n.appendChild(o);const r=document.createElement("button");r.innerText="x",r.addEventListener("click",(()=>{this._container.removeChild(n)})),n.appendChild(r);const a=t=>{if("Escape"===t.key)try{this._container.removeChild(n)}catch(t){}document.removeEventListener("keydown",a)};document.addEventListener("keydown",a);const l=this._container.firstChild;this._container.insertBefore(n,l)}}class to{constructor(t){this.inputs=t,this._handlers=new Map}execute(){for(const[t,e]of this._handlers.entries()){const i=t(this.inputs);i&&e(i)}}on(t,e){this._handlers.set(t,e)}}p();const eo={FallbackGraphicsContext:"fallbackgraphicscontext",Initialize:"initialize",Visible:"visible",Hidden:"hidden",Start:"start",Stop:"stop",PreUpdate:"preupdate",PostUpdate:"postupdate",PreFrame:"preframe",PostFrame:"postframe",PreDraw:"predraw",PostDraw:"postdraw"};var io;!function(t){t[t.None=0]="None",t[t.Canvas=1]="Canvas",t[t.All=2]="All"}(io||(io={}));class no{get canvasWidth(){return this.screen.canvasWidth}get halfCanvasWidth(){return this.screen.halfCanvasWidth}get canvasHeight(){return this.screen.canvasHeight}get halfCanvasHeight(){return this.screen.halfCanvasHeight}get drawWidth(){return this.screen.drawWidth}get halfDrawWidth(){return this.screen.halfDrawWidth}get drawHeight(){return this.screen.drawHeight}get halfDrawHeight(){return this.screen.halfDrawHeight}get isHiDpi(){return this.screen.isHiDpi}get stats(){return this.debug.stats}get isFullscreen(){return this.screen.isFullScreen}get displayMode(){return this.screen.displayMode}get pixelRatio(){return this.screen.pixelRatio}get isDebug(){return this._isDebug}get snapToPixel(){return this.graphicsContext.snapToPixel}set snapToPixel(t){this.graphicsContext.snapToPixel=t}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}constructor(t){var e,i,n,s,o,r;this.events=new m,this.maxFps=Number.POSITIVE_INFINITY,this.scenes={},this._suppressPlayButton=!1,this.pauseAudioWhenHidden=!0,this._isDebug=!1,this.enableCanvasTransparency=!0,this.onFatalException=t=>{tt.getInstance().fatal(t)},this._toaster=new Js,this._timescale=1,this._isInitialized=!1,this._deferredGoTo=null,this._originalOptions={},this._performanceThresholdTriggered=!1,this._fpsSamples=[],this._loadingComplete=!1,this._isReady=!1,this._isReadyPromise=new Promise((t=>{this._isReadyResolve=t})),this.currentFrameElapsedMs=0,this.currentFrameLagMs=0,this._lagMs=0,this._screenShotRequests=[],t={...no._DEFAULT_ENGINE_OPTIONS,...t},this._originalOptions=t,g.freeze(),this.browser=new Hs(window,document);const a=new Ve;if(!t.suppressMinimumBrowserFeatureDetection&&!(this._compatible=a.test())){const e=document.createElement("div");if(e.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(e),a.failedTests.forEach((function(t){const e=document.createElement("div");e.innerText="Browser feature missing "+t,document.body.appendChild(e)})),t.canvasElementId){const e=document.getElementById(t.canvasElementId);e&&e.parentElement.removeChild(e)}return}this._compatible=!0,console.log&&!t.suppressConsoleBootMessage&&(console.log(`%cPowered by Excalibur.js (v${Mo})`,"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log("\n      /| ________________\nO|===|* >________________>\n      \\|"),console.log("Visit","http://excaliburjs.com","for more information")),t.suppressPlayButton&&(this._suppressPlayButton=!0),this._logger=tt.getInstance(),this._logger.defaultLevel===h.Debug&&a.logBrowserFeatures(),this._logger.debug("Building engine..."),this.canvasElementId=t.canvasElementId,t.canvasElementId?(this._logger.debug("Using Canvas element specified: "+t.canvasElementId),this.canvas=document.getElementById(t.canvasElementId)):t.canvasElement?(this._logger.debug("Using Canvas element specified:",t.canvasElement),this.canvas=t.canvasElement):(this._logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas"));let l=null!==(e=t.displayMode)&&void 0!==e?e:we.Fixed;t.width&&t.height||t.viewport?(void 0===t.displayMode&&(l=we.Fixed),this._logger.debug("Engine viewport is size "+t.width+" x "+t.height)):t.displayMode||(this._logger.debug("Engine viewport is fit"),l=we.FitScreen),this._originalDisplayMode=l;let c=g.isEnabled("use-canvas-context");if(!c)try{this.graphicsContext=new me({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})}catch(t){this._logger.warn(`Excalibur could not load webgl for some reason (${t.message}) and loaded a Canvas 2D fallback. Some features of Excalibur will not work in this mode. \n\nRead more about this issue at https://excaliburjs.com/docs/webgl`),c=!0}c&&(this.graphicsContext=new ye({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})),this.screen=new be({canvas:this.canvas,context:this.graphicsContext,antialiasing:null===(i=t.antialiasing)||void 0===i||i,browser:this.browser,viewport:null!==(n=t.viewport)&&void 0!==n?n:t.width&&t.height?{width:t.width,height:t.height}:xe.SVGA,resolution:t.resolution,displayMode:l,pixelRatio:t.suppressHiDPIScaling?1:null!==(s=t.pixelRatio)&&void 0!==s?s:null}),Ut.filtering=t.antialiasing?Ht.Blended:Ht.Pixel,t.backgroundColor&&(this.backgroundColor=t.backgroundColor.clone()),this.maxFps=null!==(o=t.maxFps)&&void 0!==o?o:this.maxFps,this.fixedUpdateFps=null!==(r=t.fixedUpdateFps)&&void 0!==r?r:this.fixedUpdateFps,this.clock=new Xs({maxFps:this.maxFps,tick:this._mainloop.bind(this),onFatalException:t=>this.onFatalException(t)}),this.enableCanvasTransparency=t.enableCanvasTransparency,this._loader=new Ue,this._loader.wireEngine(this),this.debug=new Os(this),this._initialize(t),this.rootScene=this.currentScene=new Ms,this.addScene("root",this.rootScene),window.___EXCALIBUR_DEVTOOL=this}_monitorPerformanceThresholdAndTriggerFallback(){const{allow:t}=this._originalOptions.configurePerformanceCanvas2DFallback;let{threshold:e,showPlayerMessage:i}=this._originalOptions.configurePerformanceCanvas2DFallback;if(void 0===e&&(e=no._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.threshold),void 0===i&&(i=no._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.showPlayerMessage),!g.isEnabled("use-canvas-context")&&t&&this.ready&&!this._performanceThresholdTriggered){this._fpsSamples.length===e.numberOfFrames&&this._fpsSamples.splice(0,1),this._fpsSamples.push(this.clock.fpsSampler.fps);let t=0;for(let e=0;e<this._fpsSamples.length;e++)t+=this._fpsSamples[e];const n=t/this._fpsSamples.length;this._fpsSamples.length===e.numberOfFrames&&n<=e.fps&&(this._performanceThresholdTriggered=!0,this._logger.warn('Switching to browser 2D Canvas fallback due to performance. Some features of Excalibur will not work in this mode.\nthis might mean your browser doesn\'t have webgl enabled or hardware acceleration is unavailable.\n\nIf in Chrome:\n  * Visit Settings > Advanced > System, and ensure "Use Hardware Acceleration" is checked.\n  * Visit chrome://flags/#ignore-gpu-blocklist and ensure "Override software rendering list" is "enabled"\nIf in Firefox, visit about:config\n  * Ensure webgl.disabled = false\n  * Ensure webgl.force-enabled = true\n  * Ensure layers.acceleration.force-enabled = true\n\nRead more about this issue at https://excaliburjs.com/docs/performance'),i&&this._toaster.toast("Excalibur is encountering performance issues. It's possible that your browser doesn't have hardware acceleration enabled. Visit [LINK] for more information and potential solutions.","https://excaliburjs.com/docs/performance"),this.useCanvas2DFallback(),this.emit("fallbackgraphicscontext",this.graphicsContext))}}useCanvas2DFallback(){var t,e,i;const n=this.canvas.cloneNode(!1);this.canvas.parentNode.replaceChild(n,this.canvas),this.canvas=n;const s=this._originalOptions,o=this._originalDisplayMode;this.graphicsContext=new ye({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:s.antialiasing,backgroundColor:s.backgroundColor,snapToPixel:s.snapToPixel,useDrawSorting:s.useDrawSorting}),this.screen&&this.screen.dispose(),this.screen=new be({canvas:this.canvas,context:this.graphicsContext,antialiasing:null===(t=s.antialiasing)||void 0===t||t,browser:this.browser,viewport:null!==(e=s.viewport)&&void 0!==e?e:s.width&&s.height?{width:s.width,height:s.height}:xe.SVGA,resolution:s.resolution,displayMode:o,pixelRatio:s.suppressHiDPIScaling?1:null!==(i=s.pixelRatio)&&void 0!==i?i:null}),this.screen.setCurrentCamera(this.currentScene.camera),this.input.pointers.detach();const r=s&&s.pointerScope===d.Document?document:this.canvas;this.input.pointers=this.input.pointers.recreate(r,this),this.input.pointers.init()}getWorldBounds(){return this.screen.getWorldBounds()}get timescale(){return this._timescale}set timescale(t){t<=0?tt.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0."):this._timescale=t}addTimer(t){return this.currentScene.addTimer(t)}removeTimer(t){return this.currentScene.removeTimer(t)}addScene(t,e){this.scenes[t]&&this._logger.warn("Scene",t,"already exists overwriting"),this.scenes[t]=e}removeScene(t){if(t instanceof Ms)for(const e in this.scenes)this.scenes.hasOwnProperty(e)&&this.scenes[e]===t&&delete this.scenes[e];"string"==typeof t&&delete this.scenes[t]}add(t){2!==arguments.length?this._deferredGoTo&&this.scenes[this._deferredGoTo]?this.scenes[this._deferredGoTo].add(t):this.currentScene.add(t):this.addScene(arguments[0],arguments[1])}remove(t){t instanceof Oi&&this.currentScene.remove(t),t instanceof Ms&&this.removeScene(t),"string"==typeof t&&this.removeScene(t)}goToScene(t,e){if(this.isInitialized)if(this.scenes[t]){const i=this.currentScene,n=this.scenes[t];if(this._logger.debug("Going to scene:",t),this.currentScene.isInitialized){const t={engine:this,previousScene:i,nextScene:n};this.currentScene._deactivate.apply(this.currentScene,[t,n]),this.currentScene.events.emit("deactivate",new K(t,this.currentScene))}this.currentScene=n,this.screen.setCurrentCamera(n.camera),this.currentScene._initialize(this);const s={engine:this,previousScene:i,nextScene:n,data:e};this.currentScene._activate.apply(this.currentScene,[s,n]),this.currentScene.events.emit("activate",new G(s,this.currentScene))}else this._logger.error("Scene",t,"does not exist!");else this._deferredGoTo=t}screenToWorldCoordinates(t){return this.screen.screenToWorldCoordinates(t)}worldToScreenCoordinates(t){return this.screen.worldToScreenCoordinates(t)}_initialize(t){var e,i,n,s;this.pageScrollPreventionMode=t.scrollPreventionMode;const o=t&&t.pointerScope===d.Document?document:this.canvas;this.input={keyboard:new ot,pointers:new Ks(o,this),gamepads:new Q},this.input.keyboard.init({grabWindowFocus:null===(i=null===(e=this._originalOptions)||void 0===e?void 0:e.grabWindowFocus)||void 0===i||i}),this.input.pointers.init({grabWindowFocus:null===(s=null===(n=this._originalOptions)||void 0===n?void 0:n.grabWindowFocus)||void 0===s||s}),this.input.gamepads.init(),this.inputMapper=new to(this.input),this.browser.document.on("visibilitychange",(()=>{"hidden"===document.visibilityState?(this.events.emit("hidden",new B(this)),this._logger.debug("Window hidden")):"visible"===document.visibilityState&&(this.events.emit("visible",new P(this)),this._logger.debug("Window visible"))})),this.canvasElementId||t.canvasElement||document.body.appendChild(this.canvas)}onInitialize(t){}setAntialiasing(t){this.screen.antialiasing=t}getAntialiasing(){return this.screen.antialiasing}get isInitialized(){return this._isInitialized}_overrideInitialize(t){if(!this.isInitialized)if(this.onInitialize(t),this.events.emit("initialize",new V(t,this)),this._isInitialized=!0,this._deferredGoTo){const t=this._deferredGoTo;this._deferredGoTo=null,this.goToScene(t)}else this.goToScene("root")}_update(t){if(!this.ready)return this._loader.update(this,t),this.input.keyboard.update(),this.input.gamepads.update(),void this.inputMapper.execute();this._preupdate(t),this.currentScene.update(this,t),this.graphicsContext.updatePostProcessors(t),this._postupdate(t),this.input.keyboard.update(),this.input.gamepads.update(),this.inputMapper.execute()}_preupdate(t){this.emit("preupdate",new T(this,t,this)),this.onPreUpdate(this,t)}onPreUpdate(t,e){}_postupdate(t){this.emit("postupdate",new k(this,t,this)),this.onPostUpdate(this,t)}onPostUpdate(t,e){}_draw(t){if(this.graphicsContext.beginDrawLifecycle(),this.graphicsContext.clear(),this._predraw(this.graphicsContext,t),!this._isReady)return this._loader.canvas.draw(this.graphicsContext,0,0),void this.graphicsContext.flush();this.graphicsContext.backgroundColor=this.backgroundColor,this.currentScene.draw(this.graphicsContext,t),this._postdraw(this.graphicsContext,t),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle(),this._checkForScreenShots()}_predraw(t,e){this.emit("predraw",new C(t,e,this)),this.onPreDraw(t,e)}onPreDraw(t,e){}_postdraw(t,e){this.emit("postdraw",new A(t,e,this)),this.onPostDraw(t,e)}onPostDraw(t,e){}showDebug(t){this._isDebug=t}toggleDebug(){return this._isDebug=!this._isDebug,this._isDebug}get loadingComplete(){return this._loadingComplete}get ready(){return this._isReady}isReady(){return this._isReadyPromise}async start(t){if(!this._compatible)throw new Error("Excalibur is incompatible with your browser");return t&&(this.screen.pushResolutionAndViewport(),this.screen.resolution=this.screen.viewport,this.screen.applyResolutionAndViewport(),this._loader=t,this._loader.suppressPlayButton=this._suppressPlayButton||this._loader.suppressPlayButton,this._loader.wireEngine(this)),this._logger.debug("Starting game clock..."),this.browser.resume(),this.clock.start(),this._logger.debug("Game clock started"),t&&(await this.load(this._loader),this._loadingComplete=!0,this.screen.popResolutionAndViewport(),this.screen.applyResolutionAndViewport()),this._loadingComplete=!0,this._overrideInitialize(this),this._isReady=!0,this._isReadyResolve(),this.emit("start",new x(this)),this._isReadyPromise}_mainloop(t){this.emit("preframe",new M(this,this.stats.prevFrame));const e=t*this.timescale;this.currentFrameElapsedMs=e;const i=this.stats.prevFrame.id+1;this.stats.currFrame.reset(),this.stats.currFrame.id=i,this.stats.currFrame.delta=e,this.stats.currFrame.fps=this.clock.fpsSampler.fps,ie.clear();const n=this.clock.now(),s=1e3/this.fixedUpdateFps;if(this.fixedUpdateFps)for(this._lagMs+=e;this._lagMs>=s;)this._update(s),this._lagMs-=s;else this._update(e);const o=this.clock.now();this.currentFrameLagMs=this._lagMs,this._draw(e);const r=this.clock.now();this.stats.currFrame.duration.update=o-n,this.stats.currFrame.duration.draw=r-o,this.stats.currFrame.graphics.drawnImages=ie.DrawnImagesCount,this.stats.currFrame.graphics.drawCalls=ie.DrawCallCount,this.emit("postframe",new $(this,this.stats.currFrame)),this.stats.prevFrame.reset(this.stats.currFrame),this._monitorPerformanceThresholdAndTriggerFallback()}stop(){this.clock.isRunning()&&(this.emit("stop",new b(this)),this.browser.pause(),this.clock.stop(),this._logger.debug("Game stopped"))}isRunning(){return this.clock.isRunning()}screenshot(t=!1){return new Promise((e=>{this._screenShotRequests.push({preserveHiDPIResolution:t,resolve:e})}))}_checkForScreenShots(){for(const t of this._screenShotRequests){const e=t.preserveHiDPIResolution?this.canvas.width:this.screen.resolution.width,i=t.preserveHiDPIResolution?this.canvas.height:this.screen.resolution.height,n=document.createElement("canvas");n.width=e,n.height=i;const s=n.getContext("2d");s.imageSmoothingEnabled=this.screen.antialiasing,s.drawImage(this.canvas,0,0,e,i);const o=new Image,r=n.toDataURL("image/png");o.src=r,t.resolve(o)}this._screenShotRequests.length=0}async load(t){try{await t.load()}catch(t){this._logger.error("Error loading resources, things may not behave properly",t),await Promise.resolve()}}}no._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,useDrawSorting:!0,configurePerformanceCanvas2DFallback:{allow:!0,showPlayerMessage:!1,threshold:{fps:20,numberOfFrames:100}},canvasElementId:"",canvasElement:void 0,snapToPixel:!1,pointerScope:d.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,grabWindowFocus:!0,scrollPreventionMode:io.Canvas,backgroundColor:wt.fromHex("#2185d0")};class so{constructor(){this._handlers={},this._wiredEventDispatchers=[],this._deferedHandlerRemovals=[]}clear(){this._handlers={},this._wiredEventDispatchers=[]}_processDeferredHandlerRemovals(){for(const t of this._deferedHandlerRemovals)this._removeHandler(t.name,t.handler);this._deferedHandlerRemovals.length=0}emit(t,e){if(this._processDeferredHandlerRemovals(),!t)return;let i,n;if(t=t.toLowerCase(),null==e&&(e=new v),this._handlers[t])for(i=0,n=this._handlers[t].length;i<n;i++)this._handlers[t][i](e);for(i=0,n=this._wiredEventDispatchers.length;i<n;i++)this._wiredEventDispatchers[i].emit(t,e)}on(t,e){this._processDeferredHandlerRemovals(),t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(e)}off(t,e){this._deferedHandlerRemovals.push({name:t,handler:e})}_removeHandler(t,e){t=t.toLowerCase();const i=this._handlers[t];if(i)if(e){const n=i.indexOf(e);n>-1&&this._handlers[t].splice(n,1)}else this._handlers[t].length=0}once(t,e){this._processDeferredHandlerRemovals();const i=n=>{const s=n||new v;this.off(t,i),e(s)};this.on(t,i)}wire(t){t._wiredEventDispatchers.push(this)}unwire(t){const e=t._wiredEventDispatchers.indexOf(this);e>-1&&t._wiredEventDispatchers.splice(e,1)}}class oo extends An{get font(){return this._font}set font(t){this._font=t,this._text.font=t}get text(){return this._text.text}set text(t){this._text.text=t}get color(){return this._text.color}set color(t){this._text&&(this._text.color=t)}get opacity(){return this._text.opacity}set opacity(t){this._text.opacity=t}get spriteFont(){return this._spriteFont}set spriteFont(t){t&&(this._spriteFont=t,this._text.font=this._spriteFont)}constructor(t){super(t),this._font=new bn,this._text=new Cn({text:"",font:this._font});const{text:e,pos:i,x:n,y:s,spriteFont:o,font:r,color:a}=t;this.pos=null!=i?i:n&&s?yt(n,s):this.pos,this.text=null!=e?e:this.text,this.font=null!=r?r:this.font,this.spriteFont=null!=o?o:this.spriteFont,this._text.color=null!=a?a:this.color;const l=this.get(Hi);l.anchor=_t.Zero,l.use(this._text)}_initialize(t){super._initialize(t)}getTextWidth(){return this._text.width}}class ro extends Oi{getGraphics(){return this._graphics}addGraphic(t){this._graphics.push(t),this._gfx.visible=!0,this._gfx.localBounds=this._recalculateBounds()}_recalculateBounds(){let t=this._tileBounds.clone();for(const e of this._graphics){const i=yt(this.map.graphicsOffset.x-this.map.tileWidth/2,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:e.height-this.map.tileHeight));t=t.combine(e.localBounds.translate(i))}return t}removeGraphic(t){const e=this._graphics.indexOf(t);e>-1&&this._graphics.splice(e,1),this._gfx.localBounds=this._recalculateBounds()}clearGraphics(){this._graphics.length=0,this._gfx.visible=!1,this._gfx.localBounds=this._recalculateBounds()}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const e=this._colliders.indexOf(t);e>-1&&this._colliders.splice(e,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}get pos(){return this.map.tileToWorld(yt(this.x,this.y))}get center(){return this.pos.add(yt(0,this.map.tileHeight/2))}constructor(t,e,i,n){super([new hi,new Hi({offset:null!=i?i:_t.Zero,onPostDraw:(t,e)=>this.draw(t,e)}),new As(n)]),this.solid=!1,this._tileBounds=new At,this._graphics=[],this._colliders=[],this.x=t,this.y=e,this.map=n,this._transform=this.get(hi),this._isometricEntityComponent=this.get(As);const s=this.map.tileWidth/2,o=this.map.tileHeight/2,r=(this.x-this.y)*s,a=(this.x+this.y)*o;this._transform.pos=yt(r,a),this._isometricEntityComponent.elevation=0,this._gfx=this.get(Hi),this._gfx.visible=!1;const l=this.map.tileWidth,h=this.map.tileHeight,c=yt(0,this.map.renderFromTopOfGraphic?h:0);this._gfx.localBounds=this._tileBounds=new At({left:-l/2,top:-h,right:l/2,bottom:h}).translate(c)}draw(t,e){const i=this.map.tileWidth/2;t.save(),t.translate(-i,0);for(const e of this._graphics)e.draw(t,this.map.graphicsOffset.x,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:e.height-this.map.tileHeight));t.restore()}}class ao extends Oi{constructor(t){super([new hi,new Ri({type:Ge.Fixed}),new $i,new Mn((t=>this.debug(t)),!1)],t.name),this.renderFromTopOfGraphic=!1,this.graphicsOffset=yt(0,0),this._collidersDirty=!1,this._originalOffsets=new WeakMap;const{pos:e,tileWidth:i,tileHeight:n,columns:s,rows:o,renderFromTopOfGraphic:r,graphicsOffset:a}=t;this.transform=this.get(hi),e&&(this.transform.pos=e),this.collider=this.get($i),this.collider&&this.collider.set(this._composite=new yi([])),this.renderFromTopOfGraphic=null!=r?r:this.renderFromTopOfGraphic,this.graphicsOffset=null!=a?a:this.graphicsOffset,this.tileWidth=i,this.tileHeight=n,this.columns=s,this.rows=o,this.tiles=new Array(s*o);for(let t=0;t<o;t++)for(let e=0;e<s;e++){const i=new ro(e,t,this.graphicsOffset,this);this.tiles[e+t*s]=i,this.addChild(i)}}update(){this._collidersDirty&&(this.updateColliders(),this._collidersDirty=!1)}flagCollidersDirty(){this._collidersDirty=!0}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const e=t.offset;return this._originalOffsets.set(t,e),e}}updateColliders(){this._composite.clearColliders();const t=this.get(hi).pos;for(const e of this.tiles)if(e.solid)for(const i of e.getColliders()){const n=this._getOrSetColliderOriginalOffset(i);i.offset=this.tileToWorld(yt(e.x,e.y)).sub(t).add(n).sub(yt(this.tileWidth/2,this.tileHeight)),i.owner=this,this._composite.addCollider(i)}this.collider.update()}worldToTile(t){t=t.sub(this.transform.globalPos);const e=this.tileWidth/2,i=this.tileHeight/2;return yt(~~((t.x/e+t.y/i)/2),~~((t.y/i-t.x/e)/2))}tileToWorld(t){const e=this.tileWidth/2,i=this.tileHeight/2;return yt((t.x-t.y)*e,(t.x+t.y)*i).add(this.transform.pos)}getTile(t,e){return t<0||e<0||t>=this.columns||e>=this.rows?null:this.tiles[t+e*this.columns]}getTileByPoint(t){const e=this.worldToTile(t);return this.getTile(e.x,e.y)}_getMaxZIndex(){let t=Number.NEGATIVE_INFINITY;for(const e of this.tiles){const i=e.get(hi).z;i>t&&(t=i)}return t}debug(t){t.save(),t.z=this._getMaxZIndex()+.5;for(let e=0;e<this.rows+1;e++){const i=this.tileToWorld(yt(0,e)),n=this.tileToWorld(yt(this.columns,e));t.drawLine(i,n,wt.Red,2)}for(let e=0;e<this.columns+1;e++){const i=this.tileToWorld(yt(e,0)),n=this.tileToWorld(yt(e,this.rows));t.drawLine(i,n,wt.Red,2)}for(const e of this.tiles)t.drawCircle(this.tileToWorld(yt(e.x,e.y)),3,wt.Yellow);t.restore()}}class lo{constructor(t,e){this._stopped=!1,this._sequenceBuilder=e,this._sequenceContext=new _n(t),this._actionQueue=this._sequenceContext.getQueue(),this._sequenceBuilder(this._sequenceContext)}update(t){this._actionQueue.update(t)}isComplete(){return this._stopped||this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._stopped=!1,this._actionQueue.reset()}clone(t){return new lo(t,this._sequenceBuilder)}}class ho{constructor(t){this._actions=t}update(t){for(let e=0;e<this._actions.length;e++)this._actions[e].update(t)}isComplete(t){return this._actions.every((e=>e.isComplete(t)))}reset(){this._actions.forEach((t=>t.reset()))}stop(){this._actions.forEach((t=>t.stop()))}}class co{static create(t,e){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);if(this._GROUPS.get(t))throw new Error(`Collision group ${t} already exists`);const i=new di(t,this._CURRENT_BIT,void 0!==e?e:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,i),i}static get groups(){return Array.from(this._GROUPS.values())}static groupByName(t){return this._GROUPS.get(t)}static reset(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}function uo(t){return!!t._initialize}function po(t){return!!t.onInitialize}function go(t){return!!t._preupdate}function fo(t){return!!t.onPreUpdate}function mo(t){return!!t.onPostUpdate}function vo(t){return!!t.onPostUpdate}function _o(t){return!!t.onPreDraw}function yo(t){return!!t.onPostDraw}co._STARTING_BIT=1,co._MAX_GROUPS=32,co._CURRENT_GROUP=1,co._CURRENT_BIT=co._STARTING_BIT,co._GROUPS=new Map;class wo{constructor(t,e=wt.Magenta,i=!1){this.path=t,this.color=e,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new Ft(t,"arraybuffer",i),this._transparentColor=e}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}async load(){const t=await this._resource.load();this._stream=new Co(t),this._gif=new Ao(this._stream,this._transparentColor);const e=this._gif.images.map((t=>new jt(t.src,!1)));return await Promise.all(e.map((t=>t.load()))),this.data=this._textures=e}isLoaded(){return!!this.data}toSprite(t=0){return this._textures[t].toSprite()}toSpriteSheet(){const t=this._textures.map((t=>t.toSprite()));return new Vt({sprites:t})}toAnimation(t){const e=this.toSpriteSheet(),i=e.sprites.length;return this._animation=us.fromSpriteSheet(e,ft(0,i),t),this._animation}get readCheckBytes(){return this._gif.checkBytes}}const xo=t=>t.reduce((function(t,e){return 2*t+e}),0),bo=t=>{const e=[];for(let i=7;i>=0;i--)e.push(!!(t&1<<i));return e};class Co{constructor(t){if(this.data=null,this.len=0,this.position=0,this.readByte=()=>{if(this.position>=this.data.byteLength)throw new Error("Attempted to read past end of stream.");return this.data[this.position++]},this.readBytes=t=>{const e=[];for(let i=0;i<t;i++)e.push(this.readByte());return e},this.read=t=>{let e="";for(let i=0;i<t;i++)e+=String.fromCharCode(this.readByte());return e},this.readUnsigned=()=>{const t=this.readBytes(2);return(t[1]<<8)+t[0]},this.data=new Uint8Array(t),this.len=this.data.byteLength,0===this.len)throw new Error("No data loaded from file")}}class Ao{constructor(t,e=wt.Magenta){this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=t=>{const e=[];for(let i=0;i<t;i++){const t="#"+this._st.readBytes(3).map((t=>{const e=t.toString(16);return 1===e.length?"0"+e:e})).join("");e.push(t)}return e},this.readSubBlocks=()=>{let t,e;e="";do{t=this._st.readByte(),e+=this._st.read(t)}while(0!==t);return e},this.parseHeader=()=>{const t={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(t.sig=this._st.read(3),t.ver=this._st.read(3),"GIF"!==t.sig)throw new Error("Not a GIF file.");t.width=this._st.readUnsigned(),t.height=this._st.readUnsigned();const e=bo(this._st.readByte());t.gctFlag=e.shift(),t.colorRes=xo(e.splice(0,3)),t.sorted=e.shift(),t.globalColorTableSize=xo(e.splice(0,3)),t.bgColor=this._st.readByte(),t.pixelAspectRatio=this._st.readByte(),t.gctFlag&&(t.globalColorTable=this.parseColorTable(1<<t.globalColorTableSize+1),this.globalColorTable=t.globalColorTable),this._handler.hdr&&this._handler.hdr(t)&&this.checkBytes.push(this._handler.hdr)},this.parseExt=t=>{const e=t=>{this.checkBytes.push(this._st.readByte());const e=bo(this._st.readByte());t.reserved=e.splice(0,3),t.disposalMethod=xo(e.splice(0,3)),t.userInput=e.shift(),t.transparencyGiven=e.shift(),t.delayTime=this._st.readUnsigned(),t.transparencyIndex=this._st.readByte(),t.terminator=this._st.readByte(),this._handler.gce&&this._handler.gce(t)&&this.checkBytes.push(this._handler.gce)},i=t=>{t.comment=this.readSubBlocks(),this._handler.com&&this._handler.com(t)&&this.checkBytes.push(this._handler.com)},n=t=>{this.checkBytes.push(this._st.readByte()),t.ptHeader=this._st.readBytes(12),t.ptData=this.readSubBlocks(),this._handler.pte&&this._handler.pte(t)&&this.checkBytes.push(this._handler.pte)},s=t=>{this.checkBytes.push(this._st.readByte()),t.identifier=this._st.read(8),t.authCode=this._st.read(3),"NETSCAPE"===t.identifier?(t=>{this.checkBytes.push(this._st.readByte()),t.unknown=this._st.readByte(),t.iterations=this._st.readUnsigned(),t.terminator=this._st.readByte(),this._handler.app&&this._handler.app.NETSCAPE&&this._handler.app.NETSCAPE(t)&&this.checkBytes.push(this._handler.app)})(t):(t=>{t.appData=this.readSubBlocks(),this._handler.app&&this._handler.app[t.identifier]&&this._handler.app[t.identifier](t)&&this.checkBytes.push(this._handler.app[t.identifier])})(t)},o=t=>{t.data=this.readSubBlocks(),this._handler.unknown&&this._handler.unknown(t)&&this.checkBytes.push(this._handler.unknown)};switch(t.label=this._st.readByte(),t.label){case 249:t.extType="gce",e(t);break;case 254:t.extType="com",i(t);break;case 1:t.extType="pte",n(t);break;case 255:t.extType="app",s(t);break;default:t.extType="unknown",o(t)}},this.parseImg=t=>{t.leftPos=this._st.readUnsigned(),t.topPos=this._st.readUnsigned(),t.width=this._st.readUnsigned(),t.height=this._st.readUnsigned();const e=bo(this._st.readByte());t.lctFlag=e.shift(),t.interlaced=e.shift(),t.sorted=e.shift(),t.reserved=e.splice(0,2),t.lctSize=xo(e.splice(0,3)),t.lctFlag&&(t.lct=this.parseColorTable(1<<t.lctSize+1)),t.lzwMinCodeSize=this._st.readByte();const i=this.readSubBlocks();t.pixels=function(t,e){let i=0;const n=function(t){let n=0;for(let s=0;s<t;s++)e.charCodeAt(i>>3)&1<<(7&i)&&(n|=1<<s),i++;return n},s=[],o=1<<t,r=o+1;let a=t+1,l=[];const h=function(){l=[],a=t+1;for(let t=0;t<o;t++)l[t]=[t];l[o]=[],l[r]=null};let c,d;for(;;)if(d=c,c=n(a),c!==o){if(c===r)break;if(c<l.length)d!==o&&l.push(l[d].concat(l[c][0]));else{if(c!==l.length)throw new Error("Invalid LZW code.");l.push(l[d].concat(l[d][0]))}s.push.apply(s,l[c]),l.length===1<<a&&a<12&&a++}else h();return s}(t.lzwMinCodeSize,i),t.interlaced&&(t.pixels=((t,e)=>{const i=new Array(t.length),n=t.length/e,s=(n,s)=>{const o=t.slice(s*e,(s+1)*e);i.splice.apply(i,[n*e,e].concat(o))},o=[0,4,2,1],r=[8,8,4,2];let a=0;for(let t=0;t<4;t++)for(let e=o[t];e<n;e+=r[t])s(e,a),a++;return i})(t.pixels,t.width)),this.frames.push(t),this.arrayToImage(t),this._handler.img&&this._handler.img(t)&&this.checkBytes.push(this._handler)},this.parseBlock=()=>{const t={sentinel:this._st.readByte(),type:""};switch(String.fromCharCode(t.sentinel)){case"!":t.type="ext",this.parseExt(t);break;case",":t.type="img",this.parseImg(t);break;case";":t.type="eof",this._handler.eof&&this._handler.eof(t)&&this.checkBytes.push(this._handler.eof);break;default:throw new Error("Unknown block: 0x"+t.sentinel.toString(16))}"eof"!==t.type&&this.parseBlock()},this.arrayToImage=t=>{let e=0;const i=document.createElement("canvas");i.id=e.toString(),i.width=t.width,i.height=t.height,e++;const n=i.getContext("2d");let s=0,o=0;for(let e=0;e<t.pixels.length;e++)o%t.width==0&&(s++,o=0),this.globalColorTable[t.pixels[e]]===this._transparentColor.toHex()?n.fillStyle="rgba(0, 0, 0, 0)":n.fillStyle=this.globalColorTable[t.pixels[e]],n.fillRect(o,s,1,1),o++;const r=new Image;r.src=i.toDataURL(),this.images.push(r)},this._st=t,this._handler={},this._transparentColor=e,this.parseHeader(),this.parseBlock()}}class So extends zt{constructor(t){super(),this.color=wt.Black,this.thickness=1;const{start:e,end:i,color:n,thickness:s}=t;this.start=e,this.end=i,this.color=null!=n?n:this.color,this.thickness=null!=s?s:this.thickness;const{width:o,height:r}=At.fromPoints([e,i]);this.width=o,this.height=r}_drawImage(t,e,i){t.drawLine(this.start,this.end,this.color,this.thickness)}clone(){return new So({start:this.start,end:this.end,color:this.color,thickness:this.thickness})}}class Eo extends Le{get points(){return this._points}set points(t){this._points=t;const e=this.minPoint;this.width=this._points.reduce(((t,e)=>Math.max(e.x,t)),0)-e.x,this.height=this._points.reduce(((t,e)=>Math.max(e.y,t)),0)-e.y,this.flagDirty()}get minPoint(){return yt(this._points.reduce(((t,e)=>Math.min(e.x,t)),1/0),this._points.reduce(((t,e)=>Math.min(e.y,t)),1/0))}constructor(t){super(t),this.points=t.points,this.filtering=Ht.Blended,this.rasterize()}clone(){return new Eo({points:this.points.map((t=>t.clone())),...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){if(this.points&&this.points.length){t.beginPath();const e=this.minPoint.negate(),i=this.points[0].add(e);t.moveTo(i.x,i.y),this.points.forEach((i=>{t.lineTo(i.x+e.x,i.y+e.y)})),t.lineTo(i.x,i.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}class To{constructor(){this._queue=[]}get length(){return this._queue.length}enqueue(){const t=new St;return this._queue.push(t),t.promise}dequeue(t){this._queue.shift().resolve(t)}}class ko{constructor(t){this._count=t,this._waitQueue=new To}get count(){return this._count}get waiting(){return this._waitQueue.length}async enter(){return 0!==this._count?(this._count--,Promise.resolve()):this._waitQueue.enqueue()}exit(t=1){if(0!==t){for(;0!==t&&0!==this._waitQueue.length;)this._waitQueue.dequeue(null),t--;this._count+=t}}}const Mo="0.28.0";p()})();var a=r.fWn,l=r.Ia8,h=r.rqv,c=r.hLI,d=r.yyv,u=r.tX5,p=r.vtX,g=r.r7K,f=r.lCh,m=r.cE4,v=r.fwF,_=r.sce,y=r.AQ6,w=r._c7,x=r.KUs,b=r.Ajp,C=r.dkO,A=r.RDh,S=r._H9,E=r.mxs,T=r.OmD,k=r.kBf,M=r.C4F,$=r.NQt,L=r.JjN,R=r.EK_,I=r.V1s,D=r.xHm,P=r.Xz7,B=r.Cdc,F=r.FKn,O=r.SUY,N=r.ab2,z=r.GfZ,W=r.YMS,H=r.oyv,U=r.aUb,j=r.SdD,V=r.JUv,G=r.jEj,K=r.TFq,Y=r.HDU,q=r.R_y,X=r.ydN,Z=r.t50,Q=r.s$$,J=r.v2G,tt=r.Ilk,et=r.s9i,it=r.dxL,nt=r.LLX,st=r.wA2,ot=r.R_p,rt=r.IQ$,at=r.I5F,lt=r.X8$,ht=r.FR6,ct=r.U8o,dt=r.kbG,ut=r.iS_,pt=r.cGG,gt=r.RPN,ft=r.skb,mt=r.SLU,vt=r.RdJ,_t=r.cNu,yt=r.gU7,wt=r.LSk,xt=r.Nmp,bt=r.d1Y,Ct=r.xrL,At=r.sRW,St=r.cmV,Et=r.qWz,Tt=r.N0Q,kt=r.q8b,Mt=r.ynB,$t=r.jT9,Lt=r.wAz,Rt=r.D4V,It=r.NLr,Dt=r.N6H,Pt=r.W1A,Bt=r.JHW,Ft=r.ZZ$,Ot=r.v2K,Nt=r.pBf,zt=r.vpe,Wt=r.GMl,Ht=r.zW2,Ut=r.B0K,jt=r.Nv7,Vt=r.C_p,Gt=r.MUA,Kt=r.xqU,Yt=r.pTp,qt=r.vUK,Xt=r.j9l,Zt=r.Zxw,Qt=r.v51,Jt=r.Hdx,te=r.Z$d,ee=r.iqV,ie=r.o$7,ne=r.olM,se=r.Zm$,oe=r.$QH,re=r.i78,ae=r.nJg,le=r.h6u,he=r.hts,ce=r.j88,de=r.VME,ue=r.fy2,pe=r.nt,ge=r.Ukr,fe=r.zsu,me=r.oA6,ve=r.TVh,_e=r.TwZ,ye=r.GTT,we=r.xxj,xe=r.XdK,be=r.Jmb,Ce=r.cXo,Ae=r.Dm5,Se=r.IIB,Ee=r.ebW,Te=r.zI0,ke=r.LYD,Me=r.cEG,$e=r.SEl,Le=r.t9V,Re=r.ez5,Ie=r.N1d,De=r.R8U,Pe=r.SKZ,Be=r.__J,Fe=r.RI$,Oe=r.x12,Ne=r.ccz,ze=r.aNw,We=r.XrL,He=r.xwn,Ue=r.dNK,je=r.ini,Ve=r.YdH,Ge=r.F5T,Ke=r.y3G,Ye=r.l57,qe=r.xn0,Xe=r.t2V,Ze=r.uxB,Qe=r.cpd,Je=r.fiy,ti=r.$XZ,ei=r.UG6,ii=r.uqK,ni=r.STE,si=r.y$z,oi=r.mAD,ri=r.sOq,ai=r.hUw,li=r._0G,hi=r.Sqs,ci=r.hpZ,di=r.Vol,ui=r.vYX,pi=r.wIZ,gi=r.cBi,fi=r.c30,mi=r.MPV,vi=r.RFv,_i=r.Ux6,yi=r.rxy,wi=r.I$c,xi=r.kfC,bi=r.VjY,Ci=r.mgq,Ai=r.YVA,Si=r.Kgp,Ei=r.HH$,Ti=r.M_d,ki=r.rgh,Mi=r.Ra6,$i=r.KhR,Li=r.BS5,Ri=r.xhz,Ii=r.xOq,Di=r.a9j,Pi=r.bHk,Bi=r.CgK,Fi=r.cuY,Oi=r.kvE,Ni=r.SBu,zi=r.AE_,Wi=r.ctO,Hi=r.OLH,Ui=r.kky,ji=r.nSF,Vi=r.zHn,Gi=r.zwx,Ki=r.AeJ,Yi=r.hLz,qi=r.D9g,Xi=r.wA,Zi=r.jhr,Qi=r.GVs,Ji=r._zO,tn=r.LXZ,en=r.w6$,nn=r.mhV,sn=r.MOD,on=r.kwd,rn=r.Lmr,an=r.xsS,ln=r.K5l,hn=r.lLr,cn=r.Z$r,dn=r.IXb,un=r.SGH,pn=r.SMj,gn=r.L34,fn=r.exe,mn=r.bnF,vn=r.MFA,_n=r.$uU,yn=r.Sap,wn=r.jyi,xn=r.E03,bn=r.V6q,Cn=r.rg2,An=r.DVW,Sn=r.nVo,En=r.F6N,Tn=r.xP7,kn=r.Odq,Mn=r.Zif,$n=r.ZGJ,Ln=r.MJk,Rn=r.xvT,In=r.PHM,Dn=r.dpR,Pn=r.n9L,Bn=r.KwO,Fn=r.SxM,On=r.B7y,Nn=r.x7r,zn=r.wx7,Wn=r.Uvn,Hn=r.OFT,Un=r.xzN,jn=r.CcZ,Vn=r.M5Z,Gn=r.ZrN,Kn=r.OWs,Yn=r.dF9,qn=r.oZy,Xn=r.rD2,Zn=r.VHo,Qn=r.ohE,Jn=r.R$E,ts=r.xQN,es=r.AdJ,is=r.q3I,ns=r.Pab,ss=r.uZ5,os=r.McK,rs=r.F9c,as=r.k0b,ls=r.hnT,hs=r.RSJ,cs=r.Mku,ds=r.h90,us=r.rms,ps=r.ErP,gs=r.aVg,fs=r.lPc,ms=r.Z8E,vs=r._N2,_s=r.yFn,ys=r.lNv,ws=r.cu9,xs=r.MZQ,bs=r.FUM,Cs=r.BxR,As=r.vdf,Ss=r.iaL,Es=r.w6H,Ts=r.Q4c,ks=r.Xxe,Ms=r.Uxb,$s=r.Yr5,Ls=r.Bhw,Rs=r.yOA},548:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>v});var n=i(379),s=i.n(n),o=i(795),r=i.n(o),a=i(569),l=i.n(a),h=i(565),c=i.n(h),d=i(216),u=i.n(d),p=i(589),g=i.n(p),f=i(424),m={};m.styleTagTransform=g(),m.setAttributes=c(),m.insert=l().bind(null,"head"),m.domAPI=r(),m.insertStyleElement=u(),s()(f.Z,m);const v=f.Z&&f.Z.locals?f.Z.locals:void 0},379:t=>{"use strict";var e=[];function i(t){for(var i=-1,n=0;n<e.length;n++)if(e[n].identifier===t){i=n;break}return i}function n(t,n){for(var o={},r=[],a=0;a<t.length;a++){var l=t[a],h=n.base?l[0]+n.base:l[0],c=o[h]||0,d="".concat(h," ").concat(c);o[h]=c+1;var u=i(d),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)e[u].references++,e[u].updater(p);else{var g=s(p,n);n.byIndex=a,e.splice(a,0,{identifier:d,updater:g,references:1})}r.push(d)}return r}function s(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,s){var o=n(t=t||[],s=s||{});return function(t){t=t||[];for(var r=0;r<o.length;r++){var a=i(o[r]);e[a].references--}for(var l=n(t,s),h=0;h<o.length;h++){var c=i(o[h]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}o=l}}},569:t=>{"use strict";var e={};t.exports=function(t,i){var n=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(i)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,i)=>{"use strict";t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var n="";i.supports&&(n+="@supports (".concat(i.supports,") {")),i.media&&(n+="@media ".concat(i.media," {"));var s=void 0!==i.layer;s&&(n+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),n+=i.css,s&&(n+="}"),i.media&&(n+="}"),i.supports&&(n+="}");var o=i.sourceMap;o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},3:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.animManager=e.AnimationManager=void 0;const r=o(i(882));class a extends r.Actor{constructor(){super({name:"AnimationManager",pos:r.Vector.Zero,width:0,height:0,collisionType:r.CollisionType.PreventCollision}),this.animations=[],this.graphics.onPostDraw=t=>this.drawAnimations(t)}play(t,e){this.animations.push({anim:t.clone(),pos:e.clone()})}onPostUpdate(t,e){this.animations.forEach((i=>i.anim.tick(e,t.stats.currFrame.id))),this.animations=this.animations.filter((t=>!t.anim.done))}drawAnimations(t){for(let e of this.animations)e.anim.draw(t,e.pos.x-e.anim.width/2,e.pos.y-e.anim.height/2)}}e.AnimationManager=a;const l=new a;e.animManager=l},330:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Asteroid=void 0;const a=o(i(882)),l=r(i(913)),h=i(512);class c extends a.Actor{constructor(t,e,i,n){super({pos:new a.Vector(t,e),width:i,height:n}),this.isExploding=!1,this.body.collisionType=a.CollisionType.Passive}onInitialize(t){this.graphics.onPostDraw=this.onPostDraw.bind(this),this.on("precollision",(t=>this.onPreCollision(t))),this.anim=a.Animation.fromSpriteSheet(h.gameSheet,[23],100,a.AnimationStrategy.Loop),this.anim.scale=new a.Vector(4,4),this.graphics.use(this.anim),this.explode=a.Animation.fromSpriteSheet(h.explosionSpriteSheet,a.range(0,h.explosionSpriteSheet.sprites.length-1),40,a.AnimationStrategy.End),this.explode.scale=new a.Vector(3,3);const e=Math.random()*Math.PI*2,i=2*Math.random();this.vel=new a.Vector(Math.cos(e)*l.default.enemySpeed*i,Math.sin(e)*l.default.enemySpeed*i)}onPostUpdate(t,e){this.isExploding&&(this.vel=a.Vector.Zero,this.body.collisionType=a.CollisionType.PreventCollision)}onPreCollision(t){this.isExploding||(h.Sounds.explodeSound.play(),this.isExploding=!0)}reverseDirection(){const t=this.vel;this.vel=t.negate()}onPostDraw(){this.isExploding&&this.explode&&(this.graphics.use(this.explode),this.explode.done&&this.kill())}}e.Asteroid=c,c.group=a.CollisionGroupManager.create("asteroid")},506:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Baddie=void 0;const a=o(i(882)),l=r(i(913)),h=i(512),c=i(527),d=i(3),u=i(746);class p extends a.Actor{constructor(t,e,i,n){super({pos:new a.Vector(t,e),width:i,height:n}),this.fireAngle=Math.random()*Math.PI*2,this.body.collisionType=a.CollisionType.Passive,this.body.group=p.group,this.on("precollision",(t=>this.onPreCollision(t)))}onInitialize(t){this.anim=a.Animation.fromSpriteSheet(h.gameSheet,[10,11,12],100,a.AnimationStrategy.Loop),this.anim.scale=new a.Vector(4,4),this.graphics.use(this.anim),this.explode=a.Animation.fromSpriteSheet(h.explosionSpriteSheet,a.range(0,h.explosionSpriteSheet.sprites.length-1),40,a.AnimationStrategy.End),this.explode.scale=new a.Vector(3,3),this.actions.repeatForever((t=>t.moveTo(this.pos.x,this.pos.y+800,l.default.enemySpeed).moveTo(this.pos.x+800,this.pos.y,l.default.enemySpeed).moveTo(this.pos.x+800,this.pos.y+800,l.default.enemySpeed).moveTo(this.pos.x,this.pos.y,l.default.enemySpeed))),this.fireTimer=new a.Timer({fcn:()=>{this.fire(t)},interval:l.default.enemyFireInterval,repeats:!0,numberOfRepeats:-1}),t.addTimer(this.fireTimer),this.fireTimer.start()}onPreCollision(t){t.other instanceof p||a.Util.contains(p.Bullets,t.other)||(h.Sounds.explodeSound.play(),this.explode&&d.animManager.play(this.explode,this.pos),c.stats.score+=100,this.fireTimer&&this.fireTimer.cancel(),this.kill())}fire(t){this.fireAngle+=Math.PI/20;const e=new a.Vector(l.default.enemyBulletVelocity*Math.cos(this.fireAngle),l.default.enemyBulletVelocity*Math.sin(this.fireAngle)),i=new u.Bullet(this.pos.x,this.pos.y,e.x,e.y,p.group);p.Bullets.push(i),t.add(i)}}e.Baddie=p,p.group=a.CollisionGroupManager.create("enemy"),p.Bullets=[]},746:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Bullet=void 0;const a=o(i(882)),l=r(i(913)),h=i(512),c=i(506);class d extends a.Actor{constructor(t,e,i,n,s){super({pos:new a.Vector(t,e),vel:new a.Vector(i,n),width:l.default.bulletSize,height:l.default.bulletSize}),this.body.collisionType=a.CollisionType.Passive,this.body.group=s}onInitialize(t){this.on("precollision",(t=>this.onPreCollision(t))),this.on("exitviewport",(()=>this.killAndRemoveFromBullets()));const e=a.Animation.fromSpriteSheet(h.gameSheet,[3,4,5,6,7,8,7,6,5,4],100,a.AnimationStrategy.Loop);e.scale=new a.Vector(2,2),this.graphics.use(e)}onPreCollision(t){t.other instanceof d||this.killAndRemoveFromBullets()}killAndRemoveFromBullets(){this.kill(),a.Util.removeItemFromArray(this,c.Baddie.Bullets)}}e.Bullet=d},169:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Console=void 0;const a=o(i(882)),l=i(882),h=r(i(913));class c extends a.Actor{constructor(){super({name:"console",color:a.Color.DarkGray,pos:new a.Vector((window.innerWidth-h.default.consoleWidth)/3,window.innerHeight-h.default.consoleHeight-70)}),this.cursorVisible=!0,this.cursorTimer=new a.Timer({interval:500,fcn:()=>{this.cursorVisible=!this.cursorVisible},repeats:!0}),this.ConsoleWidth=h.default.consoleWidth,this.ConsoleHeight=h.default.consoleHeight,this.currentCommand="",this.transform.coordPlane=a.CoordPlane.Screen,this.body.collisionType=a.CollisionType.Active,this.graphics.anchor=l.Vector.Zero,this.graphics.use(new a.Canvas({draw:t=>this.draw(t),cache:!1,width:h.default.consoleWidth+20,height:h.default.consoleHeight+50})),window.addEventListener("keydown",(t=>this.handleKeyPress(t)))}handleKeyPress(t){"Enter"===t.key?(this.executeCommand(this.currentCommand),this.currentCommand=""):"Backspace"===t.key?this.currentCommand=this.currentCommand.slice(0,-1):this.currentCommand+=t.key}executeCommand(t){console.log(`Executing command: ${t}`)}draw(t){t.strokeStyle=this.color.toString(),t.fillStyle=this.color.toString(),t.lineWidth=3,t.font="italic 20px Open Sans",t.fillText("command console",0,30),t.strokeRect(0,35,h.default.consoleWidth+10,h.default.consoleHeight+10),t.fillRect(5,40,this.ConsoleWidth,h.default.consoleHeight),t.fillText(this.currentCommand,10,h.default.consoleHeight+50),this.cursorVisible&&t.fillRect(10+t.measureText(this.currentCommand).width,h.default.consoleHeight+40,10,20)}}e.Console=c},96:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.HealthBar=void 0;const a=o(i(882)),l=i(882),h=r(i(913)),c=i(527);class d extends a.Actor{constructor(){super({name:"healthbar",color:a.Color.Red,pos:new a.Vector(20,700)}),this.healthBarWidth=h.default.healthBarWidth,this.healthBarHeight=h.default.healthBarHeight,this.transform.coordPlane=a.CoordPlane.Screen,this.body.collisionType=a.CollisionType.PreventCollision,this.graphics.anchor=l.Vector.Zero,this.graphics.use(new a.Canvas({draw:t=>this.draw(t),cache:!1,width:100,height:100}))}onPreUpdate(){this.healthBarWidth=h.default.healthBarWidth*(c.stats.hp/h.default.totalHp)}draw(t){t.clearRect(0,0,100,100),t.strokeStyle=this.color.toString(),t.fillStyle=this.color.toString(),t.lineWidth=3,t.beginPath(),t.arc(50,50,40,0,2*Math.PI),t.closePath(),t.stroke();const e=2*Math.PI*(c.stats.hp/h.default.totalHp);t.beginPath(),t.moveTo(50,50),t.arc(50,50,40,-Math.PI/2,-Math.PI/2+e),t.lineTo(50,50),t.closePath(),t.fill(),t.font="normal 30px Open Sans",t.fillText("",0,30)}}e.HealthBar=d},103:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Ship=void 0;const a=o(i(882)),l=r(i(913)),h=i(512),c=i(746);class d extends a.Actor{constructor(t,e,i,n){super({pos:new a.Vector(t,e),width:i,height:n}),this.flipBarrel=!1,this.isLeftEngineOn=!1,this.isRightEngineOn=!1,this.isLeftSensorTriggered=!1,this.isRightSensorTriggered=!1,this.shouldFireBullet=!1,this.stopRegisteringFireThrottleEvent=()=>{this.throttleFire=void 0},this.fire=t=>{const e=this.pos.add(a.vec(0,-48).rotate(this.rotation)),i=a.Vector.Up.scale(l.default.playerBulletVelocity).rotate(this.rotation),n=new c.Bullet(e.x,e.y,i.x,i.y,d.group);this.flipBarrel=!this.flipBarrel,h.Sounds.laserSound.play(),t.add(n)},this.body.collisionType=a.CollisionType.Passive,this.body.group=d.group}onInitialize(t){this.throttleFire=function(t,e){var i=Date.now();return n=>{var s=Date.now();if(s-i>e){var o=t.apply(this,[n]);return i=s,o}}}(this.fire,l.default.playerFireThrottle),this.on("precollision",(t=>this.onPreCollision(t)));const e=a.Animation.fromSpriteSheet(h.gameSheet,[19],100,a.AnimationStrategy.Loop);e.scale=new a.Vector(4,4),this.graphics.use(e),this.explode=a.Animation.fromSpriteSheet(h.explosionSpriteSheet,a.range(0,h.explosionSpriteSheet.sprites.length-1),40,a.AnimationStrategy.End),this.explode.scale=new a.Vector(3,3)}onPreCollision(t){}onPreUpdate(t,e){this.isLeftEngineOn&&!this.isRightEngineOn?"simple"===l.default.physicsMode?this.body.angularVelocity=Math.PI/(e/2):this.body.angularVelocity+=Math.PI/(32*e):!this.isLeftEngineOn&&this.isRightEngineOn?"simple"===l.default.physicsMode?this.body.angularVelocity=-Math.PI/(e/2):this.body.angularVelocity-=Math.PI/(32*e):"simple"===l.default.physicsMode&&(this.body.angularVelocity=0);const i=[this.isLeftEngineOn,this.isRightEngineOn].filter((t=>t)).length*l.default.playerSpeedPerEngine;this.body.vel=a.vec(0,-i).rotate(this.rotation)}onPostUpdate(t,e){const i=16+(this.isLeftEngineOn?0:2)+(this.isRightEngineOn?0:1),n=a.Animation.fromSpriteSheet(h.gameSheet,[i],100,a.AnimationStrategy.Loop);n.scale=new a.Vector(4,4),this.graphics.use(n);const s=a.Vector.Up.rotate(this.body.rotation),o=new a.Ray(this.pos.add(s.scale(32)).add(a.Vector.Left.scale(64).rotate(this.body.rotation)),s),r=this.scene.physics.rayCast(o);this.isLeftSensorTriggered=!!r.length;const l=new a.Ray(this.pos.add(s.scale(32)).add(a.Vector.Right.scale(64).rotate(this.body.rotation)),s),c=this.scene.physics.rayCast(l);this.isRightSensorTriggered=!!c.length,this.shouldFireBullet&&(this.shouldFireBullet=!1,this.throttleFire&&this.throttleFire(t))}}e.Ship=d,d.group=a.CollisionGroupManager.create("player")},913:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={playerSpeedPerEngine:200,physicsMode:"simple",backgroundTileCount:128,backgroundTileSize:600,playerBulletVelocity:600,playerFireThrottle:500,enemySpawnRadius:1500,spawnTime:100,soundVolume:.1,missileSpeed:-400,enemyBulletVelocity:-300,enemySpeed:200,enemyFireInterval:900,enemyDamage:10,bulletSize:5,healthBarHeight:25,healthBarWidth:400,consoleWidth:700,consoleHeight:100,totalHp:100,currentStripe:19}},769:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;const a=o(i(882)),l=i(96),h=i(103),c=i(506),d=r(i(913)),u=i(527),p=i(3),g=i(169);class f extends a.Scene{constructor(){super(),this.random=new a.Random(1337)}onInitialize(t){t.add(p.animManager);const e=new h.Ship(t.halfDrawWidth,800,80,80);t.add(e);const i=new l.HealthBar;t.add(i);const n=new g.Console;t.add(n);const s=new a.Label({text:"Score: "+u.stats.score,pos:a.vec(80,50)});s.font.quality=4,s.font.size=30,s.font.unit=a.FontUnit.Px,s.font.family="Open Sans",s.transform.coordPlane=a.CoordPlane.Screen,s.color=a.Color.Azure,s.on("preupdate",(t=>{s.text="Score: "+u.stats.score})),t.add(s);const o=new a.Label({text:"Game Over",pos:a.vec(t.halfDrawWidth-250,t.halfDrawHeight)});o.font.quality=4,o.font.size=60,o.color=a.Color.Green.clone(),o.scale=new a.Vector(2,2),o.actions.repeatForever((t=>t.blink(1e3,1e3,400)));let r=new a.Timer({fcn:()=>{var e=new c.Baddie(this.random.floating(this.camera.viewport.left,this.camera.viewport.right),-100,80,80);t.add(e)},interval:d.default.spawnTime,repeats:!0,numberOfRepeats:-1});t.addTimer(r),r.start(),t.on("preupdate",(()=>{u.stats.gameOver&&t.add(o)}))}}e.Game=f},164:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,a)}l((n=n.apply(t,e||[])).next())}))},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LevelOne=void 0,i(239),i(395),i(658);const l=a(i(239)),h=o(i(882)),c=i(3),d=i(103),u=a(i(913)),p=i(512),g=document.getElementById("rootDiv");class f extends h.Scene{constructor(){super(),this.random=new h.Random(1337),this.deployedCode="const ENGINE_LEFT = 0;\nconst ENGINE_RIGHT = 1;\nconst SENSOR_LEFT = 10;\nconst SENSOR_RIGHT = 11;\nconst LOW = 0;\nconst HIGH = 1;\n\n// This function is called every cycle forever.\nfunction loop() {\n\n}",this.isSimulating=!1,this.sinceLastSimulationMs=0,this.globals={}}onActivate(t){g.innerHTML=`\n\t\t\t<section id="sandbox-editor">\n\t\t\t\t<button id="sandbox-collapse">Collapse</button>\n\t\t\t\t<button id="sandbox-fullscreen">Full Screen</button>\n\t\t\t\t<button id="switch">Output</button>\n\t\t\t\t<div id="editor">${this.deployedCode}</div>\n\t\t\t\t<textarea id="output" readonly style="display: none"></textarea>\n\t\t\t\t<footer>\n\t\t\t\t\t<button id="sandbox-deploy">Deploy</button>\n\t\t\t\t\t<button id="sandbox-back">Back</button>\n\t\t\t\t</footer>\n\t\t\t</section>\n\t\t`;const e=l.default.edit("editor",{useWorker:!1});e.setTheme("ace/theme/github_dark"),e.session.setMode("ace/mode/javascript");const i=document.getElementById("sandbox-deploy"),n=document.getElementById("sandbox-collapse"),s=document.getElementById("editor"),o=document.getElementById("sandbox-fullscreen"),r=document.getElementById("switch"),a=document.getElementById("output"),h=document.getElementById("sandbox-back");i.addEventListener("click",(()=>{const t=e.getValue();this.deployedCode=t})),n.addEventListener("click",(()=>{"none"===s.style.display?(s.style.display="block",o.style.display="inline-block",n.innerText="Collapse"):(s.style.display="none",o.style.display="none",n.innerText="Expand")})),o.addEventListener("click",(()=>{"70vh"===s.style.height?(s.style.height="20vh",o.innerText="Full Screen"):(s.style.height="70vh",o.innerText="Exit Full")})),r.addEventListener("click",(()=>{"none"===s.style.display?(s.style.display="block",a.style.display="none",r.innerText="Output",o.style.display="inline-block",n.style.display="inline-block"):(s.style.display="none",a.style.display="block",r.innerText="Editor",o.style.display="none",n.style.display="none")})),h.addEventListener("click",(()=>{t.engine.goToScene("mainmenu")}))}onDeactivate(){g.innerHTML=""}onPreUpdate(t,e){this.sinceLastSimulationMs+=e,this.isSimulating&&(this.sinceLastSimulationMs=0),this.sinceLastSimulationMs>=100&&(this.sinceLastSimulationMs=0,this.simulate(t))}onPostUpdate(t,e){this.camera.pos=this.ship.pos}simulate(t){return r(this,void 0,void 0,(function*(){const e=this.globals;try{this.isSimulating=!0,yield Function(`\n\t\t\t\t'use strict'\n\t\t\t\tconst { delay, g_has, g_get, g_set, print, read, write } = this\n\t\t\t\t${this.deployedCode.replace("function loop()","async function loop()").replace(/\bdelay\s*\(\s*(\d+)\s*\)/g,"await delay($1 * 100)")}\n\t\t\t\t;return loop()\n\t\t\t`).bind({delay:e=>new Promise((i=>t.clock.schedule(i,e))),g_has:t=>t in e,g_get:t=>e[t],g_set(t,i){e[t]=i},print:(...t)=>{this.showInOutput(t.join(" "))},read:t=>{switch(t){case 0:return Number(this.ship.isLeftEngineOn);case 1:return Number(this.ship.isRightEngineOn);case 10:return Number(this.ship.isLeftSensorTriggered);case 11:return Number(this.ship.isRightSensorTriggered);default:return 0}},write:(t,e)=>{switch(t){case 0:this.ship.isLeftEngineOn=Boolean(e);break;case 1:this.ship.isRightEngineOn=Boolean(e)}}})()}catch(t){this.showInOutput(`${t}`)}finally{this.isSimulating=!1}}))}showInOutput(t){const e=document.getElementById("output"),i=(new Date).toLocaleTimeString();e.textContent+=`[${i}] `+t+"\n",e.scrollTop=e.scrollHeight}onInitialize(t){t.add(c.animManager);const e=new h.TileMap({rows:128,columns:128,tileWidth:u.default.backgroundTileSize,tileHeight:u.default.backgroundTileSize});e.pos=h.vec(-64*u.default.backgroundTileSize,-64*u.default.backgroundTileSize);const i=p.Images.stars.toSprite();i.destSize.width=u.default.backgroundTileSize,i.destSize.height=u.default.backgroundTileSize;for(const t of e.tiles)t.addGraphic(i);this.add(e);const n=new d.Ship(t.halfDrawWidth,900,80,80);t.add(n),this.ship=n}}e.LevelOne=f},433:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Levels=void 0;const r=o(i(882)),a=document.getElementById("rootDiv");class l extends r.Scene{constructor(){super()}onActivate(t){a.innerHTML='\n         <section id="main-menu">\n            <div class="container">\n            <div class="gap">\n               <div>\n                   <h1 id="h1-SS">StellarScript</h1>\n                   <div class="gap">\n                       <button id="level-one">Level 1</button>\n                       <button id="level-two">Level Two</button>\n                   </div>\n               </div>\n            </div>\n         </section>\n        ',document.getElementById("level-one").onclick=()=>{t.engine.goToScene("level-one")},document.getElementById("level-two")}onDeactivate(t){a.innerHTML=""}}e.Levels=l},519:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,a)}l((n=n.apply(t,e||[])).next())}))},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const l=o(i(882)),h=a(i(913)),c=i(769),d=i(512),u=i(671);i(548);const p=i(523),g=i(433),f=i(164),m=document.getElementById("gameCanvas"),v=document.getElementById("rootDiv"),_=new l.Engine({backgroundColor:l.Color.Black,pixelRatio:2,width:2e3,height:1400,displayMode:l.DisplayMode.FitScreen,canvasElement:m});if(_.backgroundColor=l.Color.Black,_.setAntialiasing(!1),d.Images.backgroundImage){const t=d.Images.backgroundImage.toSprite();t.destSize.width=_.screen.resolution.width,t.destSize.height=_.screen.resolution.height;const e=new l.Actor({x:_.screen.resolution.width/2,y:_.screen.resolution.height/2,width:_.screen.resolution.width,height:_.screen.resolution.height});e.z=-99,e.graphics.anchor=l.Vector.Zero,e.graphics.use(t),_.add(e)}else console.error("Background image not loaded");function y(){v.style.top=`${m.offsetTop}px`,v.style.left=`${m.offsetLeft}px`,v.style.width=`${m.offsetWidth}px`,v.style.height=`${m.offsetHeight}px`}_.add("level-one",new f.LevelOne),_.add("game",new c.Game),_.add("levels",new g.Levels),_.add("mainmenu",new p.MainMenu),_.add("sandbox",new u.Sandbox),_.goToScene("mainmenu"),_.on("hidden",(()=>{console.log("pause"),_.stop()})),_.on("visible",(()=>{console.log("start"),_.start()})),_.input.keyboard.on("press",(t=>{})),function(t,e=2e3,i=100){return r(this,void 0,void 0,(function*(){return new Promise(((n,s)=>{const o=setInterval((()=>r(this,void 0,void 0,(function*(){try{yield document.fonts.load(t)}catch(t){s(t)}document.fonts.check(t)&&(clearInterval(o),n(!0))}))),i);setTimeout((()=>clearInterval(o)),e)}))}))}("normal 30px Open Sans").then((()=>{_.start(d.loader).then((()=>{d.Sounds.laserSound.volume=h.default.soundVolume,d.Sounds.explodeSound.volume=h.default.soundVolume,d.Sounds.enemyFireSound.volume=h.default.soundVolume,d.Sounds.powerUp.volume=h.default.soundVolume,d.Sounds.rocketSound.volume=h.default.soundVolume,console.log("Game Resources Loaded")}))})),y(),window.addEventListener("resize",(()=>{y()}))},523:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MainMenu=void 0;const a=o(i(882)),l=r(i(913)),h=document.getElementById("rootDiv");class c extends a.Scene{constructor(){super()}onActivate(t){h.innerHTML='\n            <section id="main-menu" class="w-full flex flex-row gap-4">\n                <h1 id="h1-SS">StellarScript</h1>\n                <button id="level-select" class="button blue">Levels</button>\n                <button id="sandbox-button" class="button blue">Sandbox</button>\n                <div class="flex flex-row gap-4 justify-stretch w-60">\n                    <button id="go-fullscreen" class="button yellow">Fullscreen</button>\n                    <button id="toggle-physics" class="button yellow">Physics: simple</button>\n                </div>\n            </section>\n        ',document.getElementById("sandbox-button").onclick=()=>{this.engine.goToScene("sandbox")},document.getElementById("go-fullscreen").addEventListener("click",(()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}));const e=document.getElementById("toggle-physics");e.onclick=()=>{l.default.physicsMode="simple"===l.default.physicsMode?"advanced":"simple",e.innerText=`Physics: ${l.default.physicsMode}`},document.getElementById("level-select").onclick=()=>{t.engine.goToScene("levels")}}onDeactivate(t){h.innerHTML=""}}e.MainMenu=c},512:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Sounds=e.loader=e.Images=e.gameSheet=e.explosionSpriteSheet=void 0;const a=o(i(882)),l=r(i(401)),h=r(i(521)),c=r(i(385)),d=r(i(336)),u=r(i(624)),p=r(i(869)),g=r(i(394)),f=r(i(170)),m=r(i(255)),v=r(i(87)),_=r(i(154)),y=r(i(629)),w={fighter:new a.ImageSource(u.default),enemyPink:new a.ImageSource(h.default),asteroid:new a.ImageSource(l.default),explosion:new a.ImageSource(y.default),sheet:new a.ImageSource(p.default),stars:new a.ImageSource(m.default)};e.Images=w;const x={laserSound:new a.Sound(f.default),enemyFireSound:new a.Sound(c.default),explodeSound:new a.Sound(d.default),hitSound:new a.Sound(g.default),powerUp:new a.Sound(v.default),rocketSound:new a.Sound(_.default)};e.Sounds=x;const b=a.SpriteSheet.fromImageSource({image:w.explosion,grid:{rows:5,columns:5,spriteWidth:45,spriteHeight:45}});e.explosionSpriteSheet=b;const C=a.SpriteSheet.fromImageSource({image:w.sheet,grid:{rows:10,columns:10,spriteWidth:32,spriteHeight:32}});e.gameSheet=C;const A=new a.Loader;e.loader=A;const S=Object.assign(Object.assign({},w),x);for(const t in S)A.addResource(S[t])},671:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,a)}l((n=n.apply(t,e||[])).next())}))},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Sandbox=void 0,i(239),i(395),i(658);const l=a(i(239)),h=o(i(882)),c=i(330),d=i(103),u=a(i(913)),p=i(512),g=document.getElementById("rootDiv");class f extends h.Scene{constructor(){super(),this.random=new h.Random(1337),this.deployedCode="const ENGINE_LEFT = 0;\nconst ENGINE_RIGHT = 1;\nconst SENSOR_LEFT = 2;\nconst SENSOR_RIGHT = 3;\nconst WEAPON = 4;\nconst LOW = 0;\nconst HIGH = 1;\n\n// This function is called every cycle forever.\nfunction loop() {\n\n}",this.isSimulating=!1,this.sinceLastSimulationMs=0,this.globals={}}onActivate(t){g.innerHTML=`\n\t\t\t<section id="sandbox-editor">\n\t\t\t\t<button id="sandbox-collapse">Collapse</button>\n\t\t\t\t<button id="sandbox-fullscreen">Full Screen</button>\n\t\t\t\t<button id="switch">Output</button>\n\t\t\t\t<div id="editor">${this.deployedCode}</div>\n\t\t\t\t<textarea id="output" readonly style="display: none"></textarea>\n\t\t\t\t<footer>\n\t\t\t\t\t<button id="sandbox-pause">Pause</button>\n\t\t\t\t\t<button id="sandbox-deploy">Deploy</button>\n\t\t\t\t\t<button id="sandbox-back">Back</button>\n\t\t\t\t</footer>\n\t\t\t</section>\n\t\t`;const e=l.default.edit("editor",{useWorker:!1});e.setTheme("ace/theme/github_dark"),e.session.setMode("ace/mode/javascript");const i=document.getElementById("sandbox-pause"),n=document.getElementById("sandbox-deploy"),s=document.getElementById("sandbox-collapse"),o=document.getElementById("editor"),r=document.getElementById("sandbox-fullscreen"),a=document.getElementById("switch"),h=document.getElementById("output"),c=document.getElementById("sandbox-back");i.addEventListener("click",(()=>{"Pause"===i.innerText?(t.engine.stop(),i.innerText="Play"):(t.engine.start(),i.innerText="Pause")})),n.addEventListener("click",(()=>{const t=e.getValue();this.deployedCode=t})),s.addEventListener("click",(()=>{"none"===o.style.display?(o.style.display="block",r.style.display="inline-block",s.innerText="Collapse"):(o.style.display="none",r.style.display="none",s.innerText="Expand")})),r.addEventListener("click",(()=>{"70vh"===o.style.height?(o.style.height="20vh",r.innerText="Full Screen"):(o.style.height="70vh",r.innerText="Exit Full")})),a.addEventListener("click",(()=>{"none"===o.style.display?(o.style.display="block",h.style.display="none",a.innerText="Output",r.style.display="inline-block",s.style.display="inline-block"):(o.style.display="none",h.style.display="block",a.innerText="Editor",r.style.display="none",s.style.display="none")})),c.addEventListener("click",(()=>{t.engine.goToScene("mainmenu")}))}onDeactivate(){g.innerHTML=""}onPreUpdate(t,e){this.sinceLastSimulationMs+=e,this.isSimulating&&(this.sinceLastSimulationMs=0),this.sinceLastSimulationMs>=100&&(this.sinceLastSimulationMs=0,this.simulate(t))}onPostUpdate(t,e){this.camera.pos=this.ship.pos}simulate(t){return r(this,void 0,void 0,(function*(){const e=this.globals;try{this.isSimulating=!0,yield Function(`\n\t\t\t\t'use strict'\n\t\t\t\tconst { delay, g_has, g_get, g_set, print, read, write } = this\n\t\t\t\t${this.deployedCode.replace("function loop()","async function loop()").replace(/\bdelay\s*\(\s*(\d+)\s*\)/g,"await delay($1 * 100)")}\n\t\t\t\t;return loop()\n\t\t\t`).bind({delay:e=>new Promise((i=>t.clock.schedule(i,e))),g_has:t=>t in e,g_get:t=>e[t],g_set(t,i){e[t]=i},print:(...t)=>{this.showInOutput(t.join(" "))},read:t=>{switch(t){case 0:return Number(this.ship.isLeftEngineOn);case 1:return Number(this.ship.isRightEngineOn);case 2:return Number(this.ship.isLeftSensorTriggered);case 3:return Number(this.ship.isRightSensorTriggered);default:return 0}},write:(t,e)=>{switch(t){case 0:this.ship.isLeftEngineOn=Boolean(e);break;case 1:this.ship.isRightEngineOn=Boolean(e);break;case 4:this.ship.shouldFireBullet=Boolean(e)}}})()}catch(t){this.showInOutput(`${t}`)}finally{this.isSimulating=!1}}))}showInOutput(t){const e=document.getElementById("output"),i=(new Date).toLocaleTimeString();e.textContent+=`[${i}] `+t+"\n",e.scrollTop=e.scrollHeight}onInitialize(t){const e=new h.TileMap({rows:u.default.backgroundTileCount,columns:u.default.backgroundTileCount,tileWidth:u.default.backgroundTileSize,tileHeight:u.default.backgroundTileSize});e.pos=h.vec(-u.default.backgroundTileCount*u.default.backgroundTileSize/2,-u.default.backgroundTileCount*u.default.backgroundTileSize/2);const i=p.Images.stars.toSprite();i.destSize.width=u.default.backgroundTileSize,i.destSize.height=u.default.backgroundTileSize;for(const t of e.tiles)t.addGraphic(i);this.add(e);const n=new d.Ship(t.halfDrawWidth,900,80,80);t.add(n),this.ship=n;let s=new h.Timer({fcn:()=>{var e=new c.Asteroid(this.random.floating(this.ship.pos.x-u.default.enemySpawnRadius,this.ship.pos.x+u.default.enemySpawnRadius),this.random.floating(this.ship.pos.y-u.default.enemySpawnRadius,this.ship.pos.y+u.default.enemySpawnRadius),80,80);t.add(e)},interval:u.default.spawnTime,repeats:!0,numberOfRepeats:-1});t.addTimer(s),s.start()}}e.Sandbox=f},527:function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.stats=void 0;const s=n(i(913)),o=new class{constructor(){this.hp=s.default.totalHp,this.gameOver=!1,this.score=0}reset(){this.hp=s.default.totalHp,this.gameOver=!1,this.score=0}};e.stats=o},401:(t,e,i)=>{"use strict";t.exports=i.p+"0bc526feb76a01094013.png"},521:(t,e,i)=>{"use strict";t.exports=i.p+"73c126c98b32a2a1d174.png"},385:(t,e,i)=>{"use strict";t.exports=i.p+"109437615117ec949edb.wav"},336:(t,e,i)=>{"use strict";t.exports=i.p+"68595939d7ffbb2e1f81.wav"},624:(t,e,i)=>{"use strict";t.exports=i.p+"c6d88f9cd7c076b16821.png"},869:(t,e,i)=>{"use strict";t.exports=i.p+"41ba4365cb466fe5e624.png"},394:(t,e,i)=>{"use strict";t.exports=i.p+"55e2fb68f61a6a0a01ba.wav"},170:(t,e,i)=>{"use strict";t.exports=i.p+"7ff63ad5b47002a1eab8.wav"},255:(t,e,i)=>{"use strict";t.exports=i.p+"63ba4728d5686f7a7136.png"},87:(t,e,i)=>{"use strict";t.exports=i.p+"e3e82149d6a7eb8dd036.wav"},154:(t,e,i)=>{"use strict";t.exports=i.p+"f5bfdb4e03a5d35a3987.wav"},629:(t,e,i)=>{"use strict";t.exports=i.p+"f8db5fe78fc678294d4d.png"}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.amdD=function(){throw new Error("define cannot be used indirect")},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var s=n.length-1;s>-1&&!t;)t=n[s--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),i.nc=void 0,i(519)})();
//# sourceMappingURL=main.js.map